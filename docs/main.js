(()=>{var e={9638:function(e){"undefined"!=typeof self&&self,e.exports=function(){var e=[function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(140)),n(r(141)),n(r(53)),n(r(142)),n(r(158)),n(r(159)),n(r(25))},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(51)),n(r(216)),n(r(21)),n(r(3)),n(r(37)),n(r(231))},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(89)),n(r(90)),n(r(91)),n(r(92)),n(r(93)),n(r(239)),n(r(94))},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(17)),n(r(9)),n(r(162)),n(r(163)),n(r(165)),n(r(34)),n(r(213)),n(r(19)),n(r(33)),n(r(215))},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";var n=r(15),i=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};e.exports=d;var o=r(14);o.inherits=r(7);var s=r(57),a=r(29);o.inherits(d,s);for(var l=i(a.prototype),c=0;c<l.length;c++){var u=l[c];d.prototype[u]||(d.prototype[u]=a.prototype[u])}function d(e){if(!(this instanceof d))return new d(e);s.call(this,e),a.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",h)}function h(){this.allowHalfOpen||this._writableState.ended||n.nextTick(p,this)}function p(e){e.end()}Object.defineProperty(d.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(d.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),d.prototype._destroy=function(e,t){this.push(null),this.end(),n.nextTick(t,e)}},function(e,t,r){"use strict";(function(e){var n=r(144),i=r(145),o=r(55);function s(){return l.TYPED_ARRAY_SUPPORT?0x7fffffff:0x3fffffff}function a(e,t){if(s()<t)throw RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=l.prototype:(null===e&&(e=new l(t)),e.length=t),e}function l(e,t,r){if(!l.TYPED_ARRAY_SUPPORT&&!(this instanceof l))return new l(e,t,r);if("number"==typeof e){if("string"==typeof t)throw Error("If encoding is specified then the first argument must be a string");return d(this,e)}return c(this,e,t,r)}function c(e,t,r,n){if("number"==typeof t)throw TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw RangeError("'length' is out of bounds");return t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n),l.TYPED_ARRAY_SUPPORT?(e=t).__proto__=l.prototype:e=h(e,t),e}(e,t,r,n):"string"==typeof t?function(e,t,r){if(("string"!=typeof r||""===r)&&(r="utf8"),!l.isEncoding(r))throw TypeError('"encoding" must be a valid string encoding');var n=0|f(t,r),i=(e=a(e,n)).write(t,r);return i!==n&&(e=e.slice(0,i)),e}(e,t,r):function(e,t){if(l.isBuffer(t)){var r,n=0|p(t.length);return 0===(e=a(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t){return"number"!=typeof t.length||(r=t.length)!=r?a(e,0):h(e,t)}if("Buffer"===t.type&&o(t.data))return h(e,t.data)}throw TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function u(e){if("number"!=typeof e)throw TypeError('"size" argument must be a number');if(e<0)throw RangeError('"size" argument must not be negative')}function d(e,t){if(u(t),e=a(e,t<0?0:0|p(t)),!l.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function h(e,t){var r=t.length<0?0:0|p(t.length);e=a(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function p(e){if(e>=s())throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function f(e,t){if(l.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return N(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return I(e).length;default:if(n)return N(e).length;t=(""+t).toLowerCase(),n=!0}}function g(e,t,r){var i,o,s,a=!1;if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===r||r>this.length)&&(r=this.length),r<=0||(r>>>=0)<=(t>>>=0)))return"";for(e||(e="utf8");;)switch(e){case"hex":return function(e,t,r){var n,i=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>i)&&(r=i);for(var o="",s=t;s<r;++s){o+=(n=e[s])<16?"0"+n.toString(16):n.toString(16)}return o}(this,t,r);case"utf8":case"utf-8":return w(this,t,r);case"ascii":return function(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}(this,t,r);case"latin1":case"binary":return function(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}(this,t,r);case"base64":return i=this,o=t,s=r,0===o&&s===i.length?n.fromByteArray(i):n.fromByteArray(i.slice(o,s));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}(this,t,r);default:if(a)throw TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),a=!0}}function b(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function v(e,t,r,n,i){if(0===e.length)return -1;if("string"==typeof r?(n=r,r=0):r>0x7fffffff?r=0x7fffffff:r<-0x80000000&&(r=-0x80000000),isNaN(r*=1)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length)if(i)return -1;else r=e.length-1;else if(r<0)if(!i)return -1;else r=0;if("string"==typeof t&&(t=l.from(t,n)),l.isBuffer(t))return 0===t.length?-1:y(e,t,r,n,i);if("number"==typeof t){if(t&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf)if(i)return Uint8Array.prototype.indexOf.call(e,t,r);else return Uint8Array.prototype.lastIndexOf.call(e,t,r);return y(e,[t],r,n,i)}throw TypeError("val must be string, number or Buffer")}function y(e,t,r,n,i){var o,s=1,a=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return -1;s=2,a/=2,l/=2,r/=2}function c(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){var u=-1;for(o=r;o<a;o++)if(c(e,o)===c(t,-1===u?0:o-u)){if(-1===u&&(u=o),o-u+1===l)return u*s}else -1!==u&&(o-=o-u),u=-1}else for(r+l>a&&(r=a-l),o=r;o>=0;o--){for(var d=!0,h=0;h<l;h++)if(c(e,o+h)!==c(t,h)){d=!1;break}if(d)return o}return -1}t.Buffer=l,t.SlowBuffer=function(e){return+e!=e&&(e=0),l.alloc(+e)},t.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=s(),l.poolSize=8192,l._augment=function(e){return e.__proto__=l.prototype,e},l.from=function(e,t,r){return c(null,e,t,r)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(e,t,r){return(u(e),e<=0)?a(null,e):void 0!==t?"string"==typeof r?a(null,e).fill(t,r):a(null,e).fill(t):a(null,e)},l.allocUnsafe=function(e){return d(null,e)},l.allocUnsafeSlow=function(e){return d(null,e)},l.isBuffer=function(e){return!!(null!=e&&e._isBuffer)},l.compare=function(e,t){if(!l.isBuffer(e)||!l.isBuffer(t))throw TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:+(n<r)},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!o(e))throw TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);if(void 0===t)for(r=0,t=0;r<e.length;++r)t+=e[r].length;var r,n=l.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var s=e[r];if(!l.isBuffer(s))throw TypeError('"list" argument must be an Array of Buffers');s.copy(n,i),i+=s.length}return n},l.byteLength=f,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)b(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)b(this,t,t+3),b(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)b(this,t,t+7),b(this,t+1,t+6),b(this,t+2,t+5),b(this,t+3,t+4);return this},l.prototype.toString=function(){var e=0|this.length;return 0===e?"":0==arguments.length?w(this,0,e):g.apply(this,arguments)},l.prototype.equals=function(e){if(!l.isBuffer(e))throw TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"},l.prototype.compare=function(e,t,r,n,i){if(!l.isBuffer(e))throw TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return -1;if(t>=r)return 1;if(t>>>=0,r>>>=0,n>>>=0,i>>>=0,this===e)return 0;for(var o=i-n,s=r-t,a=Math.min(o,s),c=this.slice(n,i),u=e.slice(t,r),d=0;d<a;++d)if(c[d]!==u[d]){o=c[d],s=u[d];break}return o<s?-1:+(s<o)},l.prototype.includes=function(e,t,r){return -1!==this.indexOf(e,t,r)},l.prototype.indexOf=function(e,t,r){return v(this,e,t,r,!0)},l.prototype.lastIndexOf=function(e,t,r){return v(this,e,t,r,!1)};function w(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o,s,a,l,c=e[i],u=null,d=c>239?4:c>223?3:c>191?2:1;if(i+d<=r)switch(d){case 1:c<128&&(u=c);break;case 2:(192&(o=e[i+1]))==128&&(l=(31&c)<<6|63&o)>127&&(u=l);break;case 3:o=e[i+1],s=e[i+2],(192&o)==128&&(192&s)==128&&(l=(15&c)<<12|(63&o)<<6|63&s)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:o=e[i+1],s=e[i+2],a=e[i+3],(192&o)==128&&(192&s)==128&&(192&a)==128&&(l=(15&c)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&l<1114112&&(u=l)}null===u?(u=65533,d=1):u>65535&&(u-=65536,n.push(u>>>10&1023|55296),u=56320|1023&u),n.push(u),i+=d}var h=n,p=h.length;if(p<=4096)return String.fromCharCode.apply(String,h);for(var f="",g=0;g<p;)f+=String.fromCharCode.apply(String,h.slice(g,g+=4096));return f}function x(e,t,r){if(e%1!=0||e<0)throw RangeError("offset is not uint");if(e+t>r)throw RangeError("Trying to access beyond buffer length")}function E(e,t,r,n,i,o){if(!l.isBuffer(e))throw TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw RangeError('"value" argument is out of bounds');if(r+n>e.length)throw RangeError("Index out of range")}function _(e,t,r,n){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-r,2);i<o;++i)e[r+i]=(t&255<<8*(n?i:1-i))>>>(n?i:1-i)*8}function T(e,t,r,n){t<0&&(t=0xffffffff+t+1);for(var i=0,o=Math.min(e.length-r,4);i<o;++i)e[r+i]=t>>>(n?i:3-i)*8&255}function O(e,t,r,n,i,o){if(r+n>e.length||r<0)throw RangeError("Index out of range")}function A(e,t,r,n,o){return o||O(e,t,r,4,34028234663852886e22,-34028234663852886e22),i.write(e,t,r,n,23,4),r+4}function S(e,t,r,n,o){return o||O(e,t,r,8,17976931348623157e292,-17976931348623157e292),i.write(e,t,r,n,52,8),r+8}l.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else if(isFinite(t))t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var i,o,s,a,l,c,u,d,h=this.length-t;if((void 0===r||r>h)&&(r=h),e.length>0&&(r<0||t<0)||t>this.length)throw RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var p=!1;;)switch(n){case"hex":return function(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;if(o%2!=0)throw TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var s=0;s<n;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))break;e[r+s]=a}return s}(this,e,t,r);case"utf8":case"utf-8":return i=t,o=r,R(N(e,this.length-i),this,i,o);case"ascii":return s=t,a=r,R(C(e),this,s,a);case"latin1":case"binary":return function(e,t,r,n){return R(C(t),e,r,n)}(this,e,t,r);case"base64":return l=t,c=r,R(I(e),this,l,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return u=t,d=r,R(function(e,t){for(var r,n,i=[],o=0;o<e.length&&!((t-=2)<0);++o)n=(r=e.charCodeAt(o))>>8,i.push(r%256),i.push(n);return i}(e,this.length-u),this,u,d);default:if(p)throw TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),p=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},l.prototype.slice=function(e,t){var r,n=this.length;if(e=~~e,t=void 0===t?n:~~t,e<0?(e+=n)<0&&(e=0):e>n&&(e=n),t<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e),l.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=l.prototype;else{var i=t-e;r=new l(i,void 0);for(var o=0;o<i;++o)r[o]=this[o+e]}return r},l.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||x(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},l.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||x(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},l.prototype.readUInt8=function(e,t){return t||x(e,1,this.length),this[e]},l.prototype.readUInt16LE=function(e,t){return t||x(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUInt16BE=function(e,t){return t||x(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUInt32LE=function(e,t){return t||x(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+0x1000000*this[e+3]},l.prototype.readUInt32BE=function(e,t){return t||x(e,4,this.length),0x1000000*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||x(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},l.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||x(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},l.prototype.readInt8=function(e,t){return(t||x(e,1,this.length),128&this[e])?-((255-this[e]+1)*1):this[e]},l.prototype.readInt16LE=function(e,t){t||x(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?0xffff0000|r:r},l.prototype.readInt16BE=function(e,t){t||x(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?0xffff0000|r:r},l.prototype.readInt32LE=function(e,t){return t||x(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return t||x(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return t||x(e,4,this.length),i.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return t||x(e,4,this.length),i.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return t||x(e,8,this.length),i.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return t||x(e,8,this.length),i.read(this,e,!1,52,8)},l.prototype.writeUIntLE=function(e,t,r,n){if(e*=1,t|=0,r|=0,!n){var i=Math.pow(2,8*r)-1;E(this,e,t,r,i,0)}var o=1,s=0;for(this[t]=255&e;++s<r&&(o*=256);)this[t+s]=e/o&255;return t+r},l.prototype.writeUIntBE=function(e,t,r,n){if(e*=1,t|=0,r|=0,!n){var i=Math.pow(2,8*r)-1;E(this,e,t,r,i,0)}var o=r-1,s=1;for(this[t+o]=255&e;--o>=0&&(s*=256);)this[t+o]=e/s&255;return t+r},l.prototype.writeUInt8=function(e,t,r){return e*=1,t|=0,r||E(this,e,t,1,255,0),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},l.prototype.writeUInt16LE=function(e,t,r){return e*=1,t|=0,r||E(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):_(this,e,t,!0),t+2},l.prototype.writeUInt16BE=function(e,t,r){return e*=1,t|=0,r||E(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):_(this,e,t,!1),t+2},l.prototype.writeUInt32LE=function(e,t,r){return e*=1,t|=0,r||E(this,e,t,4,0xffffffff,0),l.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):T(this,e,t,!0),t+4},l.prototype.writeUInt32BE=function(e,t,r){return e*=1,t|=0,r||E(this,e,t,4,0xffffffff,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):T(this,e,t,!1),t+4},l.prototype.writeIntLE=function(e,t,r,n){if(e*=1,t|=0,!n){var i=Math.pow(2,8*r-1);E(this,e,t,r,i-1,-i)}var o=0,s=1,a=0;for(this[t]=255&e;++o<r&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s|0)-a&255;return t+r},l.prototype.writeIntBE=function(e,t,r,n){if(e*=1,t|=0,!n){var i=Math.pow(2,8*r-1);E(this,e,t,r,i-1,-i)}var o=r-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s|0)-a&255;return t+r},l.prototype.writeInt8=function(e,t,r){return e*=1,t|=0,r||E(this,e,t,1,127,-128),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,r){return e*=1,t|=0,r||E(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):_(this,e,t,!0),t+2},l.prototype.writeInt16BE=function(e,t,r){return e*=1,t|=0,r||E(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):_(this,e,t,!1),t+2},l.prototype.writeInt32LE=function(e,t,r){return e*=1,t|=0,r||E(this,e,t,4,0x7fffffff,-0x80000000),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):T(this,e,t,!0),t+4},l.prototype.writeInt32BE=function(e,t,r){return e*=1,t|=0,r||E(this,e,t,4,0x7fffffff,-0x80000000),e<0&&(e=0xffffffff+e+1),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):T(this,e,t,!1),t+4},l.prototype.writeFloatLE=function(e,t,r){return A(this,e,t,!0,r)},l.prototype.writeFloatBE=function(e,t,r){return A(this,e,t,!1,r)},l.prototype.writeDoubleLE=function(e,t,r){return S(this,e,t,!0,r)},l.prototype.writeDoubleBE=function(e,t,r){return S(this,e,t,!1,r)},l.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r||0===e.length||0===this.length)return 0;if(t<0)throw RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw RangeError("sourceStart out of bounds");if(n<0)throw RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i,o=n-r;if(this===e&&r<t&&t<n)for(i=o-1;i>=0;--i)e[i+t]=this[i+r];else if(o<1e3||!l.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+o),t);return o},l.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var i,o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==n&&"string"!=typeof n)throw TypeError("encoding must be a string");if("string"==typeof n&&!l.isEncoding(n))throw TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw RangeError("Out of range index");if(r<=t)return this;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{var s=l.isBuffer(e)?e:N(new l(e,n).toString()),a=s.length;for(i=0;i<r-t;++i)this[i+t]=s[i%a]}return this};var k=/[^+\/0-9A-Za-z-_]/g;function N(e,t){t=t||1/0;for(var r,n=e.length,i=null,o=[],s=0;s<n;++s){if((r=e.charCodeAt(s))>55295&&r<57344){if(!i){if(r>56319||s+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=(i-55296<<10|r-56320)+65536}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else if(r<1114112){if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}else throw Error("Invalid code point")}return o}function C(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}function I(e){return n.toByteArray(function(e){var t;if((e=((t=e).trim?t.trim():t.replace(/^\s+|\s+$/g,"")).replace(k,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function R(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length)&&!(i>=e.length);++i)t[i+r]=e[i];return i}}).call(t,r(4))},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),(n=t.SpaceType||(t.SpaceType={})).DEFAULT="default",n.PRESERVE="preserve"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(33),o=r(68),s=r(34),a=r(69),l=r(70),c=r(19);class u extends n.IgnoreIfEmptyXmlComponent{constructor(e){if(super("w:rPr"),!e)return;e.bold&&this.push(new o.Bold),(void 0===e.boldComplexScript&&e.bold||e.boldComplexScript)&&this.push(new o.BoldComplexScript),e.italics&&this.push(new o.Italics),(void 0===e.italicsComplexScript&&e.italics||e.italicsComplexScript)&&this.push(new o.ItalicsComplexScript),e.underline&&this.push(new c.Underline(e.underline.type,e.underline.color)),e.emphasisMark&&this.push(new i.EmphasisMark(e.emphasisMark.type)),e.color&&this.push(new o.Color(e.color)),e.size&&this.push(new o.Size(e.size));let t=void 0===e.sizeComplexScript||!0===e.sizeComplexScript?e.size:e.sizeComplexScript;t&&this.push(new o.SizeComplexScript(t)),e.rightToLeft&&this.push(new o.RightToLeft),e.smallCaps&&this.push(new o.SmallCaps),e.allCaps&&this.push(new o.Caps),e.strike&&this.push(new o.Strike),e.doubleStrike&&this.push(new o.DoubleStrike),e.subScript&&this.push(new a.SubScript),e.superScript&&this.push(new a.SuperScript),e.style&&this.push(new l.Style(e.style)),e.font&&("string"==typeof e.font?this.push(new s.RunFonts(e.font)):"name"in e.font?this.push(new s.RunFonts(e.font.name,e.font.hint)):this.push(new s.RunFonts(e.font))),e.highlight&&this.push(new o.Highlight(e.highlight));let r=void 0===e.highlightComplexScript||!0===e.highlightComplexScript?e.highlight:e.highlightComplexScript;r&&this.push(new o.HighlightComplexScript(r)),e.characterSpacing&&this.push(new o.CharacterSpacing(e.characterSpacing));let n=e.shading||e.shadow;n&&this.push(new o.Shading(n.type,n.fill,n.color));let u=void 0===e.shadingComplexScript||!0===e.shadingComplexScript?n:e.shadingComplexScript;u&&this.push(new o.ShadowComplexScript(u.type,u.fill,u.color))}push(e){this.root.push(e)}}t.RunProperties=u},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(265)),n(r(38))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type"}}}t.DocumentAttributes=i},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(1)),n(r(262)),n(r(280)),n(r(339)),n(r(133)),n(r(50)),n(r(72)),n(r(114)),n(r(23)),n(r(340)),n(r(0)),n(r(49)),n(r(46)),n(r(132)),n(r(131)),n(r(347))},function(e,t){var r,n,i,o=e.exports={};function s(){throw Error("setTimeout has not been defined")}function a(){throw Error("clearTimeout has not been defined")}try{r="function"==typeof setTimeout?setTimeout:s}catch(e){r=s}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(e){n=a}function l(e){if(r===setTimeout)return setTimeout(e,0);if((r===s||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}var c=[],u=!1,d=-1;function h(){u&&i&&(u=!1,i.length?c=i.concat(c):d=-1,c.length&&p())}function p(){if(!u){var e=l(h);u=!0;for(var t=c.length;t;){for(i=c,c=[];++d<t;)i&&i[d].run();d=-1,t=c.length}i=null,u=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function g(){}o.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new f(e,t)),1!==c.length||u||l(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=g,o.addListener=g,o.once=g,o.off=g,o.removeListener=g,o.removeAllListeners=g,o.emit=g,o.prependListener=g,o.prependOnceListener=g,o.listeners=function(e){return[]},o.binding=function(e){throw Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t,r){(function(e){function r(e){return Object.prototype.toString.call(e)}t.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===r(e)},t.isBoolean=function(e){return"boolean"==typeof e},t.isNull=function(e){return null===e},t.isNullOrUndefined=function(e){return null==e},t.isNumber=function(e){return"number"==typeof e},t.isString=function(e){return"string"==typeof e},t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=function(e){return void 0===e},t.isRegExp=function(e){return"[object RegExp]"===r(e)},t.isObject=function(e){return"object"==typeof e&&null!==e},t.isDate=function(e){return"[object Date]"===r(e)},t.isError=function(e){return"[object Error]"===r(e)||e instanceof Error},t.isFunction=function(e){return"function"==typeof e},t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=e.isBuffer}).call(t,r(6).Buffer)},function(e,t,r){"use strict";(function(t){void 0!==t&&t.version&&0!==t.version.indexOf("v0.")&&(0!==t.version.indexOf("v1.")||0===t.version.indexOf("v1.8."))?e.exports=t:e.exports={nextTick:function(e,r,n,i){if("function"!=typeof e)throw TypeError('"callback" argument must be a function');var o,s,a=arguments.length;switch(a){case 0:case 1:return t.nextTick(e);case 2:return t.nextTick(function(){e.call(null,r)});case 3:return t.nextTick(function(){e.call(null,r,n)});case 4:return t.nextTick(function(){e.call(null,r,n,i)});default:for(o=Array(a-1),s=0;s<o.length;)o[s++]=arguments[s];return t.nextTick(function(){e.apply(null,o)})}}}}).call(t,r(13))},function(e,t,r){var n=r(6),i=n.Buffer;function o(e,t){for(var r in e)t[r]=e[r]}function s(e,t,r){return i(e,t,r)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=n:(o(n,t),t.Buffer=s),o(i,s),s.from=function(e,t,r){if("number"==typeof e)throw TypeError("Argument must not be a number");return i(e,t,r)},s.alloc=function(e,t,r){if("number"!=typeof e)throw TypeError("Argument must be a number");var n=i(e);return void 0!==t?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},s.allocUnsafe=function(e){if("number"!=typeof e)throw TypeError("Argument must be a number");return i(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw TypeError("Argument must be a number");return n.SlowBuffer(e)}},function(e,t,r){"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0});let o=r(0),s=r(67),a=r(18),l=r(161),c=r(9),u=r(71);(i=n=t.PageNumber||(t.PageNumber={})).CURRENT="CURRENT",i.TOTAL_PAGES="TOTAL_PAGES",i.TOTAL_PAGES_IN_SECTION="TOTAL_PAGES_IN_SECTION";class d extends o.XmlComponent{constructor(e){if(super("w:r"),this.properties=new c.RunProperties(e),this.root.push(this.properties),e.children)for(let t of e.children){if("string"==typeof t){switch(t){case n.CURRENT:this.root.push(new a.Begin),this.root.push(new l.Page),this.root.push(new a.Separate),this.root.push(new a.End);break;case n.TOTAL_PAGES:this.root.push(new a.Begin),this.root.push(new l.NumberOfPages),this.root.push(new a.Separate),this.root.push(new a.End);break;case n.TOTAL_PAGES_IN_SECTION:this.root.push(new a.Begin),this.root.push(new l.NumberOfPagesSection),this.root.push(new a.Separate),this.root.push(new a.End);break;default:this.root.push(new u.Text(t))}continue}this.root.push(t)}else e.text&&this.root.push(new u.Text(e.text));if(e.break)for(let t=0;t<e.break;t++)this.root.splice(1,0,new s.Break)}}t.Run=d},function(e,t,r){"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0});let o=r(0);(i=n||(n={})).BEGIN="begin",i.END="end",i.SEPARATE="separate";class s extends o.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={type:"w:fldCharType",dirty:"w:dirty"}}}class a extends o.XmlComponent{constructor(e){super("w:fldChar"),this.root.push(new s({type:n.BEGIN,dirty:e}))}}t.Begin=a;class l extends o.XmlComponent{constructor(e){super("w:fldChar"),this.root.push(new s({type:n.SEPARATE,dirty:e}))}}t.Separate=l;class c extends o.XmlComponent{constructor(e){super("w:fldChar"),this.root.push(new s({type:n.END,dirty:e}))}}t.End=c},function(e,t,r){"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0});let o=r(0);(i=n=t.UnderlineType||(t.UnderlineType={})).SINGLE="single",i.WORDS="words",i.DOUBLE="double",i.THICK="thick",i.DOTTED="dotted",i.DOTTEDHEAVY="dottedHeavy",i.DASH="dash",i.DASHEDHEAVY="dashedHeavy",i.DASHLONG="dashLong",i.DASHLONGHEAVY="dashLongHeavy",i.DOTDASH="dotDash",i.DASHDOTHEAVY="dashDotHeavy",i.DOTDOTDASH="dotDotDash",i.DASHDOTDOTHEAVY="dashDotDotHeavy",i.WAVE="wave",i.WAVYHEAVY="wavyHeavy",i.WAVYDOUBLE="wavyDouble";class s extends o.XmlComponent{constructor(e,t){super("w:u"),this.root.push(new o.Attributes({val:e,color:t}))}}t.BaseUnderline=s,t.Underline=class extends s{constructor(e=n.SINGLE,t){super(e,t)}},t.DashUnderline=class extends s{constructor(){super("dash")}},t.DashDotDotHeavyUnderline=class extends s{constructor(){super("dashDotDotHeavy")}},t.DashDotHeavyUnderline=class extends s{constructor(){super("dashDotHeavy")}},t.DashLongUnderline=class extends s{constructor(){super("dashLong")}},t.DashLongHeavyUnderline=class extends s{constructor(){super("dashLongHeavy")}},t.DotDashUnderline=class extends s{constructor(){super("dotDash")}},t.DotDotDashUnderline=class extends s{constructor(){super("dotDotDash")}},t.DottedUnderline=class extends s{constructor(){super("dotted")}},t.DottedHeavyUnderline=class extends s{constructor(){super("dottedHeavy")}},t.DoubleUnderline=class extends s{constructor(){super("double")}},t.SingleUnderline=class extends s{constructor(){super("single")}},t.ThickUnderline=class extends s{constructor(){super("thick")}},t.WaveUnderline=class extends s{constructor(){super("wave")}},t.WavyDoubleUnderline=class extends s{constructor(){super("wavyDouble")}},t.WavyHeavyUnderline=class extends s{constructor(){super("wavyHeavy")}},t.WordsUnderline=class extends s{constructor(){super("words")}}},function(e,t,r){"use strict";var n,i,o,s=r(221),a="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_-";function l(e){if(!e){n!==a&&(n=a,o=!1);return}if(e!==n){if(e.length!==a.length)throw Error("Custom alphabet for shortid must be "+a.length+" unique characters. You submitted "+e.length+" characters: "+e);var t=e.split("").filter(function(e,t,r){return t!==r.lastIndexOf(e)});if(t.length)throw Error("Custom alphabet for shortid must be "+a.length+" unique characters. These characters were not unique: "+t.join(", "));n=e,o=!1}}function c(){return o||(o=function(){n||l(a);for(var e,t=n.split(""),r=[],i=s.nextValue();t.length>0;)e=Math.floor(s.nextValue()*t.length),r.push(t.splice(e,1)[0]);return r.join("")}())}e.exports={get:function(){return n||a},characters:function(e){return l(e),n},seed:function(e){s.seed(e),i!==e&&(o=!1,i=e)},lookup:function(e){return c()[e]},shuffled:c}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(52),o=r(230),s=r(63),a=r(64),l=r(65),c=r(66),u=r(82),d=r(83),h=r(84),p=r(85),f=r(37),g=r(68);class b extends n.IgnoreIfEmptyXmlComponent{constructor(e){if(super("w:pPr"),!e)return;if(e.border&&this.push(new s.Border(e.border)),e.spacing&&this.push(new u.Spacing(e.spacing)),void 0!==e.outlineLevel&&this.push(new f.OutlineLevel(e.outlineLevel)),e.alignment&&this.push(new i.Alignment(e.alignment)),e.heading&&this.push(new d.Style(e.heading)),e.bidirectional&&this.push(new o.Bidirectional),e.thematicBreak&&this.push(new s.ThematicBreak),e.pageBreakBefore&&this.push(new c.PageBreakBefore),e.contextualSpacing&&this.push(new u.ContextualSpacing(e.contextualSpacing)),e.indent&&this.push(new a.Indent(e.indent)),e.keepLines&&this.push(new l.KeepLines),e.keepNext&&this.push(new l.KeepNext),e.tabStops)for(let t of e.tabStops)this.push(new h.TabStop(t.type,t.position,t.leader));e.style&&this.push(new d.Style(e.style)),e.bullet&&(this.push(new d.Style("ListParagraph")),this.push(new p.NumberProperties(1,e.bullet.level))),e.numbering&&(e.numbering.custom||this.push(new d.Style("ListParagraph")),this.push(new p.NumberProperties(e.numbering.reference,e.numbering.level))),e.rightTabStop&&this.push(new h.TabStop(h.TabStopType.RIGHT,e.rightTabStop)),e.leftTabStop&&this.push(new h.TabStop(h.TabStopType.LEFT,e.leftTabStop)),e.shading&&this.push(new g.Shading(e.shading.type,e.shading.fill,e.shading.color))}push(e){this.root.push(e)}}t.ParagraphProperties=b},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(257),o=r(258);class s extends n.XmlComponent{constructor(e){super("m:dPr"),e&&(this.root.push(new i.MathBeginningCharacter(e.beginningCharacter)),this.root.push(new o.MathEndingCharacter(e.endingCharacter)))}}t.MathBracketProperties=s},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(271)),n(r(43)),n(r(42)),n(r(106))},function(e,t,r){"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0});let o=r(0),s=r(51),a=r(21),l=r(9);(n=t.LevelFormat||(t.LevelFormat={})).BULLET="bullet",n.CARDINAL_TEXT="cardinalText",n.CHICAGO="chicago",n.DECIMAL="decimal",n.DECIMAL_ENCLOSED_CIRCLE="decimalEnclosedCircle",n.DECIMAL_ENCLOSED_FULLSTOP="decimalEnclosedFullstop",n.DECIMAL_ENCLOSED_PARENTHESES="decimalEnclosedParen",n.DECIMAL_ZERO="decimalZero",n.LOWER_LETTER="lowerLetter",n.LOWER_ROMAN="lowerRoman",n.NONE="none",n.ORDINAL_TEXT="ordinalText",n.UPPER_LETTER="upperLetter",n.UPPER_ROMAN="upperRoman";class c extends o.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={ilvl:"w:ilvl",tentative:"w15:tentative"}}}class u extends o.XmlComponent{constructor(e){super("w:start"),this.root.push(new o.Attributes({val:e}))}}class d extends o.XmlComponent{constructor(e){super("w:numFmt"),this.root.push(new o.Attributes({val:e}))}}class h extends o.XmlComponent{constructor(e){super("w:lvlText"),this.root.push(new o.Attributes({val:e}))}}class p extends o.XmlComponent{constructor(e){super("w:lvlJc"),this.root.push(new o.Attributes({val:e}))}}(i=t.LevelSuffix||(t.LevelSuffix={})).NOTHING="nothing",i.SPACE="space",i.TAB="tab";class f extends o.XmlComponent{constructor(e){super("w:suff"),this.root.push(new o.Attributes({val:e}))}}class g extends o.XmlComponent{constructor({level:e,format:t,text:r,alignment:n=s.AlignmentType.START,start:i=1,style:o,suffix:g}){super("w:lvl"),this.root.push(new c({ilvl:e,tentative:1})),this.root.push(new u(i)),this.root.push(new p(n)),t&&this.root.push(new d(t)),r&&this.root.push(new h(r)),this.paragraphProperties=new a.ParagraphProperties(o&&o.paragraph),this.runProperties=new l.RunProperties(o&&o.run),this.root.push(this.paragraphProperties),this.root.push(this.runProperties),g&&this.root.push(new f(g))}}t.LevelBase=g,t.Level=class extends g{constructor(e){super(e)}},t.LevelForOverride=class extends g{}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseXmlComponent=class{constructor(e){this.deleted=!1,this.rootKey=e}get IsDeleted(){return this.deleted}}},function(e,t,r){e.exports={xml2js:r(54),xml2json:r(156),js2xml:r(62),json2xml:r(157)}},function(e,t,r){"use strict";var n,i="object"==typeof Reflect?Reflect:null,o=i&&"function"==typeof i.apply?i.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};n=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var s=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var l=10;function c(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function u(e,t,r,n){if("function"!=typeof r)throw TypeError('The "listener" argument must be of type Function. Received type '+typeof r);if(void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),s=o[t]),void 0===s)s=o[t]=r,++e._eventsCount;else if("function"==typeof s?s=o[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(i=c(e))>0&&s.length>i&&!s.warned){s.warned=!0;var i,o,s,a=Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=s.length,console&&console.warn&&console.warn(a)}return e}function d(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,o(this.listener,this.target,e))}function h(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=d.bind(n);return i.listener=r,n.wrapFn=i,i}function p(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):g(i,i.length)}function f(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function g(e,t){for(var r=Array(t),n=0;n<t;++n)r[n]=e[n];return r}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(e){if("number"!=typeof e||e<0||s(e))throw RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");l=e}}),a.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||s(e))throw RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return c(this)},a.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var s,a=Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var l=i[e];if(void 0===l)return!1;if("function"==typeof l)o(l,this,t);else for(var c=l.length,u=g(l,c),r=0;r<c;++r)o(u[r],this,t);return!0},a.prototype.addListener=function(e,t){return u(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return u(this,e,t,!0)},a.prototype.once=function(e,t){if("function"!=typeof t)throw TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.on(e,h(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.prependListener(e,h(this,e,t)),this},a.prototype.removeListener=function(e,t){var r,n,i,o,s;if("function"!=typeof t)throw TypeError('The "listener" argument must be of type Function. Received type '+typeof t);if(void 0===(n=this._events)||void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){s=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0==arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0==arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(i=o[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},a.prototype.listeners=function(e){return p(this,e,!0)},a.prototype.rawListeners=function(e){return p(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},a.prototype.listenerCount=f,a.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]}},function(e,t,r){(t=e.exports=r(57)).Stream=t,t.Readable=t,t.Writable=r(29),t.Duplex=r(5),t.Transform=r(61),t.PassThrough=r(151)},function(e,t,r){"use strict";(function(t,n,i){var o,s,a=r(15);function l(e){var t=this;this.next=null,this.entry=null,this.finish=function(){var r=t,n=e,i=r.entry;for(r.entry=null;i;){var o=i.callback;n.pendingcb--,o(void 0),i=i.next}n.corkedRequestsFree?n.corkedRequestsFree.next=r:n.corkedRequestsFree=r}}e.exports=y;var c=!t.browser&&["v0.10","v0.9."].indexOf(t.version.slice(0,5))>-1?n:a.nextTick;y.WritableState=v;var u=r(14);u.inherits=r(7);var d={deprecate:r(150)},h=r(58),p=r(16).Buffer,f=i.Uint8Array||function(){},g=r(59);function b(){}function v(e,t){o=o||r(5),e=e||{};var n=t instanceof o;this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var i=e.highWaterMark,s=e.writableHighWaterMark,u=this.objectMode?16:16384;i||0===i?this.highWaterMark=i:n&&(s||0===s)?this.highWaterMark=s:this.highWaterMark=u,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var d=!1===e.decodeStrings;this.decodeStrings=!d,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,n=r.sync,i=r.writecb;if(r.writing=!1,r.writecb=null,r.length-=r.writelen,r.writelen=0,t)--r.pendingcb,n?(a.nextTick(i,t),a.nextTick(O,e,r),e._writableState.errorEmitted=!0,e.emit("error",t)):(i(t),e._writableState.errorEmitted=!0,e.emit("error",t),O(e,r));else{var o=_(r);o||r.corked||r.bufferProcessing||!r.bufferedRequest||E(e,r),n?c(x,e,r,o,i):x(e,r,o,i)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new l(this)}u.inherits(y,h),v.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t};try{Object.defineProperty(v.prototype,"buffer",{get:d.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}function y(e){if(o=o||r(5),!s.call(y,this)&&!(this instanceof o))return new y(e);this._writableState=new v(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),h.call(this)}function w(e,t,r,n,i,o,s){t.writelen=n,t.writecb=s,t.writing=!0,t.sync=!0,r?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function x(e,t,r,n){var i,o;r||(i=e,0===(o=t).length&&o.needDrain&&(o.needDrain=!1,i.emit("drain"))),t.pendingcb--,n(),O(e,t)}function E(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=Array(t.bufferedRequestCount),i=t.corkedRequestsFree;i.entry=r;for(var o=0,s=!0;r;)n[o]=r,r.isBuf||(s=!1),r=r.next,o+=1;n.allBuffers=s,w(e,t,!0,t.length,n,"",i.finish),t.pendingcb++,t.lastBufferedRequest=null,i.next?(t.corkedRequestsFree=i.next,i.next=null):t.corkedRequestsFree=new l(t),t.bufferedRequestCount=0}else{for(;r;){var a=r.chunk,c=r.encoding,u=r.callback,d=t.objectMode?1:a.length;if(w(e,t,!1,d,a,c,u),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function _(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function T(e,t){e._final(function(r){t.pendingcb--,r&&e.emit("error",r),t.prefinished=!0,e.emit("prefinish"),O(e,t)})}function O(e,t){var r=_(t);return r&&(t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,a.nextTick(T,e,t)):(t.prefinished=!0,e.emit("prefinish"))),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),r}"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(s=Function.prototype[Symbol.hasInstance],Object.defineProperty(y,Symbol.hasInstance,{value:function(e){return!!s.call(this,e)||this===y&&e&&e._writableState instanceof v}})):s=function(e){return e instanceof this},y.prototype.pipe=function(){this.emit("error",Error("Cannot pipe, not readable"))},y.prototype.write=function(e,t,r){var n,i,o,s,l,c,u,d,h=this._writableState,g=!1,v=!h.objectMode&&(n=e,p.isBuffer(n)||n instanceof f);return(v&&!p.isBuffer(e)&&(i=e,e=p.from(i)),"function"==typeof t&&(r=t,t=null),v?t="buffer":t||(t=h.defaultEncoding),"function"!=typeof r&&(r=b),h.ended)?(o=r,s=Error("write after end"),this.emit("error",s),a.nextTick(o,s)):(v||(l=e,c=r,u=!0,d=!1,null===l?d=TypeError("May not write null values to stream"):"string"==typeof l||void 0===l||h.objectMode||(d=TypeError("Invalid non-string/buffer chunk")),d&&(this.emit("error",d),a.nextTick(c,d),u=!1),u))&&(h.pendingcb++,g=function(e,t,r,n,i,o){if(!r){var s,a,l=(s=n,a=i,t.objectMode||!1===t.decodeStrings||"string"!=typeof s||(s=p.from(s,a)),s);n!==l&&(r=!0,i="buffer",n=l)}var c=t.objectMode?1:n.length;t.length+=c;var u=t.length<t.highWaterMark;if(u||(t.needDrain=!0),t.writing||t.corked){var d=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:o,next:null},d?d.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else w(e,t,!1,c,n,i,o);return u}(this,h,v,e,t,r)),g},y.prototype.cork=function(){var e=this._writableState;e.corked++},y.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||E(this,e))},y.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(y.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),y.prototype._write=function(e,t,r){r(Error("_write() is not implemented"))},y.prototype._writev=null,y.prototype.end=function(e,t,r){var n,i,o,s=this._writableState;"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),s.corked&&(s.corked=1,this.uncork()),s.ending||s.finished||(n=this,i=s,o=r,i.ending=!0,O(n,i),o&&(i.finished?a.nextTick(o):n.once("finish",o)),i.ended=!0,n.writable=!1)},Object.defineProperty(y.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),y.prototype.destroy=g.destroy,y.prototype._undestroy=g.undestroy,y.prototype._destroy=function(e,t){this.end(),t(e)}}).call(t,r(13),r(60).setImmediate,r(4))},function(e,t,r){"use strict";var n=r(16).Buffer,i=n.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(e){var t;switch(this.encoding=function(e){var t=function(e){var t;if(!e)return"utf8";for(;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(n.isEncoding===i||!i(e)))throw Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=l,this.end=c,t=4;break;case"utf8":this.fillLast=a,t=4;break;case"base64":this.text=u,this.end=d,t=3;break;default:this.write=h,this.end=p;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(t)}function s(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function a(e){var t=this.lastTotal-this.lastNeed,r=function(e,t,r){if((192&t[0])!=128)return e.lastNeed=0,"";if(e.lastNeed>1&&t.length>1){if((192&t[1])!=128)return e.lastNeed=1,"";if(e.lastNeed>2&&t.length>2&&(192&t[2])!=128)return e.lastNeed=2,""}}(this,e,0);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):void(e.copy(this.lastChar,t,0,e.length),this.lastNeed-=e.length)}function l(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function c(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function u(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function d(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function h(e){return e.toString(this.encoding)}function p(e){return e&&e.length?this.write(e):""}t.StringDecoder=o,o.prototype.write=function(e){var t,r;if(0===e.length)return"";if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},o.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t},o.prototype.text=function(e,t){var r=function(e,t,r){var n=t.length-1;if(n<r)return 0;var i=s(t[n]);return i>=0?(i>0&&(e.lastNeed=i-1),i):--n<r||-2===i?0:(i=s(t[n]))>=0?(i>0&&(e.lastNeed=i-2),i):--n<r||-2===i?0:(i=s(t[n]))>=0?(i>0&&(2===i?i=0:e.lastNeed=i-3),i):0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var n=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",t,n)},o.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},function(e,t,r){var n=r(32).isArray;e.exports={copyOptions:function(e){var t,r={};for(t in e)e.hasOwnProperty(t)&&(r[t]=e[t]);return r},ensureFlagExists:function(e,t){e in t&&"boolean"==typeof t[e]||(t[e]=!1)},ensureSpacesExists:function(e){"spaces"in e&&("number"==typeof e.spaces||"string"==typeof e.spaces)||(e.spaces=0)},ensureAlwaysArrayExists:function(e){"alwaysArray"in e&&("boolean"==typeof e.alwaysArray||n(e.alwaysArray))||(e.alwaysArray=!1)},ensureKeyExists:function(e,t){e+"Key"in t&&"string"==typeof t[e+"Key"]||(t[e+"Key"]=t.compact?"_"+e:e)},checkFnExists:function(e,t){return e+"Fn"in t}}},function(e,t){e.exports={isArray:function(e){return Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)}}},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0});let i=r(0);(n=t.EmphasisMarkType||(t.EmphasisMarkType={})).DOT="dot";class o extends i.XmlComponent{constructor(e){super("w:em"),this.root.push(new i.Attributes({val:e}))}}t.BaseEmphasisMark=o,t.EmphasisMark=class extends o{constructor(e=n.DOT){super(e)}},t.DotEmphasisMark=class extends o{constructor(){super(n.DOT)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={ascii:"w:ascii",cs:"w:cs",eastAsia:"w:eastAsia",hAnsi:"w:hAnsi",hint:"w:hint"}}}class o extends n.XmlComponent{constructor(e,t){super("w:rFonts"),"string"==typeof e?this.root.push(new i({ascii:e,cs:e,eastAsia:e,hAnsi:e,hint:t})):this.root.push(new i(e))}}t.RunFonts=o},function(e,t,r){"use strict";var n,i,o,s;Object.defineProperty(t,"__esModule",{value:!0}),(n=t.HorizontalPositionRelativeFrom||(t.HorizontalPositionRelativeFrom={})).CHARACTER="character",n.COLUMN="column",n.INSIDE_MARGIN="insideMargin",n.LEFT_MARGIN="leftMargin",n.MARGIN="margin",n.OUTSIDE_MARGIN="outsideMargin",n.PAGE="page",n.RIGHT_MARGIN="rightMargin",(i=t.VerticalPositionRelativeFrom||(t.VerticalPositionRelativeFrom={})).BOTTOM_MARGIN="bottomMargin",i.INSIDE_MARGIN="insideMargin",i.LINE="line",i.MARGIN="margin",i.OUTSIDE_MARGIN="outsideMargin",i.PAGE="page",i.PARAGRAPH="paragraph",i.TOP_MARGIN="topMargin",(o=t.HorizontalPositionAlign||(t.HorizontalPositionAlign={})).CENTER="center",o.INSIDE="inside",o.LEFT="left",o.OUTSIDE="outside",o.RIGHT="right",(s=t.VerticalPositionAlign||(t.VerticalPositionAlign={})).BOTTOM="bottom",s.CENTER="center",s.INSIDE="inside",s.OUTSIDE="outside",s.TOP="top"},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(200)),n(r(201)),n(r(202)),n(r(203)),n(r(204))},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(217)),n(r(219)),n(r(229))},function(e,t,r){"use strict";var n,i,o,s;Object.defineProperty(t,"__esModule",{value:!0});let a=r(0);class l extends a.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={style:"w:val",size:"w:sz",color:"w:color"}}}class c extends a.XmlComponent{setProperties(e,t,r){let n=new l({style:e,size:t,color:r});return this.root.push(n),this}}class u extends a.IgnoreIfEmptyXmlComponent{constructor(){super("w:tcBorders")}addTopBorder(e,t,r){let n=new c("w:top");return n.setProperties(e,t,r),this.root.push(n),this}addStartBorder(e,t,r){let n=new c("w:start");return n.setProperties(e,t,r),this.root.push(n),this}addBottomBorder(e,t,r){let n=new c("w:bottom");return n.setProperties(e,t,r),this.root.push(n),this}addEndBorder(e,t,r){let n=new c("w:end");return n.setProperties(e,t,r),this.root.push(n),this}addLeftBorder(e,t,r){let n=new c("w:left");return n.setProperties(e,t,r),this.root.push(n),this}addRightBorder(e,t,r){let n=new c("w:right");return n.setProperties(e,t,r),this.root.push(n),this}}t.TableCellBorders=u;class d extends a.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={val:"w:val"}}}class h extends a.XmlComponent{constructor(e){super("w:gridSpan"),this.root.push(new d({val:e}))}}t.GridSpan=h,(n=t.VerticalMergeType||(t.VerticalMergeType={})).CONTINUE="continue",n.RESTART="restart";class p extends a.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={val:"w:val"}}}class f extends a.XmlComponent{constructor(e){super("w:vMerge"),this.root.push(new p({val:e}))}}t.VerticalMerge=f,(i=t.VerticalAlign||(t.VerticalAlign={})).BOTTOM="bottom",i.CENTER="center",i.TOP="top";class g extends a.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={val:"w:val"}}}class b extends a.XmlComponent{constructor(e){super("w:vAlign"),this.root.push(new g({val:e}))}}t.VAlign=b,(o=t.TextDirection||(t.TextDirection={})).BOTTOM_TO_TOP_LEFT_TO_RIGHT="btLr",o.LEFT_TO_RIGHT_TOP_TO_BOTTOM="lrTb",o.TOP_TO_BOTTOM_RIGHT_TO_LEFT="tbRl";class v extends a.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={val:"w:val"}}}class y extends a.XmlComponent{constructor(e){super("w:textDirection"),this.root.push(new v({val:e}))}}t.TDirection=y,(s=t.WidthType||(t.WidthType={})).AUTO="auto",s.DXA="dxa",s.NIL="nil",s.PERCENTAGE="pct";class w extends a.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={width:"w:w",type:"w:type"}}}class x extends a.XmlComponent{constructor(e,t){super("w:tcW"),this.root.push(new w({width:e,type:t}))}}t.TableCellWidth=x},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(267);for(var i in n)t.hasOwnProperty(i)||(t[i]=n[i])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(41);class o extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={type:"w:type",styleId:"w:styleId",default:"w:default",customStyle:"w:customStyle"}}}class s extends n.XmlComponent{constructor(e,t){super("w:style"),this.root.push(new o(e)),t&&this.root.push(new i.Name(t))}}t.Style=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={val:"w:val"}}}class o extends n.XmlComponent{constructor(e){super("w:name"),this.root.push(new i({val:e}))}}t.Name=o;class s extends n.XmlComponent{constructor(e){super("w:basedOn"),this.root.push(new i({val:e}))}}t.BasedOn=s;class a extends n.XmlComponent{constructor(e){super("w:next"),this.root.push(new i({val:e}))}}t.Next=a;class l extends n.XmlComponent{constructor(e){super("w:link"),this.root.push(new i({val:e}))}}t.Link=l;class c extends n.XmlComponent{constructor(e){super("w:uiPriority"),this.root.push(new i({val:e}))}}t.UiPriority=c;class u extends n.XmlComponent{constructor(){super("w:unhideWhenUsed")}}t.UnhideWhenUsed=u;class d extends n.XmlComponent{constructor(){super("w:qFormat")}}t.QuickFormat=d;class h extends n.XmlComponent{}t.TableProperties=h;class p extends n.XmlComponent{}t.RsId=p;class f extends n.XmlComponent{constructor(){super("w:semiHidden")}}t.SemiHidden=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(1),i=r(9),o=r(41),s=r(40);class a extends s.Style{constructor(e){super({type:"paragraph",styleId:e.id},e.name),this.paragraphProperties=new n.ParagraphProperties(e.paragraph),this.runProperties=new i.RunProperties(e.run),this.root.push(this.paragraphProperties),this.root.push(this.runProperties),e.basedOn&&this.root.push(new o.BasedOn(e.basedOn)),e.next&&this.root.push(new o.Next(e.next)),e.quickFormat&&this.root.push(new o.QuickFormat),e.link&&this.root.push(new o.Link(e.link)),e.semiHidden&&this.root.push(new o.SemiHidden),e.uiPriority&&this.root.push(new o.UiPriority(e.uiPriority)),e.unhideWhenUsed&&this.root.push(new o.UnhideWhenUsed)}}t.StyleForParagraph=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(9),i=r(41),o=r(40);class s extends o.Style{constructor(e){super({type:"character",styleId:e.id},e.name),this.runProperties=new n.RunProperties(e.run),this.root.push(this.runProperties),this.root.push(new i.UiPriority(99)),this.root.push(new i.UnhideWhenUsed),e.basedOn&&this.root.push(new i.BasedOn(e.basedOn)),e.link&&this.root.push(new i.Link(e.link)),e.semiHidden&&this.root.push(new i.SemiHidden)}}t.StyleForCharacter=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertMillimetersToTwip=e=>Math.floor(e/25.4*1440),t.convertInchesToTwip=e=>Math.floor(72*e*20)},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0});let i=r(0);(n=t.PageOrientation||(t.PageOrientation={})).PORTRAIT="portrait",n.LANDSCAPE="landscape";class o extends i.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={width:"w:w",height:"w:h",orientation:"w:orient"}}}t.PageSizeAttributes=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(308),i=r(47);t.FooterWrapper=class{constructor(e,t,r){this.media=e,this.footer=new n.Footer(t,r),this.relationships=new i.Relationships}add(e){this.footer.add(e)}addChildElement(e){this.footer.addChildElement(e)}get Footer(){return this.footer}get Relationships(){return this.relationships}get Media(){return this.media}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(310);for(var i in n)t.hasOwnProperty(i)||(t[i]=n[i])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(312);(t.TargetModeType||(t.TargetModeType={})).EXTERNAL="External";class o extends n.XmlComponent{constructor(e,t,r,n){super("Relationship"),this.root.push(new i.RelationshipAttributes({id:e,type:t,target:r,targetMode:n}))}}t.Relationship=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(326),i=r(47);t.HeaderWrapper=class{constructor(e,t,r){this.media=e,this.header=new n.Header(t,r),this.relationships=new i.Relationships}add(e){return this.header.add(e),this}addChildElement(e){this.header.addChildElement(e)}get Header(){return this.header}get Relationships(){return this.relationships}get Media(){return this.media}}},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(328)),n(r(329))},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(52)),n(r(63)),n(r(64)),n(r(65)),n(r(66)),n(r(82)),n(r(83)),n(r(84)),n(r(85))},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0});let i=r(0);(n=t.AlignmentType||(t.AlignmentType={})).START="start",n.END="end",n.CENTER="center",n.BOTH="both",n.JUSTIFIED="both",n.DISTRIBUTE="distribute",n.LEFT="left",n.RIGHT="right";class o extends i.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={val:"w:val"}}}t.AlignmentAttributes=o;class s extends i.XmlComponent{constructor(e){super("w:jc"),this.root.push(new o({val:e}))}}t.Alignment=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(25);class i extends n.BaseXmlComponent{constructor(e){super("_attr"),this.root=e}prepForXml(){let e={};return Object.keys(this.root).forEach(t=>{let r=this.root[t];void 0!==r&&(e[this.xmlKeys&&this.xmlKeys[t]||t]=r)}),{_attr:e}}set(e){this.root=e}}t.XmlAttributeComponent=i},function(e,t,r){var n,i,o=r(143),s=r(31),a=r(32).isArray;function l(e){var t=Number(e);if(!isNaN(t))return t;var r=e.toLowerCase();return"true"===r||"false"!==r&&e}function c(e,t){var r;if(n.compact){if(!i[n[e+"Key"]]&&(a(n.alwaysArray)?-1!==n.alwaysArray.indexOf(n[e+"Key"]):n.alwaysArray)&&(i[n[e+"Key"]]=[]),i[n[e+"Key"]]&&!a(i[n[e+"Key"]])&&(i[n[e+"Key"]]=[i[n[e+"Key"]]]),e+"Fn"in n&&"string"==typeof t&&(t=n[e+"Fn"](t,i)),"instruction"===e&&("instructionFn"in n||"instructionNameFn"in n)){for(r in t)if(t.hasOwnProperty(r))if("instructionFn"in n)t[r]=n.instructionFn(t[r],r,i);else{var o=t[r];delete t[r],t[n.instructionNameFn(r,o,i)]=o}}a(i[n[e+"Key"]])?i[n[e+"Key"]].push(t):i[n[e+"Key"]]=t}else{i[n.elementsKey]||(i[n.elementsKey]=[]);var s={};if(s[n.typeKey]=e,"instruction"===e){for(r in t)if(t.hasOwnProperty(r))break;s[n.nameKey]="instructionNameFn"in n?n.instructionNameFn(r,t,i):r,n.instructionHasAttributes?(s[n.attributesKey]=t[r][n.attributesKey],"instructionFn"in n&&(s[n.attributesKey]=n.instructionFn(s[n.attributesKey],r,i))):("instructionFn"in n&&(t[r]=n.instructionFn(t[r],r,i)),s[n.instructionKey]=t[r])}else e+"Fn"in n&&(t=n[e+"Fn"](t,i)),s[n[e+"Key"]]=t;n.addParent&&(s[n.parentKey]=i),i[n.elementsKey].push(s)}}function u(e){if("attributesFn"in n&&e&&(e=n.attributesFn(e,i)),(n.trim||"attributeValueFn"in n||"attributeNameFn"in n||n.nativeTypeAttributes)&&e){var t;for(t in e)if(e.hasOwnProperty(t)&&(n.trim&&(e[t]=e[t].trim()),n.nativeTypeAttributes&&(e[t]=l(e[t])),"attributeValueFn"in n&&(e[t]=n.attributeValueFn(e[t],t,i)),"attributeNameFn"in n)){var r=e[t];delete e[t],e[n.attributeNameFn(t,e[t],i)]=r}}return e}function d(e){var t={};if(e.body&&("xml"===e.name.toLowerCase()||n.instructionHasAttributes)){for(var r,o=/([\w:-]+)\s*=\s*(?:"([^"]*)"|'([^']*)'|(\w+))\s*/g;null!==(r=o.exec(e.body));)t[r[1]]=r[2]||r[3]||r[4];t=u(t)}if("xml"===e.name.toLowerCase()){if(n.ignoreDeclaration)return;i[n.declarationKey]={},Object.keys(t).length&&(i[n.declarationKey][n.attributesKey]=t),n.addParent&&(i[n.declarationKey][n.parentKey]=i)}else{if(n.ignoreInstruction)return;n.trim&&(e.body=e.body.trim());var s={};n.instructionHasAttributes&&Object.keys(t).length?(s[e.name]={},s[e.name][n.attributesKey]=t):s[e.name]=e.body,c("instruction",s)}}function h(e,t){var r,o;if("object"==typeof e&&(t=e.attributes,e=e.name),t=u(t),"elementNameFn"in n&&(e=n.elementNameFn(e,i)),n.compact){if(r={},!n.ignoreAttributes&&t&&Object.keys(t).length)for(o in r[n.attributesKey]={},t)t.hasOwnProperty(o)&&(r[n.attributesKey][o]=t[o]);e in i||(a(n.alwaysArray)?-1===n.alwaysArray.indexOf(e):!n.alwaysArray)||(i[e]=[]),i[e]&&!a(i[e])&&(i[e]=[i[e]]),a(i[e])?i[e].push(r):i[e]=r}else i[n.elementsKey]||(i[n.elementsKey]=[]),(r={})[n.typeKey]="element",r[n.nameKey]=e,!n.ignoreAttributes&&t&&Object.keys(t).length&&(r[n.attributesKey]=t),n.alwaysChildren&&(r[n.elementsKey]=[]),i[n.elementsKey].push(r);r[n.parentKey]=i,i=r}function p(e){!n.ignoreText&&(e.trim()||n.captureSpacesBetweenElements)&&(n.trim&&(e=e.trim()),n.nativeType&&(e=l(e)),n.sanitize&&(e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),c("text",e))}function f(e){n.ignoreComment||(n.trim&&(e=e.trim()),c("comment",e))}function g(e){var t=i[n.parentKey];n.addParent||delete i[n.parentKey],i=t}function b(e){n.ignoreCdata||(n.trim&&(e=e.trim()),c("cdata",e))}function v(e){n.ignoreDoctype||(e=e.replace(/^ /,""),n.trim&&(e=e.trim()),c("doctype",e))}function y(e){e.note=e}e.exports=function(e,t){var r=o.parser(!0,{}),a={};if(i=a,n=s.copyOptions(t),s.ensureFlagExists("ignoreDeclaration",n),s.ensureFlagExists("ignoreInstruction",n),s.ensureFlagExists("ignoreAttributes",n),s.ensureFlagExists("ignoreText",n),s.ensureFlagExists("ignoreComment",n),s.ensureFlagExists("ignoreCdata",n),s.ensureFlagExists("ignoreDoctype",n),s.ensureFlagExists("compact",n),s.ensureFlagExists("alwaysChildren",n),s.ensureFlagExists("addParent",n),s.ensureFlagExists("trim",n),s.ensureFlagExists("nativeType",n),s.ensureFlagExists("nativeTypeAttributes",n),s.ensureFlagExists("sanitize",n),s.ensureFlagExists("instructionHasAttributes",n),s.ensureFlagExists("captureSpacesBetweenElements",n),s.ensureAlwaysArrayExists(n),s.ensureKeyExists("declaration",n),s.ensureKeyExists("instruction",n),s.ensureKeyExists("attributes",n),s.ensureKeyExists("text",n),s.ensureKeyExists("comment",n),s.ensureKeyExists("cdata",n),s.ensureKeyExists("doctype",n),s.ensureKeyExists("type",n),s.ensureKeyExists("name",n),s.ensureKeyExists("elements",n),s.ensureKeyExists("parent",n),s.checkFnExists("doctype",n),s.checkFnExists("instruction",n),s.checkFnExists("cdata",n),s.checkFnExists("comment",n),s.checkFnExists("text",n),s.checkFnExists("instructionName",n),s.checkFnExists("elementName",n),s.checkFnExists("attributeName",n),s.checkFnExists("attributeValue",n),s.checkFnExists("attributes",n),r.opt={strictEntities:!0},r.onopentag=h,r.ontext=p,r.oncomment=f,r.onclosetag=g,r.onerror=y,r.oncdata=b,r.ondoctype=v,r.onprocessinginstruction=d,r.write(e).close(),a[n.elementsKey]){var l=a[n.elementsKey];delete a[n.elementsKey],a[n.elementsKey]=l,delete a.text}return a}},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},function(e,t,r){e.exports=i;var n=r(27).EventEmitter;function i(){n.call(this)}r(7)(i,n),i.Readable=r(28),i.Writable=r(152),i.Duplex=r(153),i.Transform=r(154),i.PassThrough=r(155),i.Stream=i,i.prototype.pipe=function(e,t){var r=this;function i(t){e.writable&&!1===e.write(t)&&r.pause&&r.pause()}function o(){r.readable&&r.resume&&r.resume()}r.on("data",i),e.on("drain",o),e._isStdio||t&&!1===t.end||(r.on("end",a),r.on("close",l));var s=!1;function a(){s||(s=!0,e.end())}function l(){s||(s=!0,"function"==typeof e.destroy&&e.destroy())}function c(e){if(u(),0===n.listenerCount(this,"error"))throw e}function u(){r.removeListener("data",i),e.removeListener("drain",o),r.removeListener("end",a),r.removeListener("close",l),r.removeListener("error",c),e.removeListener("error",c),r.removeListener("end",u),r.removeListener("close",u),e.removeListener("close",u)}return r.on("error",c),e.on("error",c),r.on("end",u),r.on("close",u),e.on("close",u),e.emit("pipe",r),e}},function(e,t,r){"use strict";(function(t,n){var i,o,s=r(15);e.exports=w;var a=r(55);w.ReadableState=y,r(27).EventEmitter;var l=function(e,t){return e.listeners(t).length},c=r(58),u=r(16).Buffer,d=t.Uint8Array||function(){},h=r(14);h.inherits=r(7);var p=r(146),f=void 0;f=p&&p.debuglog?p.debuglog("stream"):function(){};var g=r(147),b=r(59);h.inherits(w,c);var v=["error","close","destroy","pause","resume"];function y(e,t){i=i||r(5),e=e||{};var n=t instanceof i;this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var s=e.highWaterMark,a=e.readableHighWaterMark,l=this.objectMode?16:16384;s||0===s?this.highWaterMark=s:n&&(a||0===a)?this.highWaterMark=a:this.highWaterMark=l,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new g,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(o||(o=r(30).StringDecoder),this.decoder=new o(e.encoding),this.encoding=e.encoding)}function w(e){if(i=i||r(5),!(this instanceof w))return new w(e);this._readableState=new y(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),c.call(this)}function x(e,t,r,n,i){var o,s,a,l=e._readableState;return null===t?(l.reading=!1,function(e,t){if(!t.ended){if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,T(e)}}(e,l)):(i||(a=function(e,t){var r;return u.isBuffer(t)||t instanceof d||"string"==typeof t||void 0===t||e.objectMode||(r=TypeError("Invalid non-string/buffer chunk")),r}(l,t)),a)?e.emit("error",a):l.objectMode||t&&t.length>0?("string"==typeof t||l.objectMode||Object.getPrototypeOf(t)===u.prototype||(s=t,t=u.from(s)),n?l.endEmitted?e.emit("error",Error("stream.unshift() after end event")):E(e,l,t,!0):l.ended?e.emit("error",Error("stream.push() after EOF")):(l.reading=!1,l.decoder&&!r?(t=l.decoder.write(t),l.objectMode||0!==t.length?E(e,l,t,!1):A(e,l)):E(e,l,t,!1))):n||(l.reading=!1),!(o=l).ended&&(o.needReadable||o.length<o.highWaterMark||0===o.length)}function E(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(e.emit("data",r),e.read(0)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&T(e)),A(e,t)}function _(e,t){var r;if(e<=0||0===t.length&&t.ended)return 0;if(t.objectMode)return 1;if(e!=e)if(t.flowing&&t.length)return t.buffer.head.data.length;else return t.length;return(e>t.highWaterMark&&((r=e)>=8388608?r=8388608:(r--,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r++),t.highWaterMark=r),e<=t.length)?e:t.ended?t.length:(t.needReadable=!0,0)}function T(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(f("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?s.nextTick(O,e):O(e))}function O(e){f("emit readable"),e.emit("readable"),C(e)}function A(e,t){t.readingMore||(t.readingMore=!0,s.nextTick(S,e,t))}function S(e,t){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(f("maybeReadMore read 0"),e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}function k(e){f("readable nexttick read 0"),e.read(0)}function N(e,t){t.reading||(f("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),C(e),t.flowing&&!t.reading&&e.read(0)}function C(e){var t=e._readableState;for(f("flow",t.flowing);t.flowing&&null!==e.read(););}function I(e,t){var r,n,i,o,s;return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):(n=e,i=t.buffer,o=t.decoder,n<i.head.data.length?(s=i.head.data.slice(0,n),i.head.data=i.head.data.slice(n)):s=n===i.head.data.length?i.shift():o?function(e,t){var r=t.head,n=1,i=r.data;for(e-=i.length;r=r.next;){var o=r.data,s=e>o.length?o.length:e;if(s===o.length?i+=o:i+=o.slice(0,e),0==(e-=s)){s===o.length?(++n,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=o.slice(s));break}++n}return t.length-=n,i}(n,i):function(e,t){var r=u.allocUnsafe(e),n=t.head,i=1;for(n.data.copy(r),e-=n.data.length;n=n.next;){var o=n.data,s=e>o.length?o.length:e;if(o.copy(r,r.length-e,0,s),0==(e-=s)){s===o.length?(++i,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=o.slice(s));break}++i}return t.length-=i,r}(n,i),r=s),r)}function R(e){var t=e._readableState;if(t.length>0)throw Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,s.nextTick(P,t,e))}function P(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function L(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return -1}Object.defineProperty(w.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),w.prototype.destroy=b.destroy,w.prototype._undestroy=b.undestroy,w.prototype._destroy=function(e,t){this.push(null),t(e)},w.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=u.from(e,t),t=""),r=!0),x(this,e,t,!1,r)},w.prototype.unshift=function(e){return x(this,e,null,!0,!1)},w.prototype.isPaused=function(){return!1===this._readableState.flowing},w.prototype.setEncoding=function(e){return o||(o=r(30).StringDecoder),this._readableState.decoder=new o(e),this._readableState.encoding=e,this},w.prototype.read=function(e){f("read",e),e=parseInt(e,10);var t,r=this._readableState,n=e;if(0!==e&&(r.emittedReadable=!1),0===e&&r.needReadable&&(r.length>=r.highWaterMark||r.ended))return f("read: emitReadable",r.length,r.ended),0===r.length&&r.ended?R(this):T(this),null;if(0===(e=_(e,r))&&r.ended)return 0===r.length&&R(this),null;var i=r.needReadable;return f("need readable",i),(0===r.length||r.length-e<r.highWaterMark)&&f("length less than watermark",i=!0),r.ended||r.reading?f("reading or ended",i=!1):i&&(f("do read"),r.reading=!0,r.sync=!0,0===r.length&&(r.needReadable=!0),this._read(r.highWaterMark),r.sync=!1,r.reading||(e=_(n,r))),null===(t=e>0?I(e,r):null)?(r.needReadable=!0,e=0):r.length-=e,0===r.length&&(r.ended||(r.needReadable=!0),n!==e&&r.ended&&R(this)),null!==t&&this.emit("data",t),t},w.prototype._read=function(e){this.emit("error",Error("_read() is not implemented"))},w.prototype.pipe=function(e,t){var r,i=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=e;break;case 1:o.pipes=[o.pipes,e];break;default:o.pipes.push(e)}o.pipesCount+=1,f("pipe count=%d opts=%j",o.pipesCount,t);var c=t&&!1===t.end||e===n.stdout||e===n.stderr?w:u;function u(){f("onend"),e.end()}o.endEmitted?s.nextTick(c):i.once("end",c),e.on("unpipe",function t(r,n){f("onunpipe"),r===i&&n&&!1===n.hasUnpiped&&(n.hasUnpiped=!0,f("cleanup"),e.removeListener("close",v),e.removeListener("finish",y),e.removeListener("drain",d),e.removeListener("error",b),e.removeListener("unpipe",t),i.removeListener("end",u),i.removeListener("end",w),i.removeListener("data",g),h=!0,o.awaitDrain&&(!e._writableState||e._writableState.needDrain)&&d())});var d=(r=i,function(){var e=r._readableState;f("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&l(r,"data")&&(e.flowing=!0,C(r))});e.on("drain",d);var h=!1,p=!1;function g(t){f("ondata"),p=!1,!1!==e.write(t)||p||((1===o.pipesCount&&o.pipes===e||o.pipesCount>1&&-1!==L(o.pipes,e))&&!h&&(f("false write response, pause",i._readableState.awaitDrain),i._readableState.awaitDrain++,p=!0),i.pause())}function b(t){f("onerror",t),w(),e.removeListener("error",b),0===l(e,"error")&&e.emit("error",t)}function v(){e.removeListener("finish",y),w()}function y(){f("onfinish"),e.removeListener("close",v),w()}function w(){f("unpipe"),i.unpipe(e)}return i.on("data",g),!function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?a(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",b),e.once("close",v),e.once("finish",y),e.emit("pipe",i),o.flowing||(f("pipe resume"),i.resume()),e},w.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<i;o++)n[o].emit("unpipe",this,r);return this}var s=L(t.pipes,e);return -1===s||(t.pipes.splice(s,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},w.prototype.on=function(e,t){var r=c.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var n=this._readableState;n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.emittedReadable=!1,n.reading?n.length&&T(this):s.nextTick(k,this))}return r},w.prototype.addListener=w.prototype.on,w.prototype.resume=function(){var e,t,r=this._readableState;return r.flowing||(f("resume"),r.flowing=!0,e=this,(t=r).resumeScheduled||(t.resumeScheduled=!0,s.nextTick(N,e,t))),this},w.prototype.pause=function(){return f("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(f("pause"),this._readableState.flowing=!1,this.emit("pause")),this},w.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var i in e.on("end",function(){if(f("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)}),e.on("data",function(i){if(f("wrapped data"),r.decoder&&(i=r.decoder.write(i)),!r.objectMode||null!=i)(r.objectMode||i&&i.length)&&(t.push(i)||(n=!0,e.pause()))}),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var o=0;o<v.length;o++)e.on(v[o],this.emit.bind(this,v[o]));return this._read=function(t){f("wrapped _read",t),n&&(n=!1,e.resume())},this},Object.defineProperty(w.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),w._fromList=I}).call(t,r(4),r(13))},function(e,t,r){e.exports=r(27).EventEmitter},function(e,t,r){"use strict";var n=r(15);function i(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var r=this,o=this._readableState&&this._readableState.destroyed,s=this._writableState&&this._writableState.destroyed;return o||s?t?t(e):!e||this._writableState&&this._writableState.errorEmitted||n.nextTick(i,this,e):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!t&&e?(n.nextTick(i,r,e),r._writableState&&(r._writableState.errorEmitted=!0)):t&&t(e)})),this},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(e,t,r){(function(e){var n=void 0!==e&&e||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function o(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new o(i.call(setTimeout,n,arguments),clearTimeout)},t.setInterval=function(){return new o(i.call(setInterval,n,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(n,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},r(149),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(t,r(4))},function(e,t,r){"use strict";e.exports=s;var n=r(5),i=r(14);function o(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(!n)return this.emit("error",Error("write callback called multiple times"));r.writechunk=null,r.writecb=null,null!=t&&this.push(t),n(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function s(e){if(!(this instanceof s))return new s(e);n.call(this,e),this._transformState={afterTransform:o.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",a)}function a(){var e=this;"function"==typeof this._flush?this._flush(function(t,r){l(e,t,r)}):l(this,null,null)}function l(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw Error("Calling transform done when still transforming");return e.push(null)}i.inherits=r(7),i.inherits(s,n),s.prototype.push=function(e,t){return this._transformState.needTransform=!1,n.prototype.push.call(this,e,t)},s.prototype._transform=function(e,t,r){throw Error("_transform() is not implemented")},s.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},s.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},s.prototype._destroy=function(e,t){var r=this;n.prototype._destroy.call(this,e,function(e){t(e),r.emit("close")})}},function(e,t,r){var n,i,o=r(31),s=r(32).isArray;function a(e,t,r){return(!r&&e.spaces?"\n":"")+Array(t+1).join(e.spaces)}function l(e,t,r){if(t.ignoreAttributes)return"";"attributesFn"in t&&(e=t.attributesFn(e,i,n));var o,s,l,c,u=[];for(o in e)e.hasOwnProperty(o)&&null!==e[o]&&void 0!==e[o]&&(c=t.noQuotesForNativeAttributes&&"string"!=typeof e[o]?"":'"',s=(s=""+e[o]).replace(/"/g,"&quot;"),l="attributeNameFn"in t?t.attributeNameFn(o,s,i,n):o,u.push(t.spaces&&t.indentAttributes?a(t,r+1,!1):" "),u.push(l+"="+c+("attributeValueFn"in t?t.attributeValueFn(s,o,i,n):s)+c));return e&&Object.keys(e).length&&t.spaces&&t.indentAttributes&&u.push(a(t,r,!1)),u.join("")}function c(e,t,r){return n=e,i="xml",t.ignoreDeclaration?"":"<?xml"+l(e[t.attributesKey],t,r)+"?>"}function u(e,t,r){if(t.ignoreInstruction)return"";for(o in e)if(e.hasOwnProperty(o))break;var o,s="instructionNameFn"in t?t.instructionNameFn(o,e[o],i,n):o;if("object"==typeof e[o])return n=e,i=s,"<?"+s+l(e[o][t.attributesKey],t,r)+"?>";var a=e[o]?e[o]:"";return"instructionFn"in t&&(a=t.instructionFn(a,o,i,n)),"<?"+s+(a?" "+a:"")+"?>"}function d(e,t){return t.ignoreComment?"":"\x3c!--"+("commentFn"in t?t.commentFn(e,i,n):e)+"--\x3e"}function h(e,t){return t.ignoreCdata?"":"<![CDATA["+("cdataFn"in t?t.cdataFn(e,i,n):e.replace("]]>","]]]]><![CDATA[>"))+"]]>"}function p(e,t){return t.ignoreDoctype?"":"<!DOCTYPE "+("doctypeFn"in t?t.doctypeFn(e,i,n):e)+">"}function f(e,t){return t.ignoreText?"":(e=(e=(e=""+e).replace(/&amp;/g,"&")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"textFn"in t?t.textFn(e,i,n):e)}function g(e,t,r){var n;for(n in e)if(e.hasOwnProperty(n))switch(n){case t.parentKey:case t.attributesKey:break;case t.textKey:if(t.indentText||r)return!0;break;case t.cdataKey:if(t.indentCdata||r)return!0;break;case t.instructionKey:if(t.indentInstruction||r)return!0;break;case t.doctypeKey:case t.commentKey:default:return!0}return!1}e.exports=function(e,t){r=t,b=o.copyOptions(r),o.ensureFlagExists("ignoreDeclaration",b),o.ensureFlagExists("ignoreInstruction",b),o.ensureFlagExists("ignoreAttributes",b),o.ensureFlagExists("ignoreText",b),o.ensureFlagExists("ignoreComment",b),o.ensureFlagExists("ignoreCdata",b),o.ensureFlagExists("ignoreDoctype",b),o.ensureFlagExists("compact",b),o.ensureFlagExists("indentText",b),o.ensureFlagExists("indentCdata",b),o.ensureFlagExists("indentAttributes",b),o.ensureFlagExists("indentInstruction",b),o.ensureFlagExists("fullTagEmptyElement",b),o.ensureFlagExists("noQuotesForNativeAttributes",b),o.ensureSpacesExists(b),"number"==typeof b.spaces&&(b.spaces=Array(b.spaces+1).join(" ")),o.ensureKeyExists("declaration",b),o.ensureKeyExists("instruction",b),o.ensureKeyExists("attributes",b),o.ensureKeyExists("text",b),o.ensureKeyExists("comment",b),o.ensureKeyExists("cdata",b),o.ensureKeyExists("doctype",b),o.ensureKeyExists("type",b),o.ensureKeyExists("name",b),o.ensureKeyExists("elements",b),o.checkFnExists("doctype",b),o.checkFnExists("instruction",b),o.checkFnExists("cdata",b),o.checkFnExists("comment",b),o.checkFnExists("text",b),o.checkFnExists("instructionName",b),o.checkFnExists("elementName",b),o.checkFnExists("attributeName",b),o.checkFnExists("attributeValue",b),o.checkFnExists("attributes",b),o.checkFnExists("fullTagEmptyElement",b),t=b;var r,b,v=[];return n=e,i="_root_",t.compact?v.push(function e(t,r,o,b){var v,y,w,x=[];for(y in t)if(t.hasOwnProperty(y))for(v=0,w=s(t[y])?t[y]:[t[y]];v<w.length;++v){switch(y){case r.declarationKey:x.push(c(w[v],r,o));break;case r.instructionKey:x.push((r.indentInstruction?a(r,o,b):"")+u(w[v],r,o));break;case r.attributesKey:case r.parentKey:break;case r.textKey:x.push((r.indentText?a(r,o,b):"")+f(w[v],r));break;case r.cdataKey:x.push((r.indentCdata?a(r,o,b):"")+h(w[v],r));break;case r.doctypeKey:x.push(a(r,o,b)+p(w[v],r));break;case r.commentKey:x.push(a(r,o,b)+d(w[v],r));break;default:x.push(a(r,o,b)+function(t,r,o,s,c){n=t,i=r;var u="elementNameFn"in o?o.elementNameFn(r,t):r;if(null==t||""===t)return"fullTagEmptyElementFn"in o&&o.fullTagEmptyElementFn(r,t)||o.fullTagEmptyElement?"<"+u+"></"+u+">":"<"+u+"/>";var d=[];if(r){if(d.push("<"+u),"object"!=typeof t)return d.push(">"+f(t,o)+"</"+u+">"),d.join("");t[o.attributesKey]&&d.push(l(t[o.attributesKey],o,s));var h=g(t,o,!0)||t[o.attributesKey]&&"preserve"===t[o.attributesKey]["xml:space"];if(h||(h="fullTagEmptyElementFn"in o?o.fullTagEmptyElementFn(r,t):o.fullTagEmptyElement),!h)return d.push("/>"),d.join("");d.push(">")}return d.push(e(t,o,s+1,!1)),n=t,i=r,r&&d.push((c?a(o,s,!1):"")+"</"+u+">"),d.join("")}(w[v],y,r,o,g(w[v],r)))}b=b&&!x.length}return x.join("")}(e,t,0,!0)):(e[t.declarationKey]&&v.push(c(e[t.declarationKey],t,0)),e[t.elementsKey]&&e[t.elementsKey].length&&v.push(function e(t,r,o,s){return t.reduce(function(t,c){var g,b,v,y=a(r,o,s&&!t);switch(c.type){case"element":return t+y+(n=c,i=c.name,g=[],b="elementNameFn"in r?r.elementNameFn(c.name,c):c.name,g.push("<"+b),c[r.attributesKey]&&g.push(l(c[r.attributesKey],r,o)),(v=c[r.elementsKey]&&c[r.elementsKey].length||c[r.attributesKey]&&"preserve"===c[r.attributesKey]["xml:space"])||(v="fullTagEmptyElementFn"in r?r.fullTagEmptyElementFn(c.name,c):r.fullTagEmptyElement),v?(g.push(">"),c[r.elementsKey]&&c[r.elementsKey].length&&(g.push(e(c[r.elementsKey],r,o+1)),n=c,i=c.name),g.push(r.spaces&&function(e,t){var r;if(e.elements&&e.elements.length)for(r=0;r<e.elements.length;++r)switch(e.elements[r][t.typeKey]){case"text":if(t.indentText)return!0;break;case"cdata":if(t.indentCdata)return!0;break;case"instruction":if(t.indentInstruction)return!0;break;default:return!0}return!1}(c,r)?"\n"+Array(o+1).join(r.spaces):""),g.push("</"+b+">")):g.push("/>"),g.join(""));case"comment":return t+y+d(c[r.commentKey],r);case"doctype":return t+y+p(c[r.doctypeKey],r);case"cdata":return t+(r.indentCdata?y:"")+h(c[r.cdataKey],r);case"text":return t+(r.indentText?y:"")+f(c[r.textKey],r);case"instruction":var w={};return w[c[r.nameKey]]=c[r.attributesKey]?c:c[r.instructionKey],t+(r.indentInstruction?y:"")+u(w,r,o)}},"")}(e[t.elementsKey],t,0,!v.length))),v.join("")}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(160);class o extends n.XmlComponent{constructor(e,t={color:"auto",space:1,value:"single",size:6}){super(e);let r=new i.BorderAttributes({color:t.color,space:t.space,val:t.value,sz:t.size});this.root.push(r)}}class s extends n.XmlComponent{constructor(e){if(super("w:pBdr"),void 0!==e.top){let t=new o("w:top",e.top);this.root.push(t)}if(void 0!==e.bottom){let t=new o("w:bottom",e.bottom);this.root.push(t)}if(void 0!==e.left){let t=new o("w:left",e.left);this.root.push(t)}if(void 0!==e.right){let t=new o("w:right",e.right);this.root.push(t)}}}t.Border=s;class a extends n.XmlComponent{constructor(){super("w:pBdr");let e=new o("w:bottom",{color:"auto",space:1,value:"single",size:6});this.root.push(e)}}t.ThematicBreak=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={left:"w:left",hanging:"w:hanging",firstLine:"w:firstLine",start:"w:start",end:"w:end",right:"w:end"}}}class o extends n.XmlComponent{constructor(e){super("w:ind"),this.root.push(new i(e))}}t.Indent=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlComponent{constructor(){super("w:keepLines")}}t.KeepLines=i;class o extends n.XmlComponent{constructor(){super("w:keepNext")}}t.KeepNext=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(3);class o extends n.XmlComponent{constructor(){super("w:br"),this.root.push(new n.Attributes({type:"page"}))}}class s extends i.Run{constructor(){super({}),this.root.push(new o)}}t.PageBreak=s;class a extends n.XmlComponent{constructor(){super("w:pageBreakBefore")}}t.PageBreakBefore=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlComponent{constructor(){super("w:br")}}t.Break=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);t.Underline=r(19).Underline,t.EmphasisMark=r(33).EmphasisMark;var i=r(69);t.SubScript=i.SubScript,t.SuperScript=i.SuperScript,t.RunFonts=r(34).RunFonts;class o extends n.XmlComponent{constructor(){super("w:b"),this.root.push(new n.Attributes({val:!0}))}}t.Bold=o;class s extends n.XmlComponent{constructor(){super("w:bCs"),this.root.push(new n.Attributes({val:!0}))}}t.BoldComplexScript=s;class a extends n.XmlComponent{constructor(e){super("w:spacing"),this.root.push(new n.Attributes({val:e}))}}t.CharacterSpacing=a;class l extends n.XmlComponent{constructor(){super("w:i"),this.root.push(new n.Attributes({val:!0}))}}t.Italics=l;class c extends n.XmlComponent{constructor(){super("w:iCs"),this.root.push(new n.Attributes({val:!0}))}}t.ItalicsComplexScript=c;class u extends n.XmlComponent{constructor(){super("w:caps"),this.root.push(new n.Attributes({val:!0}))}}t.Caps=u;class d extends n.XmlComponent{constructor(e){super("w:color"),this.root.push(new n.Attributes({val:e}))}}t.Color=d;class h extends n.XmlComponent{constructor(){super("w:dstrike"),this.root.push(new n.Attributes({val:!0}))}}t.DoubleStrike=h;class p extends n.XmlComponent{constructor(){super("w:emboss"),this.root.push(new n.Attributes({val:!0}))}}t.Emboss=p;class f extends n.XmlComponent{constructor(){super("w:imprint"),this.root.push(new n.Attributes({val:!0}))}}t.Imprint=f;class g extends n.XmlComponent{constructor(){super("w:smallCaps"),this.root.push(new n.Attributes({val:!0}))}}t.SmallCaps=g;class b extends n.XmlComponent{constructor(){super("w:strike"),this.root.push(new n.Attributes({val:!0}))}}t.Strike=b;class v extends n.XmlComponent{constructor(e){super("w:sz"),this.root.push(new n.Attributes({val:e}))}}t.Size=v;class y extends n.XmlComponent{constructor(e){super("w:szCs"),this.root.push(new n.Attributes({val:e}))}}t.SizeComplexScript=y;class w extends n.XmlComponent{constructor(){super("w:rtl"),this.root.push(new n.Attributes({val:!0}))}}t.RightToLeft=w;class x extends n.XmlComponent{constructor(e){super("w:highlight"),this.root.push(new n.Attributes({val:e}))}}t.Highlight=x;class E extends n.XmlComponent{constructor(e){super("w:highlightCs"),this.root.push(new n.Attributes({val:e}))}}t.HighlightComplexScript=E;class _ extends n.XmlComponent{constructor(e,t,r){super("w:shd"),this.root.push(new n.Attributes({val:e,fill:t,color:r}))}}t.Shading=_;class T extends n.XmlComponent{constructor(e,t,r){super("w:shdCs"),this.root.push(new n.Attributes({val:e,fill:t,color:r}))}}t.ShadowComplexScript=T},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlComponent{constructor(e){super("w:vertAlign"),this.root.push(new n.Attributes({val:e}))}}t.VerticalAlign=i,t.SuperScript=class extends i{constructor(){super("superscript")}},t.SubScript=class extends i{constructor(){super("subscript")}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={val:"w:val"}}}class o extends n.XmlComponent{constructor(e){super("w:rStyle"),this.root.push(new i({val:e}))}}t.Style=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(8),i=r(0);class o extends i.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={space:"xml:space"}}}class s extends i.XmlComponent{constructor(e){super("w:t"),this.root.push(new o({space:n.SpaceType.PRESERVE})),this.root.push(e)}}t.Text=s},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(166)),n(r(36)),n(r(73))},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(35)),n(r(169)),n(r(170)),n(r(171))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlComponent{constructor(e){super("wp:align"),this.root.push(e)}}t.Align=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlComponent{constructor(e){super("wp:posOffset"),this.root.push(e.toString())}}t.PositionOffset=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(172);for(var i in n)t.hasOwnProperty(i)||(t[i]=n[i])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(205);class o extends n.XmlComponent{constructor(){super("wp:docPr"),this.root.push(new i.DocPropertiesAttributes({id:0,name:"",descr:""}))}}t.DocProperties=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(206);class o extends n.XmlComponent{constructor(){super("wp:effectExtent"),this.root.push(new i.EffectExtentAttributes({b:0,l:0,r:0,t:0}))}}t.EffectExtent=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(207);class o extends n.XmlComponent{constructor(e,t){super("wp:extent"),this.attributes=new i.ExtentAttributes({cx:e,cy:t}),this.root.push(this.attributes)}setXY(e,t){this.attributes.set({cx:e,cy:t})}}t.Extent=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(208);class o extends n.XmlComponent{constructor(){super("wp:cNvGraphicFramePr"),this.root.push(new i.GraphicFrameLocks)}}t.GraphicFrameProperties=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={distT:"distT",distB:"distB",distL:"distL",distR:"distR",allowOverlap:"allowOverlap",behindDoc:"behindDoc",layoutInCell:"layoutInCell",locked:"locked",relativeHeight:"relativeHeight",simplePos:"simplePos"}}}t.AnchorAttributes=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={after:"w:after",before:"w:before",line:"w:line",lineRule:"w:lineRule"}}}class o extends n.XmlComponent{constructor(e){super("w:spacing"),this.root.push(new i(e))}}t.Spacing=o;class s extends n.XmlComponent{constructor(e){super("w:contextualSpacing"),this.root.push(new n.Attributes({val:+(!1!==e)}))}}t.ContextualSpacing=s},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0});let i=r(0);(n=t.HeadingLevel||(t.HeadingLevel={})).HEADING_1="Heading1",n.HEADING_2="Heading2",n.HEADING_3="Heading3",n.HEADING_4="Heading4",n.HEADING_5="Heading5",n.HEADING_6="Heading6",n.TITLE="Title";class o extends i.XmlComponent{constructor(e){super("w:pStyle"),this.root.push(new i.Attributes({val:e}))}}t.Style=o},function(e,t,r){"use strict";var n,i,o;Object.defineProperty(t,"__esModule",{value:!0});let s=r(0);class a extends s.XmlComponent{constructor(e,t,r){super("w:tabs"),this.root.push(new c(e,t,r))}}t.TabStop=a,(n=t.TabStopType||(t.TabStopType={})).LEFT="left",n.RIGHT="right",n.CENTER="center",n.BAR="bar",n.CLEAR="clear",n.DECIMAL="decimal",n.END="end",n.NUM="num",n.START="start",(i=t.LeaderType||(t.LeaderType={})).DOT="dot",i.HYPHEN="hyphen",i.MIDDLE_DOT="middleDot",i.NONE="none",i.UNDERSCORE="underscore",(o=t.TabStopPosition||(t.TabStopPosition={}))[o.MAX=9026]="MAX";class l extends s.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={val:"w:val",pos:"w:pos",leader:"w:leader"}}}t.TabAttributes=l;class c extends s.XmlComponent{constructor(e,t,r){super("w:tab"),this.root.push(new l({val:e,pos:t,leader:r}))}}t.TabStopItem=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlComponent{constructor(e,t){super("w:numPr"),this.root.push(new o(t)),this.root.push(new s(e))}}t.NumberProperties=i;class o extends n.XmlComponent{constructor(e){super("w:ilvl"),this.root.push(new n.Attributes({val:e}))}}class s extends n.XmlComponent{constructor(e){super("w:numId"),this.root.push(new n.Attributes({val:"string"==typeof e?`{${e}}`:e}))}}},function(e,t,r){"use strict";e.exports=r(220)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlComponent{constructor(e){for(let t of(super("m:den"),e))this.root.push(t)}}t.MathDenominator=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlComponent{constructor(e){for(let t of(super("m:num"),e))this.root.push(t)}}t.MathNumerator=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={accent:"m:val"}}}class o extends n.XmlComponent{constructor(e){super("m:chr"),this.root.push(new i({accent:e}))}}t.MathAccentCharacter=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlComponent{constructor(e){for(let t of(super("m:e"),e))this.root.push(t)}}t.MathBase=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={value:"m:val"}}}class o extends n.XmlComponent{constructor(){super("m:limLoc"),this.root.push(new i({value:"undOvr"}))}}t.MathLimitLocation=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(89),o=r(91),s=r(237),a=r(238);class l extends n.XmlComponent{constructor(e,t,r){super("m:naryPr"),this.root.push(new i.MathAccentCharacter(e)),this.root.push(new o.MathLimitLocation),t||this.root.push(new a.MathSuperScriptHide),r||this.root.push(new s.MathSubScriptHide)}}t.MathNArayProperties=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlComponent{constructor(e){for(let t of(super("m:sub"),e))this.root.push(t)}}t.MathSubScriptElement=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlComponent{constructor(e){for(let t of(super("m:sup"),e))this.root.push(t)}}t.MathSuperScriptElement=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlComponent{constructor(){super("m:sSupPr")}}t.MathSuperScriptProperties=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlComponent{constructor(){super("m:sSubPr")}}t.MathSubScriptProperties=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlComponent{constructor(){super("m:sSubSupPr")}}t.MathSubSuperScriptProperties=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlComponent{constructor(){super("m:sPrePr")}}t.MathPreSubSuperScriptProperties=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlComponent{constructor(e){if(super("m:deg"),e)for(let t of e)this.root.push(t)}}t.MathDegree=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(252);class o extends n.XmlComponent{constructor(e){super("m:radPr"),e||this.root.push(new i.MathDegreeHide)}}t.MathRadicalProperties=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlComponent{constructor(e){for(let t of(super("m:fName"),e))this.root.push(t)}}t.MathFunctionName=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlComponent{constructor(){super("m:funcPr")}}t.MathFunctionProperties=i},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(270)),n(r(109)),n(r(111)),n(r(104)),n(r(110))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(23),i=r(0);class o extends i.XmlComponent{constructor(e){super("w:tblBorders"),e.top?this.root.push(new s("w:top",e.top.style,e.top.size,0,e.top.color)):this.root.push(new s("w:top",n.BorderStyle.SINGLE,4,0,"auto")),e.left?this.root.push(new s("w:left",e.left.style,e.left.size,0,e.left.color)):this.root.push(new s("w:left",n.BorderStyle.SINGLE,4,0,"auto")),e.bottom?this.root.push(new s("w:bottom",e.bottom.style,e.bottom.size,0,e.bottom.color)):this.root.push(new s("w:bottom",n.BorderStyle.SINGLE,4,0,"auto")),e.right?this.root.push(new s("w:right",e.right.style,e.right.size,0,e.right.color)):this.root.push(new s("w:right",n.BorderStyle.SINGLE,4,0,"auto")),e.insideHorizontal?this.root.push(new s("w:insideH",e.insideHorizontal.style,e.insideHorizontal.size,0,e.insideHorizontal.color)):this.root.push(new s("w:insideH",n.BorderStyle.SINGLE,4,0,"auto")),e.insideVertical?this.root.push(new s("w:insideV",e.insideVertical.style,e.insideVertical.size,0,e.insideVertical.color)):this.root.push(new s("w:insideV",n.BorderStyle.SINGLE,4,0,"auto"))}}o.NONE={top:{style:n.BorderStyle.NONE,size:0,color:"auto"},bottom:{style:n.BorderStyle.NONE,size:0,color:"auto"},left:{style:n.BorderStyle.NONE,size:0,color:"auto"},right:{style:n.BorderStyle.NONE,size:0,color:"auto"},insideHorizontal:{style:n.BorderStyle.NONE,size:0,color:"auto"},insideVertical:{style:n.BorderStyle.NONE,size:0,color:"auto"}},t.TableBorders=o;class s extends i.XmlComponent{constructor(e,t,r,n,i){super(e),this.root.push(new a({value:t,size:r,space:n,color:i}))}}class a extends i.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={value:"w:val",size:"w:sz",space:"w:space",color:"w:color"}}}},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(40)),n(r(42)),n(r(43)),n(r(272))},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(107)),n(r(108)),n(r(275))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(21),i=r(0);class o extends i.XmlComponent{constructor(e){super("w:pPrDefault"),this.root.push(new n.ParagraphProperties(e))}}t.ParagraphPropertiesDefaults=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(9),i=r(0);class o extends i.XmlComponent{constructor(e){super("w:rPrDefault"),this.properties=new n.RunProperties(e),this.root.push(this.properties)}}t.RunPropertiesDefaults=o},function(e,t,r){"use strict";var n,i,o;Object.defineProperty(t,"__esModule",{value:!0});let s=r(0),a=r(110);(n=t.TableAnchorType||(t.TableAnchorType={})).MARGIN="margin",n.PAGE="page",n.TEXT="text",(i=t.RelativeHorizontalPosition||(t.RelativeHorizontalPosition={})).CENTER="center",i.INSIDE="inside",i.LEFT="left",i.OUTSIDE="outside",i.RIGHT="right",(o=t.RelativeVerticalPosition||(t.RelativeVerticalPosition={})).CENTER="center",o.INSIDE="inside",o.BOTTOM="bottom",o.OUTSIDE="outside",o.INLINE="inline",o.TOP="top";class l extends s.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={horizontalAnchor:"w:horzAnchor",verticalAnchor:"w:vertAnchor",absoluteHorizontalPosition:"w:tblpX",relativeHorizontalPosition:"w:tblpXSpec",absoluteVerticalPosition:"w:tblpY",relativeVerticalPosition:"w:tblpYSpec",bottomFromText:"w:bottomFromText",topFromText:"w:topFromText",leftFromText:"w:leftFromText",rightFromText:"w:rightFromText"}}}t.TableFloatOptionsAttributes=l;class c extends s.XmlComponent{constructor(e){super("w:tblpPr"),this.root.push(new l(e)),e.overlap&&this.root.push(new a.TableOverlap(e.overlap))}}t.TableFloatProperties=c},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0});let i=r(0);(n=t.OverlapType||(t.OverlapType={})).NEVER="never",n.OVERLAP="overlap";class o extends i.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={val:"w:val"}}}class s extends i.XmlComponent{constructor(e){super("w:tblOverlap"),this.root.push(new o({val:e}))}}t.TableOverlap=s},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0});let i=r(0);(n=t.TableLayoutType||(t.TableLayoutType={})).AUTOFIT="autofit",n.FIXED="fixed";class o extends i.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={type:"w:type"}}}class s extends i.XmlComponent{constructor(e){super("w:tblLayout"),this.root.push(new o({type:e}))}}t.TableLayout=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(113);class o extends n.IgnoreIfEmptyXmlComponent{constructor(){super("w:trPr")}setCantSplit(){return this.root.push(new a),this}setTableHeader(){return this.root.push(new c),this}setHeight(e,t){return this.root.push(new i.TableRowHeight(e,t)),this}}t.TableRowProperties=o;class s extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={val:"w:val"}}}class a extends n.XmlComponent{constructor(){super("w:cantSplit"),this.root.push(new s({val:!0}))}}t.CantSplit=a;class l extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={val:"w:val"}}}class c extends n.XmlComponent{constructor(){super("w:tblHeader"),this.root.push(new l({val:!0}))}}t.TableHeader=c},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0});let i=r(0);(n=t.HeightRule||(t.HeightRule={})).AUTO="auto",n.ATLEAST="atLeast",n.EXACT="exact";class o extends i.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={height:"w:val",rule:"w:hRule"}}}t.TableRowHeightAttributes=o;class s extends i.XmlComponent{constructor(e,t){super("w:trHeight"),this.root.push(new o({height:e,rule:t}))}}t.TableRowHeight=s},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(292)),n(r(11)),n(r(115)),n(r(130))},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(293)),n(r(129))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(44),i=r(0),o=r(294),s=r(296),a=r(117),l=r(118),c=r(120),u=r(121),d=r(123),h=r(124),p=r(300),f=r(125),g=r(126),b=r(45),v=r(303),y=r(127);class w extends i.XmlComponent{constructor(e={column:{}}){super("w:sectPr");let{width:t=11906,height:r=16838,top:i=n.convertInchesToTwip(1),right:a=n.convertInchesToTwip(1),bottom:l=n.convertInchesToTwip(1),left:c=n.convertInchesToTwip(1),header:u=708,footer:w=708,gutter:x=0,mirror:E=!1,column:_={},linePitch:T=360,orientation:O=b.PageOrientation.PORTRAIT,headers:A,footers:S,pageNumberFormatType:k,pageNumberStart:N,lineNumberCountBy:C,lineNumberStart:I,lineNumberRestart:R,lineNumberDistance:P,pageBorders:L,pageBorderTop:D,pageBorderRight:j,pageBorderBottom:B,pageBorderLeft:F,titlePage:U=!1,verticalAlign:q}=e;this.options=e,this.root.push(new g.PageSize(t,r,O)),this.root.push(new p.PageMargin(i,a,l,c,u,w,x,E)),this.root.push(new o.Columns(_.space?_.space:708,_.count?_.count:1)),this.root.push(new s.DocumentGrid(T)),this.addHeaders(A),this.addFooters(S),(N||k)&&this.root.push(new f.PageNumberType(N,k)),(C||I||R||P)&&this.root.push(new d.LineNumberType(C,I,R,P)),(L||D||j||B||F)&&this.root.push(new h.PageBorders({pageBorders:L,pageBorderTop:D,pageBorderRight:j,pageBorderBottom:B,pageBorderLeft:F})),U&&this.root.push(new v.TitlePage),q&&this.root.push(new y.SectionVerticalAlign(q))}addHeaders(e){e&&(e.default&&this.root.push(new u.HeaderReference({headerType:c.HeaderReferenceType.DEFAULT,headerId:e.default.Header.ReferenceId})),e.first&&this.root.push(new u.HeaderReference({headerType:c.HeaderReferenceType.FIRST,headerId:e.first.Header.ReferenceId})),e.even&&this.root.push(new u.HeaderReference({headerType:c.HeaderReferenceType.EVEN,headerId:e.even.Header.ReferenceId})))}addFooters(e){e&&(e.default&&this.root.push(new l.FooterReference({footerType:a.FooterReferenceType.DEFAULT,footerId:e.default.Footer.ReferenceId})),e.first&&this.root.push(new l.FooterReference({footerType:a.FooterReferenceType.FIRST,footerId:e.first.Footer.ReferenceId})),e.even&&this.root.push(new l.FooterReference({footerType:a.FooterReferenceType.EVEN,footerId:e.even.Footer.ReferenceId})))}get Options(){return this.options}}t.SectionProperties=w},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(118)),n(r(119))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(119);class o extends n.XmlComponent{constructor(e){super("w:footerReference"),this.root.push(new i.FooterReferenceAttributes({type:e.footerType||i.FooterReferenceType.DEFAULT,id:`rId${e.footerId}`}))}}t.FooterReference=o},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0});let i=r(0);(n=t.FooterReferenceType||(t.FooterReferenceType={})).DEFAULT="default",n.FIRST="first",n.EVEN="even";class o extends i.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={type:"w:type",id:"r:id"}}}t.FooterReferenceAttributes=o},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(121)),n(r(122))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(122);class o extends n.XmlComponent{constructor(e){super("w:headerReference"),this.root.push(new i.HeaderReferenceAttributes({type:e.headerType||i.HeaderReferenceType.DEFAULT,id:`rId${e.headerId}`}))}}t.HeaderReference=o},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0});let i=r(0);(n=t.HeaderReferenceType||(t.HeaderReferenceType={})).DEFAULT="default",n.FIRST="first",n.EVEN="even";class o extends i.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={type:"w:type",id:"r:id"}}}t.HeaderReferenceAttributes=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(298);for(var i in n)t.hasOwnProperty(i)||(t[i]=n[i])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(299);for(var i in n)t.hasOwnProperty(i)||(t[i]=n[i])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(302);for(var i in n)t.hasOwnProperty(i)||(t[i]=n[i])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(45);class o extends n.XmlComponent{constructor(e,t,r){super("w:pgSz");let n=r===i.PageOrientation.LANDSCAPE;this.root.push(new i.PageSizeAttributes({width:n?t:e,height:n?e:t,orientation:r}))}}t.PageSize=o},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(305)),n(r(128))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={verticalAlign:"w:val"}}}t.SectionVerticalAlignAttributes=i},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(116)),n(r(117)),n(r(120)),n(r(306)),n(r(125)),n(r(124)),n(r(123)),n(r(127))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(307);for(var i in n)t.hasOwnProperty(i)||(t[i]=n[i])},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(313)),n(r(323))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Header=class{constructor(e={children:[]}){this.options=e}},t.Footer=class{constructor(e={children:[]}){this.options=e}}},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(330)),n(r(134)),n(r(24)),n(r(135))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(24),o=r(331);class s extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={abstractNumId:"w:abstractNumId",restartNumberingAfterBreak:"w15:restartNumberingAfterBreak"}}}class a extends n.XmlComponent{constructor(e,t){for(let r of(super("w:abstractNum"),this.root.push(new s({abstractNumId:e,restartNumberingAfterBreak:0})),this.root.push(new o.MultiLevelType("hybridMultilevel")),this.id=e,t))this.root.push(new i.Level(r))}}t.AbstractNumbering=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(24);class o extends n.XmlComponent{constructor(e){super("w:abstractNumId"),this.root.push(new n.Attributes({val:e}))}}class s extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={numId:"w:numId"}}}class a extends n.XmlComponent{constructor(e,t,r){super("w:num"),this.reference=r,this.root.push(new s({numId:e})),this.root.push(new o(t)),this.id=e}overrideLevel(e,t){let r=new c(e,t);return this.root.push(r),r}}t.ConcreteNumbering=a;class l extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={ilvl:"w:ilvl"}}}class c extends n.XmlComponent{constructor(e,t){super("w:lvlOverride"),this.levelNum=e,this.root.push(new l({ilvl:e})),void 0!==t&&this.root.push(new d(t)),this.lvl=new i.LevelForOverride({level:this.levelNum}),this.root.push(this.lvl)}get Level(){return this.lvl}}t.LevelOverride=c;class u extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={val:"w:val"}}}class d extends n.XmlComponent{constructor(e){super("w:startOverride"),this.root.push(new u({val:e}))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={enabled:"w:val"}}}t.UpdateFieldsAttributes=i;class o extends n.XmlComponent{constructor(e=!0){super("w:updateFields"),this.root.push(new i({enabled:e}))}}t.UpdateFields=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={id:"w:id",author:"w:author",date:"w:date"}}}t.ChangeAttributes=i},function(e,t,r){(function(t,r,n){var i;e.exports=(function e(t,r,n){function o(a,l){if(!r[a]){if(!t[a]){if(!l&&"function"==typeof i&&i)return i(a,!0);if(s)return s(a,!0);var c=Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var u=r[a]={exports:{}};t[a][0].call(u.exports,function(e){return o(t[a][1][e]||e)},u,u.exports,e,t,r,n)}return r[a].exports}for(var s="function"==typeof i&&i,a=0;a<n.length;a++)o(n[a]);return o})({1:[function(e,t,r){"use strict";var n=e("./utils"),i=e("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(e){for(var t,r,i,s,a,l,c,u=[],d=0,h=e.length,p=h,f="string"!==n.getTypeOf(e);d<e.length;)p=h-d,i=f?(t=e[d++],r=d<h?e[d++]:0,d<h?e[d++]:0):(t=e.charCodeAt(d++),r=d<h?e.charCodeAt(d++):0,d<h?e.charCodeAt(d++):0),s=t>>2,a=(3&t)<<4|r>>4,l=1<p?(15&r)<<2|i>>6:64,c=2<p?63&i:64,u.push(o.charAt(s)+o.charAt(a)+o.charAt(l)+o.charAt(c));return u.join("")},r.decode=function(e){var t,r,n,s,a,l,c=0,u=0,d="data:";if(e.substr(0,d.length)===d)throw Error("Invalid base64 input, it looks like a data url.");var h,p=3*(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(e.charAt(e.length-1)===o.charAt(64)&&p--,e.charAt(e.length-2)===o.charAt(64)&&p--,p%1!=0)throw Error("Invalid base64 input, bad content length.");for(h=i.uint8array?new Uint8Array(0|p):Array(0|p);c<e.length;)t=o.indexOf(e.charAt(c++))<<2|(s=o.indexOf(e.charAt(c++)))>>4,r=(15&s)<<4|(a=o.indexOf(e.charAt(c++)))>>2,n=(3&a)<<6|(l=o.indexOf(e.charAt(c++))),h[u++]=t,64!==a&&(h[u++]=r),64!==l&&(h[u++]=n);return h}},{"./support":30,"./utils":32}],2:[function(e,t,r){"use strict";var n=e("./external"),i=e("./stream/DataWorker"),o=e("./stream/DataLengthProbe"),s=e("./stream/Crc32Probe");function a(e,t,r,n,i){this.compressedSize=e,this.uncompressedSize=t,this.crc32=r,this.compression=n,this.compressedContent=i}o=e("./stream/DataLengthProbe"),a.prototype={getContentWorker:function(){var e=new i(n.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new o("data_length")),t=this;return e.on("end",function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw Error("Bug : uncompressed data size mismatch")}),e},getCompressedWorker:function(){return new i(n.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},a.createWorkerFrom=function(e,t,r){return e.pipe(new s).pipe(new o("uncompressedSize")).pipe(t.compressWorker(r)).pipe(new o("compressedSize")).withStreamInfo("compression",t)},t.exports=a},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,r){"use strict";var n=e("./stream/GenericWorker");r.STORE={magic:"\0\0",compressWorker:function(e){return new n("STORE compression")},uncompressWorker:function(){return new n("STORE decompression")}},r.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,r){"use strict";var n=e("./utils"),i=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?0xedb88320^e>>>1:e>>>1;t[r]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?"string"!==n.getTypeOf(e)?function(e,t,r,n){var o=0+r;e^=-1;for(var s=0;s<o;s++)e=e>>>8^i[255&(e^t[s])];return -1^e}(0|t,e,e.length,0):function(e,t,r,n){var o=0+r;e^=-1;for(var s=0;s<o;s++)e=e>>>8^i[255&(e^t.charCodeAt(s))];return -1^e}(0|t,e,e.length,0):0}},{"./utils":32}],5:[function(e,t,r){"use strict";r.base64=!1,r.binary=!1,r.dir=!1,r.createFolders=!0,r.date=null,r.compression=null,r.compressionOptions=null,r.comment=null,r.unixPermissions=null,r.dosPermissions=null},{}],6:[function(e,t,r){"use strict";t.exports={Promise:"undefined"!=typeof Promise?Promise:e("lie")}},{lie:37}],7:[function(e,t,r){"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,i=e("pako"),o=e("./utils"),s=e("./stream/GenericWorker"),a=n?"uint8array":"array";function l(e,t){s.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}r.magic="\b\0",o.inherits(l,s),l.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(o.transformTo(a,e.data),!1)},l.prototype.flush=function(){s.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},l.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this._pako=null},l.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},r.compressWorker=function(e){return new l("Deflate",e)},r.uncompressWorker=function(){return new l("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,r){"use strict";function n(e,t){var r,n="";for(r=0;r<t;r++)n+=String.fromCharCode(255&e),e>>>=8;return n}function i(e,t,r,i,s,u){var d,h,p,f,g=e.file,b=e.compression,v=u!==a.utf8encode,y=o.transformTo("string",u(g.name)),w=o.transformTo("string",a.utf8encode(g.name)),x=g.comment,E=o.transformTo("string",u(x)),_=o.transformTo("string",a.utf8encode(x)),T=w.length!==g.name.length,O=_.length!==x.length,A="",S="",k="",N=g.dir,C=g.date,I={crc32:0,compressedSize:0,uncompressedSize:0};t&&!r||(I.crc32=e.crc32,I.compressedSize=e.compressedSize,I.uncompressedSize=e.uncompressedSize);var R=0;t&&(R|=8),!v&&(T||O)&&(R|=2048);var P=0,L=0;N&&(P|=16),"UNIX"===s?(L=798,P|=(d=g.unixPermissions,h=d,d||(h=N?16893:33204),(65535&h)<<16)):(L=20,P|=63&(g.dosPermissions||0)),p=(C.getUTCHours()<<6|C.getUTCMinutes())<<5|C.getUTCSeconds()/2,f=(C.getUTCFullYear()-1980<<4|C.getUTCMonth()+1)<<5|C.getUTCDate(),T&&(S=n(1,1)+n(l(y),4)+w,A+="up"+n(S.length,2)+S),O&&(k=n(1,1)+n(l(E),4)+_,A+="uc"+n(k.length,2)+k);var D="";return D+="\n\0",D+=n(R,2),D+=b.magic,D+=n(p,2),D+=n(f,2),D+=n(I.crc32,4),D+=n(I.compressedSize,4),D+=n(I.uncompressedSize,4),D+=n(y.length,2),D+=n(A.length,2),{fileRecord:c.LOCAL_FILE_HEADER+D+y+A,dirRecord:c.CENTRAL_FILE_HEADER+n(L,2)+D+n(E.length,2)+"\0\0\0\0"+n(P,4)+n(i,4)+y+A+E}}var o=e("../utils"),s=e("../stream/GenericWorker"),a=e("../utf8"),l=e("../crc32"),c=e("../signature");function u(e,t,r,n){s.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=r,this.encodeFileName=n,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(u,s),u.prototype.push=function(e){var t=e.meta.percent||0,r=this.entriesCount,n=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,s.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:r?(t+100*(r-n-1))/r:100}}))},u.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var r=i(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:r.fileRecord,meta:{percent:0}})}else this.accumulate=!0},u.prototype.closedSource=function(e){this.accumulate=!1;var t=this.streamFiles&&!e.file.dir,r=i(e,t,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(r.dirRecord),t)this.push({data:c.DATA_DESCRIPTOR+n(e.crc32,4)+n(e.compressedSize,4)+n(e.uncompressedSize,4),meta:{percent:100}});else for(this.push({data:r.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},u.prototype.flush=function(){for(var e,t,r,i,s=this.bytesWritten,a=0;a<this.dirRecords.length;a++)this.push({data:this.dirRecords[a],meta:{percent:100}});var l=this.bytesWritten-s,u=(e=this.dirRecords.length,t=this.zipComment,r=this.encodeFileName,i=o.transformTo("string",r(t)),c.CENTRAL_DIRECTORY_END+"\0\0\0\0"+n(e,2)+n(e,2)+n(l,4)+n(s,4)+n(i.length,2)+i);this.push({data:u,meta:{percent:100}})},u.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},u.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()}),e.on("error",function(e){t.error(e)}),this},u.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},u.prototype.error=function(e){var t=this._sources;if(!s.prototype.error.call(this,e))return!1;for(var r=0;r<t.length;r++)try{t[r].error(e)}catch(e){}return!0},u.prototype.lock=function(){s.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=u},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,r){"use strict";var n=e("../compressions"),i=e("./ZipFileWorker");r.generateWorker=function(e,t,r){var o=new i(t.streamFiles,r,t.platform,t.encodeFileName),s=0;try{e.forEach(function(e,r){s++;var i=function(e,t){var r=e||t,i=n[r];if(!i)throw Error(r+" is not a valid compression method !");return i}(r.options.compression,t.compression),a=r.options.compressionOptions||t.compressionOptions||{},l=r.dir,c=r.date;r._compressWorker(i,a).withStreamInfo("file",{name:e,dir:l,date:c,comment:r.comment||"",unixPermissions:r.unixPermissions,dosPermissions:r.dosPermissions}).pipe(o)}),o.entriesCount=s}catch(e){o.error(e)}return o}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,r){"use strict";function n(){if(!(this instanceof n))return new n;if(arguments.length)throw Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files={},this.comment=null,this.root="",this.clone=function(){var e=new n;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}(n.prototype=e("./object")).loadAsync=e("./load"),n.support=e("./support"),n.defaults=e("./defaults"),n.version="3.5.0",n.loadAsync=function(e,t){return(new n).loadAsync(e,t)},n.external=e("./external"),t.exports=n},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,r){"use strict";var n=e("./utils"),i=e("./external"),o=e("./utf8"),s=(n=e("./utils"),e("./zipEntries")),a=e("./stream/Crc32Probe"),l=e("./nodejsUtils");t.exports=function(e,t){var r=this;return t=n.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),l.isNode&&l.isStream(e)?i.Promise.reject(Error("JSZip can't accept a stream when loading a zip file.")):n.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then(function(e){var r=new s(t);return r.load(e),r}).then(function(e){var r=[i.Promise.resolve(e)],n=e.files;if(t.checkCRC32)for(var o=0;o<n.length;o++)r.push(function(e){return new i.Promise(function(t,r){var n=e.decompressed.getContentWorker().pipe(new a);n.on("error",function(e){r(e)}).on("end",function(){n.streamInfo.crc32!==e.decompressed.crc32?r(Error("Corrupted zip : CRC32 mismatch")):t()}).resume()})}(n[o]));return i.Promise.all(r)}).then(function(e){for(var n=e.shift(),i=n.files,o=0;o<i.length;o++){var s=i[o];r.file(s.fileNameStr,s.decompressed,{binary:!0,optimizedBinaryString:!0,date:s.date,dir:s.dir,comment:s.fileCommentStr.length?s.fileCommentStr:null,unixPermissions:s.unixPermissions,dosPermissions:s.dosPermissions,createFolders:t.createFolders})}return n.zipComment.length&&(r.comment=n.zipComment),r})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,r){"use strict";var n=e("../utils"),i=e("../stream/GenericWorker");function o(e,t){i.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}n.inherits(o,i),o.prototype._bindStream=function(e){var t=this;(this._stream=e).pause(),e.on("data",function(e){t.push({data:e,meta:{percent:0}})}).on("error",function(e){t.isPaused?this.generatedError=e:t.error(e)}).on("end",function(){t.isPaused?t._upstreamEnded=!0:t.end()})},o.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,r){"use strict";var n=e("readable-stream").Readable;function i(e,t,r){n.call(this,t),this._helper=e;var i=this;e.on("data",function(e,t){i.push(e)||i._helper.pause(),r&&r(t)}).on("error",function(e){i.emit("error",e)}).on("end",function(){i.push(null)})}e("../utils").inherits(i,n),i.prototype._read=function(){this._helper.resume()},t.exports=i},{"../utils":32,"readable-stream":16}],14:[function(e,r,n){"use strict";r.exports={isNode:void 0!==t,newBufferFrom:function(e,r){if(t.from&&t.from!==Uint8Array.from)return t.from(e,r);if("number"==typeof e)throw Error('The "data" argument must not be a number');return new t(e,r)},allocBuffer:function(e){if(t.alloc)return t.alloc(e);var r=new t(e);return r.fill(0),r},isBuffer:function(e){return t.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,t,r){"use strict";function n(e,t,r){var n,i=o.getTypeOf(t),a=o.extend(r||{},l);a.date=a.date||new Date,null!==a.compression&&(a.compression=a.compression.toUpperCase()),"string"==typeof a.unixPermissions&&(a.unixPermissions=parseInt(a.unixPermissions,8)),a.unixPermissions&&16384&a.unixPermissions&&(a.dir=!0),a.dosPermissions&&16&a.dosPermissions&&(a.dir=!0),a.dir&&(e=g(e)),a.createFolders&&(n=f(e))&&b.call(this,n,!0);var d="string"===i&&!1===a.binary&&!1===a.base64;r&&void 0!==r.binary||(a.binary=!d),(t instanceof c&&0===t.uncompressedSize||a.dir||!t||0===t.length)&&(a.base64=!1,a.binary=!0,t="",a.compression="STORE",i="string");var v=null;v=t instanceof c||t instanceof s?t:h.isNode&&h.isStream(t)?new p(e,t):o.prepareContent(e,t,a.binary,a.optimizedBinaryString,a.base64);var y=new u(e,v,a);this.files[e]=y}var i=e("./utf8"),o=e("./utils"),s=e("./stream/GenericWorker"),a=e("./stream/StreamHelper"),l=e("./defaults"),c=e("./compressedObject"),u=e("./zipObject"),d=e("./generate"),h=e("./nodejsUtils"),p=e("./nodejs/NodejsStreamInputAdapter"),f=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return 0<t?e.substring(0,t):""},g=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},b=function(e,t){return t=void 0!==t?t:l.createFolders,e=g(e),this.files[e]||n.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function v(e){return"[object RegExp]"===Object.prototype.toString.call(e)}t.exports={load:function(){throw Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,r,n;for(t in this.files)this.files.hasOwnProperty(t)&&(n=this.files[t],(r=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(r,n))},filter:function(e){var t=[];return this.forEach(function(r,n){e(r,n)&&t.push(n)}),t},file:function(e,t,r){if(1!=arguments.length)return e=this.root+e,n.call(this,e,t,r),this;if(v(e)){var i=e;return this.filter(function(e,t){return!t.dir&&i.test(e)})}var o=this.files[this.root+e];return o&&!o.dir?o:null},folder:function(e){if(!e)return this;if(v(e))return this.filter(function(t,r){return r.dir&&e.test(t)});var t=this.root+e,r=b.call(this,t),n=this.clone();return n.root=r.name,n},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var r=this.filter(function(t,r){return r.name.slice(0,e.length)===e}),n=0;n<r.length;n++)delete this.files[r[n].name];return this},generate:function(e){throw Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,r={};try{if((r=o.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:i.utf8encode})).type=r.type.toLowerCase(),r.compression=r.compression.toUpperCase(),"binarystring"===r.type&&(r.type="string"),!r.type)throw Error("No output type specified.");o.checkSupport(r.type),"darwin"!==r.platform&&"freebsd"!==r.platform&&"linux"!==r.platform&&"sunos"!==r.platform||(r.platform="UNIX"),"win32"===r.platform&&(r.platform="DOS");var n=r.comment||this.comment||"";t=d.generateWorker(this,r,n)}catch(e){(t=new s("error")).error(e)}return new a(t,r.type||"string",r.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}}},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,r){t.exports=e("stream")},{stream:void 0}],17:[function(e,t,r){"use strict";var n=e("./DataReader");function i(e){n.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}e("../utils").inherits(i,n),i.prototype.byteAt=function(e){return this.data[this.zero+e]},i.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),r=e.charCodeAt(1),n=e.charCodeAt(2),i=e.charCodeAt(3),o=this.length-4;0<=o;--o)if(this.data[o]===t&&this.data[o+1]===r&&this.data[o+2]===n&&this.data[o+3]===i)return o-this.zero;return -1},i.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1),n=e.charCodeAt(2),i=e.charCodeAt(3),o=this.readData(4);return t===o[0]&&r===o[1]&&n===o[2]&&i===o[3]},i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./DataReader":18}],18:[function(e,t,r){"use strict";var n=e("../utils");function i(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(e){},readInt:function(e){var t,r=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)r=(r<<8)+this.byteAt(t);return this.index+=e,r},readString:function(e){return n.transformTo("string",this.readData(e))},readData:function(e){},lastIndexOfSignature:function(e){},readAndCheckSignature:function(e){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=i},{"../utils":32}],19:[function(e,t,r){"use strict";var n=e("./Uint8ArrayReader");function i(e){n.call(this,e)}e("../utils").inherits(i,n),i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,r){"use strict";var n=e("./DataReader");function i(e){n.call(this,e)}e("../utils").inherits(i,n),i.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},i.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},i.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./DataReader":18}],21:[function(e,t,r){"use strict";var n=e("./ArrayReader");function i(e){n.call(this,e)}e("../utils").inherits(i,n),i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,r){"use strict";var n=e("../utils"),i=e("../support"),o=e("./ArrayReader"),s=e("./StringReader"),a=e("./NodeBufferReader"),l=e("./Uint8ArrayReader");t.exports=function(e){var t=n.getTypeOf(e);return n.checkSupport(t),"string"!==t||i.uint8array?"nodebuffer"===t?new a(e):i.uint8array?new l(n.transformTo("uint8array",e)):new o(n.transformTo("array",e)):new s(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,r){"use strict";r.LOCAL_FILE_HEADER="PK\x03\x04",r.CENTRAL_FILE_HEADER="PK\x01\x02",r.CENTRAL_DIRECTORY_END="PK\x05\x06",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",r.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",r.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,t,r){"use strict";var n=e("./GenericWorker"),i=e("../utils");function o(e){n.call(this,"ConvertWorker to "+e),this.destType=e}i.inherits(o,n),o.prototype.processChunk=function(e){this.push({data:i.transformTo(this.destType,e.data),meta:e.meta})},t.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,r){"use strict";var n=e("./GenericWorker"),i=e("../crc32");function o(){n.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(o,n),o.prototype.processChunk=function(e){this.streamInfo.crc32=i(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,r){"use strict";var n=e("../utils"),i=e("./GenericWorker");function o(e){i.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}n.inherits(o,i),o.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}i.prototype.processChunk.call(this,e)},t.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,r){"use strict";var n=e("../utils"),i=e("./GenericWorker");function o(e){i.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then(function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=n.getTypeOf(e),t.isPaused||t._tickAndRepeat()},function(e){t.error(e)})}n.inherits(o,i),o.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,n.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,r){"use strict";function n(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}n.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var r=0;r<this._listeners[e].length;r++)this._listeners[e][r].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.end()}),e.on("error",function(e){t.error(e)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var e=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},t.exports=n},{}],29:[function(e,r,n){"use strict";var i=e("../utils"),o=e("./ConvertWorker"),s=e("./GenericWorker"),a=e("../base64"),l=e("../support"),c=e("../external"),u=null;if(l.nodestream)try{u=e("../nodejs/NodejsStreamOutputAdapter")}catch(e){}function d(e,t,r){var n=t;switch(t){case"blob":case"arraybuffer":n="uint8array";break;case"base64":n="string"}try{this._internalType=n,this._outputType=t,this._mimeType=r,i.checkSupport(n),this._worker=e.pipe(new o(n)),e.lock()}catch(e){this._worker=new s("error"),this._worker.error(e)}}d.prototype={accumulate:function(e){var r;return r=this,new c.Promise(function(n,o){var s=[],l=r._internalType,c=r._outputType,u=r._mimeType;r.on("data",function(t,r){s.push(t),e&&e(r)}).on("error",function(e){s=[],o(e)}).on("end",function(){try{var e=function(e,t,r){switch(e){case"blob":return i.newBlob(i.transformTo("arraybuffer",t),r);case"base64":return a.encode(t);default:return i.transformTo(e,t)}}(c,function(e,r){var n,i=0,o=null,s=0;for(n=0;n<r.length;n++)s+=r[n].length;switch(e){case"string":return r.join("");case"array":return Array.prototype.concat.apply([],r);case"uint8array":for(o=new Uint8Array(s),n=0;n<r.length;n++)o.set(r[n],i),i+=r[n].length;return o;case"nodebuffer":return t.concat(r);default:throw Error("concat : unsupported type '"+e+"'")}}(l,s),u);n(e)}catch(e){o(e)}s=[]}).resume()})},on:function(e,t){var r=this;return"data"===e?this._worker.on(e,function(e){t.call(r,e.data,e.meta)}):this._worker.on(e,function(){i.delay(t,arguments,r)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(i.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw Error(this._outputType+" is not supported by this method");return new u(this,{objectMode:"nodebuffer"!==this._outputType},e)}},r.exports=d},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,r,n){"use strict";if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,n.nodebuffer=void 0!==t,n.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)n.blob=!1;else{var i=new ArrayBuffer(0);try{n.blob=0===new Blob([i],{type:"application/zip"}).size}catch(e){try{var o=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);o.append(i),n.blob=0===o.getBlob("application/zip").size}catch(e){n.blob=!1}}}try{n.nodestream=!!e("readable-stream").Readable}catch(e){n.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,r){"use strict";for(var n=e("./utils"),i=e("./support"),o=e("./nodejsUtils"),s=e("./stream/GenericWorker"),a=Array(256),l=0;l<256;l++)a[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;function c(){s.call(this,"utf-8 decode"),this.leftOver=null}function u(){s.call(this,"utf-8 encode")}a[254]=a[254]=1,r.utf8encode=function(e){return i.nodebuffer?o.newBufferFrom(e,"utf-8"):function(e){var t,r,n,o,s,a=e.length,l=0;for(o=0;o<a;o++)55296==(64512&(r=e.charCodeAt(o)))&&o+1<a&&56320==(64512&(n=e.charCodeAt(o+1)))&&(r=65536+(r-55296<<10)+(n-56320),o++),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=i.uint8array?new Uint8Array(l):Array(l),o=s=0;s<l;o++)55296==(64512&(r=e.charCodeAt(o)))&&o+1<a&&56320==(64512&(n=e.charCodeAt(o+1)))&&(r=65536+(r-55296<<10)+(n-56320),o++),r<128?t[s++]=r:(r<2048?t[s++]=192|r>>>6:(r<65536?t[s++]=224|r>>>12:(t[s++]=240|r>>>18,t[s++]=128|r>>>12&63),t[s++]=128|r>>>6&63),t[s++]=128|63&r);return t}(e)},r.utf8decode=function(e){return i.nodebuffer?n.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,r,i,o,s=e.length,l=Array(2*s);for(t=r=0;t<s;)if((i=e[t++])<128)l[r++]=i;else if(4<(o=a[i]))l[r++]=65533,t+=o-1;else{for(i&=2===o?31:3===o?15:7;1<o&&t<s;)i=i<<6|63&e[t++],o--;1<o?l[r++]=65533:i<65536?l[r++]=i:(i-=65536,l[r++]=55296|i>>10&1023,l[r++]=56320|1023&i)}return l.length!==r&&(l.subarray?l=l.subarray(0,r):l.length=r),n.applyFromCharCode(l)}(e=n.transformTo(i.uint8array?"uint8array":"array",e))},n.inherits(c,s),c.prototype.processChunk=function(e){var t=n.transformTo(i.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(i.uint8array){var o=t;(t=new Uint8Array(o.length+this.leftOver.length)).set(this.leftOver,0),t.set(o,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var s=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;0<=r&&128==(192&e[r]);)r--;return r<0||0===r?t:r+a[e[r]]>t?r:t}(t),l=t;s!==t.length&&(i.uint8array?(l=t.subarray(0,s),this.leftOver=t.subarray(s,t.length)):(l=t.slice(0,s),this.leftOver=t.slice(s,t.length))),this.push({data:r.utf8decode(l),meta:e.meta})},c.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:r.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},r.Utf8DecodeWorker=c,n.inherits(u,s),u.prototype.processChunk=function(e){this.push({data:r.utf8encode(e.data),meta:e.meta})},r.Utf8EncodeWorker=u},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,r){"use strict";var n=e("./support"),i=e("./base64"),o=e("./nodejsUtils"),s=e("set-immediate-shim"),a=e("./external");function l(e){return e}function c(e,t){for(var r=0;r<e.length;++r)t[r]=255&e.charCodeAt(r);return t}r.newBlob=function(e,t){r.checkSupport("blob");try{return new Blob([e],{type:t})}catch(r){try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return n.append(e),n.getBlob(t)}catch(e){throw Error("Bug : can't construct the Blob.")}}};var u={stringifyByChunk:function(e,t,r){var n=[],i=0,o=e.length;if(o<=r)return String.fromCharCode.apply(null,e);for(;i<o;)"array"===t||"nodebuffer"===t?n.push(String.fromCharCode.apply(null,e.slice(i,Math.min(i+r,o)))):n.push(String.fromCharCode.apply(null,e.subarray(i,Math.min(i+r,o)))),i+=r;return n.join("")},stringifyByChar:function(e){for(var t="",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},applyCanBeUsed:{uint8array:function(){try{return n.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return n.nodebuffer&&1===String.fromCharCode.apply(null,o.allocBuffer(1)).length}catch(e){return!1}}()}};function d(e){var t=65536,n=r.getTypeOf(e),i=!0;if("uint8array"===n?i=u.applyCanBeUsed.uint8array:"nodebuffer"===n&&(i=u.applyCanBeUsed.nodebuffer),i)for(;1<t;)try{return u.stringifyByChunk(e,n,t)}catch(e){t=Math.floor(t/2)}return u.stringifyByChar(e)}function h(e,t){for(var r=0;r<e.length;r++)t[r]=e[r];return t}r.applyFromCharCode=d;var p={};p.string={string:l,array:function(e){return c(e,Array(e.length))},arraybuffer:function(e){return p.string.uint8array(e).buffer},uint8array:function(e){return c(e,new Uint8Array(e.length))},nodebuffer:function(e){return c(e,o.allocBuffer(e.length))}},p.array={string:d,array:l,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return o.newBufferFrom(e)}},p.arraybuffer={string:function(e){return d(new Uint8Array(e))},array:function(e){return h(new Uint8Array(e),Array(e.byteLength))},arraybuffer:l,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return o.newBufferFrom(new Uint8Array(e))}},p.uint8array={string:d,array:function(e){return h(e,Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:l,nodebuffer:function(e){return o.newBufferFrom(e)}},p.nodebuffer={string:d,array:function(e){return h(e,Array(e.length))},arraybuffer:function(e){return p.nodebuffer.uint8array(e).buffer},uint8array:function(e){return h(e,new Uint8Array(e.length))},nodebuffer:l},r.transformTo=function(e,t){return(t=t||"",e)?(r.checkSupport(e),p[r.getTypeOf(t)][e](t)):t},r.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":n.nodebuffer&&o.isBuffer(e)?"nodebuffer":n.uint8array&&e instanceof Uint8Array?"uint8array":n.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},r.checkSupport=function(e){if(!n[e.toLowerCase()])throw Error(e+" is not supported by this platform")},r.MAX_VALUE_16BITS=65535,r.MAX_VALUE_32BITS=-1,r.pretty=function(e){var t,r,n="";for(r=0;r<(e||"").length;r++)n+="\\x"+((t=e.charCodeAt(r))<16?"0":"")+t.toString(16).toUpperCase();return n},r.delay=function(e,t,r){s(function(){e.apply(r||null,t||[])})},r.inherits=function(e,t){function r(){}r.prototype=t.prototype,e.prototype=new r},r.extend=function(){var e,t,r={};for(e=0;e<arguments.length;e++)for(t in arguments[e])arguments[e].hasOwnProperty(t)&&void 0===r[t]&&(r[t]=arguments[e][t]);return r},r.prepareContent=function(e,t,o,s,l){return a.Promise.resolve(t).then(function(e){return n.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new a.Promise(function(t,r){var n=new FileReader;n.onload=function(e){t(e.target.result)},n.onerror=function(e){r(e.target.error)},n.readAsArrayBuffer(e)}):e}).then(function(t){var u,d=r.getTypeOf(t);return d?("arraybuffer"===d?t=r.transformTo("uint8array",t):"string"===d&&(l?t=i.decode(t):o&&!0!==s&&(t=c(u=t,n.uint8array?new Uint8Array(u.length):Array(u.length)))),t):a.Promise.reject(Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,"set-immediate-shim":54}],33:[function(e,t,r){"use strict";var n=e("./reader/readerFor"),i=e("./utils"),o=e("./signature"),s=e("./zipEntry"),a=(e("./utf8"),e("./support"));function l(e){this.files=[],this.loadOptions=e}l.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw Error("Corrupted zip or bug: unexpected signature ("+i.pretty(t)+", expected "+i.pretty(e)+")")}},isSignature:function(e,t){var r=this.reader.index;this.reader.setIndex(e);var n=this.reader.readString(4)===t;return this.reader.setIndex(r),n},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=a.uint8array?"uint8array":"array",r=i.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(r)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,r,n=this.zip64EndOfCentralSize-44;0<n;)e=this.reader.readInt(2),t=this.reader.readInt(4),r=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:r}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(e=new s({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?Error("Corrupted zip: can't find end of central directory"):Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(e);var t=e;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var r=this.centralDirOffset+this.centralDirSize;this.zip64&&(r+=20,r+=12+this.zip64EndOfCentralSize);var n=t-r;if(0<n)this.isSignature(t,o.CENTRAL_FILE_HEADER)||(this.reader.zero=n);else if(n<0)throw Error("Corrupted zip: missing "+Math.abs(n)+" bytes.")},prepareReader:function(e){this.reader=n(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=l},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utf8":31,"./utils":32,"./zipEntry":34}],34:[function(e,t,r){"use strict";var n=e("./reader/readerFor"),i=e("./utils"),o=e("./compressedObject"),s=e("./crc32"),a=e("./utf8"),l=e("./compressions"),c=e("./support");function u(e,t){this.options=e,this.loadOptions=t}u.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(e){var t,r;if(e.skip(22),this.fileNameLength=e.readInt(2),r=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(r),-1===this.compressedSize||-1===this.uncompressedSize)throw Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in l)if(l.hasOwnProperty(t)&&l[t].magic===e)return l[t];return null}(this.compressionMethod)))throw Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+i.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==e&&(this.dosPermissions=63&this.externalFileAttributes),3==e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(e){if(this.extraFields[1]){var t=n(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=t.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=t.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=t.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=t.readInt(4))}},readExtraFields:function(e){var t,r,n,i=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<i;)t=e.readInt(2),r=e.readInt(2),n=e.readData(r),this.extraFields[t]={id:t,length:r,value:n};e.setIndex(i)},handleUTF8:function(){var e=c.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=a.utf8decode(this.fileName),this.fileCommentStr=a.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var r=i.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(r)}var n=this.findExtraFieldUnicodeComment();if(null!==n)this.fileCommentStr=n;else{var o=i.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(o)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=n(e.value);return 1!==t.readInt(1)||s(this.fileName)!==t.readInt(4)?null:a.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=n(e.value);return 1!==t.readInt(1)||s(this.fileComment)!==t.readInt(4)?null:a.utf8decode(t.readData(e.length-5))}return null}},t.exports=u},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,r){"use strict";function n(e,t,r){this.name=e,this.dir=r.dir,this.date=r.date,this.comment=r.comment,this.unixPermissions=r.unixPermissions,this.dosPermissions=r.dosPermissions,this._data=t,this._dataBinary=r.binary,this.options={compression:r.compression,compressionOptions:r.compressionOptions}}var i=e("./stream/StreamHelper"),o=e("./stream/DataWorker"),s=e("./utf8"),a=e("./compressedObject"),l=e("./stream/GenericWorker");n.prototype={internalStream:function(e){var t=null,r="string";try{if(!e)throw Error("No output type specified.");var n="string"===(r=e.toLowerCase())||"text"===r;"binarystring"!==r&&"text"!==r||(r="string"),t=this._decompressWorker();var o=!this._dataBinary;o&&!n&&(t=t.pipe(new s.Utf8EncodeWorker)),!o&&n&&(t=t.pipe(new s.Utf8DecodeWorker))}catch(e){(t=new l("error")).error(e)}return new i(t,r,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof a&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var r=this._decompressWorker();return this._dataBinary||(r=r.pipe(new s.Utf8EncodeWorker)),a.createWorkerFrom(r,e,t)},_decompressWorker:function(){return this._data instanceof a?this._data.getContentWorker():this._data instanceof l?this._data:new o(this._data)}};for(var c=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],u=function(){throw Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},d=0;d<c.length;d++)n.prototype[c[d]]=u;t.exports=n},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,n){(function(e){"use strict";var r,n,i=e.MutationObserver||e.WebKitMutationObserver;if(i){var o=0,s=new i(u),a=e.document.createTextNode("");s.observe(a,{characterData:!0}),r=function(){a.data=o=++o%2}}else if(e.setImmediate||void 0===e.MessageChannel)r="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){u(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(u,0)};else{var l=new e.MessageChannel;l.port1.onmessage=u,r=function(){l.port2.postMessage(0)}}var c=[];function u(){var e,t;n=!0;for(var r=c.length;r;){for(t=c,c=[],e=-1;++e<r;)t[e]();r=c.length}n=!1}t.exports=function(e){1!==c.push(e)||n||r()}}).call(this,void 0!==r?r:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(e,t,r){"use strict";var n=e("immediate");function i(){}var o={},s=["REJECTED"],a=["FULFILLED"],l=["PENDING"];function c(e){if("function"!=typeof e)throw TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==i&&p(this,e)}function u(e,t,r){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function d(e,t,r){n(function(){var n;try{n=t(r)}catch(t){return o.reject(e,t)}n===e?o.reject(e,TypeError("Cannot resolve promise with itself")):o.resolve(e,n)})}function h(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function p(e,t){var r=!1;function n(t){r||(r=!0,o.reject(e,t))}function i(t){r||(r=!0,o.resolve(e,t))}var s=f(function(){t(i,n)});"error"===s.status&&n(s.value)}function f(e,t){var r={};try{r.value=e(t),r.status="success"}catch(e){r.status="error",r.value=e}return r}(t.exports=c).prototype.finally=function(e){if("function"!=typeof e)return this;var t=this.constructor;return this.then(function(r){return t.resolve(e()).then(function(){return r})},function(r){return t.resolve(e()).then(function(){throw r})})},c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){if("function"!=typeof e&&this.state===a||"function"!=typeof t&&this.state===s)return this;var r=new this.constructor(i);return this.state!==l?d(r,this.state===a?e:t,this.outcome):this.queue.push(new u(r,e,t)),r},u.prototype.callFulfilled=function(e){o.resolve(this.promise,e)},u.prototype.otherCallFulfilled=function(e){d(this.promise,this.onFulfilled,e)},u.prototype.callRejected=function(e){o.reject(this.promise,e)},u.prototype.otherCallRejected=function(e){d(this.promise,this.onRejected,e)},o.resolve=function(e,t){var r=f(h,t);if("error"===r.status)return o.reject(e,r.value);var n=r.value;if(n)p(e,n);else{e.state=a,e.outcome=t;for(var i=-1,s=e.queue.length;++i<s;)e.queue[i].callFulfilled(t)}return e},o.reject=function(e,t){e.state=s,e.outcome=t;for(var r=-1,n=e.queue.length;++r<n;)e.queue[r].callRejected(t);return e},c.resolve=function(e){return e instanceof this?e:o.resolve(new this(i),e)},c.reject=function(e){var t=new this(i);return o.reject(t,e)},c.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(TypeError("must be an array"));var r=e.length,n=!1;if(!r)return this.resolve([]);for(var s=Array(r),a=0,l=-1,c=new this(i);++l<r;)!function(e,i){t.resolve(e).then(function(e){s[i]=e,++a!==r||n||(n=!0,o.resolve(c,s))},function(e){n||(n=!0,o.reject(c,e))})}(e[l],l);return c},c.race=function(e){if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(TypeError("must be an array"));var t,r=e.length,n=!1;if(!r)return this.resolve([]);for(var s=-1,a=new this(i);++s<r;)t=e[s],this.resolve(t).then(function(e){n||(n=!0,o.resolve(a,e))},function(e){n||(n=!0,o.reject(a,e))});return a}},{immediate:36}],38:[function(e,t,r){"use strict";var n={};(0,e("./lib/utils/common").assign)(n,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=n},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,r){"use strict";var n=e("./zlib/deflate"),i=e("./utils/common"),o=e("./utils/strings"),s=e("./zlib/messages"),a=e("./zlib/zstream"),l=Object.prototype.toString;function c(e){if(!(this instanceof c))return new c(e);this.options=i.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var t,r=this.options;r.raw&&0<r.windowBits?r.windowBits=-r.windowBits:r.gzip&&0<r.windowBits&&r.windowBits<16&&(r.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;var u=n.deflateInit2(this.strm,r.level,r.method,r.windowBits,r.memLevel,r.strategy);if(0!==u)throw Error(s[u]);if(r.header&&n.deflateSetHeader(this.strm,r.header),r.dictionary){if(t="string"==typeof r.dictionary?o.string2buf(r.dictionary):"[object ArrayBuffer]"===l.call(r.dictionary)?new Uint8Array(r.dictionary):r.dictionary,0!==(u=n.deflateSetDictionary(this.strm,t)))throw Error(s[u]);this._dict_set=!0}}function u(e,t){var r=new c(t);if(r.push(e,!0),r.err)throw r.msg||s[r.err];return r.result}c.prototype.push=function(e,t){var r,s,a=this.strm,c=this.options.chunkSize;if(this.ended)return!1;s=t===~~t?t:4*(!0===t),"string"==typeof e?a.input=o.string2buf(e):"[object ArrayBuffer]"===l.call(e)?a.input=new Uint8Array(e):a.input=e,a.next_in=0,a.avail_in=a.input.length;do{if(0===a.avail_out&&(a.output=new i.Buf8(c),a.next_out=0,a.avail_out=c),1!==(r=n.deflate(a,s))&&0!==r)return this.onEnd(r),this.ended=!0,!1;0!==a.avail_out&&(0!==a.avail_in||4!==s&&2!==s)||("string"===this.options.to?this.onData(o.buf2binstring(i.shrinkBuf(a.output,a.next_out))):this.onData(i.shrinkBuf(a.output,a.next_out)))}while((0<a.avail_in||0===a.avail_out)&&1!==r);return 4===s?(r=n.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,0===r):2!==s||(this.onEnd(0),a.avail_out=0,!0)},c.prototype.onData=function(e){this.chunks.push(e)},c.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},r.Deflate=c,r.deflate=u,r.deflateRaw=function(e,t){return(t=t||{}).raw=!0,u(e,t)},r.gzip=function(e,t){return(t=t||{}).gzip=!0,u(e,t)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,r){"use strict";var n=e("./zlib/inflate"),i=e("./utils/common"),o=e("./utils/strings"),s=e("./zlib/constants"),a=e("./zlib/messages"),l=e("./zlib/zstream"),c=e("./zlib/gzheader"),u=Object.prototype.toString;function d(e){if(!(this instanceof d))return new d(e);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var r=n.inflateInit2(this.strm,t.windowBits);if(r!==s.Z_OK)throw Error(a[r]);this.header=new c,n.inflateGetHeader(this.strm,this.header)}function h(e,t){var r=new d(t);if(r.push(e,!0),r.err)throw r.msg||a[r.err];return r.result}d.prototype.push=function(e,t){var r,a,l,c,d,h,p=this.strm,f=this.options.chunkSize,g=this.options.dictionary,b=!1;if(this.ended)return!1;a=t===~~t?t:!0===t?s.Z_FINISH:s.Z_NO_FLUSH,"string"==typeof e?p.input=o.binstring2buf(e):"[object ArrayBuffer]"===u.call(e)?p.input=new Uint8Array(e):p.input=e,p.next_in=0,p.avail_in=p.input.length;do{if(0===p.avail_out&&(p.output=new i.Buf8(f),p.next_out=0,p.avail_out=f),(r=n.inflate(p,s.Z_NO_FLUSH))===s.Z_NEED_DICT&&g&&(h="string"==typeof g?o.string2buf(g):"[object ArrayBuffer]"===u.call(g)?new Uint8Array(g):g,r=n.inflateSetDictionary(this.strm,h)),r===s.Z_BUF_ERROR&&!0===b&&(r=s.Z_OK,b=!1),r!==s.Z_STREAM_END&&r!==s.Z_OK)return this.onEnd(r),this.ended=!0,!1;p.next_out&&(0!==p.avail_out&&r!==s.Z_STREAM_END&&(0!==p.avail_in||a!==s.Z_FINISH&&a!==s.Z_SYNC_FLUSH)||("string"===this.options.to?(l=o.utf8border(p.output,p.next_out),c=p.next_out-l,d=o.buf2string(p.output,l),p.next_out=c,p.avail_out=f-c,c&&i.arraySet(p.output,p.output,l,c,0),this.onData(d)):this.onData(i.shrinkBuf(p.output,p.next_out)))),0===p.avail_in&&0===p.avail_out&&(b=!0)}while((0<p.avail_in||0===p.avail_out)&&r!==s.Z_STREAM_END);return r===s.Z_STREAM_END&&(a=s.Z_FINISH),a===s.Z_FINISH?(r=n.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===s.Z_OK):a!==s.Z_SYNC_FLUSH||(this.onEnd(s.Z_OK),p.avail_out=0,!0)},d.prototype.onData=function(e){this.chunks.push(e)},d.prototype.onEnd=function(e){e===s.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},r.Inflate=d,r.inflate=h,r.inflateRaw=function(e,t){return(t=t||{}).raw=!0,h(e,t)},r.ungzip=h},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,r){"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;r.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if("object"!=typeof r)throw TypeError(r+"must be non-object");for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])}}return e},r.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var i={arraySet:function(e,t,r,n,i){if(t.subarray&&e.subarray)e.set(t.subarray(r,r+n),i);else for(var o=0;o<n;o++)e[i+o]=t[r+o]},flattenChunks:function(e){var t,r,n,i,o,s;for(t=n=0,r=e.length;t<r;t++)n+=e[t].length;for(s=new Uint8Array(n),t=i=0,r=e.length;t<r;t++)o=e[t],s.set(o,i),i+=o.length;return s}},o={arraySet:function(e,t,r,n,i){for(var o=0;o<n;o++)e[i+o]=t[r+o]},flattenChunks:function(e){return[].concat.apply([],e)}};r.setTyped=function(e){e?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,i)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,o))},r.setTyped(n)},{}],42:[function(e,t,r){"use strict";var n=e("./common"),i=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(e){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){o=!1}for(var s=new n.Buf8(256),a=0;a<256;a++)s[a]=252<=a?6:248<=a?5:240<=a?4:224<=a?3:192<=a?2:1;function l(e,t){if(t<65537&&(e.subarray&&o||!e.subarray&&i))return String.fromCharCode.apply(null,n.shrinkBuf(e,t));for(var r="",s=0;s<t;s++)r+=String.fromCharCode(e[s]);return r}s[254]=s[254]=1,r.string2buf=function(e){var t,r,i,o,s,a=e.length,l=0;for(o=0;o<a;o++)55296==(64512&(r=e.charCodeAt(o)))&&o+1<a&&56320==(64512&(i=e.charCodeAt(o+1)))&&(r=65536+(r-55296<<10)+(i-56320),o++),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=new n.Buf8(l),o=s=0;s<l;o++)55296==(64512&(r=e.charCodeAt(o)))&&o+1<a&&56320==(64512&(i=e.charCodeAt(o+1)))&&(r=65536+(r-55296<<10)+(i-56320),o++),r<128?t[s++]=r:(r<2048?t[s++]=192|r>>>6:(r<65536?t[s++]=224|r>>>12:(t[s++]=240|r>>>18,t[s++]=128|r>>>12&63),t[s++]=128|r>>>6&63),t[s++]=128|63&r);return t},r.buf2binstring=function(e){return l(e,e.length)},r.binstring2buf=function(e){for(var t=new n.Buf8(e.length),r=0,i=t.length;r<i;r++)t[r]=e.charCodeAt(r);return t},r.buf2string=function(e,t){var r,n,i,o,a=t||e.length,c=Array(2*a);for(r=n=0;r<a;)if((i=e[r++])<128)c[n++]=i;else if(4<(o=s[i]))c[n++]=65533,r+=o-1;else{for(i&=2===o?31:3===o?15:7;1<o&&r<a;)i=i<<6|63&e[r++],o--;1<o?c[n++]=65533:i<65536?c[n++]=i:(i-=65536,c[n++]=55296|i>>10&1023,c[n++]=56320|1023&i)}return l(c,n)},r.utf8border=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;0<=r&&128==(192&e[r]);)r--;return r<0||0===r?t:r+s[e[r]]>t?r:t}},{"./common":41}],43:[function(e,t,r){"use strict";t.exports=function(e,t,r,n){for(var i=65535&e,o=e>>>16&65535,s=0;0!==r;){for(r-=s=2e3<r?2e3:r;o=o+(i=i+t[n++]|0)|0,--s;);i%=65521,o%=65521}return i|o<<16}},{}],44:[function(e,t,r){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,r){"use strict";var n=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?0xedb88320^e>>>1:e>>>1;t[r]=e}return t}();t.exports=function(e,t,r,i){var o=i+r;e^=-1;for(var s=i;s<o;s++)e=e>>>8^n[255&(e^t[s])];return -1^e}},{}],46:[function(e,t,r){"use strict";var n,i=e("../utils/common"),o=e("./trees"),s=e("./adler32"),a=e("./crc32"),l=e("./messages");function c(e,t){return e.msg=l[t],t}function u(e){return(e<<1)-9*(4<e)}function d(e){for(var t=e.length;0<=--t;)e[t]=0}function h(e){var t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(i.arraySet(e.output,t.pending_buf,t.pending_out,r,e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))}function p(e,t){o._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,h(e.strm)}function f(e,t){e.pending_buf[e.pending++]=t}function g(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function b(e,t){var r,n,i=e.max_chain_length,o=e.strstart,s=e.prev_length,a=e.nice_match,l=e.strstart>e.w_size-262?e.strstart-(e.w_size-262):0,c=e.window,u=e.w_mask,d=e.prev,h=e.strstart+258,p=c[o+s-1],f=c[o+s];e.prev_length>=e.good_match&&(i>>=2),a>e.lookahead&&(a=e.lookahead);do if(c[(r=t)+s]===f&&c[r+s-1]===p&&c[r]===c[o]&&c[++r]===c[o+1]){o+=2,r++;do;while(c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&o<h);if(n=258-(h-o),o=h-258,s<n){if(e.match_start=t,a<=(s=n))break;p=c[o+s-1],f=c[o+s]}}while((t=d[t&u])>l&&0!=--i);return s<=e.lookahead?s:e.lookahead}function v(e){var t,r,n,o,l,c,u,d,h,p,f=e.w_size;do{if(o=e.window_size-e.lookahead-e.strstart,e.strstart>=f+(f-262)){for(i.arraySet(e.window,e.window,f,f,0),e.match_start-=f,e.strstart-=f,e.block_start-=f,t=r=e.hash_size;n=e.head[--t],e.head[t]=f<=n?n-f:0,--r;);for(t=r=f;n=e.prev[--t],e.prev[t]=f<=n?n-f:0,--r;);o+=f}if(0===e.strm.avail_in)break;if(c=e.strm,u=e.window,d=e.strstart+e.lookahead,p=void 0,(h=o)<(p=c.avail_in)&&(p=h),r=0===p?0:(c.avail_in-=p,i.arraySet(u,c.input,c.next_in,p,d),1===c.state.wrap?c.adler=s(c.adler,u,p,d):2===c.state.wrap&&(c.adler=a(c.adler,u,p,d)),c.next_in+=p,c.total_in+=p,p),e.lookahead+=r,e.lookahead+e.insert>=3)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+3-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<262&&0!==e.strm.avail_in)}function y(e,t){for(var r,n;;){if(e.lookahead<262){if(v(e),e.lookahead<262&&0===t)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-262&&(e.match_length=b(e,r)),e.match_length>=3)if(n=o._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else n=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(p(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(p(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(p(e,!1),0===e.strm.avail_out)?1:2}function w(e,t){for(var r,n,i;;){if(e.lookahead<262){if(v(e),e.lookahead<262&&0===t)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-262&&(e.match_length=b(e,r),e.match_length<=5&&(1===e.strategy||3===e.match_length&&4096<e.strstart-e.match_start)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){for(i=e.strstart+e.lookahead-3,n=o._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=2,e.strstart++,n&&(p(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((n=o._tr_tally(e,0,e.window[e.strstart-1]))&&p(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=o._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(p(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(p(e,!1),0===e.strm.avail_out)?1:2}function x(e,t,r,n,i){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=i}function E(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(1146),this.dyn_dtree=new i.Buf16(122),this.bl_tree=new i.Buf16(78),d(this.dyn_ltree),d(this.dyn_dtree),d(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(16),this.heap=new i.Buf16(573),d(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(573),d(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function _(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:113,e.adler=+(2!==t.wrap),t.last_flush=0,o._tr_init(t),0):c(e,-2)}function T(e){var t,r=_(e);return 0===r&&((t=e.state).window_size=2*t.w_size,d(t.head),t.max_lazy_match=n[t.level].max_lazy,t.good_match=n[t.level].good_length,t.nice_match=n[t.level].nice_length,t.max_chain_length=n[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),r}function O(e,t,r,n,o,s){if(!e)return -2;var a=1;if(-1===t&&(t=6),n<0?(a=0,n=-n):15<n&&(a=2,n-=16),o<1||9<o||8!==r||n<8||15<n||t<0||9<t||s<0||4<s)return c(e,-2);8===n&&(n=9);var l=new E;return(e.state=l).strm=e,l.wrap=a,l.gzhead=null,l.w_bits=n,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=o+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+3-1)/3),l.window=new i.Buf8(2*l.w_size),l.head=new i.Buf16(l.hash_size),l.prev=new i.Buf16(l.w_size),l.lit_bufsize=1<<o+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new i.Buf8(l.pending_buf_size),l.d_buf=+l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=s,l.method=r,T(e)}n=[new x(0,0,0,0,function(e,t){var r=65535;for(65535>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(v(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var n=e.block_start+r;if((0===e.strstart||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,p(e,!1),0===e.strm.avail_out)||e.strstart-e.block_start>=e.w_size-262&&(p(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(p(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(p(e,!1),e.strm.avail_out),1)}),new x(4,4,8,4,y),new x(4,5,16,8,y),new x(4,6,32,32,y),new x(4,4,16,16,w),new x(8,16,32,32,w),new x(8,16,128,128,w),new x(8,32,128,256,w),new x(32,128,258,1024,w),new x(32,258,258,4096,w)],r.deflateInit=function(e,t){return O(e,t,8,15,8,0)},r.deflateInit2=O,r.deflateReset=T,r.deflateResetKeep=_,r.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?-2:(e.state.gzhead=t,0):-2},r.deflate=function(e,t){var r,i,s,l;if(!e||!e.state||5<t||t<0)return e?c(e,-2):-2;if(i=e.state,!e.output||!e.input&&0!==e.avail_in||666===i.status&&4!==t)return c(e,0===e.avail_out?-5:-2);if(i.strm=e,r=i.last_flush,i.last_flush=t,42===i.status)if(2===i.wrap)e.adler=0,f(i,31),f(i,139),f(i,8),i.gzhead?(f(i,+!!i.gzhead.text+2*!!i.gzhead.hcrc+4*!!i.gzhead.extra+8*!!i.gzhead.name+16*!!i.gzhead.comment),f(i,255&i.gzhead.time),f(i,i.gzhead.time>>8&255),f(i,i.gzhead.time>>16&255),f(i,i.gzhead.time>>24&255),f(i,9===i.level?2:4*(2<=i.strategy||i.level<2)),f(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(f(i,255&i.gzhead.extra.length),f(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=a(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(f(i,0),f(i,0),f(i,0),f(i,0),f(i,0),f(i,9===i.level?2:4*(2<=i.strategy||i.level<2)),f(i,3),i.status=113);else{var b=8+(i.w_bits-8<<4)<<8;b|=(2<=i.strategy||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(b|=32),b+=31-b%31,i.status=113,g(i,b),0!==i.strstart&&(g(i,e.adler>>>16),g(i,65535&e.adler)),e.adler=1}if(69===i.status)if(i.gzhead.extra){for(s=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>s&&(e.adler=a(e.adler,i.pending_buf,i.pending-s,s)),h(e),s=i.pending,i.pending!==i.pending_buf_size));)f(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>s&&(e.adler=a(e.adler,i.pending_buf,i.pending-s,s)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){s=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>s&&(e.adler=a(e.adler,i.pending_buf,i.pending-s,s)),h(e),s=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,f(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>s&&(e.adler=a(e.adler,i.pending_buf,i.pending-s,s)),0===l&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){s=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>s&&(e.adler=a(e.adler,i.pending_buf,i.pending-s,s)),h(e),s=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,f(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>s&&(e.adler=a(e.adler,i.pending_buf,i.pending-s,s)),0===l&&(i.status=103)}else i.status=103;if(103===i.status&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&h(e),i.pending+2<=i.pending_buf_size&&(f(i,255&e.adler),f(i,e.adler>>8&255),e.adler=0,i.status=113)):i.status=113),0!==i.pending){if(h(e),0===e.avail_out)return i.last_flush=-1,0}else if(0===e.avail_in&&u(t)<=u(r)&&4!==t)return c(e,-5);if(666===i.status&&0!==e.avail_in)return c(e,-5);if(0!==e.avail_in||0!==i.lookahead||0!==t&&666!==i.status){var y=2===i.strategy?function(e,t){for(var r;;){if(0===e.lookahead&&(v(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,r=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(p(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(p(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(p(e,!1),0===e.strm.avail_out)?1:2}(i,t):3===i.strategy?function(e,t){for(var r,n,i,s,a=e.window;;){if(e.lookahead<=258){if(v(e),e.lookahead<=258&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&0<e.strstart&&(n=a[i=e.strstart-1])===a[++i]&&n===a[++i]&&n===a[++i]){s=e.strstart+258;do;while(n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&i<s);e.match_length=258-(s-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(r=o._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(p(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(p(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(p(e,!1),0===e.strm.avail_out)?1:2}(i,t):n[i.level].func(i,t);if(3!==y&&4!==y||(i.status=666),1===y||3===y)return 0===e.avail_out&&(i.last_flush=-1),0;if(2===y&&(1===t?o._tr_align(i):5!==t&&(o._tr_stored_block(i,0,0,!1),3===t&&(d(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),h(e),0===e.avail_out))return i.last_flush=-1,0}return 4!==t?0:i.wrap<=0?1:(2===i.wrap?(f(i,255&e.adler),f(i,e.adler>>8&255),f(i,e.adler>>16&255),f(i,e.adler>>24&255),f(i,255&e.total_in),f(i,e.total_in>>8&255),f(i,e.total_in>>16&255),f(i,e.total_in>>24&255)):(g(i,e.adler>>>16),g(i,65535&e.adler)),h(e),0<i.wrap&&(i.wrap=-i.wrap),+(0===i.pending))},r.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&103!==t&&113!==t&&666!==t?c(e,-2):(e.state=null,113===t?c(e,-3):0):-2},r.deflateSetDictionary=function(e,t){var r,n,o,a,l,c,u,h,p=t.length;if(!e||!e.state||2===(a=(r=e.state).wrap)||1===a&&42!==r.status||r.lookahead)return -2;for(1===a&&(e.adler=s(e.adler,t,p,0)),r.wrap=0,p>=r.w_size&&(0===a&&(d(r.head),r.strstart=0,r.block_start=0,r.insert=0),h=new i.Buf8(r.w_size),i.arraySet(h,t,p-r.w_size,r.w_size,0),t=h,p=r.w_size),l=e.avail_in,c=e.next_in,u=e.input,e.avail_in=p,e.next_in=0,e.input=t,v(r);r.lookahead>=3;){for(n=r.strstart,o=r.lookahead-2;r.ins_h=(r.ins_h<<r.hash_shift^r.window[n+3-1])&r.hash_mask,r.prev[n&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=n,n++,--o;);r.strstart=n,r.lookahead=2,v(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,e.next_in=c,e.input=u,e.avail_in=l,r.wrap=a,0},r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,r){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,r){"use strict";t.exports=function(e,t){var r,n,i,o,s,a,l,c,u,d,h,p,f,g,b,v,y,w,x,E,_,T,O,A,S;r=e.state,n=e.next_in,A=e.input,i=n+(e.avail_in-5),o=e.next_out,S=e.output,s=o-(t-e.avail_out),a=o+(e.avail_out-257),l=r.dmax,c=r.wsize,u=r.whave,d=r.wnext,h=r.window,p=r.hold,f=r.bits,g=r.lencode,b=r.distcode,v=(1<<r.lenbits)-1,y=(1<<r.distbits)-1;e:do for(f<15&&(p+=A[n++]<<f,f+=8,p+=A[n++]<<f,f+=8),w=g[p&v];;){if(p>>>=x=w>>>24,f-=x,0==(x=w>>>16&255))S[o++]=65535&w;else{if(!(16&x)){if(0==(64&x)){w=g[(65535&w)+(p&(1<<x)-1)];continue}if(32&x){r.mode=12;break e}e.msg="invalid literal/length code",r.mode=30;break e}for(E=65535&w,(x&=15)&&(f<x&&(p+=A[n++]<<f,f+=8),E+=p&(1<<x)-1,p>>>=x,f-=x),f<15&&(p+=A[n++]<<f,f+=8,p+=A[n++]<<f,f+=8),w=b[p&y];;){if(p>>>=x=w>>>24,f-=x,!(16&(x=w>>>16&255))){if(0==(64&x)){w=b[(65535&w)+(p&(1<<x)-1)];continue}e.msg="invalid distance code",r.mode=30;break e}if(_=65535&w,f<(x&=15)&&(p+=A[n++]<<f,(f+=8)<x&&(p+=A[n++]<<f,f+=8)),l<(_+=p&(1<<x)-1)){e.msg="invalid distance too far back",r.mode=30;break e}if(p>>>=x,f-=x,(x=o-s)<_){if(u<(x=_-x)&&r.sane){e.msg="invalid distance too far back",r.mode=30;break e}if(O=h,(T=0)===d){if(T+=c-x,x<E){for(E-=x;S[o++]=h[T++],--x;);T=o-_,O=S}}else if(d<x){if(T+=c+d-x,(x-=d)<E){for(E-=x;S[o++]=h[T++],--x;);if(T=0,d<E){for(E-=x=d;S[o++]=h[T++],--x;);T=o-_,O=S}}}else if(T+=d-x,x<E){for(E-=x;S[o++]=h[T++],--x;);T=o-_,O=S}for(;2<E;)S[o++]=O[T++],S[o++]=O[T++],S[o++]=O[T++],E-=3;E&&(S[o++]=O[T++],1<E&&(S[o++]=O[T++]))}else{for(T=o-_;S[o++]=S[T++],S[o++]=S[T++],S[o++]=S[T++],2<(E-=3););E&&(S[o++]=S[T++],1<E&&(S[o++]=S[T++]))}break}}break}while(n<i&&o<a);n-=E=f>>3,p&=(1<<(f-=E<<3))-1,e.next_in=n,e.next_out=o,e.avail_in=n<i?i-n+5:5-(n-i),e.avail_out=o<a?a-o+257:257-(o-a),r.hold=p,r.bits=f}},{}],49:[function(e,t,r){"use strict";var n=e("../utils/common"),i=e("./adler32"),o=e("./crc32"),s=e("./inffast"),a=e("./inftrees");function l(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function c(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function u(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new n.Buf32(852),t.distcode=t.distdyn=new n.Buf32(592),t.sane=1,t.back=-1,0):-2}function d(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,u(e)):-2}function h(e,t){var r,n;return e&&e.state?(n=e.state,t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?-2:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,d(e))):-2}function p(e,t){var r;return e?((e.state=new c).window=null,0!==(r=h(e,t))&&(e.state=null),r):-2}var f,g,b=!0;function v(e,t,r,i){var o,s=e.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new n.Buf8(s.wsize)),i>=s.wsize?(n.arraySet(s.window,t,r-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):(i<(o=s.wsize-s.wnext)&&(o=i),n.arraySet(s.window,t,r-i,o,s.wnext),(i-=o)?(n.arraySet(s.window,t,r-i,i,0),s.wnext=i,s.whave=s.wsize):(s.wnext+=o,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=o))),0}r.inflateReset=d,r.inflateReset2=h,r.inflateResetKeep=u,r.inflateInit=function(e){return p(e,15)},r.inflateInit2=p,r.inflate=function(e,t){var r,c,u,d,h,p,y,w,x,E,_,T,O,A,S,k,N,C,I,R,P,L,D,j,B=0,F=new n.Buf8(4),U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return -2;12===(r=e.state).mode&&(r.mode=13),h=e.next_out,u=e.output,y=e.avail_out,d=e.next_in,c=e.input,p=e.avail_in,w=r.hold,x=r.bits,E=p,_=y,L=0;e:for(;;)switch(r.mode){case 1:if(0===r.wrap){r.mode=13;break}for(;x<16;){if(0===p)break e;p--,w+=c[d++]<<x,x+=8}if(2&r.wrap&&35615===w){F[r.check=0]=255&w,F[1]=w>>>8&255,r.check=o(r.check,F,2,0),x=w=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&w)<<8)+(w>>8))%31){e.msg="incorrect header check",r.mode=30;break}if(8!=(15&w)){e.msg="unknown compression method",r.mode=30;break}if(x-=4,P=8+(15&(w>>>=4)),0===r.wbits)r.wbits=P;else if(P>r.wbits){e.msg="invalid window size",r.mode=30;break}r.dmax=1<<P,e.adler=r.check=1,r.mode=512&w?10:12,x=w=0;break;case 2:for(;x<16;){if(0===p)break e;p--,w+=c[d++]<<x,x+=8}if(r.flags=w,8!=(255&r.flags)){e.msg="unknown compression method",r.mode=30;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=30;break}r.head&&(r.head.text=w>>8&1),512&r.flags&&(F[0]=255&w,F[1]=w>>>8&255,r.check=o(r.check,F,2,0)),x=w=0,r.mode=3;case 3:for(;x<32;){if(0===p)break e;p--,w+=c[d++]<<x,x+=8}r.head&&(r.head.time=w),512&r.flags&&(F[0]=255&w,F[1]=w>>>8&255,F[2]=w>>>16&255,F[3]=w>>>24&255,r.check=o(r.check,F,4,0)),x=w=0,r.mode=4;case 4:for(;x<16;){if(0===p)break e;p--,w+=c[d++]<<x,x+=8}r.head&&(r.head.xflags=255&w,r.head.os=w>>8),512&r.flags&&(F[0]=255&w,F[1]=w>>>8&255,r.check=o(r.check,F,2,0)),x=w=0,r.mode=5;case 5:if(1024&r.flags){for(;x<16;){if(0===p)break e;p--,w+=c[d++]<<x,x+=8}r.length=w,r.head&&(r.head.extra_len=w),512&r.flags&&(F[0]=255&w,F[1]=w>>>8&255,r.check=o(r.check,F,2,0)),x=w=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&(p<(T=r.length)&&(T=p),T&&(r.head&&(P=r.head.extra_len-r.length,r.head.extra||(r.head.extra=Array(r.head.extra_len)),n.arraySet(r.head.extra,c,d,T,P)),512&r.flags&&(r.check=o(r.check,c,T,d)),p-=T,d+=T,r.length-=T),r.length))break e;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===p)break e;for(T=0;P=c[d+T++],r.head&&P&&r.length<65536&&(r.head.name+=String.fromCharCode(P)),P&&T<p;);if(512&r.flags&&(r.check=o(r.check,c,T,d)),p-=T,d+=T,P)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===p)break e;for(T=0;P=c[d+T++],r.head&&P&&r.length<65536&&(r.head.comment+=String.fromCharCode(P)),P&&T<p;);if(512&r.flags&&(r.check=o(r.check,c,T,d)),p-=T,d+=T,P)break e}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;x<16;){if(0===p)break e;p--,w+=c[d++]<<x,x+=8}if(w!==(65535&r.check)){e.msg="header crc mismatch",r.mode=30;break}x=w=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=12;break;case 10:for(;x<32;){if(0===p)break e;p--,w+=c[d++]<<x,x+=8}e.adler=r.check=l(w),x=w=0,r.mode=11;case 11:if(0===r.havedict)return e.next_out=h,e.avail_out=y,e.next_in=d,e.avail_in=p,r.hold=w,r.bits=x,2;e.adler=r.check=1,r.mode=12;case 12:if(5===t||6===t)break e;case 13:if(r.last){w>>>=7&x,x-=7&x,r.mode=27;break}for(;x<3;){if(0===p)break e;p--,w+=c[d++]<<x,x+=8}switch(r.last=1&w,x-=1,3&(w>>>=1)){case 0:r.mode=14;break;case 1:if(function(e){if(b){var t;for(f=new n.Buf32(512),g=new n.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(a(1,e.lens,0,288,f,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;a(2,e.lens,0,32,g,0,e.work,{bits:5}),b=!1}e.lencode=f,e.lenbits=9,e.distcode=g,e.distbits=5}(r),r.mode=20,6!==t)break;w>>>=2,x-=2;break e;case 2:r.mode=17;break;case 3:e.msg="invalid block type",r.mode=30}w>>>=2,x-=2;break;case 14:for(w>>>=7&x,x-=7&x;x<32;){if(0===p)break e;p--,w+=c[d++]<<x,x+=8}if((65535&w)!=(w>>>16^65535)){e.msg="invalid stored block lengths",r.mode=30;break}if(r.length=65535&w,x=w=0,r.mode=15,6===t)break e;case 15:r.mode=16;case 16:if(T=r.length){if(p<T&&(T=p),y<T&&(T=y),0===T)break e;n.arraySet(u,c,d,T,h),p-=T,d+=T,y-=T,h+=T,r.length-=T;break}r.mode=12;break;case 17:for(;x<14;){if(0===p)break e;p--,w+=c[d++]<<x,x+=8}if(r.nlen=257+(31&w),x-=5,r.ndist=1+(31&(w>>>=5)),x-=5,r.ncode=4+(15&(w>>>=5)),w>>>=4,x-=4,286<r.nlen||30<r.ndist){e.msg="too many length or distance symbols",r.mode=30;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;x<3;){if(0===p)break e;p--,w+=c[d++]<<x,x+=8}r.lens[U[r.have++]]=7&w,w>>>=3,x-=3}for(;r.have<19;)r.lens[U[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,D={bits:r.lenbits},L=a(0,r.lens,0,19,r.lencode,0,r.work,D),r.lenbits=D.bits,L){e.msg="invalid code lengths set",r.mode=30;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;k=(B=r.lencode[w&(1<<r.lenbits)-1])>>>16&255,N=65535&B,!((S=B>>>24)<=x);){if(0===p)break e;p--,w+=c[d++]<<x,x+=8}if(N<16)w>>>=S,x-=S,r.lens[r.have++]=N;else{if(16===N){for(j=S+2;x<j;){if(0===p)break e;p--,w+=c[d++]<<x,x+=8}if(w>>>=S,x-=S,0===r.have){e.msg="invalid bit length repeat",r.mode=30;break}P=r.lens[r.have-1],T=3+(3&w),w>>>=2,x-=2}else if(17===N){for(j=S+3;x<j;){if(0===p)break e;p--,w+=c[d++]<<x,x+=8}x-=S,P=0,T=3+(7&(w>>>=S)),w>>>=3,x-=3}else{for(j=S+7;x<j;){if(0===p)break e;p--,w+=c[d++]<<x,x+=8}x-=S,P=0,T=11+(127&(w>>>=S)),w>>>=7,x-=7}if(r.have+T>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=30;break}for(;T--;)r.lens[r.have++]=P}}if(30===r.mode)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=30;break}if(r.lenbits=9,D={bits:r.lenbits},L=a(1,r.lens,0,r.nlen,r.lencode,0,r.work,D),r.lenbits=D.bits,L){e.msg="invalid literal/lengths set",r.mode=30;break}if(r.distbits=6,r.distcode=r.distdyn,D={bits:r.distbits},L=a(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,D),r.distbits=D.bits,L){e.msg="invalid distances set",r.mode=30;break}if(r.mode=20,6===t)break e;case 20:r.mode=21;case 21:if(6<=p&&258<=y){e.next_out=h,e.avail_out=y,e.next_in=d,e.avail_in=p,r.hold=w,r.bits=x,s(e,_),h=e.next_out,u=e.output,y=e.avail_out,d=e.next_in,c=e.input,p=e.avail_in,w=r.hold,x=r.bits,12===r.mode&&(r.back=-1);break}for(r.back=0;k=(B=r.lencode[w&(1<<r.lenbits)-1])>>>16&255,N=65535&B,!((S=B>>>24)<=x);){if(0===p)break e;p--,w+=c[d++]<<x,x+=8}if(k&&0==(240&k)){for(C=S,I=k,R=N;k=(B=r.lencode[R+((w&(1<<C+I)-1)>>C)])>>>16&255,N=65535&B,!(C+(S=B>>>24)<=x);){if(0===p)break e;p--,w+=c[d++]<<x,x+=8}w>>>=C,x-=C,r.back+=C}if(w>>>=S,x-=S,r.back+=S,r.length=N,0===k){r.mode=26;break}if(32&k){r.back=-1,r.mode=12;break}if(64&k){e.msg="invalid literal/length code",r.mode=30;break}r.extra=15&k,r.mode=22;case 22:if(r.extra){for(j=r.extra;x<j;){if(0===p)break e;p--,w+=c[d++]<<x,x+=8}r.length+=w&(1<<r.extra)-1,w>>>=r.extra,x-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;k=(B=r.distcode[w&(1<<r.distbits)-1])>>>16&255,N=65535&B,!((S=B>>>24)<=x);){if(0===p)break e;p--,w+=c[d++]<<x,x+=8}if(0==(240&k)){for(C=S,I=k,R=N;k=(B=r.distcode[R+((w&(1<<C+I)-1)>>C)])>>>16&255,N=65535&B,!(C+(S=B>>>24)<=x);){if(0===p)break e;p--,w+=c[d++]<<x,x+=8}w>>>=C,x-=C,r.back+=C}if(w>>>=S,x-=S,r.back+=S,64&k){e.msg="invalid distance code",r.mode=30;break}r.offset=N,r.extra=15&k,r.mode=24;case 24:if(r.extra){for(j=r.extra;x<j;){if(0===p)break e;p--,w+=c[d++]<<x,x+=8}r.offset+=w&(1<<r.extra)-1,w>>>=r.extra,x-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=30;break}r.mode=25;case 25:if(0===y)break e;if(T=_-y,r.offset>T){if((T=r.offset-T)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=30;break}O=T>r.wnext?(T-=r.wnext,r.wsize-T):r.wnext-T,T>r.length&&(T=r.length),A=r.window}else A=u,O=h-r.offset,T=r.length;for(y<T&&(T=y),y-=T,r.length-=T;u[h++]=A[O++],--T;);0===r.length&&(r.mode=21);break;case 26:if(0===y)break e;u[h++]=r.length,y--,r.mode=21;break;case 27:if(r.wrap){for(;x<32;){if(0===p)break e;p--,w|=c[d++]<<x,x+=8}if(_-=y,e.total_out+=_,r.total+=_,_&&(e.adler=r.check=r.flags?o(r.check,u,_,h-_):i(r.check,u,_,h-_)),_=y,(r.flags?w:l(w))!==r.check){e.msg="incorrect data check",r.mode=30;break}x=w=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;x<32;){if(0===p)break e;p--,w+=c[d++]<<x,x+=8}if(w!==(0|r.total)){e.msg="incorrect length check",r.mode=30;break}x=w=0}r.mode=29;case 29:L=1;break e;case 30:L=-3;break e;case 31:return -4;default:return -2}return e.next_out=h,e.avail_out=y,e.next_in=d,e.avail_in=p,r.hold=w,r.bits=x,(r.wsize||_!==e.avail_out&&r.mode<30&&(r.mode<27||4!==t))&&v(e,e.output,e.next_out,_-e.avail_out)?(r.mode=31,-4):(E-=e.avail_in,_-=e.avail_out,e.total_in+=E,e.total_out+=_,r.total+=_,r.wrap&&_&&(e.adler=r.check=r.flags?o(r.check,u,_,e.next_out-_):i(r.check,u,_,e.next_out-_)),e.data_type=r.bits+64*!!r.last+128*(12===r.mode)+256*(20===r.mode||15===r.mode),(0==E&&0===_||4===t)&&0===L&&(L=-5),L)},r.inflateEnd=function(e){if(!e||!e.state)return -2;var t=e.state;return t.window&&(t.window=null),e.state=null,0},r.inflateGetHeader=function(e,t){var r;return e&&e.state?0==(2&(r=e.state).wrap)?-2:((r.head=t).done=!1,0):-2},r.inflateSetDictionary=function(e,t){var r,n=t.length;return e&&e.state?0!==(r=e.state).wrap&&11!==r.mode?-2:11===r.mode&&i(1,t,n,0)!==r.check?-3:v(e,t,n,n)?(r.mode=31,-4):(r.havedict=1,0):-2},r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,r){"use strict";var n=e("../utils/common"),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],s=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],a=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,r,l,c,u,d,h){var p,f,g,b,v,y,w,x,E,_=h.bits,T=0,O=0,A=0,S=0,k=0,N=0,C=0,I=0,R=0,P=0,L=null,D=0,j=new n.Buf16(16),B=new n.Buf16(16),F=null,U=0;for(T=0;T<=15;T++)j[T]=0;for(O=0;O<l;O++)j[t[r+O]]++;for(k=_,S=15;1<=S&&0===j[S];S--);if(S<k&&(k=S),0===S)return c[u++]=0x1400000,c[u++]=0x1400000,h.bits=1,0;for(A=1;A<S&&0===j[A];A++);for(k<A&&(k=A),T=I=1;T<=15;T++)if(I<<=1,(I-=j[T])<0)return -1;if(0<I&&(0===e||1!==S))return -1;for(B[1]=0,T=1;T<15;T++)B[T+1]=B[T]+j[T];for(O=0;O<l;O++)0!==t[r+O]&&(d[B[t[r+O]]++]=O);if(y=0===e?(L=F=d,19):1===e?(L=i,D-=257,F=o,U-=257,256):(L=s,F=a,-1),T=A,v=u,C=O=P=0,g=-1,b=(R=1<<(N=k))-1,1===e&&852<R||2===e&&592<R)return 1;for(;;){for(w=T-C,E=d[O]<y?(x=0,d[O]):d[O]>y?(x=F[U+d[O]],L[D+d[O]]):(x=96,0),p=1<<T-C,A=f=1<<N;c[v+(P>>C)+(f-=p)]=w<<24|x<<16|E,0!==f;);for(p=1<<T-1;P&p;)p>>=1;if(0!==p?(P&=p-1,P+=p):P=0,O++,0==--j[T]){if(T===S)break;T=t[r+d[O]]}if(k<T&&(P&b)!==g){for(0===C&&(C=k),v+=A,I=1<<(N=T-C);N+C<S&&!((I-=j[N+C])<=0);)N++,I<<=1;if(R+=1<<N,1===e&&852<R||2===e&&592<R)return 1;c[g=P&b]=k<<24|N<<16|v-u}}return 0!==P&&(c[v+P]=T-C<<24|4194304),h.bits=k,0}},{"../utils/common":41}],51:[function(e,t,r){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,r){"use strict";var n=e("../utils/common");function i(e){for(var t=e.length;0<=--t;)e[t]=0}var o=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],s=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],l=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],c=Array(576);i(c);var u=Array(60);i(u);var d=Array(512);i(d);var h=Array(256);i(h);var p=Array(29);i(p);var f,g,b,v=Array(30);function y(e,t,r,n,i){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=e&&e.length}function w(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function x(e){return e<256?d[e]:d[256+(e>>>7)]}function E(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function _(e,t,r){e.bi_valid>16-r?(e.bi_buf|=t<<e.bi_valid&65535,E(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=r-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function T(e,t,r){_(e,r[2*t],r[2*t+1])}function O(e,t){for(var r=0;r|=1&e,e>>>=1,r<<=1,0<--t;);return r>>>1}function A(e,t,r){var n,i,o=Array(16),s=0;for(n=1;n<=15;n++)o[n]=s=s+r[n-1]<<1;for(i=0;i<=t;i++){var a=e[2*i+1];0!==a&&(e[2*i]=O(o[a]++,a))}}function S(e){var t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function k(e){8<e.bi_valid?E(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function N(e,t,r,n){var i=2*t,o=2*r;return e[i]<e[o]||e[i]===e[o]&&n[t]<=n[r]}function C(e,t,r){for(var n=e.heap[r],i=r<<1;i<=e.heap_len&&(i<e.heap_len&&N(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!N(t,n,e.heap[i],e.depth));)e.heap[r]=e.heap[i],r=i,i<<=1;e.heap[r]=n}function I(e,t,r){var n,i,a,l,c=0;if(0!==e.last_lit)for(;n=e.pending_buf[e.d_buf+2*c]<<8|e.pending_buf[e.d_buf+2*c+1],i=e.pending_buf[e.l_buf+c],c++,0===n?T(e,i,t):(T(e,(a=h[i])+256+1,t),0!==(l=o[a])&&_(e,i-=p[a],l),T(e,a=x(--n),r),0!==(l=s[a])&&_(e,n-=v[a],l)),c<e.last_lit;);T(e,256,t)}function R(e,t){var r,n,i,o=t.dyn_tree,s=t.stat_desc.static_tree,a=t.stat_desc.has_stree,l=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=573,r=0;r<l;r++)0!==o[2*r]?(e.heap[++e.heap_len]=c=r,e.depth[r]=0):o[2*r+1]=0;for(;e.heap_len<2;)o[2*(i=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[i]=0,e.opt_len--,a&&(e.static_len-=s[2*i+1]);for(t.max_code=c,r=e.heap_len>>1;1<=r;r--)C(e,o,r);for(i=l;r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],C(e,o,1),n=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=n,o[2*i]=o[2*r]+o[2*n],e.depth[i]=(e.depth[r]>=e.depth[n]?e.depth[r]:e.depth[n])+1,o[2*r+1]=o[2*n+1]=i,e.heap[1]=i++,C(e,o,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e,t){var r,n,i,o,s,a,l=t.dyn_tree,c=t.max_code,u=t.stat_desc.static_tree,d=t.stat_desc.has_stree,h=t.stat_desc.extra_bits,p=t.stat_desc.extra_base,f=t.stat_desc.max_length,g=0;for(o=0;o<=15;o++)e.bl_count[o]=0;for(l[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<573;r++)f<(o=l[2*l[2*(n=e.heap[r])+1]+1]+1)&&(o=f,g++),l[2*n+1]=o,c<n||(e.bl_count[o]++,s=0,p<=n&&(s=h[n-p]),a=l[2*n],e.opt_len+=a*(o+s),d&&(e.static_len+=a*(u[2*n+1]+s)));if(0!==g){do{for(o=f-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[f]--,g-=2}while(0<g);for(o=f;0!==o;o--)for(n=e.bl_count[o];0!==n;)c<(i=e.heap[--r])||(l[2*i+1]!==o&&(e.opt_len+=(o-l[2*i+1])*l[2*i],l[2*i+1]=o),n--)}}(e,t),A(o,c,e.bl_count)}function P(e,t,r){var n,i,o=-1,s=t[1],a=0,l=7,c=4;for(0===s&&(l=138,c=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)i=s,s=t[2*(n+1)+1],++a<l&&i===s||(a<c?e.bl_tree[2*i]+=a:0!==i?(i!==o&&e.bl_tree[2*i]++,e.bl_tree[32]++):a<=10?e.bl_tree[34]++:e.bl_tree[36]++,o=i,c=(a=0)===s?(l=138,3):i===s?(l=6,3):(l=7,4))}function L(e,t,r){var n,i,o=-1,s=t[1],a=0,l=7,c=4;for(0===s&&(l=138,c=3),n=0;n<=r;n++)if(i=s,s=t[2*(n+1)+1],!(++a<l&&i===s)){if(a<c)for(;T(e,i,e.bl_tree),0!=--a;);else 0!==i?(i!==o&&(T(e,i,e.bl_tree),a--),T(e,16,e.bl_tree),_(e,a-3,2)):a<=10?(T(e,17,e.bl_tree),_(e,a-3,3)):(T(e,18,e.bl_tree),_(e,a-11,7));o=i,c=(a=0)===s?(l=138,3):i===s?(l=6,3):(l=7,4)}}i(v);var D=!1;function j(e,t,r,i){_(e,0+ +!!i,3),k(e),E(e,r),E(e,~r),n.arraySet(e.pending_buf,e.window,t,r,e.pending),e.pending+=r}r._tr_init=function(e){D||(function(){var e,t,r,n,i,l=Array(16);for(n=r=0;n<28;n++)for(p[n]=r,e=0;e<1<<o[n];e++)h[r++]=n;for(h[r-1]=n,n=i=0;n<16;n++)for(v[n]=i,e=0;e<1<<s[n];e++)d[i++]=n;for(i>>=7;n<30;n++)for(v[n]=i<<7,e=0;e<1<<s[n]-7;e++)d[256+i++]=n;for(t=0;t<=15;t++)l[t]=0;for(e=0;e<=143;)c[2*e+1]=8,e++,l[8]++;for(;e<=255;)c[2*e+1]=9,e++,l[9]++;for(;e<=279;)c[2*e+1]=7,e++,l[7]++;for(;e<=287;)c[2*e+1]=8,e++,l[8]++;for(A(c,287,l),e=0;e<30;e++)u[2*e+1]=5,u[2*e]=O(e,5);f=new y(c,o,257,286,15),g=new y(u,s,0,30,15),b=new y([],a,0,19,7)}(),D=!0),e.l_desc=new w(e.dyn_ltree,f),e.d_desc=new w(e.dyn_dtree,g),e.bl_desc=new w(e.bl_tree,b),e.bi_buf=0,e.bi_valid=0,S(e)},r._tr_stored_block=j,r._tr_flush_block=function(e,t,r,n){var i,o,s=0;0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,r=0xf3ffc07f;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),R(e,e.l_desc),R(e,e.d_desc),s=function(e){var t;for(P(e,e.dyn_ltree,e.l_desc.max_code),P(e,e.dyn_dtree,e.d_desc.max_code),R(e,e.bl_desc),t=18;3<=t&&0===e.bl_tree[2*l[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),i=e.opt_len+3+7>>>3,(o=e.static_len+3+7>>>3)<=i&&(i=o)):i=o=r+5,r+4<=i&&-1!==t?j(e,t,r,n):4===e.strategy||o===i?(_(e,2+ +!!n,3),I(e,c,u)):(_(e,4+ +!!n,3),function(e,t,r,n){var i;for(_(e,t-257,5),_(e,r-1,5),_(e,n-4,4),i=0;i<n;i++)_(e,e.bl_tree[2*l[i]+1],3);L(e,e.dyn_ltree,t-1),L(e,e.dyn_dtree,r-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),I(e,e.dyn_ltree,e.dyn_dtree)),S(e),n&&k(e)},r._tr_tally=function(e,t,r){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(h[r]+256+1)]++,e.dyn_dtree[2*x(t)]++),e.last_lit===e.lit_bufsize-1},r._tr_align=function(e){_(e,2,3),T(e,256,c),16===e.bi_valid?(E(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):8<=e.bi_valid&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}},{"../utils/common":41}],53:[function(e,t,r){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,r){"use strict";t.exports="function"==typeof n?n:function(){var e=[].slice.apply(arguments);e.splice(1,0,0),setTimeout.apply(null,e)}},{}]},{},[10])(10)}).call(t,r(6).Buffer,r(4),r(60).setImmediate)},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),t.Document=r(12).File,n(r(12)),n(r(352)),n(r(360)),n(r(44))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(25);t.EMPTY_OBJECT=Object.seal({});class i extends n.BaseXmlComponent{constructor(e){super(e),this.root=[]}prepForXml(e){let r,i=this.root.filter(e=>e instanceof n.BaseXmlComponent?!e.IsDeleted:void 0!==e).map(t=>t instanceof n.BaseXmlComponent?t.prepForXml(e):t).filter(e=>void 0!==e);return{[this.rootKey]:i.length?1===i.length&&"object"==typeof(r=i[0])&&r._attr?i[0]:i:t.EMPTY_OBJECT}}addChildElement(e){return this.root.push(e),this}delete(){this.deleted=!0}}t.XmlComponent=i,t.IgnoreIfEmptyXmlComponent=class extends i{prepForXml(){let e=super.prepForXml();if(e&&("object"!=typeof e[this.rootKey]||Object.keys(e[this.rootKey]).length))return e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(53);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={val:"w:val",color:"w:color",fill:"w:fill",space:"w:space",sz:"w:sz",type:"w:type",rsidR:"w:rsidR",rsidRPr:"w:rsidRPr",rsidSect:"w:rsidSect",w:"w:w",h:"w:h",top:"w:top",right:"w:right",bottom:"w:bottom",left:"w:left",header:"w:header",footer:"w:footer",gutter:"w:gutter",linePitch:"w:linePitch",pos:"w:pos"}}}t.Attributes=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(26),i=r(0);function o(e){switch(e.type){case void 0:case"element":let t=new a(e.name,e.attributes);for(let r of e.elements||[]){let e=o(r);void 0!==e&&t.push(e)}return t;case"text":return e.text;default:return}}t.convertToXmlComponent=o;class s extends i.XmlAttributeComponent{}class a extends i.XmlComponent{static fromXmlString(e){return o(n.xml2js(e,{compact:!1}))}constructor(e,t){super(e),t&&this.root.push(new s(t))}push(e){this.root.push(e)}}t.ImportedXmlComponent=a;class l extends i.XmlComponent{constructor(e){super(""),this._attr=e}prepForXml(){return{_attr:this._attr}}}t.ImportedRootElementAttributes=l},function(e,t,r){(function(e){!function(t){t.parser=function(e,t){return new l(e,t)},t.SAXParser=l,t.SAXStream=u,t.createStream=function(e,t){return new u(e,t)},t.MAX_BUFFER_LENGTH=65536;var n,i,o,s,a=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function l(e,r){if(!(this instanceof l))return new l(e,r);(function(e){for(var t=0,r=a.length;t<r;t++)e[a[t]]=""})(this),this.q=this.c="",this.bufferCheckPosition=t.MAX_BUFFER_LENGTH,this.opt=r||{},this.opt.lowercase=this.opt.lowercase||this.opt.lowercasetags,this.looseCase=this.opt.lowercase?"toLowerCase":"toUpperCase",this.tags=[],this.closed=this.closedRoot=this.sawRoot=!1,this.tag=this.error=null,this.strict=!!e,this.noscript=!!(e||this.opt.noscript),this.state=E.BEGIN,this.strictEntities=this.opt.strictEntities,this.ENTITIES=this.strictEntities?Object.create(t.XML_ENTITIES):Object.create(t.ENTITIES),this.attribList=[],this.opt.xmlns&&(this.ns=Object.create(p)),this.trackPosition=!1!==this.opt.position,this.trackPosition&&(this.position=this.line=this.column=0),T(this,"onready")}t.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(e){function t(){}return t.prototype=e,new t}),Object.keys||(Object.keys=function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r);return t}),l.prototype={end:function(){N(this)},write:function(e){if(this.error)throw this.error;if(this.closed)return k(this,"Cannot write after close. Assign an onready handler.");if(null===e)return N(this);"object"==typeof e&&(e=e.toString());for(var r=0,n="";n=j(e,r++),this.c=n,n;)switch(this.trackPosition&&(this.position++,"\n"===n?(this.line++,this.column=0):this.column++),this.state){case E.BEGIN:if(this.state=E.BEGIN_WHITESPACE,"\uFEFF"===n)continue;D(this,n);continue;case E.BEGIN_WHITESPACE:D(this,n);continue;case E.TEXT:if(this.sawRoot&&!this.closedRoot){for(var i,o,s,l=r-1;n&&"<"!==n&&"&"!==n;)(n=j(e,r++))&&this.trackPosition&&(this.position++,"\n"===n?(this.line++,this.column=0):this.column++);this.textNode+=e.substring(l,r-1)}"<"!==n||this.sawRoot&&this.closedRoot&&!this.strict?(y(n)||this.sawRoot&&!this.closedRoot||C(this,"Text data outside of root node."),"&"===n?this.state=E.TEXT_ENTITY:this.textNode+=n):(this.state=E.OPEN_WAKA,this.startTagPosition=this.position);continue;case E.SCRIPT:"<"===n?this.state=E.SCRIPT_ENDING:this.script+=n;continue;case E.SCRIPT_ENDING:"/"===n?this.state=E.CLOSE_TAG:(this.script+="<"+n,this.state=E.SCRIPT);continue;case E.OPEN_WAKA:"!"===n?(this.state=E.SGML_DECL,this.sgmlDecl=""):y(n)||(x(f,n)?(this.state=E.OPEN_TAG,this.tagName=n):"/"===n?(this.state=E.CLOSE_TAG,this.tagName=""):"?"===n?(this.state=E.PROC_INST,this.procInstName=this.procInstBody=""):(C(this,"Unencoded <"),this.startTagPosition+1<this.position&&(n=Array(this.position-this.startTagPosition).join(" ")+n),this.textNode+="<"+n,this.state=E.TEXT));continue;case E.SGML_DECL:"[CDATA["===(this.sgmlDecl+n).toUpperCase()?(O(this,"onopencdata"),this.state=E.CDATA,this.sgmlDecl="",this.cdata=""):this.sgmlDecl+n==="--"?(this.state=E.COMMENT,this.comment="",this.sgmlDecl=""):"DOCTYPE"===(this.sgmlDecl+n).toUpperCase()?(this.state=E.DOCTYPE,(this.doctype||this.sawRoot)&&C(this,"Inappropriately located doctype declaration"),this.doctype="",this.sgmlDecl=""):">"===n?(O(this,"onsgmldeclaration",this.sgmlDecl),this.sgmlDecl="",this.state=E.TEXT):(w(n)&&(this.state=E.SGML_DECL_QUOTED),this.sgmlDecl+=n);continue;case E.SGML_DECL_QUOTED:n===this.q&&(this.state=E.SGML_DECL,this.q=""),this.sgmlDecl+=n;continue;case E.DOCTYPE:">"===n?(this.state=E.TEXT,O(this,"ondoctype",this.doctype),this.doctype=!0):(this.doctype+=n,"["===n?this.state=E.DOCTYPE_DTD:w(n)&&(this.state=E.DOCTYPE_QUOTED,this.q=n));continue;case E.DOCTYPE_QUOTED:this.doctype+=n,n===this.q&&(this.q="",this.state=E.DOCTYPE);continue;case E.DOCTYPE_DTD:this.doctype+=n,"]"===n?this.state=E.DOCTYPE:w(n)&&(this.state=E.DOCTYPE_DTD_QUOTED,this.q=n);continue;case E.DOCTYPE_DTD_QUOTED:this.doctype+=n,n===this.q&&(this.state=E.DOCTYPE_DTD,this.q="");continue;case E.COMMENT:"-"===n?this.state=E.COMMENT_ENDING:this.comment+=n;continue;case E.COMMENT_ENDING:"-"===n?(this.state=E.COMMENT_ENDED,this.comment=S(this.opt,this.comment),this.comment&&O(this,"oncomment",this.comment),this.comment=""):(this.comment+="-"+n,this.state=E.COMMENT);continue;case E.COMMENT_ENDED:">"!==n?(C(this,"Malformed comment"),this.comment+="--"+n,this.state=E.COMMENT):this.state=E.TEXT;continue;case E.CDATA:"]"===n?this.state=E.CDATA_ENDING:this.cdata+=n;continue;case E.CDATA_ENDING:"]"===n?this.state=E.CDATA_ENDING_2:(this.cdata+="]"+n,this.state=E.CDATA);continue;case E.CDATA_ENDING_2:">"===n?(this.cdata&&O(this,"oncdata",this.cdata),O(this,"onclosecdata"),this.cdata="",this.state=E.TEXT):"]"===n?this.cdata+="]":(this.cdata+="]]"+n,this.state=E.CDATA);continue;case E.PROC_INST:"?"===n?this.state=E.PROC_INST_ENDING:y(n)?this.state=E.PROC_INST_BODY:this.procInstName+=n;continue;case E.PROC_INST_BODY:!this.procInstBody&&y(n)||("?"===n?this.state=E.PROC_INST_ENDING:this.procInstBody+=n);continue;case E.PROC_INST_ENDING:">"===n?(O(this,"onprocessinginstruction",{name:this.procInstName,body:this.procInstBody}),this.procInstName=this.procInstBody="",this.state=E.TEXT):(this.procInstBody+="?"+n,this.state=E.PROC_INST_BODY);continue;case E.OPEN_TAG:x(g,n)?this.tagName+=n:(!function(e){e.strict||(e.tagName=e.tagName[e.looseCase]());var t=e.tags[e.tags.length-1]||e,r=e.tag={name:e.tagName,attributes:{}};e.opt.xmlns&&(r.ns=t.ns),e.attribList.length=0,O(e,"onopentagstart",r)}(this),">"===n?P(this):"/"===n?this.state=E.OPEN_TAG_SLASH:(y(n)||C(this,"Invalid character in tag name"),this.state=E.ATTRIB));continue;case E.OPEN_TAG_SLASH:">"===n?(P(this,!0),L(this)):(C(this,"Forward-slash in opening tag not followed by >"),this.state=E.ATTRIB);continue;case E.ATTRIB:y(n)||(">"===n?P(this):"/"===n?this.state=E.OPEN_TAG_SLASH:x(f,n)?(this.attribName=n,this.attribValue="",this.state=E.ATTRIB_NAME):C(this,"Invalid attribute name"));continue;case E.ATTRIB_NAME:"="===n?this.state=E.ATTRIB_VALUE:">"===n?(C(this,"Attribute without value"),this.attribValue=this.attribName,R(this),P(this)):y(n)?this.state=E.ATTRIB_NAME_SAW_WHITE:x(g,n)?this.attribName+=n:C(this,"Invalid attribute name");continue;case E.ATTRIB_NAME_SAW_WHITE:if("="===n)this.state=E.ATTRIB_VALUE;else{if(y(n))continue;C(this,"Attribute without value"),this.tag.attributes[this.attribName]="",this.attribValue="",O(this,"onattribute",{name:this.attribName,value:""}),this.attribName="",">"===n?P(this):x(f,n)?(this.attribName=n,this.state=E.ATTRIB_NAME):(C(this,"Invalid attribute name"),this.state=E.ATTRIB)}continue;case E.ATTRIB_VALUE:y(n)||(w(n)?(this.q=n,this.state=E.ATTRIB_VALUE_QUOTED):(C(this,"Unquoted attribute value"),this.state=E.ATTRIB_VALUE_UNQUOTED,this.attribValue=n));continue;case E.ATTRIB_VALUE_QUOTED:if(n!==this.q){"&"===n?this.state=E.ATTRIB_VALUE_ENTITY_Q:this.attribValue+=n;continue}R(this),this.q="",this.state=E.ATTRIB_VALUE_CLOSED;continue;case E.ATTRIB_VALUE_CLOSED:y(n)?this.state=E.ATTRIB:">"===n?P(this):"/"===n?this.state=E.OPEN_TAG_SLASH:x(f,n)?(C(this,"No whitespace between attributes"),this.attribName=n,this.attribValue="",this.state=E.ATTRIB_NAME):C(this,"Invalid attribute name");continue;case E.ATTRIB_VALUE_UNQUOTED:if(!(">"===(i=n)||y(i))){"&"===n?this.state=E.ATTRIB_VALUE_ENTITY_U:this.attribValue+=n;continue}R(this),">"===n?P(this):this.state=E.ATTRIB;continue;case E.CLOSE_TAG:this.tagName?">"===n?L(this):x(g,n)?this.tagName+=n:this.script?(this.script+="</"+this.tagName,this.tagName="",this.state=E.SCRIPT):(y(n)||C(this,"Invalid tagname in closing tag"),this.state=E.CLOSE_TAG_SAW_WHITE):y(n)||(x(f,n)?this.tagName=n:this.script?(this.script+="</"+n,this.state=E.SCRIPT):C(this,"Invalid tagname in closing tag."));continue;case E.CLOSE_TAG_SAW_WHITE:if(y(n))continue;">"===n?L(this):C(this,"Invalid characters in closing tag");continue;case E.TEXT_ENTITY:case E.ATTRIB_VALUE_ENTITY_Q:case E.ATTRIB_VALUE_ENTITY_U:switch(this.state){case E.TEXT_ENTITY:o=E.TEXT,s="textNode";break;case E.ATTRIB_VALUE_ENTITY_Q:o=E.ATTRIB_VALUE_QUOTED,s="attribValue";break;case E.ATTRIB_VALUE_ENTITY_U:o=E.ATTRIB_VALUE_UNQUOTED,s="attribValue"}";"===n?(this[s]+=function(e){var t,r=e.entity,n=r.toLowerCase(),i="";return e.ENTITIES[r]?e.ENTITIES[r]:e.ENTITIES[n]?e.ENTITIES[n]:("#"===(r=n).charAt(0)&&(i="x"===r.charAt(1)?(t=parseInt(r=r.slice(2),16)).toString(16):(t=parseInt(r=r.slice(1),10)).toString(10)),r=r.replace(/^0+/,""),isNaN(t)||i.toLowerCase()!==r)?(C(e,"Invalid character entity"),"&"+e.entity+";"):String.fromCodePoint(t)}(this),this.entity="",this.state=o):x(this.entity.length?v:b,n)?this.entity+=n:(C(this,"Invalid character in entity name"),this[s]+="&"+this.entity+n,this.entity="",this.state=o);continue;default:throw Error(this,"Unknown state: "+this.state)}return this.position>=this.bufferCheckPosition&&function(e){for(var r=Math.max(t.MAX_BUFFER_LENGTH,10),n=0,i=0,o=a.length;i<o;i++){var s=e[a[i]].length;if(s>r)switch(a[i]){case"textNode":A(e);break;case"cdata":O(e,"oncdata",e.cdata),e.cdata="";break;case"script":O(e,"onscript",e.script),e.script="";break;default:k(e,"Max buffer length exceeded: "+a[i])}n=Math.max(n,s)}e.bufferCheckPosition=t.MAX_BUFFER_LENGTH-n+e.position}(this),this},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){A(this),""!==this.cdata&&(O(this,"oncdata",this.cdata),this.cdata=""),""!==this.script&&(O(this,"onscript",this.script),this.script="")}};try{s=r(56).Stream}catch(e){s=function(){}}var c=t.EVENTS.filter(function(e){return"error"!==e&&"end"!==e});function u(e,t){if(!(this instanceof u))return new u(e,t);s.apply(this),this._parser=new l(e,t),this.writable=!0,this.readable=!0;var r=this;this._parser.onend=function(){r.emit("end")},this._parser.onerror=function(e){r.emit("error",e),r._parser.error=null},this._decoder=null,c.forEach(function(e){Object.defineProperty(r,"on"+e,{get:function(){return r._parser["on"+e]},set:function(t){if(!t)return r.removeAllListeners(e),r._parser["on"+e]=t,t;r.on(e,t)},enumerable:!0,configurable:!1})})}u.prototype=Object.create(s.prototype,{constructor:{value:u}}),u.prototype.write=function(t){if("function"==typeof e&&"function"==typeof e.isBuffer&&e.isBuffer(t)){if(!this._decoder){var n=r(30).StringDecoder;this._decoder=new n("utf8")}t=this._decoder.write(t)}return this._parser.write(t.toString()),this.emit("data",t),!0},u.prototype.end=function(e){return e&&e.length&&this.write(e),this._parser.end(),!0},u.prototype.on=function(e,t){var r=this;return r._parser["on"+e]||-1===c.indexOf(e)||(r._parser["on"+e]=function(){var t=1==arguments.length?[arguments[0]]:Array.apply(null,arguments);t.splice(0,0,e),r.emit.apply(r,t)}),s.prototype.on.call(r,e,t)};var d="http://www.w3.org/XML/1998/namespace",h="http://www.w3.org/2000/xmlns/",p={xml:d,xmlns:h},f=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,g=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,b=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,v=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function y(e){return" "===e||"\n"===e||"\r"===e||"	"===e}function w(e){return'"'===e||"'"===e}function x(e,t){return e.test(t)}var E=0;for(var _ in t.STATE={BEGIN:E++,BEGIN_WHITESPACE:E++,TEXT:E++,TEXT_ENTITY:E++,OPEN_WAKA:E++,SGML_DECL:E++,SGML_DECL_QUOTED:E++,DOCTYPE:E++,DOCTYPE_QUOTED:E++,DOCTYPE_DTD:E++,DOCTYPE_DTD_QUOTED:E++,COMMENT_STARTING:E++,COMMENT:E++,COMMENT_ENDING:E++,COMMENT_ENDED:E++,CDATA:E++,CDATA_ENDING:E++,CDATA_ENDING_2:E++,PROC_INST:E++,PROC_INST_BODY:E++,PROC_INST_ENDING:E++,OPEN_TAG:E++,OPEN_TAG_SLASH:E++,ATTRIB:E++,ATTRIB_NAME:E++,ATTRIB_NAME_SAW_WHITE:E++,ATTRIB_VALUE:E++,ATTRIB_VALUE_QUOTED:E++,ATTRIB_VALUE_CLOSED:E++,ATTRIB_VALUE_UNQUOTED:E++,ATTRIB_VALUE_ENTITY_Q:E++,ATTRIB_VALUE_ENTITY_U:E++,CLOSE_TAG:E++,CLOSE_TAG_SAW_WHITE:E++,SCRIPT:E++,SCRIPT_ENDING:E++},t.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},t.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(t.ENTITIES).forEach(function(e){var r=t.ENTITIES[e],n="number"==typeof r?String.fromCharCode(r):r;t.ENTITIES[e]=n}),t.STATE)t.STATE[t.STATE[_]]=_;function T(e,t,r){e[t]&&e[t](r)}function O(e,t,r){e.textNode&&A(e),T(e,t,r)}function A(e){e.textNode=S(e.opt,e.textNode),e.textNode&&T(e,"ontext",e.textNode),e.textNode=""}function S(e,t){return e.trim&&(t=t.trim()),e.normalize&&(t=t.replace(/\s+/g," ")),t}function k(e,t){return A(e),e.trackPosition&&(t+="\nLine: "+e.line+"\nColumn: "+e.column+"\nChar: "+e.c),e.error=t=Error(t),T(e,"onerror",t),e}function N(e){return e.sawRoot&&!e.closedRoot&&C(e,"Unclosed root tag"),e.state!==E.BEGIN&&e.state!==E.BEGIN_WHITESPACE&&e.state!==E.TEXT&&k(e,"Unexpected end"),A(e),e.c="",e.closed=!0,T(e,"onend"),l.call(e,e.strict,e.opt),e}function C(e,t){if("object"!=typeof e||!(e instanceof l))throw Error("bad call to strictFail");e.strict&&k(e,t)}function I(e,t){var r=0>e.indexOf(":")?["",e]:e.split(":"),n=r[0],i=r[1];return t&&"xmlns"===e&&(n="xmlns",i=""),{prefix:n,local:i}}function R(e){if(e.strict||(e.attribName=e.attribName[e.looseCase]()),-1!==e.attribList.indexOf(e.attribName)||e.tag.attributes.hasOwnProperty(e.attribName)){e.attribName=e.attribValue="";return}if(e.opt.xmlns){var t=I(e.attribName,!0),r=t.prefix,n=t.local;if("xmlns"===r)if("xml"===n&&e.attribValue!==d)C(e,"xml: prefix must be bound to "+d+"\nActual: "+e.attribValue);else if("xmlns"===n&&e.attribValue!==h)C(e,"xmlns: prefix must be bound to "+h+"\nActual: "+e.attribValue);else{var i=e.tag,o=e.tags[e.tags.length-1]||e;i.ns===o.ns&&(i.ns=Object.create(o.ns)),i.ns[n]=e.attribValue}e.attribList.push([e.attribName,e.attribValue])}else e.tag.attributes[e.attribName]=e.attribValue,O(e,"onattribute",{name:e.attribName,value:e.attribValue});e.attribName=e.attribValue=""}function P(e,t){if(e.opt.xmlns){var r=e.tag,n=I(e.tagName);r.prefix=n.prefix,r.local=n.local,r.uri=r.ns[n.prefix]||"",r.prefix&&!r.uri&&(C(e,"Unbound namespace prefix: "+JSON.stringify(e.tagName)),r.uri=n.prefix);var i=e.tags[e.tags.length-1]||e;r.ns&&i.ns!==r.ns&&Object.keys(r.ns).forEach(function(t){O(e,"onopennamespace",{prefix:t,uri:r.ns[t]})});for(var o=0,s=e.attribList.length;o<s;o++){var a=e.attribList[o],l=a[0],c=a[1],u=I(l,!0),d=u.prefix,h=u.local,p=""===d?"":r.ns[d]||"",f={name:l,value:c,prefix:d,local:h,uri:p};d&&"xmlns"!==d&&!p&&(C(e,"Unbound namespace prefix: "+JSON.stringify(d)),f.uri=d),e.tag.attributes[l]=f,O(e,"onattribute",f)}e.attribList.length=0}e.tag.isSelfClosing=!!t,e.sawRoot=!0,e.tags.push(e.tag),O(e,"onopentag",e.tag),t||(e.noscript||"script"!==e.tagName.toLowerCase()?e.state=E.TEXT:e.state=E.SCRIPT,e.tag=null,e.tagName=""),e.attribName=e.attribValue="",e.attribList.length=0}function L(e){if(!e.tagName){C(e,"Weird empty close tag."),e.textNode+="</>",e.state=E.TEXT;return}if(e.script){if("script"!==e.tagName){e.script+="</"+e.tagName+">",e.tagName="",e.state=E.SCRIPT;return}O(e,"onscript",e.script),e.script=""}var t=e.tags.length,r=e.tagName;e.strict||(r=r[e.looseCase]());for(var n=r;t--;)if(e.tags[t].name!==n)C(e,"Unexpected close tag");else break;if(t<0){C(e,"Unmatched closing tag: "+e.tagName),e.textNode+="</"+e.tagName+">",e.state=E.TEXT;return}e.tagName=r;for(var i=e.tags.length;i-- >t;){var o=e.tag=e.tags.pop();e.tagName=e.tag.name,O(e,"onclosetag",e.tagName);var s={};for(var a in o.ns)s[a]=o.ns[a];var l=e.tags[e.tags.length-1]||e;e.opt.xmlns&&o.ns!==l.ns&&Object.keys(o.ns).forEach(function(t){var r=o.ns[t];O(e,"onclosenamespace",{prefix:t,uri:r})})}0===t&&(e.closedRoot=!0),e.tagName=e.attribValue=e.attribName="",e.attribList.length=0,e.state=E.TEXT}function D(e,t){"<"===t?(e.state=E.OPEN_WAKA,e.startTagPosition=e.position):y(t)||(C(e,"Non-whitespace before first tag."),e.textNode=t,e.state=E.TEXT)}function j(e,t){var r="";return t<e.length&&(r=e.charAt(t)),r}E=t.STATE,String.fromCodePoint||(n=String.fromCharCode,i=Math.floor,o=function(){var e,t,r=[],o=-1,s=arguments.length;if(!s)return"";for(var a="";++o<s;){var l=Number(arguments[o]);if(!isFinite(l)||l<0||l>1114111||i(l)!==l)throw RangeError("Invalid code point: "+l);l<=65535?r.push(l):(l-=65536,e=(l>>10)+55296,t=l%1024+56320,r.push(e,t)),(o+1===s||r.length>16384)&&(a+=n.apply(null,r),r.length=0)}return a},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:o,configurable:!0,writable:!0}):String.fromCodePoint=o)}(t)}).call(t,r(6).Buffer)},function(e,t,r){"use strict";t.byteLength=function(e){var t=c(e),r=t[0],n=t[1];return(r+n)*3/4-n},t.toByteArray=function(e){for(var t,r=c(e),n=r[0],s=r[1],a=new o((n+s)*3/4-s),l=0,u=s>0?n-4:n,d=0;d<u;d+=4)t=i[e.charCodeAt(d)]<<18|i[e.charCodeAt(d+1)]<<12|i[e.charCodeAt(d+2)]<<6|i[e.charCodeAt(d+3)],a[l++]=t>>16&255,a[l++]=t>>8&255,a[l++]=255&t;return 2===s&&(t=i[e.charCodeAt(d)]<<2|i[e.charCodeAt(d+1)]>>4,a[l++]=255&t),1===s&&(t=i[e.charCodeAt(d)]<<10|i[e.charCodeAt(d+1)]<<4|i[e.charCodeAt(d+2)]>>2,a[l++]=t>>8&255,a[l++]=255&t),a},t.fromByteArray=function(e){for(var t,r=e.length,i=r%3,o=[],s=0,a=r-i;s<a;s+=16383)o.push(function(e,t,r){for(var i,o=[],s=t;s<r;s+=3)i=(e[s]<<16&0xff0000)+(e[s+1]<<8&65280)+(255&e[s+2]),o.push(n[i>>18&63]+n[i>>12&63]+n[i>>6&63]+n[63&i]);return o.join("")}(e,s,s+16383>a?a:s+16383));return 1===i?o.push(n[(t=e[r-1])>>2]+n[t<<4&63]+"=="):2===i&&o.push(n[(t=(e[r-2]<<8)+e[r-1])>>10]+n[t>>4&63]+n[t<<2&63]+"="),o.join("")};for(var n=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,l=s.length;a<l;++a)n[a]=s[a],i[s.charCodeAt(a)]=a;function c(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");-1===r&&(r=t);var n=r===t?0:4-r%4;return[r,n]}i[45]=62,i[95]=63},function(e,t){t.read=function(e,t,r,n,i){var o,s,a=8*i-n-1,l=(1<<a)-1,c=l>>1,u=-7,d=r?i-1:0,h=r?-1:1,p=e[t+d];for(d+=h,o=p&(1<<-u)-1,p>>=-u,u+=a;u>0;o=256*o+e[t+d],d+=h,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=n;u>0;s=256*s+e[t+d],d+=h,u-=8);if(0===o)o=1-c;else{if(o===l)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,n),o-=c}return(p?-1:1)*s*Math.pow(2,o-n)},t.write=function(e,t,r,n,i,o){var s,a,l,c=8*o-i-1,u=(1<<c)-1,d=u>>1,h=5960464477539062e-23*(23===i),p=n?0:o-1,f=n?1:-1,g=+(t<0||0===t&&1/t<0);for(isNaN(t=Math.abs(t))||t===1/0?(a=+!!isNaN(t),s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),s+d>=1?t+=h/l:t+=h*Math.pow(2,1-d),t*l>=2&&(s++,l/=2),s+d>=u?(a=0,s=u):s+d>=1?(a=(t*l-1)*Math.pow(2,i),s+=d):(a=t*Math.pow(2,d-1)*Math.pow(2,i),s=0));i>=8;e[r+p]=255&a,p+=f,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;e[r+p]=255&s,p+=f,s/=256,c-=8);e[r+p-f]|=128*g}},function(e,t){},function(e,t,r){"use strict";var n=r(16).Buffer,i=r(148);e.exports=function(){function e(){if(!(this instanceof e))throw TypeError("Cannot call a class as a function");this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r},e.prototype.concat=function(e){if(0===this.length)return n.alloc(0);if(1===this.length)return this.head.data;for(var t,r,i=n.allocUnsafe(e>>>0),o=this.head,s=0;o;)t=o.data,r=s,t.copy(i,r),s+=o.data.length,o=o.next;return i},e}(),i&&i.inspect&&i.inspect.custom&&(e.exports.prototype[i.inspect.custom]=function(){var e=i.inspect({length:this.length});return this.constructor.name+" "+e})},function(e,t){},function(e,t,r){(function(e,t){!function(e,r){"use strict";if(!e.setImmediate){var n,i,o,s,a,l=1,c={},u=!1,d=e.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(e);h=h&&h.setTimeout?h:e,"[object process]"===({}).toString.call(e.process)?a=function(e){t.nextTick(function(){f(e)})}:function(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}()?(n="setImmediate$"+Math.random()+"$",i=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(n)&&f(+t.data.slice(n.length))},e.addEventListener?e.addEventListener("message",i,!1):e.attachEvent("onmessage",i),a=function(t){e.postMessage(n+t,"*")}):e.MessageChannel?((o=new MessageChannel).port1.onmessage=function(e){f(e.data)},a=function(e){o.port2.postMessage(e)}):d&&"onreadystatechange"in d.createElement("script")?(s=d.documentElement,a=function(e){var t=d.createElement("script");t.onreadystatechange=function(){f(e),t.onreadystatechange=null,s.removeChild(t),t=null},s.appendChild(t)}):a=function(e){setTimeout(f,0,e)},h.setImmediate=function(e){"function"!=typeof e&&(e=Function(""+e));for(var t=Array(arguments.length-1),r=0;r<t.length;r++)t[r]=arguments[r+1];var n={callback:e,args:t};return c[l]=n,a(l),l++},h.clearImmediate=p}function p(e){delete c[e]}function f(e){if(u)setTimeout(f,0,e);else{var t=c[e];if(t){u=!0;try{var n=t.callback,i=t.args;switch(i.length){case 0:n();break;case 1:n(i[0]);break;case 2:n(i[0],i[1]);break;case 3:n(i[0],i[1],i[2]);break;default:n.apply(r,i)}}finally{p(e),u=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(t,r(4),r(13))},function(e,t,r){(function(t){e.exports=function(e,t){if(r("noDeprecation"))return e;var n=!1;return function(){if(!n){if(r("throwDeprecation"))throw Error(t);r("traceDeprecation")?console.trace(t):console.warn(t),n=!0}return e.apply(this,arguments)}};function r(e){try{if(!t.localStorage)return!1}catch(e){return!1}var r=t.localStorage[e];return null!=r&&"true"===String(r).toLowerCase()}}).call(t,r(4))},function(e,t,r){"use strict";e.exports=o;var n=r(61),i=r(14);function o(e){if(!(this instanceof o))return new o(e);n.call(this,e)}i.inherits=r(7),i.inherits(o,n),o.prototype._transform=function(e,t,r){r(null,e)}},function(e,t,r){e.exports=r(29)},function(e,t,r){e.exports=r(5)},function(e,t,r){e.exports=r(28).Transform},function(e,t,r){e.exports=r(28).PassThrough},function(e,t,r){var n=r(31),i=r(54);e.exports=function(e,t){var r,o,s;return s=n.copyOptions(t),n.ensureSpacesExists(s),r=i(e,s),o="compact"in s&&s.compact?"_parent":"parent",("addParent"in s&&s.addParent?JSON.stringify(r,function(e,t){return e===o?"_":t},s.spaces):JSON.stringify(r,null,s.spaces)).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}},function(e,t,r){(function(t){var n=r(62);e.exports=function(e,r){e instanceof t&&(e=e.toString());var i=null;if("string"==typeof e)try{i=JSON.parse(e)}catch(e){throw Error("The JSON structure is invalid")}else i=e;return n(i,r)}}).call(t,r(6).Buffer)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WORKAROUND3=""},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlComponent{constructor(e,t){super(e),t&&(this.root=t.root)}}t.InitializableXmlComponent=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={val:"w:val",color:"w:color",space:"w:space",sz:"w:sz"}}}t.BorderAttributes=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(8),i=r(0);class o extends i.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={space:"xml:space"}}}class s extends i.XmlComponent{constructor(){super("w:instrText"),this.root.push(new o({space:n.SpaceType.PRESERVE})),this.root.push("PAGE")}}t.Page=s;class a extends i.XmlComponent{constructor(){super("w:instrText"),this.root.push(new o({space:n.SpaceType.PRESERVE})),this.root.push("NUMPAGES")}}t.NumberOfPages=a;class l extends i.XmlComponent{constructor(){super("w:instrText"),this.root.push(new o({space:n.SpaceType.PRESERVE})),this.root.push("SECTIONPAGES")}}t.NumberOfPagesSection=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(17),i=r(71);class o extends n.Run{constructor(e){if("string"==typeof e){super({}),this.root.push(new i.Text(e));return}super(e)}}t.TextRun=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(17),i=r(164);class o extends n.Run{constructor(e){if("string"==typeof e){super({}),this.root.push(new i.Symbol(e));return}super(e),this.root.push(new i.Symbol(e.char,e.symbolfont))}}t.SymbolRun=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={char:"w:char",symbolfont:"w:font"}}}class o extends n.XmlComponent{constructor(e="",t="Wingdings"){super("w:sym"),this.root.push(new i({char:e,symbolfont:t}))}}t.Symbol=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(72),i=r(3);class o extends i.Run{constructor(e,t){super({});let r=new n.Drawing(e,t);this.root.push(r)}}t.PictureRun=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(167),o=r(210);class s extends n.XmlComponent{constructor(e,t={}){super("w:drawing"),t.floating?this.root.push(new i.Anchor(e,e.dimensions,t)):(this.inline=new o.Inline(e,e.dimensions),this.root.push(this.inline))}scale(e,t){this.inline.scale(e,t)}}t.Drawing=s},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(168)),n(r(81))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(73),o=r(76),s=r(36),a=r(77),l=r(78),c=r(79),u=r(80),d=r(81);class h extends n.XmlComponent{constructor(e,t,r){super("wp:anchor");let n=Object.assign({allowOverlap:!0,behindDocument:!1,lockAnchor:!1,layoutInCell:!0,verticalPosition:{},horizontalPosition:{}},r.floating);if(this.root.push(new d.AnchorAttributes({distT:n.margins&&n.margins.top||0,distB:n.margins&&n.margins.bottom||0,distL:n.margins&&n.margins.left||0,distR:n.margins&&n.margins.right||0,simplePos:"0",allowOverlap:!0===n.allowOverlap?"1":"0",behindDoc:!0===n.behindDocument?"1":"0",locked:!0===n.lockAnchor?"1":"0",layoutInCell:!0===n.layoutInCell?"1":"0",relativeHeight:n.zIndex?n.zIndex:t.emus.y})),this.root.push(new i.SimplePos),this.root.push(new i.HorizontalPosition(n.horizontalPosition)),this.root.push(new i.VerticalPosition(n.verticalPosition)),this.root.push(new c.Extent(t.emus.x,t.emus.y)),this.root.push(new l.EffectExtent),void 0!==r.floating&&void 0!==r.floating.wrap)switch(r.floating.wrap.type){case s.TextWrappingType.SQUARE:this.root.push(new s.WrapSquare(r.floating.wrap,r.floating.margins));break;case s.TextWrappingType.TIGHT:this.root.push(new s.WrapTight(r.floating.margins));break;case s.TextWrappingType.TOP_AND_BOTTOM:this.root.push(new s.WrapTopAndBottom(r.floating.margins));break;case s.TextWrappingType.NONE:default:this.root.push(new s.WrapNone)}else this.root.push(new s.WrapNone);this.root.push(new a.DocProperties),this.root.push(new u.GraphicFrameProperties),this.root.push(new o.Graphic(e,t.emus.x,t.emus.y))}}t.Anchor=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={x:"x",y:"y"}}}class o extends n.XmlComponent{constructor(){super("wp:simplePos"),this.root.push(new i({x:0,y:0}))}}t.SimplePos=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(74),o=r(35),s=r(75);class a extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={relativeFrom:"relativeFrom"}}}class l extends n.XmlComponent{constructor(e){if(super("wp:positionH"),this.root.push(new a({relativeFrom:e.relative||o.HorizontalPositionRelativeFrom.PAGE})),e.align)this.root.push(new i.Align(e.align));else if(void 0!==e.offset)this.root.push(new s.PositionOffset(e.offset));else throw Error("There is no configuration provided for floating position (Align or offset)")}}t.HorizontalPosition=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(74),o=r(35),s=r(75);class a extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={relativeFrom:"relativeFrom"}}}class l extends n.XmlComponent{constructor(e){if(super("wp:positionV"),this.root.push(new a({relativeFrom:e.relative||o.VerticalPositionRelativeFrom.PAGE})),e.align)this.root.push(new i.Align(e.align));else if(void 0!==e.offset)this.root.push(new s.PositionOffset(e.offset));else throw Error("There is no configuration provided for floating position (Align or offset)")}}t.VerticalPosition=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(173);class o extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={a:"xmlns:a"}}}class s extends n.XmlComponent{constructor(e,t,r){super("a:graphic"),this.root.push(new o({a:"http://schemas.openxmlformats.org/drawingml/2006/main"})),this.data=new i.GraphicData(e,t,r),this.root.push(this.data)}setXY(e,t){this.data.setXY(e,t)}}t.Graphic=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(174);for(var i in n)t.hasOwnProperty(i)||(t[i]=n[i])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(175),o=r(176);class s extends n.XmlComponent{constructor(e,t,r){super("a:graphicData"),this.root.push(new i.GraphicDataAttributes({uri:"http://schemas.openxmlformats.org/drawingml/2006/picture"})),this.pic=new o.Pic(e,t,r),this.root.push(this.pic)}setXY(e,t){this.pic.setXY(e,t)}}t.GraphicData=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={uri:"uri"}}}t.GraphicDataAttributes=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(177);for(var i in n)t.hasOwnProperty(i)||(t[i]=n[i])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(178),o=r(182),s=r(188),a=r(189);class l extends n.XmlComponent{constructor(e,t,r){super("pic:pic"),this.root.push(new s.PicAttributes({xmlns:"http://schemas.openxmlformats.org/drawingml/2006/picture"})),this.shapeProperties=new a.ShapeProperties(t,r),this.root.push(new o.NonVisualPicProperties),this.root.push(new i.BlipFill(e)),this.root.push(new a.ShapeProperties(t,r))}setXY(e,t){this.shapeProperties.setXY(e,t)}}t.Pic=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(179),o=r(180),s=r(181);class a extends n.XmlComponent{constructor(e){super("pic:blipFill"),this.root.push(new i.Blip(e)),this.root.push(new o.SourceRectangle),this.root.push(new s.Stretch)}}t.BlipFill=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={embed:"r:embed",cstate:"cstate"}}}class o extends n.XmlComponent{constructor(e){super("a:blip"),this.root.push(new i({embed:`rId{${e.fileName}}`,cstate:"none"}))}}t.Blip=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlComponent{constructor(){super("a:srcRect")}}t.SourceRectangle=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlComponent{constructor(){super("a:fillRect")}}class o extends n.XmlComponent{constructor(){super("a:stretch"),this.root.push(new i)}}t.Stretch=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(183),o=r(186);class s extends n.XmlComponent{constructor(){super("pic:nvPicPr"),this.root.push(new o.NonVisualProperties),this.root.push(new i.ChildNonVisualProperties)}}t.NonVisualPicProperties=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(184);class o extends n.XmlComponent{constructor(){super("pic:cNvPicPr"),this.root.push(new i.PicLocks)}}t.ChildNonVisualProperties=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(185);class o extends n.XmlComponent{constructor(){super("a:picLocks"),this.root.push(new i.PicLocksAttributes({noChangeAspect:1,noChangeArrowheads:1}))}}t.PicLocks=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={noChangeAspect:"noChangeAspect",noChangeArrowheads:"noChangeArrowheads"}}}t.PicLocksAttributes=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(187);class o extends n.XmlComponent{constructor(){super("pic:cNvPr"),this.root.push(new i.NonVisualPropertiesAttributes({id:0,name:"",descr:""}))}}t.NonVisualProperties=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={id:"id",name:"name",descr:"desc"}}}t.NonVisualPropertiesAttributes=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={xmlns:"xmlns:pic"}}}t.PicAttributes=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(190),o=r(196),s=r(199);class a extends n.XmlComponent{constructor(e,t){super("pic:spPr"),this.root.push(new s.ShapePropertiesAttributes({bwMode:"auto"})),this.form=new i.Form(e,t),this.root.push(this.form),this.root.push(new o.PresetGeometry)}setXY(e,t){this.form.setXY(e,t)}}t.ShapeProperties=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(191);for(var i in n)t.hasOwnProperty(i)||(t[i]=n[i])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(192),o=r(194);class s extends n.XmlComponent{constructor(e,t){super("a:xfrm"),this.extents=new i.Extents(e,t),this.root.push(this.extents),this.root.push(new o.Offset)}setXY(e,t){this.extents.setXY(e,t)}}t.Form=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(193);class o extends n.XmlComponent{constructor(e,t){super("a:ext"),this.attributes=new i.ExtentsAttributes({cx:e,cy:t}),this.root.push(this.attributes)}setXY(e,t){this.attributes.set({cx:e,cy:t})}}t.Extents=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={cx:"cx",cy:"cy"}}}t.ExtentsAttributes=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(195);class o extends n.XmlComponent{constructor(){super("a:off"),this.root.push(new i.OffsetAttributes({x:0,y:0}))}}t.Offset=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={x:"x",y:"y"}}}t.OffsetAttributes=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(197),o=r(198);class s extends n.XmlComponent{constructor(){super("a:prstGeom"),this.root.push(new o.PresetGeometryAttributes({prst:"rect"})),this.root.push(new i.AdjustmentValues)}}t.PresetGeometry=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlComponent{constructor(){super("a:avLst")}}t.AdjustmentValues=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={prst:"prst"}}}t.PresetGeometryAttributes=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={bwMode:"bwMode"}}}t.ShapePropertiesAttributes=i},function(e,t,r){"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0}),(n=t.TextWrappingType||(t.TextWrappingType={}))[n.NONE=0]="NONE",n[n.SQUARE=1]="SQUARE",n[n.TIGHT=2]="TIGHT",n[n.TOP_AND_BOTTOM=3]="TOP_AND_BOTTOM",(i=t.TextWrappingSide||(t.TextWrappingSide={})).BOTH_SIDES="bothSides",i.LEFT="left",i.RIGHT="right",i.LARGEST="largest"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlComponent{constructor(){super("wp:wrapNone")}}t.WrapNone=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(36);class o extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={distT:"distT",distB:"distB",distL:"distL",distR:"distR",wrapText:"wrapText"}}}class s extends n.XmlComponent{constructor(e,t={top:0,bottom:0,left:0,right:0}){super("wp:wrapSquare"),this.root.push(new o({wrapText:e.side||i.TextWrappingSide.BOTH_SIDES,distT:t.top,distB:t.bottom,distL:t.left,distR:t.right}))}}t.WrapSquare=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={distT:"distT",distB:"distB"}}}class o extends n.XmlComponent{constructor(e={top:0,bottom:0}){super("wp:wrapTight"),this.root.push(new i({distT:e.top,distB:e.bottom}))}}t.WrapTight=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={distT:"distT",distB:"distB"}}}class o extends n.XmlComponent{constructor(e={top:0,bottom:0}){super("wp:wrapTopAndBottom"),this.root.push(new i({distT:e.top,distB:e.bottom}))}}t.WrapTopAndBottom=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={id:"id",name:"name",descr:"descr"}}}t.DocPropertiesAttributes=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={b:"b",l:"l",r:"r",t:"t"}}}t.EffectExtentAttributes=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={cx:"cx",cy:"cy"}}}t.ExtentAttributes=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(209);class o extends n.XmlComponent{constructor(){super("a:graphicFrameLocks"),this.root.push(new i.GraphicFrameLockAttributes({xmlns:"http://schemas.openxmlformats.org/drawingml/2006/main",noChangeAspect:1}))}}t.GraphicFrameLocks=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={xmlns:"xmlns:a",noChangeAspect:"noChangeAspect"}}}t.GraphicFrameLockAttributes=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(211);for(var i in n)t.hasOwnProperty(i)||(t[i]=n[i])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(77),o=r(78),s=r(79),a=r(80),l=r(76),c=r(212);class u extends n.XmlComponent{constructor(e,t){super("wp:inline"),this.dimensions=t,this.root.push(new c.InlineAttributes({distT:0,distB:0,distL:0,distR:0})),this.extent=new s.Extent(t.emus.x,t.emus.y),this.graphic=new l.Graphic(e,t.emus.x,t.emus.y),this.root.push(this.extent),this.root.push(new o.EffectExtent),this.root.push(new i.DocProperties),this.root.push(new a.GraphicFrameProperties),this.root.push(this.graphic)}scale(e,t){let r=Math.round(this.dimensions.emus.x*e),n=Math.round(this.dimensions.emus.y*t);this.extent.setXY(r,n),this.graphic.setXY(r,n)}}t.Inline=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={distT:"distT",distB:"distB",distL:"distL",distR:"distR"}}}t.InlineAttributes=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(3),i=r(18),o=r(214);class s extends n.Run{constructor(e){super({}),this.root.push(new i.Begin(!0)),this.root.push(new o.SequentialIdentifierInstruction(e)),this.root.push(new i.Separate),this.root.push(new i.End)}}t.SequentialIdentifier=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(8),i=r(0);class o extends i.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={space:"xml:space"}}}class s extends i.XmlComponent{constructor(e){super("w:instrText"),this.root.push(new o({space:n.SpaceType.PRESERVE})),this.root.push(`SEQ ${e}`)}}t.SequentialIdentifierInstruction=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlComponent{constructor(){super("w:tab")}}t.Tab=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(37),o=r(21),s=r(3);class a extends n.XmlComponent{constructor(e){if(super("w:p"),"string"==typeof e){this.properties=new o.ParagraphProperties({}),this.root.push(this.properties),this.root.push(new s.TextRun(e));return}if(e instanceof s.PictureRun){this.properties=new o.ParagraphProperties({}),this.root.push(this.properties),this.root.push(e);return}if(this.properties=new o.ParagraphProperties(e),this.root.push(this.properties),e.text&&this.root.push(new s.TextRun(e.text)),e.children)for(let t of e.children){if(t instanceof i.Bookmark){this.root.push(t.start),this.root.push(t.text),this.root.push(t.end);continue}this.root.push(t)}}prepForXml(e){for(let t of this.root)if(t instanceof i.HyperlinkRef){let r=this.root.indexOf(t);this.root[r]=e.HyperlinkCache[t.id]}return super.prepForXml()}addRunToFront(e){return this.root.splice(1,0,e),this}}t.Paragraph=a},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0});let i=r(0),o=r(3),s=r(218);(n=t.HyperlinkType||(t.HyperlinkType={})).INTERNAL="INTERNAL",n.EXTERNAL="EXTERNAL",t.HyperlinkRef=class{constructor(e){this.id=e}};class a extends i.XmlComponent{constructor(e,t,r){super("w:hyperlink"),this.linkId=t;let n={history:1,anchor:r||void 0,id:r?void 0:`rId${this.linkId}`},i=new s.HyperlinkAttributes(n);this.root.push(i),this.textRun=new o.TextRun({text:e,style:"Hyperlink"}),this.root.push(this.textRun)}get TextRun(){return this.textRun}}t.Hyperlink=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={id:"r:id",history:"w:history",anchor:"w:anchor"}}}t.HyperlinkAttributes=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(86),o=r(3),s=r(228);t.Bookmark=class{constructor(e,t){let r=i.generate().toLowerCase();this.start=new a(e,r),this.text=new o.TextRun(t),this.end=new l(r)}};class a extends n.XmlComponent{constructor(e,t){super("w:bookmarkStart");let r=new s.BookmarkStartAttributes({name:e,id:t});this.root.push(r)}}t.BookmarkStart=a;class l extends n.XmlComponent{constructor(e){super("w:bookmarkEnd");let t=new s.BookmarkEndAttributes({id:e});this.root.push(t)}}t.BookmarkEnd=l},function(e,t,r){"use strict";var n=r(20),i=r(222),o=r(226),s=r(227)||0;function a(){return i(s)}e.exports=a,e.exports.generate=a,e.exports.seed=function(t){return n.seed(t),e.exports},e.exports.worker=function(t){return s=t,e.exports},e.exports.characters=function(e){return void 0!==e&&n.characters(e),n.shuffled()},e.exports.isValid=o},function(e,t,r){"use strict";var n=1;e.exports={nextValue:function(){return(n=(9301*n+49297)%233280)/233280},seed:function(e){n=e}}},function(e,t,r){"use strict";var n,i,o=r(223);r(20),e.exports=function(e){var t="",r=Math.floor((Date.now()-0x16d05594f0e)*.001);return r===i?n++:(n=0,i=r),t+=o(7),t+=o(e),n>0&&(t+=o(n)),t+=o(r)}},function(e,t,r){"use strict";var n=r(20),i=r(224),o=r(225);e.exports=function(e){for(var t,r=0,s="";!t;)s+=o(i,n.get(),1),t=e<Math.pow(16,r+1),r++;return s}},function(e,t,r){"use strict";var n="object"==typeof window&&(window.crypto||window.msCrypto);e.exports=n&&n.getRandomValues?function(e){return n.getRandomValues(new Uint8Array(e))}:function(e){for(var t=[],r=0;r<e;r++)t.push(Math.floor(256*Math.random()));return t}},function(e,t){e.exports=function(e,t,r){for(var n=(2<<Math.log(t.length-1)/Math.LN2)-1,i=Math.ceil(1.6*n*r/t.length),o="";;)for(var s=i,a=e(s);s--;)if((o+=t[a[s]&n]||"").length===+r)return o}},function(e,t,r){"use strict";var n=r(20);e.exports=function(e){return!!e&&"string"==typeof e&&!(e.length<6)&&!RegExp("[^"+n.get().replace(/[|\\{}()[\]^$+*?.-]/g,"\\$&")+"]").test(e)}},function(e,t,r){"use strict";e.exports=0},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={id:"w:id",name:"w:name"}}}t.BookmarkStartAttributes=i;class o extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={id:"w:id"}}}t.BookmarkEndAttributes=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlComponent{constructor(e){super("w:outlineLvl"),this.level=e,this.root.push(new n.Attributes({val:e}))}}t.OutlineLevel=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlComponent{constructor(){super("w:bidi")}}t.Bidirectional=i},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(232)),n(r(233)),n(r(235)),n(r(2)),n(r(240)),n(r(249)),n(r(250)),n(r(253)),n(r(255))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlComponent{constructor(e){for(let t of(super("m:oMath"),e.children))this.root.push(t)}}t.Math=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(234);class o extends n.XmlComponent{constructor(e){super("m:r"),this.root.push(new i.MathText(e))}}t.MathRun=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlComponent{constructor(e){super("m:t"),this.root.push(e)}}t.MathText=i},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(236)),n(r(87)),n(r(88))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(87),o=r(88);class s extends n.XmlComponent{constructor(e){super("m:f"),this.root.push(new o.MathNumerator(e.numerator)),this.root.push(new i.MathDenominator(e.denominator))}}t.MathFraction=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={hide:"m:val"}}}class o extends n.XmlComponent{constructor(){super("m:subHide"),this.root.push(new i({hide:1}))}}t.MathSubScriptHide=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={hide:"m:val"}}}class o extends n.XmlComponent{constructor(){super("m:supHide"),this.root.push(new i({hide:1}))}}t.MathSuperScriptHide=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(90),o=r(92),s=r(93),a=r(94);class l extends n.XmlComponent{constructor(e){super("m:nary"),this.root.push(new o.MathNArayProperties("",!!e.superScript,!!e.subScript)),e.subScript&&this.root.push(new s.MathSubScriptElement(e.subScript)),e.superScript&&this.root.push(new a.MathSuperScriptElement(e.superScript)),this.root.push(new i.MathBase(e.children))}}t.MathSum=l},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(241)),n(r(243)),n(r(245)),n(r(247))},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(242)),n(r(95))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(2),o=r(95);class s extends n.XmlComponent{constructor(e){super("m:sSup"),this.root.push(new o.MathSuperScriptProperties),this.root.push(new i.MathBase(e.children)),this.root.push(new i.MathSuperScriptElement(e.superScript))}}t.MathSuperScript=s},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(244)),n(r(96))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(2),o=r(96);class s extends n.XmlComponent{constructor(e){super("m:sSub"),this.root.push(new o.MathSubScriptProperties),this.root.push(new i.MathBase(e.children)),this.root.push(new i.MathSubScriptElement(e.subScript))}}t.MathSubScript=s},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(246)),n(r(97))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(2),o=r(97);class s extends n.XmlComponent{constructor(e){super("m:sSubSup"),this.root.push(new o.MathSubSuperScriptProperties),this.root.push(new i.MathBase(e.children)),this.root.push(new i.MathSubScriptElement(e.subScript)),this.root.push(new i.MathSuperScriptElement(e.superScript))}}t.MathSubSuperScript=s},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(248)),n(r(98))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(2),o=r(98);class s extends n.XmlComponent{constructor(e){super("m:sPre"),this.root.push(new o.MathPreSubSuperScriptProperties),this.root.push(new i.MathBase(e.children)),this.root.push(new i.MathSubScriptElement(e.subScript)),this.root.push(new i.MathSuperScriptElement(e.superScript))}}t.MathPreSubSuperScript=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WORKAROUND4=""},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(99)),n(r(251)),n(r(100))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(2),o=r(99),s=r(100);class a extends n.XmlComponent{constructor(e){super("m:rad"),this.root.push(new s.MathRadicalProperties(!!e.degree)),this.root.push(new o.MathDegree(e.degree)),this.root.push(new i.MathBase(e.children))}}t.MathRadical=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={hide:"m:val"}}}class o extends n.XmlComponent{constructor(){super("m:degHide"),this.root.push(new i({hide:1}))}}t.MathDegreeHide=o},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(254)),n(r(101)),n(r(102))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(2),o=r(101),s=r(102);class a extends n.XmlComponent{constructor(e){super("m:func"),this.root.push(new s.MathFunctionProperties),this.root.push(new o.MathFunctionName(e.name)),this.root.push(new i.MathBase(e.children))}}t.MathFunction=a},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(256)),n(r(259)),n(r(260)),n(r(261))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(2),o=r(22);class s extends n.XmlComponent{constructor(e){super("m:d"),this.root.push(new o.MathBracketProperties),this.root.push(new i.MathBase(e.children))}}t.MathRoundBrackets=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={character:"m:val"}}}class o extends n.XmlComponent{constructor(e){super("m:begChr"),this.root.push(new i({character:e}))}}t.MathBeginningCharacter=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={character:"m:val"}}}class o extends n.XmlComponent{constructor(e){super("m:endChr"),this.root.push(new i({character:e}))}}t.MathEndingCharacter=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(2),o=r(22);class s extends n.XmlComponent{constructor(e){super("m:d"),this.root.push(new o.MathBracketProperties({beginningCharacter:"[",endingCharacter:"]"})),this.root.push(new i.MathBase(e.children))}}t.MathSquareBrackets=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(2),o=r(22);class s extends n.XmlComponent{constructor(e){super("m:d"),this.root.push(new o.MathBracketProperties({beginningCharacter:"{",endingCharacter:"}"})),this.root.push(new i.MathBase(e.children))}}t.MathCurlyBrackets=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(2),o=r(22);class s extends n.XmlComponent{constructor(e){super("m:d"),this.root.push(new o.MathBracketProperties({beginningCharacter:"",endingCharacter:""})),this.root.push(new i.MathBase(e.children))}}t.MathAngledBrackets=s},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(263)),n(r(10)),n(r(103)),n(r(39)),n(r(278))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(264),o=r(10),s=r(103);class a extends n.XmlComponent{constructor({rows:e,width:t,columnWidths:r=Array(Math.max(...e.map(e=>e.CellCount))).fill(100),margins:{marginUnitType:n,top:a,bottom:l,right:c,left:u}={marginUnitType:o.WidthType.AUTO,top:0,bottom:0,right:0,left:0},float:d,layout:h,borders:p,alignment:f}){for(let o of(super("w:tbl"),this.properties=new s.TableProperties,this.root.push(this.properties),p?this.properties.setBorder(p):this.properties.setBorder({}),t?this.properties.setWidth(t.size,t.type):this.properties.setWidth(100),this.properties.CellMargin.addBottomMargin(l||0,n),this.properties.CellMargin.addTopMargin(a||0,n),this.properties.CellMargin.addLeftMargin(u||0,n),this.properties.CellMargin.addRightMargin(c||0,n),this.root.push(new i.TableGrid(r)),e))this.root.push(o);e.forEach((t,r)=>{if(r===e.length-1)return;let n=0;t.cells.forEach(t=>{if(t.options.rowSpan&&t.options.rowSpan>1){let i=new o.TableCell({rowSpan:t.options.rowSpan-1,columnSpan:t.options.columnSpan,borders:t.options.borders,children:[],verticalMerge:o.VerticalMergeType.CONTINUE});e[r+1].addCellToColumnIndex(i,n)}n+=t.options.columnSpan||1})}),d&&this.properties.setTableFloatProperties(d),h&&this.properties.setLayout(h),f&&this.properties.setAlignment(f)}}t.Table=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlComponent{constructor(e){for(let t of(super("w:tblGrid"),e))this.root.push(new s(t))}}t.TableGrid=i;class o extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={w:"w:w"}}}class s extends n.XmlComponent{constructor(e){super("w:gridCol"),void 0!==e&&this.root.push(new o({w:e}))}}t.GridCol=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(1),i=r(0),o=r(38),s=r(266);class a extends i.XmlComponent{constructor(e){for(let t of(super("w:tc"),this.options=e,this.properties=new s.TableCellProperties,this.root.push(this.properties),e.children))this.root.push(t);e.verticalAlign&&this.properties.setVerticalAlign(e.verticalAlign),e.textDirection&&this.properties.setTextDirection(e.textDirection),e.verticalMerge?this.properties.addVerticalMerge(e.verticalMerge):e.rowSpan&&e.rowSpan>1&&this.properties.addVerticalMerge(o.VerticalMergeType.RESTART),e.margins&&this.properties.addMargins(e.margins),e.shading&&this.properties.setShading(e.shading),e.columnSpan&&this.properties.addGridSpan(e.columnSpan),e.width&&this.properties.setWidth(e.width.size,e.width.type),e.borders&&(e.borders.top&&this.properties.Borders.addTopBorder(e.borders.top.style,e.borders.top.size,e.borders.top.color),e.borders.bottom&&this.properties.Borders.addBottomBorder(e.borders.bottom.style,e.borders.bottom.size,e.borders.bottom.color),e.borders.left&&this.properties.Borders.addLeftBorder(e.borders.left.style,e.borders.left.size,e.borders.left.color),e.borders.right&&this.properties.Borders.addRightBorder(e.borders.right.style,e.borders.right.size,e.borders.right.color))}prepForXml(e){return this.root[this.root.length-1]instanceof n.Paragraph||this.root.push(new n.Paragraph({})),super.prepForXml(e)}}t.TableCell=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(39),o=r(268),s=r(38);class a extends n.IgnoreIfEmptyXmlComponent{constructor(){super("w:tcPr"),this.cellBorder=new s.TableCellBorders,this.root.push(this.cellBorder)}get Borders(){return this.cellBorder}addGridSpan(e){return this.root.push(new s.GridSpan(e)),this}addVerticalMerge(e){return this.root.push(new s.VerticalMerge(e)),this}setVerticalAlign(e){return this.root.push(new s.VAlign(e)),this}setWidth(e,t=s.WidthType.AUTO){return this.root.push(new s.TableCellWidth(e,t)),this}setShading(e){return this.root.push(new i.TableShading(e)),this}addMargins(e){return this.root.push(new o.TableCellMargin(e)),this}setTextDirection(e){return this.root.push(new s.TDirection(e)),this}}t.TableCellProperties=a},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0});let i=r(0);class o extends i.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={fill:"w:fill",color:"w:color",val:"w:val"}}}class s extends i.XmlComponent{constructor(e){super("w:shd"),this.root.push(new o(e))}}t.TableShading=s,(n=t.ShadingType||(t.ShadingType={})).CLEAR="clear",n.DIAGONAL_CROSS="diagCross",n.DIAGONAL_STRIPE="diagStripe",n.HORIZONTAL_CROSS="horzCross",n.HORIZONTAL_STRIPE="horzStripe",n.NIL="nil",n.PERCENT_5="pct5",n.PERCENT_10="pct10",n.PERCENT_12="pct12",n.PERCENT_15="pct15",n.PERCENT_20="pct20",n.PERCENT_25="pct25",n.PERCENT_30="pct30",n.PERCENT_35="pct35",n.PERCENT_37="pct37",n.PERCENT_40="pct40",n.PERCENT_45="pct45",n.PERCENT_50="pct50",n.PERCENT_55="pct55",n.PERCENT_60="pct60",n.PERCENT_62="pct62",n.PERCENT_65="pct65",n.PERCENT_70="pct70",n.PERCENT_75="pct75",n.PERCENT_80="pct80",n.PERCENT_85="pct85",n.PERCENT_87="pct87",n.PERCENT_90="pct90",n.PERCENT_95="pct95",n.REVERSE_DIAGONAL_STRIPE="reverseDiagStripe",n.SOLID="solid",n.THIN_DIAGONAL_CROSS="thinDiagCross",n.THIN_DIAGONAL_STRIPE="thinDiagStripe",n.THIN_HORIZONTAL_CROSS="thinHorzCross",n.THIN_REVERSE_DIAGONAL_STRIPE="thinReverseDiagStripe",n.THIN_VERTICAL_STRIPE="thinVertStripe",n.VERTICAL_STRIPE="vertStripe"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(269);class o extends n.XmlComponent{constructor({top:e=0,left:t=0,right:r=0,bottom:n=0}){super("w:tcMar"),this.root.push(new i.TopCellMargin(e)),this.root.push(new i.BottomCellMargin(n)),this.root.push(new i.RightCellMargin(r)),this.root.push(new i.LeftCellMargin(t))}}t.TableCellMargin=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={width:"w:w",type:"w:type"}}}class o extends n.XmlComponent{constructor(e){super("w:top"),this.root.push(new i({width:e,type:"dxa"}))}}t.TopCellMargin=o;class s extends n.XmlComponent{constructor(e){super("w:bottom"),this.root.push(new i({width:e,type:"dxa"}))}}t.BottomCellMargin=s;class a extends n.XmlComponent{constructor(e){super("w:start"),this.root.push(new i({width:e,type:"dxa"}))}}t.LeftCellMargin=a;class l extends n.XmlComponent{constructor(e){super("w:end"),this.root.push(new i({width:e,type:"dxa"}))}}t.RightCellMargin=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(1),o=r(39),s=r(10),a=r(104),l=r(276),c=r(109),u=r(111),d=r(277);class h extends n.IgnoreIfEmptyXmlComponent{constructor(){super("w:tblPr"),this.cellMargin=new l.TableCellMargin,this.root.push(this.cellMargin)}setWidth(e,t=s.WidthType.AUTO){return this.root.push(new d.PreferredTableWidth(t,e)),this}setLayout(e){this.root.push(new u.TableLayout(e))}setBorder(e){return this.root.push(new a.TableBorders(e)),this}get CellMargin(){return this.cellMargin}setTableFloatProperties(e){return this.root.push(new c.TableFloatProperties(e)),this}setShading(e){return this.root.push(new o.TableShading(e)),this}setAlignment(e){this.root.push(new i.Alignment(e))}}t.TableProperties=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(105);var o=r(273);for(var s in o)t.hasOwnProperty(s)||(t[s]=o[s]);class a extends n.XmlComponent{constructor(e){if(super("w:styles"),e.initialStyles&&this.root.push(e.initialStyles),e.importedStyles)for(let t of e.importedStyles)this.root.push(t);if(e.paragraphStyles)for(let t of e.paragraphStyles)this.root.push(new i.StyleForParagraph(t));if(e.characterStyles)for(let t of e.characterStyles)this.root.push(new i.StyleForCharacter(t))}}t.Styles=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(19),i=r(43),o=r(42);class s extends o.StyleForParagraph{constructor(e){super(Object.assign({},e,{basedOn:"Normal",next:"Normal",quickFormat:!0}))}}t.HeadingStyle=s,t.TitleStyle=class extends s{constructor(e){super(Object.assign({},e,{id:"Title",name:"Title"}))}},t.Heading1Style=class extends s{constructor(e){super(Object.assign({},e,{id:"Heading1",name:"Heading 1"}))}},t.Heading2Style=class extends s{constructor(e){super(Object.assign({},e,{id:"Heading2",name:"Heading 2"}))}},t.Heading3Style=class extends s{constructor(e){super(Object.assign({},e,{id:"Heading3",name:"Heading 3"}))}},t.Heading4Style=class extends s{constructor(e){super(Object.assign({},e,{id:"Heading4",name:"Heading 4"}))}},t.Heading5Style=class extends s{constructor(e){super(Object.assign({},e,{id:"Heading5",name:"Heading 5"}))}},t.Heading6Style=class extends s{constructor(e){super(Object.assign({},e,{id:"Heading6",name:"Heading 6"}))}},t.StrongStyle=class extends s{constructor(e){super(Object.assign({},e,{id:"Strong",name:"Strong"}))}};class a extends o.StyleForParagraph{constructor(e){super(Object.assign({},e,{id:"ListParagraph",name:"List Paragraph",basedOn:"Normal",quickFormat:!0}))}}t.ListParagraph=a;class l extends o.StyleForParagraph{constructor(e){super(Object.assign({},e,{id:"FootnoteText",name:"footnote text",link:"FootnoteTextChar",basedOn:"Normal",uiPriority:99,semiHidden:!0,unhideWhenUsed:!0,paragraph:{spacing:{after:0,line:240,lineRule:"auto"}},run:{size:20}}))}}t.FootnoteText=l;class c extends i.StyleForCharacter{constructor(e){super(Object.assign({},e,{id:"FootnoteReference",name:"footnote reference",basedOn:"DefaultParagraphFont",semiHidden:!0,run:{superScript:!0}}))}}t.FootnoteReferenceStyle=c;class u extends i.StyleForCharacter{constructor(e){super(Object.assign({},e,{id:"FootnoteTextChar",name:"Footnote Text Char",basedOn:"DefaultParagraphFont",link:"FootnoteText",semiHidden:!0,run:{size:20}}))}}t.FootnoteTextChar=u;class d extends i.StyleForCharacter{constructor(e){super(Object.assign({},e,{id:"Hyperlink",name:"Hyperlink",basedOn:"DefaultParagraphFont",run:{color:"0563C1",underline:{type:n.UnderlineType.SINGLE}}}))}}t.HyperlinkStyle=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(274);for(var i in n)t.hasOwnProperty(i)||(t[i]=n[i])},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),(n=t.BorderStyle||(t.BorderStyle={})).SINGLE="single",n.DASH_DOT_STROKED="dashDotStroked",n.DASHED="dashed",n.DASH_SMALL_GAP="dashSmallGap",n.DOT_DASH="dotDash",n.DOT_DOT_DASH="dotDotDash",n.DOTTED="dotted",n.DOUBLE="double",n.DOUBLE_WAVE="doubleWave",n.INSET="inset",n.NIL="nil",n.NONE="none",n.OUTSET="outset",n.THICK="thick",n.THICK_THIN_LARGE_GAP="thickThinLargeGap",n.THICK_THIN_MEDIUM_GAP="thickThinMediumGap",n.THICK_THIN_SMALL_GAP="thickThinSmallGap",n.THIN_THICK_LARGE_GAP="thinThickLargeGap",n.THIN_THICK_MEDIUM_GAP="thinThickMediumGap",n.THIN_THICK_SMALL_GAP="thinThickSmallGap",n.THIN_THICK_THIN_LARGE_GAP="thinThickThinLargeGap",n.THIN_THICK_THIN_MEDIUM_GAP="thinThickThinMediumGap",n.THIN_THICK_THIN_SMALL_GAP="thinThickThinSmallGap",n.THREE_D_EMBOSS="threeDEmboss",n.THREE_D_ENGRAVE="threeDEngrave",n.TRIPLE="triple",n.WAVE="wave"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(107),o=r(108);class s extends n.XmlComponent{constructor(e){super("w:docDefaults"),this.runPropertiesDefaults=new o.RunPropertiesDefaults(e&&e.run),this.paragraphPropertiesDefaults=new i.ParagraphPropertiesDefaults(e&&e.paragraph),this.root.push(this.runPropertiesDefaults),this.root.push(this.paragraphPropertiesDefaults)}}t.DocumentDefaults=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(10);class o extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={value:"w:w",type:"w:type"}}}class s extends n.XmlComponent{setProperties(e,t=i.WidthType.DXA){this.root.push(new o({type:t,value:e}))}}class a extends n.IgnoreIfEmptyXmlComponent{constructor(){super("w:tblCellMar")}addTopMargin(e,t=i.WidthType.DXA){let r=new s("w:top");r.setProperties(e,t),this.root.push(r)}addLeftMargin(e,t=i.WidthType.DXA){let r=new s("w:left");r.setProperties(e,t),this.root.push(r)}addBottomMargin(e,t=i.WidthType.DXA){let r=new s("w:bottom");r.setProperties(e,t),this.root.push(r)}addRightMargin(e,t=i.WidthType.DXA){let r=new s("w:right");r.setProperties(e,t),this.root.push(r)}}t.TableCellMargin=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(10);class o extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={type:"w:type",w:"w:w"}}}class s extends n.XmlComponent{constructor(e,t){super("w:tblW");let r=e===i.WidthType.PERCENTAGE?`${t}%`:t;this.root.push(new o({type:e,w:r}))}}t.PreferredTableWidth=s},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(279)),n(r(112)),n(r(113))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(10),o=r(112);class s extends n.XmlComponent{constructor(e){for(let t of(super("w:tr"),this.options=e,this.properties=new o.TableRowProperties,this.root.push(this.properties),e.children))this.root.push(t);e.cantSplit&&this.properties.setCantSplit(),e.tableHeader&&this.properties.setTableHeader(),e.height&&this.properties.setHeight(e.height.height,e.height.rule)}get CellCount(){return this.options.children.length}get Children(){return this.options.children}get cells(){return this.root.filter(e=>e instanceof i.TableCell)}addCellToIndex(e,t){this.root.splice(t+1,0,e)}addCellToColumnIndex(e,t){let r=this.columnIndexToRootIndex(t,!0);this.addCellToIndex(e,r-1)}rootIndexToColumnIndex(e){if(e<1||e>=this.root.length)throw Error(`cell 'rootIndex' should between 1 to ${this.root.length-1}`);let t=0;for(let r=1;r<e;r++)t+=this.root[r].options.columnSpan||1;return t}columnIndexToRootIndex(e,t=!1){if(e<0)throw Error("cell 'columnIndex' should not less than zero");let r=0,n=1;for(;r<=e;){if(n>=this.root.length)if(t)return this.root.length;else throw Error(`cell 'columnIndex' should not great than ${r-1}`);let e=this.root[n];n+=1,r+=e&&e.options.columnSpan||1}return n-1}}t.TableRow=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(86),i=r(281),o=r(283),s=r(289),a=r(114),l=r(129),c=r(46),u=r(131),d=r(132),h=r(49),p=r(50),f=r(133),g=r(1),b=r(47),v=r(48),y=r(332),w=r(23),x=r(337),E=r(338);t.File=class{constructor(e={creator:"Un-named",revision:"1",lastModifiedBy:"Un-named"},t={},r=[]){if(this.currentRelationshipId=1,this.headers=[],this.footers=[],this.hyperlinkCache={},this.coreProperties=new s.CoreProperties(e),this.numbering=new f.Numbering(e.numbering?e.numbering:{config:[]}),this.docRelationships=new b.Relationships,this.fileRelationships=new b.Relationships,this.appProperties=new i.AppProperties,this.footNotes=new u.FootNotes,this.contentTypes=new o.ContentTypes,this.document=new a.Document({background:e.background||{}}),this.settings=new y.Settings,this.media=t.template&&t.template.media?t.template.media:new p.Media,t.template&&(this.currentRelationshipId=t.template.currentRelationshipId+1),t.template&&e.externalStyles)throw Error("can not use both template and external styles");if(t.template){let e=new x.ExternalStylesFactory;this.styles=e.newInstance(t.template.styles)}else if(e.externalStyles){let t=new x.ExternalStylesFactory;this.styles=t.newInstance(e.externalStyles)}else if(e.styles){let t=new E.DefaultStylesFactory().newInstance(e.styles.default);this.styles=new w.Styles(Object.assign({},t,e.styles))}else{let e=new E.DefaultStylesFactory;this.styles=new w.Styles(e.newInstance())}if(this.addDefaultRelationships(),t.template&&t.template.headers)for(let e of t.template.headers)this.addHeaderToDocument(e.header,e.type);if(t.template&&t.template.footers)for(let e of t.template.footers)this.addFooterToDocument(e.footer,e.type);for(let e of r)for(let t of(this.document.Body.addSection(e.properties?e.properties:{}),e.children)){if(t instanceof g.HyperlinkRef){let e=this.hyperlinkCache[t.id];this.document.add(e);continue}this.document.add(t)}if(e.footnotes)for(let t of e.footnotes)this.footNotes.createFootNote(t);if(e.hyperlinks){let t={};for(let r in e.hyperlinks){if(!e.hyperlinks[r])continue;let n=e.hyperlinks[r],i=n.type===g.HyperlinkType.EXTERNAL?this.createHyperlink(n.link,n.text):this.createInternalHyperLink(r,n.text);t[r]=i}this.hyperlinkCache=t}e.features&&e.features.trackRevisions&&this.settings.addTrackRevisions()}addSection({headers:e={default:new d.Header},footers:t={default:new d.Header},margins:r={},size:n={},properties:i,children:o}){for(let s of(this.document.Body.addSection(Object.assign({},i,{headers:{default:e.default?this.createHeader(e.default):this.createHeader(new d.Header),first:e.first?this.createHeader(e.first):void 0,even:e.even?this.createHeader(e.even):void 0},footers:{default:t.default?this.createFooter(t.default):this.createFooter(new d.Footer),first:t.first?this.createFooter(t.first):void 0,even:t.even?this.createFooter(t.even):void 0}},r,n)),o)){if(s instanceof g.HyperlinkRef){let e=this.hyperlinkCache[s.id];this.document.add(e);continue}this.document.add(s)}}verifyUpdateFields(){this.document.getTablesOfContents().length&&this.settings.addUpdateFields()}createHyperlink(e,t=e){let r=new g.Hyperlink(t,n.generate().toLowerCase());return this.docRelationships.createRelationship(r.linkId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",e,v.TargetModeType.EXTERNAL),r}createInternalHyperLink(e,t=e){return new g.Hyperlink(t,n.generate().toLowerCase(),e)}createHeader(e){let t=new h.HeaderWrapper(this.media,this.currentRelationshipId++);for(let r of e.options.children)t.add(r);return this.addHeaderToDocument(t),t}createFooter(e){let t=new c.FooterWrapper(this.media,this.currentRelationshipId++);for(let r of e.options.children)t.add(r);return this.addFooterToDocument(t),t}addHeaderToDocument(e,t=l.HeaderReferenceType.DEFAULT){this.headers.push({header:e,type:t}),this.docRelationships.createRelationship(e.Header.ReferenceId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/header",`header${this.headers.length}.xml`),this.contentTypes.addHeader(this.headers.length)}addFooterToDocument(e,t=l.FooterReferenceType.DEFAULT){this.footers.push({footer:e,type:t}),this.docRelationships.createRelationship(e.Footer.ReferenceId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer",`footer${this.footers.length}.xml`),this.contentTypes.addFooter(this.footers.length)}addDefaultRelationships(){this.fileRelationships.createRelationship(1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument","word/document.xml"),this.fileRelationships.createRelationship(2,"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties","docProps/core.xml"),this.fileRelationships.createRelationship(3,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties","docProps/app.xml"),this.docRelationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles","styles.xml"),this.docRelationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering","numbering.xml"),this.docRelationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes","footnotes.xml"),this.docRelationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings","settings.xml")}get Document(){return this.document}get Styles(){return this.styles}get CoreProperties(){return this.coreProperties}get Numbering(){return this.numbering}get Media(){return this.media}get DocumentRelationships(){return this.docRelationships}get FileRelationships(){return this.fileRelationships}get Headers(){return this.headers.map(e=>e.header)}get Footers(){return this.footers.map(e=>e.footer)}get ContentTypes(){return this.contentTypes}get AppProperties(){return this.appProperties}get FootNotes(){return this.footNotes}get Settings(){return this.settings}get HyperlinkCache(){return this.hyperlinkCache}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(282);class o extends n.XmlComponent{constructor(){super("Properties"),this.root.push(new i.AppPropertiesAttributes({xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"}))}}t.AppProperties=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={xmlns:"xmlns",vt:"xmlns:vt"}}}t.AppPropertiesAttributes=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(284),o=r(285),s=r(287);class a extends n.XmlComponent{constructor(){super("Types"),this.root.push(new i.ContentTypeAttributes({xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"})),this.root.push(new o.Default("image/png","png")),this.root.push(new o.Default("image/jpeg","jpeg")),this.root.push(new o.Default("image/jpeg","jpg")),this.root.push(new o.Default("image/bmp","bmp")),this.root.push(new o.Default("image/gif","gif")),this.root.push(new o.Default("application/vnd.openxmlformats-package.relationships+xml","rels")),this.root.push(new o.Default("application/xml","xml")),this.root.push(new s.Override("application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml","/word/document.xml")),this.root.push(new s.Override("application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml","/word/styles.xml")),this.root.push(new s.Override("application/vnd.openxmlformats-package.core-properties+xml","/docProps/core.xml")),this.root.push(new s.Override("application/vnd.openxmlformats-officedocument.extended-properties+xml","/docProps/app.xml")),this.root.push(new s.Override("application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml","/word/numbering.xml")),this.root.push(new s.Override("application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml","/word/footnotes.xml")),this.root.push(new s.Override("application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml","/word/settings.xml"))}addFooter(e){this.root.push(new s.Override("application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml",`/word/footer${e}.xml`))}addHeader(e){this.root.push(new s.Override("application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml",`/word/header${e}.xml`))}}t.ContentTypes=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={xmlns:"xmlns"}}}t.ContentTypeAttributes=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(286);class o extends n.XmlComponent{constructor(e,t){super("Default"),this.root.push(new i.DefaultAttributes({contentType:e,extension:t}))}}t.Default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={contentType:"ContentType",extension:"Extension"}}}t.DefaultAttributes=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(288);class o extends n.XmlComponent{constructor(e,t){super("Override"),this.root.push(new i.OverrideAttributes({contentType:e,partName:t}))}}t.Override=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={contentType:"ContentType",partName:"PartName"}}}t.OverrideAttributes=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(290);for(var i in n)t.hasOwnProperty(i)||(t[i]=n[i])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(11),o=r(291);class s extends n.XmlComponent{constructor(e){super("cp:coreProperties"),this.root.push(new i.DocumentAttributes({cp:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",xsi:"http://www.w3.org/2001/XMLSchema-instance"})),e.title&&this.root.push(new o.Title(e.title)),e.subject&&this.root.push(new o.Subject(e.subject)),e.creator&&this.root.push(new o.Creator(e.creator)),e.keywords&&this.root.push(new o.Keywords(e.keywords)),e.description&&this.root.push(new o.Description(e.description)),e.lastModifiedBy&&this.root.push(new o.LastModifiedBy(e.lastModifiedBy)),e.revision&&this.root.push(new o.Revision(e.revision)),this.root.push(new o.Created),this.root.push(new o.Modified)}}t.CoreProperties=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(11);class o extends n.XmlComponent{constructor(e){super("dc:title"),this.root.push(e)}}t.Title=o;class s extends n.XmlComponent{constructor(e){super("dc:subject"),this.root.push(e)}}t.Subject=s;class a extends n.XmlComponent{constructor(e){super("dc:creator"),this.root.push(e)}}t.Creator=a;class l extends n.XmlComponent{constructor(e){super("cp:keywords"),this.root.push(e)}}t.Keywords=l;class c extends n.XmlComponent{constructor(e){super("dc:description"),this.root.push(e)}}t.Description=c;class u extends n.XmlComponent{constructor(e){super("cp:lastModifiedBy"),this.root.push(e)}}t.LastModifiedBy=u;class d extends n.XmlComponent{constructor(e){super("cp:revision"),this.root.push(e)}}t.Revision=d;class h extends n.XmlComponent{getCurrentDate(){let e=new Date,t=e.getFullYear(),r=("0"+(e.getMonth()+1)).slice(-2),n=("0"+e.getDate()).slice(-2),i=("0"+e.getHours()).slice(-2);return t+"-"+r+"-"+n+"T"+i+":"+("0"+e.getMinutes()).slice(-2)+":"+("0"+e.getSeconds()).slice(-2)+"Z"}}t.DateComponent=h,t.Created=class extends h{constructor(){super("dcterms:created"),this.root.push(new i.DocumentAttributes({type:"dcterms:W3CDTF"})),this.root.push(this.getCurrentDate())}},t.Modified=class extends h{constructor(){super("dcterms:modified"),this.root.push(new i.DocumentAttributes({type:"dcterms:W3CDTF"})),this.root.push(this.getCurrentDate())}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(115),o=r(11),s=r(130);class a extends n.XmlComponent{constructor(e){super("w:document"),this.root.push(new o.DocumentAttributes({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"})),this.body=new i.Body,this.root.push(new s.DocumentBackground(e.background)),this.root.push(this.body)}add(e){return this.body.push(e),this}get Body(){return this.body}getTablesOfContents(){return this.body.getTablesOfContents()}}t.Document=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(12),o=r(116);class s extends n.XmlComponent{constructor(){super("w:body"),this.sections=[]}addSection(e){let t=this.sections.pop();this.root.push(this.createSectionParagraph(t)),this.sections.push(new o.SectionProperties(e))}prepForXml(e){return 1===this.sections.length&&(this.root.splice(0,1),this.root.push(this.sections.pop())),super.prepForXml(e)}push(e){this.root.push(e)}getTablesOfContents(){return this.root.filter(e=>e instanceof i.TableOfContents)}createSectionParagraph(e){let t=new i.Paragraph({}),r=new i.ParagraphProperties({});return r.push(e),t.addChildElement(r),t}}t.Body=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(295);class o extends n.XmlComponent{constructor(e,t){super("w:cols"),this.root.push(new i.ColumnsAttributes({space:e,num:t}))}}t.Columns=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={space:"w:space",num:"w:num"}}}t.ColumnsAttributes=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(297);class o extends n.XmlComponent{constructor(e){super("w:docGrid"),this.root.push(new i.DocGridAttributes({linePitch:e}))}}t.DocumentGrid=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={linePitch:"w:linePitch"}}}t.DocGridAttributes=i},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0});let i=r(0);(n=t.LineNumberRestartFormat||(t.LineNumberRestartFormat={})).CONTINUOUS="continuous",n.NEW_SECTION="newSection",n.NEW_PAGE="newPage";class o extends i.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={lineNumberCountBy:"w:countBy",lineNumberStart:"w:start",lineNumberRestart:"w:restart",lineNumberDistance:"w:distance"}}}t.LineNumberAttributes=o;class s extends i.XmlComponent{constructor(e,t,r,n){super("w:lnNumType"),this.root.push(new o({lineNumberCountBy:e,lineNumberStart:t,lineNumberRestart:r,lineNumberDistance:n}))}}t.LineNumberType=s},function(e,t,r){"use strict";var n,i,o;Object.defineProperty(t,"__esModule",{value:!0});let s=r(0);(n=t.PageBorderDisplay||(t.PageBorderDisplay={})).ALL_PAGES="allPages",n.FIRST_PAGE="firstPage",n.NOT_FIRST_PAGE="notFirstPage",(i=t.PageBorderOffsetFrom||(t.PageBorderOffsetFrom={})).PAGE="page",i.TEXT="text",(o=t.PageBorderZOrder||(t.PageBorderZOrder={})).BACK="back",o.FRONT="front";class a extends s.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={style:"w:val",size:"w:size",color:"w:color",space:"w:space"}}}class l extends s.XmlComponent{constructor(e,t){super(e),this.root.push(new a(t))}}class c extends s.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={display:"w:display",offsetFrom:"w:offsetFrom",zOrder:"w:zOrder"}}}class u extends s.IgnoreIfEmptyXmlComponent{constructor(e){if(super("w:pgBorders"),!e)return;let t={};e.pageBorders&&(t={display:e.pageBorders.display,offsetFrom:e.pageBorders.offsetFrom,zOrder:e.pageBorders.zOrder}),this.root.push(new c(t)),e.pageBorderTop&&this.root.push(new l("w:top",e.pageBorderTop)),e.pageBorderRight&&this.root.push(new l("w:right",e.pageBorderRight)),e.pageBorderBottom&&this.root.push(new l("w:bottom",e.pageBorderBottom)),e.pageBorderLeft&&this.root.push(new l("w:left",e.pageBorderLeft))}}t.PageBorders=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(301);class o extends n.XmlComponent{constructor(e,t,r,n,o,s,a,l){super("w:pgMar"),this.root.push(new i.PageMarginAttributes({top:e,right:t,bottom:r,left:n,header:o,footer:s,gutter:a,mirror:l}))}}t.PageMargin=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={top:"w:top",right:"w:right",bottom:"w:bottom",left:"w:left",header:"w:header",footer:"w:footer",gutter:"w:gutter",mirror:"w:mirrorMargins"}}}t.PageMarginAttributes=i},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0});let i=r(0);(n=t.PageNumberFormat||(t.PageNumberFormat={})).CARDINAL_TEXT="cardinalText",n.DECIMAL="decimal",n.DECIMAL_ENCLOSED_CIRCLE="decimalEnclosedCircle",n.DECIMAL_ENCLOSED_FULL_STOP="decimalEnclosedFullstop",n.DECIMAL_ENCLOSED_PAREN="decimalEnclosedParen",n.DECIMAL_ZERO="decimalZero",n.LOWER_LETTER="lowerLetter",n.LOWER_ROMAN="lowerRoman",n.NONE="none",n.ORDINAL_TEXT="ordinalText",n.UPPER_LETTER="upperLetter",n.UPPER_ROMAN="upperRoman",n.DECIMAL_FULL_WIDTH="decimalFullWidth";class o extends i.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={pageNumberStart:"w:start",pageNumberFormatType:"w:fmt"}}}t.PageNumberTypeAttributes=o;class s extends i.XmlComponent{constructor(e,t){super("w:pgNumType"),this.root.push(new o({pageNumberStart:e,pageNumberFormatType:t}))}}t.PageNumberType=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(304);class o extends n.XmlComponent{constructor(){super("w:titlePg"),this.root.push(new i.TitlePageAttributes({value:"1"}))}}t.TitlePage=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={value:"w:val"}}}t.TitlePageAttributes=i},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0});let i=r(0),o=r(128);(n=t.SectionVerticalAlignValue||(t.SectionVerticalAlignValue={})).BOTH="both",n.BOTTOM="bottom",n.CENTER="center",n.TOP="top";class s extends i.XmlComponent{constructor(e){super("w:vAlign"),this.root.push(new o.SectionVerticalAlignAttributes({verticalAlign:e}))}}t.SectionVerticalAlign=s},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(126)),n(r(45))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={color:"w:color",themeColor:"w:themeColor",themeShade:"w:themeShade",themeTint:"w:themeTint"}}}t.DocumentBackgroundAttributes=i;class o extends n.XmlComponent{constructor(e){super("w:background"),this.root.push(new i({color:e.color?e.color:"FFFFFF",themeColor:e.themeColor,themeShade:e.themeShade,themeTint:e.themeTint}))}}t.DocumentBackground=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(309);class o extends n.InitializableXmlComponent{constructor(e,t){super("w:ftr",t),this.refId=e,t||this.root.push(new i.FooterAttributes({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape"}))}get ReferenceId(){return this.refId}add(e){this.root.push(e)}}t.Footer=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type"}}}t.FooterAttributes=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(311),o=r(48);class s extends n.XmlComponent{constructor(){super("Relationships"),this.root.push(new i.RelationshipsAttributes({xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"}))}addRelationship(e){this.root.push(e)}createRelationship(e,t,r,n){let i=new o.Relationship(`rId${e}`,t,r,n);return this.addRelationship(i),i}get RelationshipCount(){return this.root.length-1}}t.Relationships=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={xmlns:"xmlns"}}}t.RelationshipsAttributes=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={id:"Id",type:"Type",target:"Target",targetMode:"TargetMode"}}}t.RelationshipAttributes=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(1),o=r(314),s=r(318),a=r(320),l=r(322);class c extends n.XmlComponent{constructor(){super("w:footnotes"),this.currentId=1,this.root.push(new l.FootnotesAttributes({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"}));let e=new o.Footnote(-1,o.FootnoteType.SEPERATOR);e.add(new i.Paragraph({spacing:{after:0,line:240,lineRule:"auto"},children:[new a.SeperatorRun]})),this.root.push(e);let t=new o.Footnote(0,o.FootnoteType.CONTINUATION_SEPERATOR);t.add(new i.Paragraph({spacing:{after:0,line:240,lineRule:"auto"},children:[new s.ContinuationSeperatorRun]})),this.root.push(t)}createFootNote(e){let t=new o.Footnote(this.currentId);t.add(e),this.root.push(t),this.currentId++}}t.FootNotes=c},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0});let i=r(0),o=r(315),s=r(316);(n=t.FootnoteType||(t.FootnoteType={})).SEPERATOR="separator",n.CONTINUATION_SEPERATOR="continuationSeparator";class a extends i.XmlComponent{constructor(e,t){super("w:footnote"),this.root.push(new o.FootnoteAttributes({type:t,id:e}))}add(e){e.addRunToFront(new s.FootnoteRefRun),this.root.push(e)}}t.Footnote=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={type:"w:type",id:"w:id"}}}t.FootnoteAttributes=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(1),i=r(317);class o extends n.Run{constructor(){super({style:"FootnoteReference"}),this.root.push(new i.FootnoteRef)}}t.FootnoteRefRun=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlComponent{constructor(){super("w:footnoteRef")}}t.FootnoteRef=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(1),i=r(319);class o extends n.Run{constructor(){super({}),this.root.push(new i.ContinuationSeperator)}}t.ContinuationSeperatorRun=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlComponent{constructor(){super("w:continuationSeparator")}}t.ContinuationSeperator=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(1),i=r(321);class o extends n.Run{constructor(){super({}),this.root.push(new i.Seperator)}}t.SeperatorRun=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlComponent{constructor(){super("w:separator")}}t.Seperator=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable"}}}t.FootnotesAttributes=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(324);for(var i in n)t.hasOwnProperty(i)||(t[i]=n[i])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(325);for(var i in n)t.hasOwnProperty(i)||(t[i]=n[i])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(3),i=r(70),o=r(0);class s extends o.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={id:"w:id"}}}t.FootNoteReferenceRunAttributes=s;class a extends o.XmlComponent{constructor(e){super("w:footnoteReference"),this.root.push(new s({id:e}))}}t.FootnoteReference=a;class l extends n.Run{constructor(e){super({}),this.properties.push(new i.Style("FootnoteReference")),this.root.push(new a(e))}}t.FootnoteReferenceRun=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(327);class o extends n.InitializableXmlComponent{constructor(e,t){super("w:hdr",t),this.refId=e,t||this.root.push(new i.HeaderAttributes({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",cx:"http://schemas.microsoft.com/office/drawing/2014/chartex",cx1:"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex",cx2:"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex",cx3:"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex",cx4:"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex",cx5:"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex",cx6:"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex",cx7:"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex",cx8:"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex",w16cid:"http://schemas.microsoft.com/office/word/2016/wordml/cid",w16se:"http://schemas.microsoft.com/office/word/2015/wordml/symex"}))}get ReferenceId(){return this.refId}add(e){this.root.push(e)}}t.Header=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type",cx:"xmlns:cx",cx1:"xmlns:cx1",cx2:"xmlns:cx2",cx3:"xmlns:cx3",cx4:"xmlns:cx4",cx5:"xmlns:cx5",cx6:"xmlns:cx6",cx7:"xmlns:cx7",cx8:"xmlns:cx8",w16cid:"xmlns:w16cid",w16se:"xmlns:w16se"}}}t.HeaderAttributes=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(1);class i{static addImage(e,t,r,i,o){let s=e.Media.addMedia(t,r,i);return new n.PictureRun(s,o)}static generateId(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}constructor(){this.map=new Map}getMedia(e){let t=this.map.get(e);if(void 0===t)throw Error(`Cannot find image with the key ${e}`);return t}addMedia(e,t=100,r=100){let n=`${i.generateId()}.png`;return this.createMedia(n,{width:t,height:r},e)}createMedia(e,t,r,n){let i={stream:"string"==typeof r?this.convertDataURIToBinary(r):r,path:n,fileName:e,dimensions:{pixels:{x:Math.round(t.width),y:Math.round(t.height)},emus:{x:Math.round(9525*t.width),y:Math.round(9525*t.height)}}};return this.map.set(e,i),i}get Array(){let e=[];return this.map.forEach(t=>{e.push(t)}),e}convertDataURIToBinary(e){let t=";base64,",n=e.indexOf(t)+t.length;return"function"==typeof atob?new Uint8Array(atob(e.substring(n)).split("").map(e=>e.charCodeAt(0))):new(r(6)).Buffer(e,"base64")}}t.Media=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WORKAROUND2=""},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(44),i=r(1),o=r(0),s=r(11),a=r(134),l=r(24),c=r(135);class u extends o.XmlComponent{constructor(e){super("w:numbering"),this.abstractNumbering=[],this.concreteNumbering=[],this.root.push(new s.DocumentAttributes({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"})),this.nextId=0;let t=this.createAbstractNumbering([{level:0,format:l.LevelFormat.BULLET,text:"",alignment:i.AlignmentType.LEFT,style:{paragraph:{indent:{left:n.convertInchesToTwip(.5),hanging:n.convertInchesToTwip(.25)}}}},{level:1,format:l.LevelFormat.BULLET,text:"",alignment:i.AlignmentType.LEFT,style:{paragraph:{indent:{left:n.convertInchesToTwip(1),hanging:n.convertInchesToTwip(.25)}}}},{level:2,format:l.LevelFormat.BULLET,text:"",alignment:i.AlignmentType.LEFT,style:{paragraph:{indent:{left:2160,hanging:n.convertInchesToTwip(.25)}}}},{level:3,format:l.LevelFormat.BULLET,text:"",alignment:i.AlignmentType.LEFT,style:{paragraph:{indent:{left:2880,hanging:n.convertInchesToTwip(.25)}}}},{level:4,format:l.LevelFormat.BULLET,text:"",alignment:i.AlignmentType.LEFT,style:{paragraph:{indent:{left:3600,hanging:n.convertInchesToTwip(.25)}}}},{level:5,format:l.LevelFormat.BULLET,text:"",alignment:i.AlignmentType.LEFT,style:{paragraph:{indent:{left:4320,hanging:n.convertInchesToTwip(.25)}}}},{level:6,format:l.LevelFormat.BULLET,text:"",alignment:i.AlignmentType.LEFT,style:{paragraph:{indent:{left:5040,hanging:n.convertInchesToTwip(.25)}}}},{level:7,format:l.LevelFormat.BULLET,text:"",alignment:i.AlignmentType.LEFT,style:{paragraph:{indent:{left:5760,hanging:n.convertInchesToTwip(.25)}}}},{level:8,format:l.LevelFormat.BULLET,text:"",alignment:i.AlignmentType.LEFT,style:{paragraph:{indent:{left:6480,hanging:n.convertInchesToTwip(.25)}}}}]);for(let r of(this.createConcreteNumbering(t),e.config)){let e=this.createAbstractNumbering(r.levels);this.createConcreteNumbering(e,r.reference)}}prepForXml(){return this.abstractNumbering.forEach(e=>this.root.push(e)),this.concreteNumbering.forEach(e=>this.root.push(e)),super.prepForXml()}createConcreteNumbering(e,t){let r=new c.ConcreteNumbering(this.nextId++,e.id,t);return this.concreteNumbering.push(r),r}createAbstractNumbering(e){let t=new a.AbstractNumbering(this.nextId++,e);return this.abstractNumbering.push(t),t}get ConcreteNumbering(){return this.concreteNumbering}}t.Numbering=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlComponent{constructor(e){super("w:multiLevelType"),this.root.push(new n.Attributes({val:e}))}}t.MultiLevelType=i},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(333)),n(r(136))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(334),o=r(335),s=r(336),a=r(136);class l extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable"}}}t.SettingsAttributes=l;class c extends n.XmlComponent{constructor(){super("w:settings"),this.root.push(new l({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"})),this.compatibility=new i.Compatibility,this.trackRevisions=new s.TrackRevisions,this.root.push(new o.DisplayBackgroundShape)}addUpdateFields(){this.root.find(e=>e instanceof a.UpdateFields)||this.addChildElement(new a.UpdateFields)}addCompatibility(){return this.root.find(e=>e instanceof i.Compatibility)||this.addChildElement(this.compatibility),this.compatibility}addTrackRevisions(){return this.root.find(e=>e instanceof s.TrackRevisions)||this.addChildElement(this.trackRevisions),this.trackRevisions}}t.Settings=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlComponent{constructor(){super("w:doNotExpandShiftReturn")}}class o extends n.XmlComponent{constructor(){super("w:compat")}doNotExpandShiftReturn(){return this.root.push(new i),this}}t.Compatibility=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlComponent{constructor(){super("w:displayBackgroundShape")}}t.DisplayBackgroundShape=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlComponent{constructor(){super("w:trackRevisions")}}t.TrackRevisions=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(26),o=r(23);t.ExternalStylesFactory=class{newInstance(e){let t;for(let r of i.xml2js(e,{compact:!1}).elements||[])"w:styles"===r.name&&(t=r);if(void 0===t)throw Error("can not find styles element");let r=t.elements||[];return new o.Styles({initialStyles:new n.ImportedRootElementAttributes(t.attributes),importedStyles:r.map(e=>n.convertToXmlComponent(e))})}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(11),i=r(106),o=r(105);t.DefaultStylesFactory=class{newInstance(e={}){return{initialStyles:new n.DocumentAttributes({mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",Ignorable:"w14 w15"}),importedStyles:[new i.DocumentDefaults(e.document),new o.TitleStyle(Object.assign({run:{size:56}},e.title)),new o.Heading1Style(Object.assign({run:{color:"2E74B5",size:32}},e.heading1)),new o.Heading2Style(Object.assign({run:{color:"2E74B5",size:26}},e.heading2)),new o.Heading3Style(Object.assign({run:{color:"1F4D78",size:24}},e.heading3)),new o.Heading4Style(Object.assign({run:{color:"2E74B5",italics:!0}},e.heading4)),new o.Heading5Style(Object.assign({run:{color:"2E74B5"}},e.heading5)),new o.Heading6Style(Object.assign({run:{color:"1F4D78"}},e.heading6)),new o.StrongStyle(Object.assign({run:{bold:!0}},e.strong)),new o.ListParagraph(e.listParagraph||{}),new o.HyperlinkStyle(e.hyperlink||{}),new o.FootnoteReferenceStyle(e.footnoteReference||{}),new o.FootnoteText(e.footnoteText||{}),new o.FootnoteTextChar(e.footnoteTextChar||{})]}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WORKAROUND=""},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(341)),n(r(346))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(1),i=r(3),o=r(18),s=r(0),a=r(342),l=r(343),c=r(344);class u extends s.XmlComponent{constructor(e="Table of Contents",t){super("w:sdt"),this.root.push(new c.StructuredDocumentTagProperties(e));let r=new l.StructuredDocumentTagContent,s=new n.Paragraph({children:[new i.Run({children:[new o.Begin(!0),new a.FieldInstruction(t),new o.Separate]})]});r.addChildElement(s);let u=new n.Paragraph({children:[new i.Run({children:[new o.End]})]});r.addChildElement(u),this.root.push(r)}}t.TableOfContents=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(8),i=r(0);class o extends i.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={space:"xml:space"}}}class s extends i.XmlComponent{constructor(e={}){super("w:instrText"),this.properties=e,this.root.push(new o({space:n.SpaceType.PRESERVE}));let t="TOC";if(this.properties.captionLabel&&(t=`${t} \\a "${this.properties.captionLabel}"`),this.properties.entriesFromBookmark&&(t=`${t} \\b "${this.properties.entriesFromBookmark}"`),this.properties.captionLabelIncludingNumbers&&(t=`${t} \\c "${this.properties.captionLabelIncludingNumbers}"`),this.properties.sequenceAndPageNumbersSeparator&&(t=`${t} \\d "${this.properties.sequenceAndPageNumbersSeparator}"`),this.properties.tcFieldIdentifier&&(t=`${t} \\f "${this.properties.tcFieldIdentifier}"`),this.properties.hyperlink&&(t=`${t} \\h`),this.properties.tcFieldLevelRange&&(t=`${t} \\l "${this.properties.tcFieldLevelRange}"`),this.properties.pageNumbersEntryLevelsRange&&(t=`${t} \\n "${this.properties.pageNumbersEntryLevelsRange}"`),this.properties.headingStyleRange&&(t=`${t} \\o "${this.properties.headingStyleRange}"`),this.properties.entryAndPageNumberSeparator&&(t=`${t} \\p "${this.properties.entryAndPageNumberSeparator}"`),this.properties.seqFieldIdentifierForPrefix&&(t=`${t} \\s "${this.properties.seqFieldIdentifierForPrefix}"`),this.properties.stylesWithLevels&&this.properties.stylesWithLevels.length){let e=this.properties.stylesWithLevels.map(e=>`${e.styleName},${e.level}`).join(",");t=`${t} \\t "${e}"`}this.properties.useAppliedParagraphOutlineLevel&&(t=`${t} \\u`),this.properties.preserveTabInEntries&&(t=`${t} \\w`),this.properties.preserveNewLineInEntries&&(t=`${t} \\x`),this.properties.hideTabAndPageNumbersInWebView&&(t=`${t} \\z`),this.root.push(t)}}t.FieldInstruction=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlComponent{constructor(){super("w:sdtContent")}}t.StructuredDocumentTagContent=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(345);class o extends n.XmlComponent{constructor(e){super("w:sdtPr"),this.root.push(new i.Alias(e))}}t.StructuredDocumentTagProperties=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0);class i extends n.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={alias:"w:val"}}}class o extends n.XmlComponent{constructor(e){super("w:alias"),this.root.push(new i({alias:e}))}}t.Alias=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StyleLevel=class{constructor(e,t){this.styleName=e,this.level=t}}},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(348)),n(r(349))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(12),o=r(137);class s extends n.XmlComponent{constructor(e){super("w:ins"),this.root.push(new o.ChangeAttributes({id:e.id,author:e.author,date:e.date})),this.addChildElement(new i.TextRun(e))}}t.InsertedTextRun=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(0),i=r(12),o=r(67),s=r(18),a=r(17),l=r(137),c=r(350),u=r(351);class d extends n.XmlComponent{constructor(e){super("w:del"),this.root.push(new l.ChangeAttributes({id:e.id,author:e.author,date:e.date})),this.deletedTextRunWrapper=new h(e),this.addChildElement(this.deletedTextRunWrapper)}}t.DeletedTextRun=d;class h extends n.XmlComponent{constructor(e){if(super("w:r"),this.root.push(new i.RunProperties(e)),e.children)for(let t of e.children){if("string"==typeof t){switch(t){case a.PageNumber.CURRENT:this.root.push(new s.Begin),this.root.push(new c.DeletedPage),this.root.push(new s.Separate),this.root.push(new s.End);break;case a.PageNumber.TOTAL_PAGES:this.root.push(new s.Begin),this.root.push(new c.DeletedNumberOfPages),this.root.push(new s.Separate),this.root.push(new s.End);break;case a.PageNumber.TOTAL_PAGES_IN_SECTION:this.root.push(new s.Begin),this.root.push(new c.DeletedNumberOfPagesSection),this.root.push(new s.Separate),this.root.push(new s.End);break;default:this.root.push(new u.DeletedText(t))}continue}this.root.push(t)}else e.text&&this.root.push(new u.DeletedText(e.text));if(e.break)for(let t=0;t<e.break;t++)this.root.splice(1,0,new o.Break)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(8),i=r(0);class o extends i.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={space:"xml:space"}}}class s extends i.XmlComponent{constructor(){super("w:delInstrText"),this.root.push(new o({space:n.SpaceType.PRESERVE})),this.root.push("PAGE")}}t.DeletedPage=s;class a extends i.XmlComponent{constructor(){super("w:delInstrText"),this.root.push(new o({space:n.SpaceType.PRESERVE})),this.root.push("NUMPAGES")}}t.DeletedNumberOfPages=a;class l extends i.XmlComponent{constructor(){super("w:delInstrText"),this.root.push(new o({space:n.SpaceType.PRESERVE})),this.root.push("SECTIONPAGES")}}t.DeletedNumberOfPagesSection=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(8),i=r(0);class o extends i.XmlAttributeComponent{constructor(){super(...arguments),this.xmlKeys={space:"xml:space"}}}class s extends i.XmlComponent{constructor(e){super("w:delText"),this.root.push(new o({space:n.SpaceType.PRESERVE})),this.root.push(e)}}t.DeletedText=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(353);for(var i in n)t.hasOwnProperty(i)||(t[i]=n[i])},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(s,a)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});let i=r(354);class o{static toBuffer(e,t){return n(this,void 0,void 0,function*(){let r=this.compiler.compile(e,t);return yield r.generateAsync({type:"nodebuffer",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})})}static toBase64String(e,t){return n(this,void 0,void 0,function*(){let r=this.compiler.compile(e,t);return yield r.generateAsync({type:"base64",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})})}static toBlob(e,t){return n(this,void 0,void 0,function*(){let r=this.compiler.compile(e,t);return yield r.generateAsync({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})})}}o.compiler=new i.Compiler,t.Packer=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(138),i=r(355),o=r(357),s=r(358),a=r(359);t.Compiler=class{constructor(){this.formatter=new o.Formatter,this.imageReplacer=new s.ImageReplacer,this.numberingReplacer=new a.NumberingReplacer}compile(e,t){let r=new n,i=this.xmlifyFile(e,t);for(let e in i){if(!i[e])continue;let t=i[e];if(Array.isArray(t))for(let e of t)r.file(e.path,e.data);else r.file(t.path,t.data)}for(let t of e.Media.Array){let e=t.stream;r.file(`word/media/${t.fileName}`,e)}return r}xmlifyFile(e,t){e.verifyUpdateFields();let r=e.DocumentRelationships.RelationshipCount+1,n=i(this.formatter.format(e.Document,e),t),o=this.imageReplacer.getMediaData(n,e.Media);return{Relationships:{data:(o.forEach((t,n)=>{e.DocumentRelationships.createRelationship(r+n,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${t.fileName}`)}),i(this.formatter.format(e.DocumentRelationships,e),t)),path:"word/_rels/document.xml.rels"},Document:{data:(()=>{let t=this.imageReplacer.replace(n,o,r);return this.numberingReplacer.replace(t,e.Numbering.ConcreteNumbering)})(),path:"word/document.xml"},Styles:{data:i(this.formatter.format(e.Styles,e),t),path:"word/styles.xml"},Properties:{data:i(this.formatter.format(e.CoreProperties,e),{declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/core.xml"},Numbering:{data:i(this.formatter.format(e.Numbering,e),t),path:"word/numbering.xml"},FileRelationships:{data:i(this.formatter.format(e.FileRelationships,e),t),path:"_rels/.rels"},HeaderRelationships:e.Headers.map((r,n)=>{let o=i(this.formatter.format(r.Header,e),t);return this.imageReplacer.getMediaData(o,e.Media).forEach((e,t)=>{r.Relationships.createRelationship(t,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${e.fileName}`)}),{data:i(this.formatter.format(r.Relationships,e),t),path:`word/_rels/header${n+1}.xml.rels`}}),FooterRelationships:e.Footers.map((r,n)=>{let o=i(this.formatter.format(r.Footer,e),t);return this.imageReplacer.getMediaData(o,e.Media).forEach((e,t)=>{r.Relationships.createRelationship(t,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${e.fileName}`)}),{data:i(this.formatter.format(r.Relationships,e),t),path:`word/_rels/footer${n+1}.xml.rels`}}),Headers:e.Headers.map((r,n)=>{let o=i(this.formatter.format(r.Header,e),t),s=this.imageReplacer.getMediaData(o,e.Media);return{data:this.imageReplacer.replace(o,s,0),path:`word/header${n+1}.xml`}}),Footers:e.Footers.map((r,n)=>{let o=i(this.formatter.format(r.Footer,e),t),s=this.imageReplacer.getMediaData(o,e.Media);return{data:this.imageReplacer.replace(o,s,0),path:`word/footer${n+1}.xml`}}),ContentTypes:{data:i(this.formatter.format(e.ContentTypes,e),t),path:"[Content_Types].xml"},AppProperties:{data:i(this.formatter.format(e.AppProperties,e),t),path:"docProps/app.xml"},FootNotes:{data:i(this.formatter.format(e.FootNotes,e),t),path:"word/footnotes.xml"},Settings:{data:i(this.formatter.format(e.Settings,e),t),path:"word/settings.xml"}}}}},function(e,t,r){(function(t){var n=r(356),i=r(56).Stream;function o(e,t,r){var i,s,a=Array((r=r||0)||0).join(t||""),l=e;if("object"==typeof e&&(i=Object.keys(e)[0],(l=e[i])&&l._elem))return l._elem.name=i,l._elem.icount=r,l._elem.indent=t,l._elem.indents=a,l._elem.interrupt=l,l._elem;var c=[],u=[];function d(e){Object.keys(e).forEach(function(t){c.push(t+'="'+n(e[t])+'"')})}switch(typeof l){case"object":if(null===l)break;l._attr&&d(l._attr),l._cdata&&u.push(("<![CDATA["+l._cdata).replace(/\]\]>/g,"]]]]><![CDATA[>")+"]]>"),l.forEach&&(s=!1,u.push(""),l.forEach(function(e){"object"==typeof e?"_attr"==Object.keys(e)[0]?d(e._attr):u.push(o(e,t,r+1)):(u.pop(),s=!0,u.push(n(e)))}),s||u.push(""));break;default:u.push(n(l))}return{name:i,interrupt:!1,attributes:c,content:u,icount:r,indents:a,indent:t}}function s(e,t,r){if("object"!=typeof t)return e(!1,t);var n=t.interrupt?1:t.content.length;function i(){for(;t.content.length;){var i=t.content.shift();if(void 0!==i){if(o(i))return;s(e,i)}}e(!1,(n>1?t.indents:"")+(t.name?"</"+t.name+">":"")+(t.indent&&!r?"\n":"")),r&&r()}function o(t){return!!t.interrupt&&(t.interrupt.append=e,t.interrupt.end=i,t.interrupt=!1,e(!0),!0)}if(e(!1,t.indents+(t.name?"<"+t.name:"")+(t.attributes.length?" "+t.attributes.join(" "):"")+(n?t.name?">":"":t.name?"/>":"")+(t.indent&&n>1?"\n":"")),!n)return e(!1,t.indent?"\n":"");o(t)||i()}e.exports=function(e,r){"object"!=typeof r&&(r={indent:r});var n,a,l=r.stream?new i:null,c="",u=!1,d=r.indent?!0===r.indent?"    ":r.indent:"",h=!0;function p(e){h?t.nextTick(e):e()}function f(e,t){if(void 0!==t&&(c+=t),e&&!u&&(l=l||new i,u=!0),e&&u){var r=c;p(function(){l.emit("data",r)}),c=""}}function g(e,t){s(f,o(e,d,+!!d),t)}function b(){if(l){var e=c;p(function(){l.emit("data",e),l.emit("end"),l.readable=!1,l.emit("close")})}}return(p(function(){h=!1}),r.declaration&&(a={version:"1.0",encoding:(n=r.declaration).encoding||"UTF-8"},n.standalone&&(a.standalone=n.standalone),g({"?xml":{_attr:a}}),c=c.replace("/>","?>")),e&&e.forEach?e.forEach(function(t,r){var n;r+1===e.length&&(n=b),g(t,n)}):g(e,b),l)?(l.readable=!0,l):c},e.exports.element=e.exports.Element=function(){var e=Array.prototype.slice.call(arguments),t={_elem:o(e)};return t.push=function(e){if(!this.append)throw Error("not assigned to a parent!");var t=this,r=this._elem.indent;s(this.append,o(e,r,this._elem.icount+ +!!r),function(){t.append(!0)})},t.close=function(e){void 0!==e&&this.push(e),this.end&&this.end()},t}}).call(t,r(13))},function(e,t){var r={"&":"&amp;",'"':"&quot;","'":"&apos;","<":"&lt;",">":"&gt;"};e.exports=function(e){return e&&e.replace?e.replace(/([&"<>'])/g,function(e,t){return r[t]}):e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Formatter=class{format(e,t){let r=e.prepForXml(t);if(r)return r;throw Error("XMLComponent did not format correctly")}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ImageReplacer=class{replace(e,t,r){let n=e;return t.forEach((e,t)=>{n=n.replace(RegExp(`{${e.fileName}}`,"g"),(r+t).toString())}),n}getMediaData(e,t){return t.Array.filter(t=>e.search(`{${t.fileName}}`)>0)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NumberingReplacer=class{replace(e,t){let r=e;for(let e of t)e.reference&&(r=r.replace(RegExp(`{${e.reference}}`,"g"),e.id.toString()));return r}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(361);for(var i in n)t.hasOwnProperty(i)||(t[i]=n[i])},function(e,t,r){"use strict";var n,i,o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(s,a)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});let s=r(138),a=r(26),l=r(46),c=r(49),u=r(50),d=r(48),h=r(0),p={"http://schemas.openxmlformats.org/officeDocument/2006/relationships/header":"header","http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer":"footer","http://schemas.openxmlformats.org/officeDocument/2006/relationships/image":"image","http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink":"hyperlink"};(n=i||(i={})).HEADER="header",n.FOOTER="footer",n.IMAGE="image",n.HYPERLINK="hyperlink",t.ImportDotx=class{extract(e){return o(this,void 0,void 0,function*(){let t=yield s.loadAsync(e),r=yield t.files["word/document.xml"].async("text"),n=yield t.files["word/_rels/document.xml.rels"].async("text"),i=this.extractDocumentRefs(r),o=this.findReferenceFiles(n),a=new u.Media;return{headers:yield this.createHeaders(t,i,o,a,0),footers:yield this.createFooters(t,i,o,a,i.headers.length),currentRelationshipId:i.footers.length+i.headers.length,styles:yield t.files["word/styles.xml"].async("text"),titlePageIsDefined:this.checkIfTitlePageIsDefined(r),media:a}})}createFooters(e,t,r,n,i){return o(this,void 0,void 0,function*(){return Promise.all(t.footers.map((t,s)=>o(this,void 0,void 0,function*(){let o=r.find(e=>e.id===t.id);if(null===o||!o)throw Error(`Can not find target file for id ${t.id}`);let c=yield e.files[`word/${o.target}`].async("text"),u=a.xml2js(c,{compact:!1,captureSpacesBetweenElements:!0});if(!u.elements)return;let d=u.elements.reduce((e,t)=>"w:ftr"===t.name?t:e),p=h.convertToXmlComponent(d),f=new l.FooterWrapper(n,i+s,p);return yield this.addRelationshipToWrapper(o,e,f,n),{type:t.type,footer:f}})).filter(e=>!!e))})}createHeaders(e,t,r,n,i){return o(this,void 0,void 0,function*(){return Promise.all(t.headers.map((t,s)=>o(this,void 0,void 0,function*(){let o=r.find(e=>e.id===t.id);if(null===o||!o)throw Error(`Can not find target file for id ${t.id}`);let l=yield e.files[`word/${o.target}`].async("text"),u=a.xml2js(l,{compact:!1,captureSpacesBetweenElements:!0});if(!u.elements)return;let d=u.elements.reduce((e,t)=>"w:hdr"===t.name?t:e),p=h.convertToXmlComponent(d),f=new c.HeaderWrapper(n,i+s,p);return yield this.addRelationshipToWrapper(o,e,f,n),{type:t.type,header:f}})).filter(e=>!!e))})}addRelationshipToWrapper(e,t,r,n){return o(this,void 0,void 0,function*(){let o=t.files[`word/_rels/${e.target}.rels`];if(!o)return;let s=yield o.async("text"),a=this.findReferenceFiles(s).filter(e=>e.type===i.IMAGE),l=this.findReferenceFiles(s).filter(e=>e.type===i.HYPERLINK);for(let e of a){let i=yield t.files[`word/${e.target}`].async("nodebuffer"),o=n.addMedia(i);r.Relationships.createRelationship(e.id,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${o.fileName}`)}for(let e of l)r.Relationships.createRelationship(e.id,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",e.target,d.TargetModeType.EXTERNAL)})}findReferenceFiles(e){let t=a.xml2js(e,{compact:!0});return(Array.isArray(t.Relationships.Relationship)?t.Relationships.Relationship:[t.Relationships.Relationship]).map(e=>{if(void 0===e._attributes)throw Error("relationship element has no attributes");return{id:this.parseRefId(e._attributes.Id),type:p[e._attributes.Type],target:e._attributes.Target}}).filter(e=>null!==e.type)}extractDocumentRefs(e){let t=a.xml2js(e,{compact:!0})["w:document"]["w:body"]["w:sectPr"],r=t["w:headerReference"],n=(void 0===r?[]:Array.isArray(r)?r:[r]).map(e=>{if(void 0===e._attributes)throw Error("header referecne element has no attributes");return{type:e._attributes["w:type"],id:this.parseRefId(e._attributes["r:id"])}}),i=t["w:footerReference"];return{headers:n,footers:(void 0===i?[]:Array.isArray(i)?i:[i]).map(e=>{if(void 0===e._attributes)throw Error("footer referecne element has no attributes");return{type:e._attributes["w:type"],id:this.parseRefId(e._attributes["r:id"])}})}}checkIfTitlePageIsDefined(e){return void 0!==a.xml2js(e,{compact:!0})["w:document"]["w:body"]["w:sectPr"]["w:titlePg"]}parseRefId(e){let t=/^rId(\d+)$/.exec(e);if(null===t)throw Error("Invalid ref id");return parseInt(t[1],10)}}}],t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=139)}()},1343:function(e){"use strict";var t=Object.prototype.hasOwnProperty,r="~";function n(){}function i(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,n,o,s){if("function"!=typeof n)throw TypeError("The listener must be a function");var a=new i(n,o||e,s),l=r?r+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],a]:e._events[l].push(a):(e._events[l]=a,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function a(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1)),a.prototype.eventNames=function(){var e,n,i=[];if(0===this._eventsCount)return i;for(n in e=this._events)t.call(e,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},a.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,s=Array(o);i<o;i++)s[i]=n[i].fn;return s},a.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},a.prototype.emit=function(e,t,n,i,o,s){var a=r?r+e:e;if(!this._events[a])return!1;var l,c,u=this._events[a],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,n),!0;case 4:return u.fn.call(u.context,t,n,i),!0;case 5:return u.fn.call(u.context,t,n,i,o),!0;case 6:return u.fn.call(u.context,t,n,i,o,s),!0}for(c=1,l=Array(d-1);c<d;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var h,p=u.length;for(c=0;c<p;c++)switch(u[c].once&&this.removeListener(e,u[c].fn,void 0,!0),d){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,t);break;case 3:u[c].fn.call(u[c].context,t,n);break;case 4:u[c].fn.call(u[c].context,t,n,i);break;default:if(!l)for(h=1,l=Array(d-1);h<d;h++)l[h-1]=arguments[h];u[c].fn.apply(u[c].context,l)}}return!0},a.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},a.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},a.prototype.removeListener=function(e,t,n,i){var o=r?r+e:e;if(!this._events[o])return this;if(!t)return s(this,o),this;var a=this._events[o];if(a.fn)a.fn!==t||i&&!a.once||n&&a.context!==n||s(this,o);else{for(var l=0,c=[],u=a.length;l<u;l++)(a[l].fn!==t||i&&!a[l].once||n&&a[l].context!==n)&&c.push(a[l]);c.length?this._events[o]=1===c.length?c[0]:c:s(this,o)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&s(this,t)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,e.exports=a},3864:function(e){function t(e,h,p,f,g){if(e===h)return e?[[0,e]]:[];if(null!=p){var v=function(e,t,r){var n="number"==typeof r?{index:r,length:0}:r.oldRange,i="number"==typeof r?null:r.newRange,o=e.length,s=t.length;if(0===n.length&&(null===i||0===i.length)){var a=n.index,l=e.slice(0,a),c=e.slice(a),u=i?i.index:null;t:{var d=a+s-o;if(null!==u&&u!==d||d<0||d>s)break t;var h=t.slice(0,d),p=t.slice(d);if(p!==c)break t;var f=Math.min(a,d),g=l.slice(0,f),v=h.slice(0,f);if(g!==v)break t;var y=l.slice(f),w=h.slice(f);return b(g,y,w,c)}r:if(null===u||u===a){var h=t.slice(0,a),p=t.slice(a);if(h!==l)break r;var x=Math.min(o-a,s-a),E=c.slice(c.length-x),_=p.slice(p.length-x);if(E!==_)break r;var y=c.slice(0,c.length-x),w=p.slice(0,p.length-x);return b(l,y,w,E)}}if(n.length>0&&i&&0===i.length)n:{var g=e.slice(0,n.index),E=e.slice(n.index+n.length),f=g.length,x=E.length;if(s<f+x)break n;var v=t.slice(0,f),_=t.slice(s-x);if(g!==v||E!==_)break n;var y=e.slice(f,o-x),w=t.slice(f,s-x);return b(g,y,w,E)}return null}(e,h,p);if(v)return v}var y=n(e,h),w=e.substring(0,y);y=o(e=e.substring(y),h=h.substring(y));var x=e.substring(e.length-y),E=function(e,i){if(!e)return[[1,i]];if(!i)return[[-1,e]];var s,a=e.length>i.length?e:i,l=e.length>i.length?i:e,c=a.indexOf(l);if(-1!==c)return s=[[1,a.substring(0,c)],[0,l],[1,a.substring(c+l.length)]],e.length>i.length&&(s[0][0]=s[2][0]=-1),s;if(1===l.length)return[[-1,e],[1,i]];var u=function(e,t){var r,i,s,a,l,c=e.length>t.length?e:t,u=e.length>t.length?t:e;if(c.length<4||2*u.length<c.length)return null;function d(e,t,r){for(var i,s,a,l,c=e.substring(r,r+Math.floor(e.length/4)),u=-1,d="";-1!==(u=t.indexOf(c,u+1));){var h=n(e.substring(r),t.substring(u)),p=o(e.substring(0,r),t.substring(0,u));d.length<p+h&&(d=t.substring(u-p,u)+t.substring(u,u+h),i=e.substring(0,r-p),s=e.substring(r+h),a=t.substring(0,u-p),l=t.substring(u+h))}return 2*d.length>=e.length?[i,s,a,l,d]:null}var h=d(c,u,Math.ceil(c.length/4)),p=d(c,u,Math.ceil(c.length/2));return h||p?(r=p?h&&h[4].length>p[4].length?h:p:h,e.length>t.length?(i=r[0],s=r[1],a=r[2],l=r[3]):(a=r[0],l=r[1],i=r[2],s=r[3]),[i,s,a,l,r[4]]):null}(e,i);if(u){var d=u[0],h=u[1],p=u[2],f=u[3],g=u[4],b=t(d,p),v=t(h,f);return b.concat([[0,g]],v)}return function(e,t){for(var n=e.length,i=t.length,o=Math.ceil((n+i)/2),s=2*o,a=Array(s),l=Array(s),c=0;c<s;c++)a[c]=-1,l[c]=-1;a[o+1]=0,l[o+1]=0;for(var u=n-i,d=u%2!=0,h=0,p=0,f=0,g=0,b=0;b<o;b++){for(var v=-b+h;v<=b-p;v+=2){for(var y,w=o+v,x=(y=v===-b||v!==b&&a[w-1]<a[w+1]?a[w+1]:a[w-1]+1)-v;y<n&&x<i&&e.charAt(y)===t.charAt(x);)y++,x++;if(a[w]=y,y>n)p+=2;else if(x>i)h+=2;else if(d){var E=o+u-v;if(E>=0&&E<s&&-1!==l[E]){var _=n-l[E];if(y>=_)return r(e,t,y,x)}}}for(var T=-b+f;T<=b-g;T+=2){for(var _,E=o+T,O=(_=T===-b||T!==b&&l[E-1]<l[E+1]?l[E+1]:l[E-1]+1)-T;_<n&&O<i&&e.charAt(n-_-1)===t.charAt(i-O-1);)_++,O++;if(l[E]=_,_>n)g+=2;else if(O>i)f+=2;else if(!d){var w=o+u-T;if(w>=0&&w<s&&-1!==a[w]){var y=a[w],x=o+y-w;if(y>=(_=n-_))return r(e,t,y,x)}}}}return[[-1,e],[1,t]]}(e,i)}(e=e.substring(0,e.length-y),h=h.substring(0,h.length-y));return w&&E.unshift([0,w]),x&&E.push([0,x]),d(E,g),f&&function(e){for(var t=!1,r=[],n=0,h=null,p=0,f=0,g=0,b=0,v=0;p<e.length;)0==e[p][0]?(r[n++]=p,f=b,g=v,b=0,v=0,h=e[p][1]):(1==e[p][0]?b+=e[p][1].length:v+=e[p][1].length,h&&h.length<=Math.max(f,g)&&h.length<=Math.max(b,v)&&(e.splice(r[n-1],0,[-1,h]),e[r[n-1]+1][0]=1,n--,p=--n>0?r[n-1]:-1,f=0,g=0,b=0,v=0,h=null,t=!0)),p++;for(t&&d(e),function(e){function t(e,t){if(!e||!t)return 6;var r=e.charAt(e.length-1),n=t.charAt(0),i=r.match(s),o=n.match(s),d=i&&r.match(a),h=o&&n.match(a),p=d&&r.match(l),f=h&&n.match(l),g=p&&e.match(c),b=f&&t.match(u);if(g||b)return 5;if(p||f)return 4;if(i&&!d&&h)return 3;if(d||h)return 2;if(i||o)return 1;return 0}for(var r=1;r<e.length-1;){if(0==e[r-1][0]&&0==e[r+1][0]){var n=e[r-1][1],i=e[r][1],d=e[r+1][1],h=o(n,i);if(h){var p=i.substring(i.length-h);n=n.substring(0,n.length-h),i=p+i.substring(0,i.length-h),d=p+d}for(var f=n,g=i,b=d,v=t(n,i)+t(i,d);i.charAt(0)===d.charAt(0);){n+=i.charAt(0),i=i.substring(1)+d.charAt(0),d=d.substring(1);var y=t(n,i)+t(i,d);y>=v&&(v=y,f=n,g=i,b=d)}e[r-1][1]!=f&&(f?e[r-1][1]=f:(e.splice(r-1,1),r--),e[r][1]=g,b?e[r+1][1]=b:(e.splice(r+1,1),r--))}r++}}(e),p=1;p<e.length;){if(-1==e[p-1][0]&&1==e[p][0]){var y=e[p-1][1],w=e[p][1],x=i(y,w),E=i(w,y);x>=E?(x>=y.length/2||x>=w.length/2)&&(e.splice(p,0,[0,w.substring(0,x)]),e[p-1][1]=y.substring(0,y.length-x),e[p+1][1]=w.substring(x),p++):(E>=y.length/2||E>=w.length/2)&&(e.splice(p,0,[0,y.substring(0,E)]),e[p-1][0]=1,e[p-1][1]=w.substring(0,w.length-E),e[p+1][0]=-1,e[p+1][1]=y.substring(E),p++),p++}p++}}(E),E}function r(e,r,n,i){var o=e.substring(0,n),s=r.substring(0,i),a=e.substring(n),l=r.substring(i),c=t(o,s),u=t(a,l);return c.concat(u)}function n(e,t){if(!e||!t||e.charAt(0)!==t.charAt(0))return 0;for(var r=0,n=Math.min(e.length,t.length),i=n,o=0;r<i;)e.substring(o,i)==t.substring(o,i)?o=r=i:n=i,i=Math.floor((n-r)/2+r);return h(e.charCodeAt(i-1))&&i--,i}function i(e,t){var r=e.length,n=t.length;if(0==r||0==n)return 0;r>n?e=e.substring(r-n):r<n&&(t=t.substring(0,r));var i=Math.min(r,n);if(e==t)return i;for(var o=0,s=1;;){var a=e.substring(i-s),l=t.indexOf(a);if(-1==l)return o;s+=l,(0==l||e.substring(i-s)==t.substring(0,s))&&(o=s,s++)}}function o(e,t){if(!e||!t||e.slice(-1)!==t.slice(-1))return 0;for(var r=0,n=Math.min(e.length,t.length),i=n,o=0;r<i;)e.substring(e.length-i,e.length-o)==t.substring(t.length-i,t.length-o)?o=r=i:n=i,i=Math.floor((n-r)/2+r);return p(e.charCodeAt(e.length-i))&&i--,i}var s=/[^a-zA-Z0-9]/,a=/\s/,l=/[\r\n]/,c=/\n\r?\n$/,u=/^\r?\n\r?\n/;function d(e,t){e.push([0,""]);for(var r,i=0,s=0,a=0,l="",c="";i<e.length;){if(i<e.length-1&&!e[i][1]){e.splice(i,1);continue}switch(e[i][0]){case 1:a++,c+=e[i][1],i++;break;case -1:s++,l+=e[i][1],i++;break;case 0:var u=i-a-s-1;if(t){if(u>=0&&g(e[u][1])){var h=e[u][1].slice(-1);if(e[u][1]=e[u][1].slice(0,-1),l=h+l,c=h+c,!e[u][1]){e.splice(u,1),i--;var p=u-1;e[p]&&1===e[p][0]&&(a++,c=e[p][1]+c,p--),e[p]&&-1===e[p][0]&&(s++,l=e[p][1]+l,p--),u=p}}if(f(e[i][1])){var h=e[i][1].charAt(0);e[i][1]=e[i][1].slice(1),l+=h,c+=h}}if(i<e.length-1&&!e[i][1]){e.splice(i,1);break}if(l.length>0||c.length>0){l.length>0&&c.length>0&&(0!==(r=n(c,l))&&(u>=0?e[u][1]+=c.substring(0,r):(e.splice(0,0,[0,c.substring(0,r)]),i++),c=c.substring(r),l=l.substring(r)),0!==(r=o(c,l))&&(e[i][1]=c.substring(c.length-r)+e[i][1],c=c.substring(0,c.length-r),l=l.substring(0,l.length-r)));var b=a+s;0===l.length&&0===c.length?(e.splice(i-b,b),i-=b):0===l.length?(e.splice(i-b,b,[1,c]),i=i-b+1):0===c.length?(e.splice(i-b,b,[-1,l]),i=i-b+1):(e.splice(i-b,b,[-1,l],[1,c]),i=i-b+2)}0!==i&&0===e[i-1][0]?(e[i-1][1]+=e[i][1],e.splice(i,1)):i++,a=0,s=0,l="",c=""}}""===e[e.length-1][1]&&e.pop();var v=!1;for(i=1;i<e.length-1;)0===e[i-1][0]&&0===e[i+1][0]&&(e[i][1].substring(e[i][1].length-e[i-1][1].length)===e[i-1][1]?(e[i][1]=e[i-1][1]+e[i][1].substring(0,e[i][1].length-e[i-1][1].length),e[i+1][1]=e[i-1][1]+e[i+1][1],e.splice(i-1,1),v=!0):e[i][1].substring(0,e[i+1][1].length)==e[i+1][1]&&(e[i-1][1]+=e[i+1][1],e[i][1]=e[i][1].substring(e[i+1][1].length)+e[i+1][1],e.splice(i+1,1),v=!0)),i++;v&&d(e,t)}function h(e){return e>=55296&&e<=56319}function p(e){return e>=56320&&e<=57343}function f(e){return p(e.charCodeAt(0))}function g(e){return h(e.charCodeAt(e.length-1))}function b(e,t,r,n){if(g(e)||f(n))return null;for(var i=[[0,e],[-1,t],[1,r],[0,n]],o=[],s=0;s<i.length;s++)i[s][1].length>0&&o.push(i[s]);return o}function v(e,r,n,i){return t(e,r,n,i,!0)}v.INSERT=1,v.DELETE=-1,v.EQUAL=0,e.exports=v},5126:function(e,t,r){e=r.nmd(e);var n,i="__lodash_hash_undefined__",o="[object Arguments]",s="[object Boolean]",a="[object Date]",l="[object Function]",c="[object GeneratorFunction]",u="[object Map]",d="[object Number]",h="[object Object]",p="[object Promise]",f="[object RegExp]",g="[object Set]",b="[object String]",v="[object Symbol]",y="[object WeakMap]",w="[object ArrayBuffer]",x="[object DataView]",E="[object Float32Array]",_="[object Float64Array]",T="[object Int8Array]",O="[object Int16Array]",A="[object Int32Array]",S="[object Uint8Array]",k="[object Uint8ClampedArray]",N="[object Uint16Array]",C="[object Uint32Array]",I=/\w*$/,R=/^\[object .+?Constructor\]$/,P=/^(?:0|[1-9]\d*)$/,L={};L[o]=L["[object Array]"]=L[w]=L[x]=L[s]=L[a]=L[E]=L[_]=L[T]=L[O]=L[A]=L[u]=L[d]=L[h]=L[f]=L[g]=L[b]=L[v]=L[S]=L[k]=L[N]=L[C]=!0,L["[object Error]"]=L[l]=L[y]=!1;var D="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g,j="object"==typeof self&&self&&self.Object===Object&&self,B=D||j||Function("return this")(),F=t&&!t.nodeType&&t,U=F&&e&&!e.nodeType&&e,q=U&&U.exports===F;function z(e,t){return e.set(t[0],t[1]),e}function H(e,t){return e.add(t),e}function X(e,t,r,n){var i=-1,o=e?e.length:0;for(n&&o&&(r=e[++i]);++i<o;)r=t(r,e[i],i,e);return r}function V(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function $(e){var t=-1,r=Array(e.size);return e.forEach(function(e,n){r[++t]=[n,e]}),r}function K(e,t){return function(r){return e(t(r))}}function W(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}var G=Array.prototype,Y=Function.prototype,Z=Object.prototype,J=B["__core-js_shared__"],Q=(n=/[^.]+$/.exec(J&&J.keys&&J.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",ee=Y.toString,et=Z.hasOwnProperty,er=Z.toString,en=RegExp("^"+ee.call(et).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ei=q?B.Buffer:void 0,eo=B.Symbol,es=B.Uint8Array,ea=K(Object.getPrototypeOf,Object),el=Object.create,ec=Z.propertyIsEnumerable,eu=G.splice,ed=Object.getOwnPropertySymbols,eh=ei?ei.isBuffer:void 0,ep=K(Object.keys,Object),ef=eM(B,"DataView"),em=eM(B,"Map"),eg=eM(B,"Promise"),eb=eM(B,"Set"),ev=eM(B,"WeakMap"),ey=eM(Object,"create"),ew=eU(ef),ex=eU(em),eE=eU(eg),e_=eU(eb),eT=eU(ev),eO=eo?eo.prototype:void 0,eA=eO?eO.valueOf:void 0;function eS(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function ek(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function eN(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function eC(e){this.__data__=new ek(e)}function eI(e,t,r){var n=e[t];et.call(e,t)&&eq(n,r)&&(void 0!==r||t in e)||(e[t]=r)}function eR(e,t){for(var r=e.length;r--;)if(eq(e[r][0],t))return r;return -1}function eP(e){var t=new e.constructor(e.byteLength);return new es(t).set(new es(e)),t}function eL(e,t,r,n){r||(r={});for(var i=-1,o=t.length;++i<o;){var s=t[i],a=n?n(r[s],e[s],s,r,e):void 0;eI(r,s,void 0===a?e[s]:a)}return r}function eD(e,t){var r,n,i=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof t?"string":"hash"]:i.map}function eM(e,t){var r,n=null==e?void 0:e[t];return!(!e$(n)||(r=n,Q&&Q in r))&&(eV(n)||V(n)?en:R).test(eU(n))?n:void 0}eS.prototype.clear=function(){this.__data__=ey?ey(null):{}},eS.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},eS.prototype.get=function(e){var t=this.__data__;if(ey){var r=t[e];return r===i?void 0:r}return et.call(t,e)?t[e]:void 0},eS.prototype.has=function(e){var t=this.__data__;return ey?void 0!==t[e]:et.call(t,e)},eS.prototype.set=function(e,t){return this.__data__[e]=ey&&void 0===t?i:t,this},ek.prototype.clear=function(){this.__data__=[]},ek.prototype.delete=function(e){var t=this.__data__,r=eR(t,e);return!(r<0)&&(r==t.length-1?t.pop():eu.call(t,r,1),!0)},ek.prototype.get=function(e){var t=this.__data__,r=eR(t,e);return r<0?void 0:t[r][1]},ek.prototype.has=function(e){return eR(this.__data__,e)>-1},ek.prototype.set=function(e,t){var r=this.__data__,n=eR(r,e);return n<0?r.push([e,t]):r[n][1]=t,this},eN.prototype.clear=function(){this.__data__={hash:new eS,map:new(em||ek),string:new eS}},eN.prototype.delete=function(e){return eD(this,e).delete(e)},eN.prototype.get=function(e){return eD(this,e).get(e)},eN.prototype.has=function(e){return eD(this,e).has(e)},eN.prototype.set=function(e,t){return eD(this,e).set(e,t),this},eC.prototype.clear=function(){this.__data__=new ek},eC.prototype.delete=function(e){return this.__data__.delete(e)},eC.prototype.get=function(e){return this.__data__.get(e)},eC.prototype.has=function(e){return this.__data__.has(e)},eC.prototype.set=function(e,t){var r=this.__data__;if(r instanceof ek){var n=r.__data__;if(!em||n.length<199)return n.push([e,t]),this;r=this.__data__=new eN(n)}return r.set(e,t),this};var ej=ed?K(ed,Object):function(){return[]},eB=function(e){return er.call(e)};function eF(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Z)}function eU(e){if(null!=e){try{return ee.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function eq(e,t){return e===t||e!=e&&t!=t}(ef&&eB(new ef(new ArrayBuffer(1)))!=x||em&&eB(new em)!=u||eg&&eB(eg.resolve())!=p||eb&&eB(new eb)!=g||ev&&eB(new ev)!=y)&&(eB=function(e){var t=er.call(e),r=t==h?e.constructor:void 0,n=r?eU(r):void 0;if(n)switch(n){case ew:return x;case ex:return u;case eE:return p;case e_:return g;case eT:return y}return t});var ez=Array.isArray;function eH(e){var t;return null!=e&&"number"==typeof(t=e.length)&&t>-1&&t%1==0&&t<=0x1fffffffffffff&&!eV(e)}var eX=eh||function(){return!1};function eV(e){var t=e$(e)?er.call(e):"";return t==l||t==c}function e$(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function eK(e){return eH(e)?function(e,t){var r,n,i,s,a,l=ez(e)||(i=n=r=e)&&"object"==typeof i&&eH(n)&&et.call(r,"callee")&&(!ec.call(r,"callee")||er.call(r)==o)?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],c=l.length,u=!!c;for(var d in e){et.call(e,d)&&!(u&&("length"==d||(s=d,(a=null==(a=c)?0x1fffffffffffff:a)&&("number"==typeof s||P.test(s))&&s>-1&&s%1==0&&s<a)))&&l.push(d)}return l}(e):function(e){if(!eF(e))return ep(e);var t=[];for(var r in Object(e))et.call(e,r)&&"constructor"!=r&&t.push(r);return t}(e)}e.exports=function(e){return function e(t,r,n,i,p,y,R){if(i&&(P=y?i(t,p,y,R):i(t)),void 0!==P)return P;if(!e$(t))return t;var P,D=ez(t);if(D){if(B=(j=t).length,F=j.constructor(B),B&&"string"==typeof j[0]&&et.call(j,"index")&&(F.index=j.index,F.input=j.input),P=F,!r){var j,B,F,U=t,q=P,K=-1,G=U.length;for(q||(q=Array(G));++K<G;)q[K]=U[K];return q}}else{var Y,Z,J,Q,ee,er=eB(t),en=er==l||er==c;if(eX(t)){var ei=t,eo=r;if(eo)return ei.slice();var es=new ei.constructor(ei.length);return ei.copy(es),es}if(er==h||er==o||en&&!y){if(V(t))return y?t:{};if(P="function"!=typeof(Y=en?{}:t).constructor||eF(Y)?{}:e$(Z=ea(Y))?el(Z):{},!r){return J=t,Q=(ee=P)&&eL(t,eK(t),ee),eL(J,ej(J),Q)}}else{if(!L[er])return y?t:{};P=function(e,t,r,n){var i,o,l,c=e.constructor;switch(t){case w:return eP(e);case s:case a:return new c(+e);case x:return i=n?eP(e.buffer):e.buffer,new e.constructor(i,e.byteOffset,e.byteLength);case E:case _:case T:case O:case A:case S:case k:case N:case C:return o=n?eP(e.buffer):e.buffer,new e.constructor(o,e.byteOffset,e.length);case u:return X(n?r($(e),!0):$(e),z,new e.constructor);case d:case b:return new c(e);case f:return(l=new e.constructor(e.source,I.exec(e))).lastIndex=e.lastIndex,l;case g:return X(n?r(W(e),!0):W(e),H,new e.constructor);case v:return eA?Object(eA.call(e)):{}}}(t,er,e,r)}}R||(R=new eC);var ec=R.get(t);if(ec)return ec;if(R.set(t,P),!D)var eu=n?function(e){var t;return t=eK(e),ez(e)?t:function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}(t,ej(e))}(t):eK(t);return!function(e,t){for(var r=-1,n=e?e.length:0;++r<n&&!1!==t(e[r],r,e););}(eu||t,function(o,s){eu&&(o=t[s=o]),eI(P,s,e(o,r,n,i,s,t,R))}),P}(e,!0,!0)}},2178:function(e,t,r){e=r.nmd(e);var n,i,o,s="__lodash_hash_undefined__",a="[object Arguments]",l="[object Array]",c="[object Boolean]",u="[object Date]",d="[object Error]",h="[object Function]",p="[object Map]",f="[object Number]",g="[object Object]",b="[object Promise]",v="[object RegExp]",y="[object Set]",w="[object String]",x="[object WeakMap]",E="[object ArrayBuffer]",_="[object DataView]",T=/^\[object .+?Constructor\]$/,O=/^(?:0|[1-9]\d*)$/,A={};A["[object Float32Array]"]=A["[object Float64Array]"]=A["[object Int8Array]"]=A["[object Int16Array]"]=A["[object Int32Array]"]=A["[object Uint8Array]"]=A["[object Uint8ClampedArray]"]=A["[object Uint16Array]"]=A["[object Uint32Array]"]=!0,A[a]=A[l]=A[E]=A[c]=A[_]=A[u]=A[d]=A[h]=A[p]=A[f]=A[g]=A[v]=A[y]=A[w]=A[x]=!1;var S="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g,k="object"==typeof self&&self&&self.Object===Object&&self,N=S||k||Function("return this")(),C=t&&!t.nodeType&&t,I=C&&e&&!e.nodeType&&e,R=I&&I.exports===C,P=R&&S.process,L=function(){try{return P&&P.binding&&P.binding("util")}catch(e){}}(),D=L&&L.isTypedArray;function j(e){var t=-1,r=Array(e.size);return e.forEach(function(e,n){r[++t]=[n,e]}),r}function B(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}var F=Array.prototype,U=Function.prototype,q=Object.prototype,z=N["__core-js_shared__"],H=U.toString,X=q.hasOwnProperty,V=(n=/[^.]+$/.exec(z&&z.keys&&z.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",$=q.toString,K=RegExp("^"+H.call(X).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),W=R?N.Buffer:void 0,G=N.Symbol,Y=N.Uint8Array,Z=q.propertyIsEnumerable,J=F.splice,Q=G?G.toStringTag:void 0,ee=Object.getOwnPropertySymbols,et=W?W.isBuffer:void 0,er=(i=Object.keys,o=Object,function(e){return i(o(e))}),en=eS(N,"DataView"),ei=eS(N,"Map"),eo=eS(N,"Promise"),es=eS(N,"Set"),ea=eS(N,"WeakMap"),el=eS(Object,"create"),ec=eC(en),eu=eC(ei),ed=eC(eo),eh=eC(es),ep=eC(ea),ef=G?G.prototype:void 0,em=ef?ef.valueOf:void 0;function eg(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function eb(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function ev(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function ey(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new ev;++t<r;)this.add(e[t])}function ew(e){var t=this.__data__=new eb(e);this.size=t.size}function ex(e,t){for(var r=e.length;r--;)if(eI(e[r][0],t))return r;return -1}function eE(e){var t;return null==e?void 0===e?"[object Undefined]":"[object Null]":Q&&Q in Object(e)?function(e){var t=X.call(e,Q),r=e[Q];try{e[Q]=void 0;var n=!0}catch(e){}var i=$.call(e);return n&&(t?e[Q]=r:delete e[Q]),i}(e):(t=e,$.call(t))}function e_(e){return eB(e)&&eE(e)==a}function eT(e,t,r,n,i,o){var s=1&r,a=e.length,l=t.length;if(a!=l&&!(s&&l>a))return!1;var c=o.get(e);if(c&&o.get(t))return c==t;var u=-1,d=!0,h=2&r?new ey:void 0;for(o.set(e,t),o.set(t,e);++u<a;){var p=e[u],f=t[u];if(n)var g=s?n(f,p,u,t,e,o):n(p,f,u,e,t,o);if(void 0!==g){if(g)continue;d=!1;break}if(h){if(!function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}(t,function(e,t){if(!h.has(t)&&(p===e||i(p,e,r,n,o)))return h.push(t)})){d=!1;break}}else if(!(p===f||i(p,f,r,n,o))){d=!1;break}}return o.delete(e),o.delete(t),d}function eO(e){var t;return t=eU(e),eP(e)?t:function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}(t,ek(e))}function eA(e,t){var r,n,i=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof t?"string":"hash"]:i.map}function eS(e,t){var r,n=null==e?void 0:e[t];return!(!ej(n)||(r=n,V&&V in r))&&(eD(n)?K:T).test(eC(n))?n:void 0}eg.prototype.clear=function(){this.__data__=el?el(null):{},this.size=0},eg.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=!!t,t},eg.prototype.get=function(e){var t=this.__data__;if(el){var r=t[e];return r===s?void 0:r}return X.call(t,e)?t[e]:void 0},eg.prototype.has=function(e){var t=this.__data__;return el?void 0!==t[e]:X.call(t,e)},eg.prototype.set=function(e,t){var r=this.__data__;return this.size+=+!this.has(e),r[e]=el&&void 0===t?s:t,this},eb.prototype.clear=function(){this.__data__=[],this.size=0},eb.prototype.delete=function(e){var t=this.__data__,r=ex(t,e);return!(r<0)&&(r==t.length-1?t.pop():J.call(t,r,1),--this.size,!0)},eb.prototype.get=function(e){var t=this.__data__,r=ex(t,e);return r<0?void 0:t[r][1]},eb.prototype.has=function(e){return ex(this.__data__,e)>-1},eb.prototype.set=function(e,t){var r=this.__data__,n=ex(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this},ev.prototype.clear=function(){this.size=0,this.__data__={hash:new eg,map:new(ei||eb),string:new eg}},ev.prototype.delete=function(e){var t=eA(this,e).delete(e);return this.size-=!!t,t},ev.prototype.get=function(e){return eA(this,e).get(e)},ev.prototype.has=function(e){return eA(this,e).has(e)},ev.prototype.set=function(e,t){var r=eA(this,e),n=r.size;return r.set(e,t),this.size+=+(r.size!=n),this},ey.prototype.add=ey.prototype.push=function(e){return this.__data__.set(e,s),this},ey.prototype.has=function(e){return this.__data__.has(e)},ew.prototype.clear=function(){this.__data__=new eb,this.size=0},ew.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},ew.prototype.get=function(e){return this.__data__.get(e)},ew.prototype.has=function(e){return this.__data__.has(e)},ew.prototype.set=function(e,t){var r=this.__data__;if(r instanceof eb){var n=r.__data__;if(!ei||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new ev(n)}return r.set(e,t),this.size=r.size,this};var ek=ee?function(e){return null==e?[]:function(e,t){for(var r=-1,n=null==e?0:e.length,i=0,o=[];++r<n;){var s=e[r];t(s,r,e)&&(o[i++]=s)}return o}(ee(e=Object(e)),function(t){return Z.call(e,t)})}:function(){return[]},eN=eE;function eC(e){if(null!=e){try{return H.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function eI(e,t){return e===t||e!=e&&t!=t}(en&&eN(new en(new ArrayBuffer(1)))!=_||ei&&eN(new ei)!=p||eo&&eN(eo.resolve())!=b||es&&eN(new es)!=y||ea&&eN(new ea)!=x)&&(eN=function(e){var t=eE(e),r=t==g?e.constructor:void 0,n=r?eC(r):"";if(n)switch(n){case ec:return _;case eu:return p;case ed:return b;case eh:return y;case ep:return x}return t});var eR=e_(function(){return arguments}())?e_:function(e){return eB(e)&&X.call(e,"callee")&&!Z.call(e,"callee")},eP=Array.isArray,eL=et||function(){return!1};function eD(e){if(!ej(e))return!1;var t=eE(e);return t==h||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}function eM(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=0x1fffffffffffff}function ej(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function eB(e){return null!=e&&"object"==typeof e}var eF=D?function(e){return D(e)}:function(e){return eB(e)&&eM(e.length)&&!!A[eE(e)]};function eU(e){return null!=e&&eM(e.length)&&!eD(e)?function(e,t){var r,n,i=eP(e),o=!i&&eR(e),s=!i&&!o&&eL(e),a=!i&&!o&&!s&&eF(e),l=i||o||s||a,c=l?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],u=c.length;for(var d in e){X.call(e,d)&&!(l&&("length"==d||s&&("offset"==d||"parent"==d)||a&&("buffer"==d||"byteLength"==d||"byteOffset"==d)||(r=d,(n=null==(n=u)?0x1fffffffffffff:n)&&("number"==typeof r||O.test(r))&&r>-1&&r%1==0&&r<n)))&&c.push(d)}return c}(e):function(e){if(r=(t=e)&&t.constructor,t!==("function"==typeof r&&r.prototype||q))return er(e);var t,r,n=[];for(var i in Object(e))X.call(e,i)&&"constructor"!=i&&n.push(i);return n}(e)}e.exports=function(e,t){return function e(t,r,n,i,o){return t===r||(null!=t&&null!=r&&(eB(t)||eB(r))?function(e,t,r,n,i,o){var s=eP(e),h=eP(t),b=s?l:eN(e),x=h?l:eN(t);b=b==a?g:b,x=x==a?g:x;var T=b==g,O=x==g,A=b==x;if(A&&eL(e)){if(!eL(t))return!1;s=!0,T=!1}if(A&&!T)return o||(o=new ew),s||eF(e)?eT(e,t,r,n,i,o):function(e,t,r,n,i,o,s){switch(r){case _:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)break;e=e.buffer,t=t.buffer;case E:if(e.byteLength!=t.byteLength||!o(new Y(e),new Y(t)))break;return!0;case c:case u:case f:return eI(+e,+t);case d:return e.name==t.name&&e.message==t.message;case v:case w:return e==t+"";case p:var a=j;case y:var l=1&n;if(a||(a=B),e.size!=t.size&&!l)break;var h=s.get(e);if(h)return h==t;n|=2,s.set(e,t);var g=eT(a(e),a(t),n,i,o,s);return s.delete(e),g;case"[object Symbol]":if(em)return em.call(e)==em.call(t)}return!1}(e,t,b,r,n,i,o);if(!(1&r)){var S=T&&X.call(e,"__wrapped__"),k=O&&X.call(t,"__wrapped__");if(S||k){var N=S?e.value():e,C=k?t.value():t;return o||(o=new ew),i(N,C,r,n,o)}}return!!A&&(o||(o=new ew),function(e,t,r,n,i,o){var s=1&r,a=eO(e),l=a.length;if(l!=eO(t).length&&!s)return!1;for(var c=l;c--;){var u=a[c];if(!(s?u in t:X.call(t,u)))return!1}var d=o.get(e);if(d&&o.get(t))return d==t;var h=!0;o.set(e,t),o.set(t,e);for(var p=s;++c<l;){var f=e[u=a[c]],g=t[u];if(n)var b=s?n(g,f,u,t,e,o):n(f,g,u,e,t,o);if(!(void 0===b?f===g||i(f,g,r,n,o):b)){h=!1;break}p||(p="constructor"==u)}if(h&&!p){var v=e.constructor,y=t.constructor;v!=y&&"constructor"in e&&"constructor"in t&&!("function"==typeof v&&v instanceof v&&"function"==typeof y&&y instanceof y)&&(h=!1)}return o.delete(e),o.delete(t),h}(e,t,r,n,i,o))}(t,r,n,i,e,o):t!=t&&r!=r)}(e,t)}},5723:function(e,t,r){"use strict";t.meiosisSetup=void 0;var n=r(2793);Object.defineProperty(t,"meiosisSetup",{enumerable:!0,get:function(){return n.meiosisSetup}})},2793:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.meiosisSetup=void 0;let i=r(706),o=r(7489),s=n(r(1038)),a=(e,t,r)=>(r[e]=t,r),l=(e,t)=>t?e.concat(t):e,c=e=>e?Object.keys(e).reduce((t,r)=>a(r,Object.assign({},e[r].initial,c(e[r].nested)),t),{}):{},u=e=>e?Object.keys(e).reduce((t,r)=>{let n=e[r];if(void 0!==n.view){let e=n.view;return a(r,{view:(t,...n)=>e(t.nest(r),...n),nested:u(n.nested)},t)}return t},{}):{},d=(e,t=e=>e,r=e=>e)=>e?Object.keys(e).reduce((n,i)=>{var o;let s=e=>t(e).nest(i),a=e=>r(e)[i],c=e[i];return l(n,null==(o=c.services)?void 0:o.map(e=>({onchange:t=>e.onchange?e.onchange(a(t)):t,run:t=>e.run(s(t))}))).concat(d(c.nested,s,a))},[]):[],h=(e,t,r)=>n=>{let i=e.map(e=>e[n]),s=()=>e()[n],a=e=>t({[n]:e}),l=(0,o.get)(r,[n,"nested"]);return{states:i,state:s(),getState:s,update:a,nest:h(i,a,l),nested:l}};t.meiosisSetup=e=>{let t=null==e?void 0:e.stream,r=null==e?void 0:e.app,{states:n,update:o,view:a}=(({stream:e,app:t})=>{e||(e=i.simpleStream);let r=t||{},n=Object.assign({},r.initial,c(r.nested)),o=u(r.nested),a="function"==typeof e?e:e.stream,l=e.scan,d=a();return{states:l((e,t)=>(0,s.default)(e,t),n,d),update:d,view:o}})({stream:t,app:r}),p=h(n,o,a),f=()=>n(),g=e=>({states:n,state:e,getState:f,update:o,nest:p,nested:a}),b=(0,i.createDropRepeats)(t);return r&&l([],r.services).concat(d(r.nested)).forEach(e=>{b(n,e.onchange).map(t=>e.run(g(t)))}),b(n).map(g)}},706:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dropRepeats=t.createDropRepeats=t.simpleStream=t.scan=t.stream=void 0,t.stream=e=>{let r=[],n=e,i=function(e){if(arguments.length>0&&!i.ended)for(let t in n=e,r)r[t](n);return n};return i.map=e=>{let i=(0,t.stream)(),o=t=>{i(e(t))};return r.push(o),i.end=e=>{let t=r.indexOf(o);i.ended=!0,r.splice(t,1)},void 0!==n&&i(e(n)),i},i.end=e=>{i.ended=!0},i},t.scan=(e,r,n)=>{let i=(0,t.stream)(r),o=r;return n.map(t=>{i(o=e(o,t))}),i},t.simpleStream={stream:t.stream,scan:t.scan},t.createDropRepeats=(e=t.simpleStream)=>(t,r=e=>e)=>{let n,i=("function"==typeof e?e:e.stream)();return t.map(e=>{let t=r(e);t!==n&&(n=t,i(e))}),i},t.dropRepeats=(0,t.createDropRepeats)()},7489:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateFormFloatValue=t.updateFormIntValue=t.updateFormValue=t.get=void 0,t.get=(e,t)=>t.reduce((e,t)=>void 0==e?void 0:e[t],e);let r=(e,t)=>({[e[0]]:1===e.length?t:r(e.slice(1),t)}),n=e=>Array.isArray(e)?e:[e],i=(e,t,i)=>o=>{let s=e(o.currentTarget.value);isNaN(s)||t.update(r(n(i),s))};t.updateFormValue=(e,t,i=e=>e)=>o=>e.update(r(n(t),i(o.currentTarget.value))),t.updateFormIntValue=(e,t)=>r=>i(parseInt,e,t)(r),t.updateFormFloatValue=(e,t)=>r=>i(parseFloat,e,t)(r)},1038:function(e,t,r){"use strict";r.r(t),r.d(t,{default:()=>s});let n=Object.assign||((e,t)=>(t&&Object.keys(t).forEach(r=>e[r]=t[r]),e)),i=(e,t,r)=>{let n=typeof r;if(r&&"object"===n)if(Array.isArray(r))for(let n of r)t=i(e,t,n);else for(let n of Object.keys(r)){let s=r[n];"function"==typeof s?t[n]=s(t[n],o):void 0===s?e&&!isNaN(n)?t.splice(n,1):delete t[n]:null===s||"object"!=typeof s||Array.isArray(s)?t[n]=s:"object"==typeof t[n]?t[n]=s===t[n]?s:o(t[n],s):t[n]=i(!1,{},s)}else"function"===n&&(t=r(t,o));return t},o=(e,...t)=>{let r=Array.isArray(e);return i(r,r?e.slice():n({},e),t)},s=o},1835:function(e,t,r){"use strict";var n=r(6660);e.exports=function(e,t,r){var i=[],o=!1,s=-1;function a(){for(s=0;s<i.length;s+=2)try{e(i[s],n(i[s+1]),l)}catch(e){r.error(e)}s=-1}function l(){o||(o=!0,t(function(){o=!1,a()}))}return l.sync=a,{mount:function(t,r){if(null!=r&&null==r.view&&"function"!=typeof r)throw TypeError("m.mount expects a component, not a vnode.");var o=i.indexOf(t);o>=0&&(i.splice(o,2),o<=s&&(s-=2),e(t,[])),null!=r&&(i.push(t,r),e(t,n(r),l))},redraw:l}}},3745:function(e,t,r){"use strict";var n=r(6660),i=r(6999),o=r(422),s=r(4837),a=r(993),l=r(8470);function c(e){try{return decodeURIComponent(e)}catch(t){return e}}e.exports=function(e,t){var r,u,d,h,p,f,g,b,v=null==e?null:"function"==typeof e.setImmediate?e.setImmediate:e.setTimeout,y=Promise.resolve(),w=!1,x=!1,E=!1,_={onremove:function(){x=E=!1,e.removeEventListener("popstate",A,!1)},view:function(){var e=n(p,f.key,f);return h?h.render(e):[e]}},T=S.SKIP={};function O(){w=!1;var n=e.location.hash;"#"!==S.prefix[0]&&(n=e.location.search+n,"?"!==S.prefix[0]&&"/"!==(n=e.location.pathname+n)[0]&&(n="/"+n));var i=n.concat().replace(/(?:%[a-f89][a-f0-9])+/gim,c).slice(S.prefix.length),o=s(i);function a(e){console.error(e),S.set(d,null,{replace:!0})}Object.assign(o.params,e.history.state),function e(n){for(;n<u.length;n++)if(u[n].check(o)){var s=u[n].component,l=u[n].route,c=s,v=b=function(a){if(v===b){if(a===T)return e(n+1);p=null!=a&&("function"==typeof a.view||"function"==typeof a)?a:"div",f=o.params,g=i,b=null,h=s.render?s:null,E?t.redraw():(E=!0,t.mount(r,_))}};s.view||"function"==typeof s?(s={},v(c)):s.onmatch?y.then(function(){return s.onmatch(o.params,i,l)}).then(v,i===d?null:a):v();return}if(i===d)throw Error("Could not resolve default route "+d+".");S.set(d,null,{replace:!0})}(0)}function A(){w||(w=!0,v(O))}function S(t,n,i){if(!t)throw TypeError("DOM element being rendered to does not exist.");if(u=Object.keys(i).map(function(e){if("/"!==e[0])throw SyntaxError("Routes must start with a '/'.");if(/:([^\/\.-]+)(\.{3})?:/.test(e))throw SyntaxError("Route parameter names must be separated with either '/', '.', or '-'.");return{route:e,component:i[e],check:a(e)}}),d=n,null!=n){var o=s(n);if(!u.some(function(e){return e.check(o)}))throw ReferenceError("Default route doesn't match any known routes.")}r=t,e.addEventListener("popstate",A,!1),x=!0,O()}return S.set=function(t,r,n){if(null!=b&&((n=n||{}).replace=!0),b=null,t=o(t,r),x){A();var i=n?n.state:null,s=n?n.title:null;n&&n.replace?e.history.replaceState(i,s,S.prefix+t):e.history.pushState(i,s,S.prefix+t)}else e.location.href=S.prefix+t},S.get=function(){return g},S.prefix="#!",S.Link={view:function(e){var t,r,n,s=i(e.attrs.selector||"a",l(e.attrs,["options","params","selector","onclick"]),e.children);return(s.attrs.disabled=!!s.attrs.disabled)?(s.attrs.href=null,s.attrs["aria-disabled"]="true"):(t=e.attrs.options,r=e.attrs.onclick,n=o(s.attrs.href,e.attrs.params),s.attrs.href=S.prefix+n,s.attrs.onclick=function(e){var i;"function"==typeof r?i=r.call(e.currentTarget,e):null==r||"object"!=typeof r||"function"==typeof r.handleEvent&&r.handleEvent(e),!1===i||e.defaultPrevented||0!==e.button&&0!==e.which&&1!==e.which||e.currentTarget.target&&"_self"!==e.currentTarget.target||e.ctrlKey||e.metaKey||e.shiftKey||e.altKey||(e.preventDefault(),e.redraw=!1,S.set(n,null,t))}),s}},S.param=function(e){return f&&null!=e?f[e]:f},S}},1460:function(e,t,r){"use strict";var n=r(6999);n.trust=r(4508),n.fragment=r(6496),e.exports=n},3201:function(e,t,r){"use strict";var n=r(1460),i=r(9428),o=r(3502),s=r(6195),a=function(){return n.apply(this,arguments)};a.m=n,a.trust=n.trust,a.fragment=n.fragment,a.Fragment="[",a.mount=o.mount,a.route=r(224),a.render=r(8017),a.redraw=o.redraw,a.request=i.request,a.parseQueryString=r(7996),a.buildQueryString=r(8223),a.parsePathname=r(4837),a.buildPathname=r(422),a.vnode=r(6660),a.censor=r(8470),a.domFor=s.domFor,e.exports=a},3502:function(e,t,r){"use strict";var n=r(8017);e.exports=r(1835)(n,"undefined"!=typeof requestAnimationFrame?requestAnimationFrame:null,"undefined"!=typeof console?console:null)},422:function(e,t,r){"use strict";var n=r(8223);e.exports=function(e,t){if(/:([^\/\.-]+)(\.{3})?:/.test(e))throw SyntaxError("Template parameter names must be separated by either a '/', '-', or '.'.");if(null==t)return e;var r=e.indexOf("?"),i=e.indexOf("#"),o=i<0?e.length:i,s=e.slice(0,r<0?o:r),a={};Object.assign(a,t);var l=s.replace(/:([^\/\.-]+)(\.{3})?/g,function(e,r,n){return(delete a[r],null==t[r])?e:n?t[r]:encodeURIComponent(String(t[r]))}),c=l.indexOf("?"),u=l.indexOf("#"),d=u<0?l.length:u,h=l.slice(0,c<0?d:c);r>=0&&(h+=e.slice(r,o)),c>=0&&(h+=(r<0?"?":"&")+l.slice(c,d));var p=n(a);return p&&(h+=(r<0&&c<0?"?":"&")+p),i>=0&&(h+=e.slice(i)),u>=0&&(h+=(i<0?"":"&")+l.slice(u)),h}},993:function(e,t,r){"use strict";var n=r(4837);e.exports=function(e){var t=n(e),r=Object.keys(t.params),i=[],o=RegExp("^"+t.path.replace(/:([^\/.-]+)(\.{3}|\.(?!\.)|-)?|[\\^$*+.()|\[\]{}]/g,function(e,t,r){return null==t?"\\"+e:(i.push({k:t,r:"..."===r}),"..."===r)?"(.*)":"."===r?"([^/]+)\\.":"([^/]+)"+(r||"")})+"\\/?$");return function(e){for(var n=0;n<r.length;n++)if(t.params[r[n]]!==e.params[r[n]])return!1;if(!i.length)return o.test(e.path);var s=o.exec(e.path);if(null==s)return!1;for(var n=0;n<i.length;n++)e.params[i[n].k]=i[n].r?s[n+1]:decodeURIComponent(s[n+1]);return!0}}},4837:function(e,t,r){"use strict";var n=r(7996);e.exports=function(e){var t=e.indexOf("?"),r=e.indexOf("#"),i=r<0?e.length:r,o=e.slice(0,t<0?i:t).replace(/\/{2,}/g,"/");return o?"/"!==o[0]&&(o="/"+o):o="/",{path:o,params:t<0?{}:n(e.slice(t+1,i))}}},8223:function(e){"use strict";e.exports=function(e){if("[object Object]"!==Object.prototype.toString.call(e))return"";var t=[];for(var r in e)!function e(r,n){if(Array.isArray(n))for(var i=0;i<n.length;i++)e(r+"["+i+"]",n[i]);else if("[object Object]"===Object.prototype.toString.call(n))for(var i in n)e(r+"["+i+"]",n[i]);else t.push(encodeURIComponent(r)+(null!=n&&""!==n?"="+encodeURIComponent(n):""))}(r,e[r]);return t.join("&")}},7996:function(e){"use strict";function t(e){try{return decodeURIComponent(e)}catch(t){return e}}e.exports=function(e){if(""===e||null==e)return{};"?"===e.charAt(0)&&(e=e.slice(1));for(var r=e.split("&"),n={},i={},o=0;o<r.length;o++){var s=r[o].split("="),a=t(s[0]),l=2===s.length?t(s[1]):"";"true"===l?l=!0:"false"===l&&(l=!1);var c=a.split(/\]\[?|\[/),u=i;a.indexOf("[")>-1&&c.pop();for(var d=0;d<c.length;d++){var h=c[d],p=c[d+1],f=""==p||!isNaN(parseInt(p,10));if(""===h){var a=c.slice(0,d).join();null==n[a]&&(n[a]=Array.isArray(u)?u.length:0),h=n[a]++}else if("__proto__"===h)break;if(d===c.length-1)u[h]=l;else{var g=Object.getOwnPropertyDescriptor(u,h);null!=g&&(g=g.value),null==g&&(u[h]=g=f?[]:{}),u=g}}}return i}},8017:function(e,t,r){"use strict";e.exports=r(8620)("undefined"!=typeof window?window:null)},7014:function(e,t,r){"use strict";e.exports=new Map([[r(111),!0]])},6195:function(e){"use strict";var t=new WeakMap;e.exports={delayedRemoval:t,domFor:function*(e){var r=e.dom,n=e.domSize,i=t.get(r);if(null!=r)do{var o=r.nextSibling;t.get(r)===i&&(yield r,n--),r=o}while(n)}}},111:function(e){"use strict";e.exports={}},6496:function(e,t,r){"use strict";var n=r(6660),i=r(9553);e.exports=function(e,...t){var r=i(e,t);return null==r.attrs&&(r.attrs={}),r.tag="[",r.children=n.normalizeChildren(r.children),r}},6999:function(e,t,r){"use strict";var n=r(6660),i=r(9553),o=r(2560),s=r(111),a=r(7014),l=/(?:(^|#|\.)([^#\.\[\]]+))|(\[(.+?)(?:\s*=\s*("|'|)((?:\\["'\]]|.)*?)\5)?\])/g,c=Object.create(null);e.exports=function(e,t,...r){if(null==e||"string"!=typeof e&&"function"!=typeof e&&"function"!=typeof e.view)throw Error("The selector must be either a string or a component.");var u=i(t,r);return"string"==typeof e&&(u.children=n.normalizeChildren(u.children),"["!==e)?function(e,t){t.tag=e.tag;var r=t.attrs;if(null==r)return t.attrs=e.attrs,t.is=e.is,t;var n=o.call(r,"class"),i=n?r.class:r.className;return e.attrs!==s?(r=Object.assign({},e.attrs,r),(null!=i||null!=e.attrs.className)&&(r.className=null!=i?null!=e.attrs.className?String(e.attrs.className)+" "+String(i):i:e.attrs.className)):null!=i&&(r.className=i),n&&(r.class=null),"input"===e.tag&&o.call(r,"type")&&(r=Object.assign({type:r.type},r)),t.is=r.is,t.attrs=r,t}(c[e]||function(e){for(var t,r="div",n=[],i={},u=!0;t=l.exec(e);){var d=t[1],h=t[2];if(""===d&&""!==h)r=h;else if("#"===d)i.id=h;else if("."===d)n.push(h);else if("["===t[3][0]){var p,f=t[6];(f&&(f=f.replace(/\\(["'])/g,"$1").replace(/\\\\/g,"\\")),"class"===t[4])?n.push(f):(i[t[4]]=""===f?f:f||!0,("value"===(p=t[4])||"checked"===p||"selectedIndex"===p||"selected"===p)&&(u=!1))}}return n.length>0&&(i.className=n.join(" ")),!function(e){for(var t in e)if(o.call(e,t))return!1;return!0}(i)?a.set(i,u):i=s,c[e]={tag:r,attrs:i,is:i.is}}(e),u):(null==u.attrs&&(u.attrs={}),u.tag=e,u)}},9553:function(e,t,r){"use strict";var n=r(6660);e.exports=function(e,t){return null!=e&&("object"!=typeof e||null!=e.tag||Array.isArray(e))?(t=0===t.length&&Array.isArray(e)?e:[e,...t],e=void 0):1===t.length&&Array.isArray(t[0])&&(t=t[0]),n("",e&&e.key,e,t)}},8620:function(e,t,r){"use strict";var n=r(6660),i=r(6195),o=i.delayedRemoval,s=i.domFor,a=r(7014);e.exports=function(){var e,t,r,i={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"};function l(e){return e.ownerDocument}function c(e){return e.attrs&&e.attrs.xmlns||i[e.tag]}function u(e,t){if(e.state!==t)throw Error("'vnode.state' must not be modified.")}function d(e){var t=e.state;try{return this.apply(t,arguments)}finally{u(e,t)}}function h(e){try{return l(e).activeElement}catch(e){return null}}function p(e,t,r,n,i,o,s){for(var a=r;a<n;a++){var l=t[a];null!=l&&f(e,l,i,s,o)}}function f(e,t,r,i,o){var s,a,u,h,g,v,y,w,x=t.tag;if("string"==typeof x)switch(t.state={},null!=t.attrs&&j(t.attrs,t,r),x){case"#":s=e,a=t,u=o,a.dom=l(s).createTextNode(a.children),_(s,a.dom,u);break;case"<":b(e,t,i,o);break;case"[":var E=e,O=t,A=r,S=i,k=o,N=l(E).createDocumentFragment();if(null!=O.children){var I=O.children;p(N,I,0,I.length,A,null,S)}O.dom=N.firstChild,O.domSize=N.childNodes.length,_(E,N,k);break;default:!function(e,t,r,n,i){var o=t.tag,s=t.attrs,a=t.is,u=(n=c(t)||n)?a?l(e).createElementNS(n,o,{is:a}):l(e).createElementNS(n,o):a?l(e).createElement(o,{is:a}):l(e).createElement(o);if(t.dom=u,null!=s&&function(e,t,r){for(var n in t)C(e,n,null,t[n],r)}(t,s,n),_(e,u,i),!T(t)&&null!=t.children){var d=t.children;p(u,d,0,d.length,r,null,n),"select"===t.tag&&null!=s&&function(e,t){if("value"in t)if(null===t.value)-1!==e.dom.selectedIndex&&(e.dom.value=null);else{var r=""+t.value;(e.dom.value!==r||-1===e.dom.selectedIndex)&&(e.dom.value=r)}"selectedIndex"in t&&C(e,"selectedIndex",null,t.selectedIndex,void 0)}(t,s)}}(e,t,r,i,o)}else{h=e,g=t,v=r,y=i,w=o,!function(e,t){var r;if("function"==typeof e.tag.view){if(e.state=Object.create(e.tag),null!=(r=e.state.view).$$reentrantLock$$)return;r.$$reentrantLock$$=!0}else{if(e.state=void 0,null!=(r=e.tag).$$reentrantLock$$)return;r.$$reentrantLock$$=!0,e.state=null!=e.tag.prototype&&"function"==typeof e.tag.prototype.view?new e.tag(e):e.tag(e)}if(j(e.state,e,t),null!=e.attrs&&j(e.attrs,e,t),e.instance=n.normalize(d.call(e.state.view,e)),e.instance===e)throw Error("A view cannot return the vnode it received as argument");r.$$reentrantLock$$=null}(g,v),null!=g.instance?(f(h,g.instance,v,y,w),g.dom=g.instance.dom,g.domSize=null!=g.dom?g.instance.domSize:0):g.domSize=0}}var g={caption:"table",thead:"table",tbody:"table",tfoot:"table",tr:"tbody",th:"tr",td:"tr",colgroup:"table",col:"colgroup"};function b(e,t,r,n){var i,o=t.children.match(/^\s*?<(\w+)/im)||[],s=l(e).createElement(g[o[1]]||"div");"http://www.w3.org/2000/svg"===r?(s.innerHTML='<svg xmlns="http://www.w3.org/2000/svg">'+t.children+"</svg>",s=s.firstChild):s.innerHTML=t.children,t.dom=s.firstChild,t.domSize=s.childNodes.length;for(var a=l(e).createDocumentFragment();i=s.firstChild;)a.appendChild(i);_(e,a,n)}function v(e,t,r,n,i,o){if(t!==r&&(null!=t||null!=r))if(null==t||0===t.length)p(e,r,0,r.length,n,i,o);else if(null==r||0===r.length)O(e,t,0,t.length);else{var s=null!=t[0]&&null!=t[0].key,a=null!=r[0]&&null!=r[0].key,l=0,c=0;if(!s)for(;c<t.length&&null==t[c];)c++;if(!a)for(;l<r.length&&null==r[l];)l++;if(s!==a)O(e,t,c,t.length),p(e,r,l,r.length,n,i,o);else if(a){for(var u,d,h,g,b,v,_=t.length-1,T=r.length-1;_>=c&&T>=l&&(g=t[_],b=r[T],g.key===b.key);)g!==b&&y(e,g,b,n,i,o),null!=b.dom&&(i=b.dom),_--,T--;for(;_>=c&&T>=l&&(d=t[c],h=r[l],d.key===h.key);)c++,l++,d!==h&&y(e,d,h,n,x(t,c,i),o);for(;_>=c&&T>=l&&l!==T&&d.key===b.key&&g.key===h.key;)E(e,g,v=x(t,c,i)),g!==h&&y(e,g,h,n,v,o),++l<=--T&&E(e,d,i),d!==b&&y(e,d,b,n,i,o),null!=b.dom&&(i=b.dom),c++,g=t[--_],b=r[T],d=t[c],h=r[l];for(;_>=c&&T>=l&&g.key===b.key;)g!==b&&y(e,g,b,n,i,o),null!=b.dom&&(i=b.dom),_--,T--,g=t[_],b=r[T];if(l>T)O(e,t,c,_+1);else if(c>_)p(e,r,l,T+1,n,i,o);else{var u,A,S=i,N=T-l+1,C=Array(N),I=0,R=0,P=0x7fffffff,L=0;for(R=0;R<N;R++)C[R]=-1;for(R=T;R>=l;R--){null==u&&(u=function(e,t,r){for(var n=Object.create(null);t<r;t++){var i=e[t];if(null!=i){var o=i.key;null!=o&&(n[o]=t)}}return n}(t,c,_+1));var D=u[(b=r[R]).key];null!=D&&(P=D<P?D:-1,C[R-l]=D,g=t[D],t[D]=null,g!==b&&y(e,g,b,n,i,o),null!=b.dom&&(i=b.dom),L++)}if(i=S,L!==_-c+1&&O(e,t,c,_+1),0===L)p(e,r,l,T+1,n,i,o);else if(-1===P)for(I=(A=function(e){for(var t=[0],r=0,n=0,i=0,o=w.length=e.length,i=0;i<o;i++)w[i]=e[i];for(var i=0;i<o;++i)if(-1!==e[i]){var s=t[t.length-1];if(e[s]<e[i]){w[i]=s,t.push(i);continue}for(r=0,n=t.length-1;r<n;){var a=(r>>>1)+(n>>>1)+(r&n&1);e[t[a]]<e[i]?r=a+1:n=a}e[i]<e[t[r]]&&(r>0&&(w[i]=t[r-1]),t[r]=i)}for(r=t.length,n=t[r-1];r-- >0;)t[r]=n,n=w[n];return w.length=0,t}(C)).length-1,R=T;R>=l;R--)h=r[R],-1===C[R-l]?f(e,h,n,o,i):A[I]===R-l?I--:E(e,h,i),null!=h.dom&&(i=r[R].dom);else for(R=T;R>=l;R--)h=r[R],-1===C[R-l]&&f(e,h,n,o,i),null!=h.dom&&(i=r[R].dom)}}else{var j=t.length<r.length?t.length:r.length;for(l=l<c?l:c;l<j;l++)(d=t[l])!==(h=r[l])&&(null!=d||null!=h)&&(null==d?f(e,h,n,o,x(t,l+1,i)):null==h?k(e,d):y(e,d,h,n,x(t,l+1,i),o));t.length>j&&O(e,t,l,t.length),r.length>j&&p(e,r,l,r.length,n,i,o)}}}function y(e,t,r,i,o,s){var l=t.tag;if(l===r.tag&&t.is===r.is){if(r.state=t.state,r.events=t.events,function(e,t){do{if(null!=e.attrs&&"function"==typeof e.attrs.onbeforeupdate){var r=d.call(e.attrs.onbeforeupdate,e,t);if(void 0!==r&&!r)break}if("string"!=typeof e.tag&&"function"==typeof e.state.onbeforeupdate){var r=d.call(e.state.onbeforeupdate,e,t);if(void 0!==r&&!r)break}return!1}while(!1);return e.dom=t.dom,e.domSize=t.domSize,e.instance=t.instance,e.attrs=t.attrs,e.children=t.children,e.text=t.text,!0}(r,t))return;if("string"==typeof l)switch(null!=r.attrs&&B(r.attrs,r,i),l){case"#":u=t,p=r,u.children.toString()!==p.children.toString()&&(u.dom.nodeValue=p.children),p.dom=u.dom;break;case"<":g=e,w=t,x=r,E=s,_=o,w.children!==x.children?(N(g,w),b(g,x,E,_)):(x.dom=w.dom,x.domSize=w.domSize);break;case"[":var u,p,g,w,x,E,_,O,A,S,L,j,F=e,U=t,q=r,z=i,H=o,X=s;v(F,U.children,q.children,z,H,X);var V=0,$=q.children;if(q.dom=null,null!=$){for(var K=0;K<$.length;K++){var W=$[K];null!=W&&null!=W.dom&&(null==q.dom&&(q.dom=W.dom),V+=W.domSize||1)}1!==V&&(q.domSize=V)}break;default:O=t,A=r,S=i,L=s,j=A.dom=O.dom,L=c(A)||L,O.attrs==A.attrs&&(null==A.attrs||a.get(A.attrs))||function(e,t,r,n){var i;if(null!=t)for(var o in t!==r||a.has(r)||console.warn("Don't reuse attrs object, use new object for every redraw, this will throw in next major"),t)null!=(i=t[o])&&(null==r||null==r[o])&&function(e,t,r,n){if(!("key"===t||null==r||I(t)))if("o"===t[0]&&"n"===t[1])D(e,t,void 0);else if("style"===t)P(e.dom,r,null);else if(R(e,t,n)&&"className"!==t&&"title"!==t&&("value"!==t||"option"!==e.tag&&("select"!==e.tag||-1!==e.dom.selectedIndex||e.dom!==h(e.dom)))&&("input"!==e.tag||"type"!==t))e.dom[t]=null;else{var i=t.indexOf(":");-1!==i&&(t=t.slice(i+1)),!1!==r&&e.dom.removeAttribute("className"===t?"class":t)}}(e,o,i,n);if(null!=r)for(var o in r)C(e,o,t&&t[o],r[o],n)}(A,O.attrs,A.attrs,L),T(A)||v(j,O.children,A.children,S,null,L)}else{var G=e,Y=t,Z=r,J=i,Q=o,ee=s;if(Z.instance=n.normalize(d.call(Z.state.view,Z)),Z.instance===Z)throw Error("A view cannot return the vnode it received as argument");B(Z.state,Z,J),null!=Z.attrs&&B(Z.attrs,Z,J),null!=Z.instance?(null==Y.instance?f(G,Z.instance,J,ee,Q):y(G,Y.instance,Z.instance,J,Q,ee),Z.dom=Z.instance.dom,Z.domSize=Z.instance.domSize):null!=Y.instance?(k(G,Y.instance),Z.dom=void 0,Z.domSize=0):(Z.dom=Y.dom,Z.domSize=Y.domSize)}}else k(e,t),f(e,r,i,s,o)}var w=[];function x(e,t,r){for(;t<e.length;t++)if(null!=e[t]&&null!=e[t].dom)return e[t].dom;return r}function E(e,t,r){if(null!=t.dom){var n;if(null==t.domSize)n=t.dom;else for(var i of(n=l(e).createDocumentFragment(),s(t)))n.appendChild(i);_(e,n,r)}}function _(e,t,r){null!=r?e.insertBefore(t,r):e.appendChild(t)}function T(e){if(null==e.attrs||null==e.attrs.contenteditable&&null==e.attrs.contentEditable)return!1;var t=e.children;if(null!=t&&1===t.length&&"<"===t[0].tag){var r=t[0].children;e.dom.innerHTML!==r&&(e.dom.innerHTML=r)}else if(null!=t&&0!==t.length)throw Error("Child node of a contenteditable must be trusted.");return!0}function O(e,t,r,n){for(var i=r;i<n;i++){var o=t[i];null!=o&&k(e,o)}}function A(e,r,n,i){var a=r.state,l=d.call(n.onbeforeremove,r);if(null!=l){var c=t;for(var h of s(r))o.set(h,c);i.v++,Promise.resolve(l).finally(function(){u(r,a),S(e,r,i)})}}function S(e,t,r){0==--r.v&&(function e(t){if("string"!=typeof t.tag&&"function"==typeof t.state.onremove&&d.call(t.state.onremove,t),t.attrs&&"function"==typeof t.attrs.onremove&&d.call(t.attrs.onremove,t),"string"!=typeof t.tag)null!=t.instance&&e(t.instance);else{null!=t.events&&(t.events._=null);var r=t.children;if(Array.isArray(r))for(var n=0;n<r.length;n++){var i=r[n];null!=i&&e(i)}}}(t),N(e,t))}function k(e,t){var r={v:1};"string"!=typeof t.tag&&"function"==typeof t.state.onbeforeremove&&A(e,t,t.state,r),t.attrs&&"function"==typeof t.attrs.onbeforeremove&&A(e,t,t.attrs,r),S(e,t,r)}function N(e,t){if(null!=t.dom)if(null==t.domSize)e.removeChild(t.dom);else for(var r of s(t))e.removeChild(r)}function C(e,t,r,n,i){var o,s;if(!("key"===t||null==n||I(t))&&(r!==n||(o=e,"value"===(s=t)||"checked"===s||"selectedIndex"===s||"selected"===s&&(o.dom===h(o.dom)||"option"===o.tag&&o.dom.parentNode===h(o.dom)))||"object"==typeof n)){if("o"===t[0]&&"n"===t[1])return D(e,t,n);if("xlink:"===t.slice(0,6))e.dom.setAttributeNS("http://www.w3.org/1999/xlink",t.slice(6),n);else if("style"===t)P(e.dom,r,n);else if(R(e,t,i)){if("value"===t){if(("input"===e.tag||"textarea"===e.tag)&&e.dom.value===""+n||"select"===e.tag&&null!==r&&e.dom.value===""+n||"option"===e.tag&&null!==r&&e.dom.value===""+n)return;if("input"===e.tag&&"file"===e.attrs.type&&""+n!="")return void console.error("`value` is read-only on file inputs!")}"input"===e.tag&&"type"===t?e.dom.setAttribute(t,n):e.dom[t]=n}else"boolean"==typeof n?n?e.dom.setAttribute(t,""):e.dom.removeAttribute(t):e.dom.setAttribute("className"===t?"class":t,n)}}function I(e){return"oninit"===e||"oncreate"===e||"onupdate"===e||"onremove"===e||"onbeforeremove"===e||"onbeforeupdate"===e}function R(e,t,r){return void 0===r&&(e.tag.indexOf("-")>-1||e.is||"href"!==t&&"list"!==t&&"form"!==t&&"width"!==t&&"height"!==t)&&t in e.dom}function P(e,t,r){if(t===r);else if(null==r)e.style="";else if("object"!=typeof r)e.style=r;else if(null==t||"object"!=typeof t)for(var n in e.style="",r){var i=r[n];null!=i&&(n.includes("-")?e.style.setProperty(n,String(i)):e.style[n]=String(i))}else{for(var n in t)null!=t[n]&&null==r[n]&&(n.includes("-")?e.style.removeProperty(n):e.style[n]="");for(var n in r){var i=r[n];null!=i&&(i=String(i))!==String(t[n])&&(n.includes("-")?e.style.setProperty(n,i):e.style[n]=i)}}}function L(){this._=e}function D(t,r,n){null!=t.events?(t.events._=e,t.events[r]!==n&&(null!=n&&("function"==typeof n||"object"==typeof n)?(null==t.events[r]&&t.dom.addEventListener(r.slice(2),t.events,!1),t.events[r]=n):(null!=t.events[r]&&t.dom.removeEventListener(r.slice(2),t.events,!1),t.events[r]=void 0))):null!=n&&("function"==typeof n||"object"==typeof n)&&(t.events=new L,t.dom.addEventListener(r.slice(2),t.events,!1),t.events[r]=n)}function j(e,t,r){"function"==typeof e.oninit&&d.call(e.oninit,t),"function"==typeof e.oncreate&&r.push(d.bind(e.oncreate,t))}function B(e,t,r){"function"==typeof e.onupdate&&r.push(d.bind(e.onupdate,t))}return L.prototype=Object.create(null),L.prototype.handleEvent=function(e){var t,r=this["on"+e.type];"function"==typeof r?t=r.call(e.currentTarget,e):"function"==typeof r.handleEvent&&r.handleEvent(e);var n=this;null!=n._&&(!1!==e.redraw&&(0,n._)(),null!=t&&"function"==typeof t.then&&Promise.resolve(t).then(function(){null!=n._&&!1!==e.redraw&&(0,n._)()})),!1===t&&(e.preventDefault(),e.stopPropagation())},function(i,o,s){if(!i)throw TypeError("DOM element being rendered to does not exist.");if(null!=r&&i.contains(r))throw TypeError("Node is currently being rendered to and thus is locked.");var a=e,l=r,c=[],u=h(i),d=i.namespaceURI;r=i,e="function"==typeof s?s:void 0,t={};try{null==i.vnodes&&(i.textContent=""),o=n.normalizeChildren(Array.isArray(o)?o:[o]),v(i,i.vnodes,o,c,null,"http://www.w3.org/1999/xhtml"===d?void 0:d),i.vnodes=o,null!=u&&h(i)!==u&&"function"==typeof u.focus&&u.focus();for(var p=0;p<c.length;p++)c[p]()}finally{e=a,r=l}}}},4508:function(e,t,r){"use strict";var n=r(6660);e.exports=function(e){return null==e&&(e=""),n("<",void 0,void 0,e,void 0,void 0)}},6660:function(e){"use strict";function t(e,t,r,n,i,o){return{tag:e,key:t,attrs:r,children:n,text:i,dom:o,is:void 0,domSize:void 0,state:void 0,events:void 0,instance:void 0}}t.normalize=function(e){return Array.isArray(e)?t("[",void 0,void 0,t.normalizeChildren(e),void 0,void 0):null==e||"boolean"==typeof e?null:"object"==typeof e?e:t("#",void 0,void 0,String(e),void 0,void 0)},t.normalizeChildren=function(e){var r=[];if(e.length){for(var n=null!=e[0]&&null!=e[0].key,i=1;i<e.length;i++)if((null!=e[i]&&null!=e[i].key)!==n)throw TypeError(n&&(null==e[i]||"boolean"==typeof e[i])?"In fragments, vnodes must either all have keys or none have keys. You may wish to consider using an explicit keyed empty fragment, m.fragment({key: ...}), instead of a hole.":"In fragments, vnodes must either all have keys or none have keys.");for(var i=0;i<e.length;i++)r[i]=t.normalize(e[i])}return r},e.exports=t},9428:function(e,t,r){"use strict";var n=r(3502);e.exports=r(9370)("undefined"!=typeof window?window:null,n.redraw)},9370:function(e,t,r){"use strict";var n=r(422),i=r(2560);e.exports=function(e,t){function r(e){return new Promise(e)}function o(e,t){for(var r in e.headers)if(i.call(e.headers,r)&&r.toLowerCase()===t)return!0;return!1}return r.prototype=Promise.prototype,r.__proto__=Promise,{request:function(s,a){"string"!=typeof s?(a=s,s=s.url):null==a&&(a={});var l,c,u=(l=s,c=a,new Promise(function(t,r){l=n(l,c.params);var s,a=null!=c.method?c.method.toUpperCase():"GET",u=c.body,d=(null==c.serialize||c.serialize===JSON.serialize)&&!(u instanceof e.FormData||u instanceof e.URLSearchParams),h=c.responseType||("function"==typeof c.extract?"":"json"),p=new e.XMLHttpRequest,f=!1,g=!1,b=p,v=p.abort;for(var y in p.abort=function(){f=!0,v.call(this)},p.open(a,l,!1!==c.async,"string"==typeof c.user?c.user:void 0,"string"==typeof c.password?c.password:void 0),d&&null!=u&&!o(c,"content-type")&&p.setRequestHeader("Content-Type","application/json; charset=utf-8"),"function"==typeof c.deserialize||o(c,"accept")||p.setRequestHeader("Accept","application/json, text/*"),c.withCredentials&&(p.withCredentials=c.withCredentials),c.timeout&&(p.timeout=c.timeout),p.responseType=h,c.headers)i.call(c.headers,y)&&p.setRequestHeader(y,c.headers[y]);p.onreadystatechange=function(e){if(!f&&4===e.target.readyState)try{var n,i=e.target.status>=200&&e.target.status<300||304===e.target.status||/^file:\/\//i.test(l),o=e.target.response;if("json"===h){if(!e.target.responseType&&"function"!=typeof c.extract)try{o=JSON.parse(e.target.responseText)}catch(e){o=null}}else h&&"text"!==h||null!=o||(o=e.target.responseText);if("function"==typeof c.extract?(o=c.extract(e.target,c),i=!0):"function"==typeof c.deserialize&&(o=c.deserialize(o)),i){if("function"==typeof c.type)if(Array.isArray(o))for(var s=0;s<o.length;s++)o[s]=new c.type(o[s]);else o=new c.type(o);t(o)}else{var a=function(){try{n=e.target.responseText}catch(e){n=o}var t=Error(n);t.code=e.target.status,t.response=o,r(t)};0===p.status?setTimeout(function(){g||a()}):a()}}catch(e){r(e)}},p.ontimeout=function(e){g=!0;var t=Error("Request timed out");t.code=e.target.status,r(t)},"function"==typeof c.config&&(p=c.config(p,c,l)||p)!==b&&(s=p.abort,p.abort=function(){f=!0,s.call(this)}),null==u?p.send():"function"==typeof c.serialize?p.send(c.serialize(u)):u instanceof e.FormData||u instanceof e.URLSearchParams?p.send(u):p.send(JSON.stringify(u))}));if(!0===a.background)return u;var d=0;function h(){0==--d&&"function"==typeof t&&t()}return function e(t){var n=t.then;return t.constructor=r,t.then=function(){d++;var r=n.apply(t,arguments);return r.then(h,function(e){if(h(),0===d)throw e}),e(r)},t}(u)}}}},224:function(e,t,r){"use strict";var n=r(3502);e.exports=r(3745)("undefined"!=typeof window?window:null,n)},8470:function(e,t,r){"use strict";var n=r(2560),i=RegExp("^(?:key|oninit|oncreate|onbeforeupdate|onupdate|onbeforeremove|onremove)$");e.exports=function(e,t){var r={};if(null!=t)for(var o in e)n.call(e,o)&&!i.test(o)&&0>t.indexOf(o)&&(r[o]=e[o]);else for(var o in e)n.call(e,o)&&!i.test(o)&&(r[o]=e[o]);return r}},2560:function(e){"use strict";e.exports=({}).hasOwnProperty},6906:function(e,t,r){"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0});let o=r(5126),s=r(2178);(i=n||(n={})).compose=function(e={},t={},r=!1){"object"!=typeof e&&(e={}),"object"!=typeof t&&(t={});let n=o(t);for(let i in r||(n=Object.keys(n).reduce((e,t)=>(null!=n[t]&&(e[t]=n[t]),e),{})),e)void 0!==e[i]&&void 0===t[i]&&(n[i]=e[i]);return Object.keys(n).length>0?n:void 0},i.diff=function(e={},t={}){"object"!=typeof e&&(e={}),"object"!=typeof t&&(t={});let r=Object.keys(e).concat(Object.keys(t)).reduce((r,n)=>(s(e[n],t[n])||(r[n]=void 0===t[n]?null:t[n]),r),{});return Object.keys(r).length>0?r:void 0},i.invert=function(e={},t={}){e=e||{};let r=Object.keys(t).reduce((r,n)=>(t[n]!==e[n]&&void 0!==e[n]&&(r[n]=t[n]),r),{});return Object.keys(e).reduce((r,n)=>(e[n]!==t[n]&&void 0===t[n]&&(r[n]=null),r),r)},i.transform=function(e,t,r=!1){if("object"!=typeof e)return t;if("object"!=typeof t)return;if(!r)return t;let n=Object.keys(t).reduce((r,n)=>(void 0===e[n]&&(r[n]=t[n]),r),{});return Object.keys(n).length>0?n:void 0},t.default=n},9228:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AttributeMap=t.OpIterator=t.Op=void 0;let n=r(3864),i=r(5126),o=r(2178),s=r(6906);t.AttributeMap=s.default;let a=r(5095);t.Op=a.default;let l=r(485);t.OpIterator=l.default;let c=(e,t)=>{if("object"!=typeof e||null===e)throw Error(`cannot retain a ${typeof e}`);if("object"!=typeof t||null===t)throw Error(`cannot retain a ${typeof t}`);let r=Object.keys(e)[0];if(!r||r!==Object.keys(t)[0])throw Error(`embed types not matched: ${r} != ${Object.keys(t)[0]}`);return[r,e[r],t[r]]};class u{constructor(e){Array.isArray(e)?this.ops=e:null!=e&&Array.isArray(e.ops)?this.ops=e.ops:this.ops=[]}static registerEmbed(e,t){this.handlers[e]=t}static unregisterEmbed(e){delete this.handlers[e]}static getHandler(e){let t=this.handlers[e];if(!t)throw Error(`no handlers for embed type "${e}"`);return t}insert(e,t){let r={};return"string"==typeof e&&0===e.length?this:(r.insert=e,null!=t&&"object"==typeof t&&Object.keys(t).length>0&&(r.attributes=t),this.push(r))}delete(e){return e<=0?this:this.push({delete:e})}retain(e,t){if("number"==typeof e&&e<=0)return this;let r={retain:e};return null!=t&&"object"==typeof t&&Object.keys(t).length>0&&(r.attributes=t),this.push(r)}push(e){let t=this.ops.length,r=this.ops[t-1];if(e=i(e),"object"==typeof r){if("number"==typeof e.delete&&"number"==typeof r.delete)return this.ops[t-1]={delete:r.delete+e.delete},this;if("number"==typeof r.delete&&null!=e.insert&&(t-=1,"object"!=typeof(r=this.ops[t-1])))return this.ops.unshift(e),this;if(o(e.attributes,r.attributes)){if("string"==typeof e.insert&&"string"==typeof r.insert)return this.ops[t-1]={insert:r.insert+e.insert},"object"==typeof e.attributes&&(this.ops[t-1].attributes=e.attributes),this;else if("number"==typeof e.retain&&"number"==typeof r.retain)return this.ops[t-1]={retain:r.retain+e.retain},"object"==typeof e.attributes&&(this.ops[t-1].attributes=e.attributes),this}}return t===this.ops.length?this.ops.push(e):this.ops.splice(t,0,e),this}chop(){let e=this.ops[this.ops.length-1];return e&&"number"==typeof e.retain&&!e.attributes&&this.ops.pop(),this}filter(e){return this.ops.filter(e)}forEach(e){this.ops.forEach(e)}map(e){return this.ops.map(e)}partition(e){let t=[],r=[];return this.forEach(n=>{(e(n)?t:r).push(n)}),[t,r]}reduce(e,t){return this.ops.reduce(e,t)}changeLength(){return this.reduce((e,t)=>t.insert?e+a.default.length(t):t.delete?e-t.delete:e,0)}length(){return this.reduce((e,t)=>e+a.default.length(t),0)}slice(e=0,t=1/0){let r=[],n=new l.default(this.ops),i=0;for(;i<t&&n.hasNext();){let o;i<e?o=n.next(e-i):(o=n.next(t-i),r.push(o)),i+=a.default.length(o)}return new u(r)}compose(e){let t=new l.default(this.ops),r=new l.default(e.ops),n=[],i=r.peek();if(null!=i&&"number"==typeof i.retain&&null==i.attributes){let e=i.retain;for(;"insert"===t.peekType()&&t.peekLength()<=e;)e-=t.peekLength(),n.push(t.next());i.retain-e>0&&r.next(i.retain-e)}let a=new u(n);for(;t.hasNext()||r.hasNext();)if("insert"===r.peekType())a.push(r.next());else if("delete"===t.peekType())a.push(t.next());else{let e=Math.min(t.peekLength(),r.peekLength()),n=t.next(e),i=r.next(e);if(i.retain){let l={};if("number"==typeof n.retain)l.retain="number"==typeof i.retain?e:i.retain;else if("number"==typeof i.retain)null==n.retain?l.insert=n.insert:l.retain=n.retain;else{let e=null==n.retain?"insert":"retain",[t,r,o]=c(n[e],i.retain),s=u.getHandler(t);l[e]={[t]:s.compose(r,o,"retain"===e)}}let d=s.default.compose(n.attributes,i.attributes,"number"==typeof n.retain);if(d&&(l.attributes=d),a.push(l),!r.hasNext()&&o(a.ops[a.ops.length-1],l)){let e=new u(t.rest());return a.concat(e).chop()}}else"number"==typeof i.delete&&("number"==typeof n.retain||"object"==typeof n.retain&&null!==n.retain)&&a.push(i)}return a.chop()}concat(e){let t=new u(this.ops.slice());return e.ops.length>0&&(t.push(e.ops[0]),t.ops=t.ops.concat(e.ops.slice(1))),t}diff(e,t){if(this.ops===e.ops)return new u;let r=[this,e].map(t=>t.map(r=>{if(null!=r.insert)return"string"==typeof r.insert?r.insert:"\0";throw Error("diff() called "+(t===e?"on":"with")+" non-document")}).join("")),i=new u,a=n(r[0],r[1],t,!0),c=new l.default(this.ops),d=new l.default(e.ops);return a.forEach(e=>{let t=e[1].length;for(;t>0;){let r=0;switch(e[0]){case n.INSERT:r=Math.min(d.peekLength(),t),i.push(d.next(r));break;case n.DELETE:r=Math.min(t,c.peekLength()),c.next(r),i.delete(r);break;case n.EQUAL:r=Math.min(c.peekLength(),d.peekLength(),t);let a=c.next(r),l=d.next(r);o(a.insert,l.insert)?i.retain(r,s.default.diff(a.attributes,l.attributes)):i.push(l).delete(r)}t-=r}}),i.chop()}eachLine(e,t="\n"){let r=new l.default(this.ops),n=new u,i=0;for(;r.hasNext();){if("insert"!==r.peekType())return;let o=r.peek(),s=a.default.length(o)-r.peekLength(),l="string"==typeof o.insert?o.insert.indexOf(t,s)-s:-1;if(l<0)n.push(r.next());else if(l>0)n.push(r.next(l));else{if(!1===e(n,r.next(1).attributes||{},i))return;i+=1,n=new u}}n.length()>0&&e(n,{},i)}invert(e){let t=new u;return this.reduce((r,n)=>{if(n.insert)t.delete(a.default.length(n));else if("number"==typeof n.retain&&null==n.attributes)return t.retain(n.retain),r+n.retain;else if(n.delete||"number"==typeof n.retain){let i=n.delete||n.retain;return e.slice(r,r+i).forEach(e=>{n.delete?t.push(e):n.retain&&n.attributes&&t.retain(a.default.length(e),s.default.invert(n.attributes,e.attributes))}),r+i}else if("object"==typeof n.retain&&null!==n.retain){let i=e.slice(r,r+1),o=new l.default(i.ops).next(),[a,d,h]=c(n.retain,o.insert),p=u.getHandler(a);return t.retain({[a]:p.invert(d,h)},s.default.invert(n.attributes,o.attributes)),r+1}return r},0),t.chop()}transform(e,t=!1){if(t=!!t,"number"==typeof e)return this.transformPosition(e,t);let r=new l.default(this.ops),n=new l.default(e.ops),i=new u;for(;r.hasNext()||n.hasNext();)if("insert"===r.peekType()&&(t||"insert"!==n.peekType()))i.retain(a.default.length(r.next()));else if("insert"===n.peekType())i.push(n.next());else{let e=Math.min(r.peekLength(),n.peekLength()),o=r.next(e),a=n.next(e);if(o.delete)continue;if(a.delete)i.push(a);else{let r=o.retain,n=a.retain,l="object"==typeof n&&null!==n?n:e;if("object"==typeof r&&null!==r&&"object"==typeof n&&null!==n){let e=Object.keys(r)[0];if(e===Object.keys(n)[0]){let i=u.getHandler(e);i&&(l={[e]:i.transform(r[e],n[e],t)})}}i.retain(l,s.default.transform(o.attributes,a.attributes,t))}}return i.chop()}transformPosition(e,t=!1){t=!!t;let r=new l.default(this.ops),n=0;for(;r.hasNext()&&n<=e;){let i=r.peekLength(),o=r.peekType();if(r.next(),"delete"===o){e-=Math.min(i,e-n);continue}"insert"===o&&(n<e||!t)&&(e+=i),n+=i}return e}}u.Op=a.default,u.OpIterator=l.default,u.AttributeMap=s.default,u.handlers={},t.default=u,e.exports=u,e.exports.default=u},5095:function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),(r||(r={})).length=function(e){return"number"==typeof e.delete?e.delete:"number"==typeof e.retain?e.retain:"object"==typeof e.retain&&null!==e.retain?1:"string"==typeof e.insert?e.insert.length:1},t.default=r},485:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(5095);t.default=class{constructor(e){this.ops=e,this.index=0,this.offset=0}hasNext(){return this.peekLength()<1/0}next(e){e||(e=1/0);let t=this.ops[this.index];if(!t)return{retain:1/0};{let r=this.offset,i=n.default.length(t);if(e>=i-r?(e=i-r,this.index+=1,this.offset=0):this.offset+=e,"number"==typeof t.delete)return{delete:e};{let n={};return t.attributes&&(n.attributes=t.attributes),"number"==typeof t.retain?n.retain=e:"object"==typeof t.retain&&null!==t.retain?n.retain=t.retain:"string"==typeof t.insert?n.insert=t.insert.substr(r,e):n.insert=t.insert,n}}}peek(){return this.ops[this.index]}peekLength(){return this.ops[this.index]?n.default.length(this.ops[this.index])-this.offset:1/0}peekType(){let e=this.ops[this.index];if(e){if("number"==typeof e.delete)return"delete";else if("number"!=typeof e.retain&&("object"!=typeof e.retain||null===e.retain))return"insert"}return"retain"}rest(){if(!this.hasNext())return[];{if(0===this.offset)return this.ops.slice(this.index);let e=this.offset,t=this.index,r=this.next(),n=this.ops.slice(this.index);return this.offset=e,this.index=t,[r].concat(n)}}}},987:function(e,t,r){var n,i,o;self,n=r(9638),i={190:e=>{self,e.exports=(()=>{"use strict";var e={607:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseQuillDelta=void 0;let r=!1;function n(e){e.paragraphs.push({textRuns:[]})}function i(e,t,r){var n,i;r?(null==(n=t.paragraphs[t.paragraphs.length-1].textRuns)||n.push({text:e,attributes:r}),r.link&&t.setup.hyperlinks.push({text:e,link:r.link})):null==(i=t.paragraphs[t.paragraphs.length-1].textRuns)||i.push({text:e})}t.parseQuillDelta=function(e){r=!1;let t={paragraphs:[],setup:{numberedLists:0,hyperlinks:[]}};for(let o of e.ops)!function(e,t){var o;e.insert.video||e.insert.image?(t.paragraphs.push({embed:e.insert}),r=!1,n(t)):e.insert.formula?(0===t.paragraphs.length&&n(t),null==(o=t.paragraphs[t.paragraphs.length-1].textRuns)||o.push({formula:e.insert.formula,attributes:e.attributes})):"\n"===e.insert?(e.attributes&&(t.paragraphs[t.paragraphs.length-1].attributes=e.attributes,"ordered"===e.attributes.list?r||(t.setup.numberedLists++,r=!0):r=!1),n(t)):function(e,t){if(0===t.paragraphs.length&&n(t),e.insert.match(/\n/))for(let o of e.insert.split(/(\n)/))"\n"===o?(n(t),r=!1):i(o,t);else i(e.insert,t,e.attributes)}(e,t)}(o,t);return t}}},t={};return function r(n){if(t[n])return t[n].exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}(607)})()},829:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultNumbering=t.customBulletLevels=t.customNumberedLevels=t.defaultStyles=void 0;let n=r(687);t.defaultStyles=[{id:"normal",name:"Normal",next:"normal",basedOn:"normal",quickFormat:!0,run:{size:24},paragraph:{spacing:{line:480,before:0,after:0}}},{id:"header_1",name:"Heading 1",next:"normal",quickFormat:!0,run:{font:"Calibri",size:30,bold:!0},paragraph:{spacing:{before:300,after:200}}},{id:"header_2",name:"Heading 2",basedOn:"normal",next:"normal",quickFormat:!0,run:{font:"Calibri",size:26,bold:!0},paragraph:{spacing:{before:200,after:100}}},{id:"list_paragraph",name:"List Paragraph",basedOn:"normal",quickFormat:!0,run:{size:24}},{id:"code_block",name:"Code Block",basedOn:"normal",quickFormat:!0,run:{size:24,font:"Courier New"},paragraph:{indent:{left:720,right:720}}},{id:"block_quote",name:"Block Quote",basedOn:"normal",quickFormat:!0,run:{italics:!0},paragraph:{indent:{left:540},border:{left:{size:12,space:28,color:"333333",value:"single"}}}},{id:"citation",name:"Citation",basedOn:"normal",quickFormat:!0,run:{size:24},paragraph:{indent:{left:0,hanging:320},spacing:{line:480}}}],t.customNumberedLevels=[{level:0,format:"decimal",text:"%1.",alignment:n.AlignmentType.LEFT,style:{paragraph:{indent:{left:720,hanging:360}}}},{level:1,format:"lowerLetter",text:"%2.",alignment:n.AlignmentType.LEFT,style:{paragraph:{indent:{left:1440,hanging:360}}}},{level:2,format:"lowerRoman",text:"%3.",alignment:n.AlignmentType.LEFT,style:{paragraph:{indent:{left:2160,hanging:360}}}},{level:3,format:"decimal",text:"%4.",alignment:n.AlignmentType.LEFT,style:{paragraph:{indent:{left:2880,hanging:360}}}},{level:4,format:"lowerLetter",text:"%5.",alignment:n.AlignmentType.LEFT,style:{paragraph:{indent:{left:3600,hanging:360}}}},{level:3,format:"lowerRoman",text:"%5.",alignment:n.AlignmentType.LEFT,style:{paragraph:{indent:{left:4320,hanging:360}}}}],t.customBulletLevels=[{level:0,format:"bullet",text:"",alignment:n.AlignmentType.LEFT,style:{paragraph:{indent:{left:720,hanging:360}}}},{level:1,format:"bullet",text:"",alignment:n.AlignmentType.LEFT,style:{paragraph:{indent:{left:1440,hanging:360}}}},{level:2,format:"bullet",text:"",alignment:n.AlignmentType.LEFT,style:{paragraph:{indent:{left:2160,hanging:360}}}},{level:3,format:"bullet",text:"",alignment:n.AlignmentType.LEFT,style:{paragraph:{indent:{left:2880,hanging:360}}}},{level:4,format:"bullet",text:"",alignment:n.AlignmentType.LEFT,style:{paragraph:{indent:{left:3600,hanging:360}}}},{level:3,format:"bullet",text:"",alignment:n.AlignmentType.LEFT,style:{paragraph:{indent:{left:4320,hanging:360}}}}],t.defaultNumbering={config:[{reference:"default-numbering",levels:t.customNumberedLevels}]}},35:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,a)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.generateWord=void 0;let a=r(190),l=o(r(687)),c=r(687),u=r(829),d=0,h=-1,p=u.defaultStyles,f=u.customNumberedLevels,g=!1;function b(e,t,r){e.paragraph&&(p[r].paragraph=e.paragraph),e.run&&(p[r].run=e.run)}t.generateWord=function(e,t){return s(this,void 0,void 0,function*(){var r;let n,i,o;d=0,h=-1,g=!1;let v=[],y=[];if(e.ops){let t=a.parseQuillDelta(e);y.push(t)}else if(Array.isArray(e))for(let t of e)y.push(t);else{if(!e.paragraphs)throw Error("Please provide a raw Quill Delta, a parsed Quill delta, or an Array of parsed Quill deltas. See QuillTodocx readme.");y.push(e)}for(let e of(r=y[0],p=u.defaultStyles,f=u.customNumberedLevels,t&&(t.paragraphStyles&&function(e){if(e.normal){let t=p.findIndex(e=>"normal"===e.id);b(e.normal,0,t)}if(e.header_1){let t=p.findIndex(e=>"header_1"===e.id);b(e.header_1,0,t)}if(e.header_2){let t=p.findIndex(e=>"header_2"===e.id);b(e.header_2,0,t)}if(e.list_paragraph){let t=p.findIndex(e=>"list_paragraph"===e.id);b(e.list_paragraph,0,t)}if(e.code_block){let t=p.findIndex(e=>"code_block"===e.id);b(e.code_block,0,t)}if(e.block_quote){let t=p.findIndex(e=>"block_quote"===e.id);b(e.block_quote,0,t)}if(e.citation){let t=p.findIndex(e=>"citation"===e.id);b(e.citation,0,t)}}(t.paragraphStyles),t.customLevels&&(f=t.customLevels)),r.setup.hyperlinks.length>0&&(i=function(e){let t={},r=0;for(let n of e){let e={link:n.link,text:n.text,type:c.HyperlinkType.EXTERNAL};t=Object.assign(Object.assign({},t),{[`link${r}`]:e}),r++}return t}(r.setup.hyperlinks)),r.setup.numberedLists>0&&(o=function(e){let t=[],r=0;for(;r<e;){let e={reference:`numbered_${r}`,levels:f};t.push(e),r++}return{config:t}}(r.setup.numberedLists)),(null==t?void 0:t.customBulletLevels)&&(o=function(e,t){let r={reference:"customBullets",levels:t};return e?(e.config.push(r),e):{config:[r]}}(o,t.customBulletLevels),g=!0),n=new l.Document({styles:{paragraphStyles:p},numbering:o,hyperlinks:i}),y))v.push(function(e,t){var r,n,i,o,s;let a=0,u=[];for(let p of e){if(null==(r=p.embed)?void 0:r.image){let e=c.Media.addImage(t,p.embed.image);u.push(new c.Paragraph(e))}else if(null==(n=p.embed)?void 0:n.video){let e=(s=p.embed.video,new c.TextRun({text:s}));u.push(new c.Paragraph({children:[e]}))}else p.textRuns&&(a>0&&"ordered"===(null==(i=p.attributes)?void 0:i.list)&&("ordered"===(null==(o=e[a-1].attributes)?void 0:o.list)||h++),u.push(function(e){var t,r,n,i,o,s,a,u,p,f,b,v,y;let w=[];for(let t of e.textRuns)t.formula?w.push((y=t.formula,new c.TextRun({text:y}))):t.text&&w.push(function(e,t){var r,n,i,o,s,a,l,u,h,p,f,g,b;let v;return(null==(r=e.attributes)?void 0:r.link)?(v=new c.HyperlinkRef(`link${d}`),d++):v=new c.TextRun({text:e.text,bold:!!(null==(n=e.attributes)?void 0:n.bold),italics:!!(null==(i=e.attributes)?void 0:i.italic),subScript:"sub"===(null==(o=e.attributes)?void 0:o.script),superScript:"super"===(null==(s=e.attributes)?void 0:s.script),strike:!!(null==(a=e.attributes)?void 0:a.strike),underline:(null==(l=e.attributes)?void 0:l.underline)?{type:c.UnderlineType.SINGLE,color:"auto"}:void 0,color:(null==(u=e.attributes)?void 0:u.color)?null==(h=e.attributes)?void 0:h.color.slice(1):void 0,size:"huge"===(null==(p=e.attributes)?void 0:p.size)?36:"large"===(null==(f=e.attributes)?void 0:f.size)?32:"small"===(null==(g=e.attributes)?void 0:g.size)?20:void 0,highlight:(null==(b=e.attributes)?void 0:b.background)?"yellow":void 0}),v}(t));return new c.Paragraph({children:w,heading:1===(null==(t=e.attributes)?void 0:t.header)?l.HeadingLevel.HEADING_1:2===(null==(r=e.attributes)?void 0:r.header)?l.HeadingLevel.HEADING_2:void 0,bullet:"bullet"!==(null==(n=e.attributes)?void 0:n.list)||g?void 0:{level:e.attributes.indent?e.attributes.indent:0},numbering:"ordered"===(null==(i=e.attributes)?void 0:i.list)?{reference:`numbered_${h}`,level:e.attributes.indent?e.attributes.indent:0}:"bullet"===(null==(o=e.attributes)?void 0:o.list)&&g?{reference:"customBullets",level:e.attributes.indent?e.attributes.indent:0}:void 0,alignment:"left"===(null==(s=e.attributes)?void 0:s.align)?c.AlignmentType.LEFT:"center"===(null==(a=e.attributes)?void 0:a.align)?c.AlignmentType.CENTER:"right"===(null==(u=e.attributes)?void 0:u.align)?c.AlignmentType.RIGHT:"justify"===(null==(p=e.attributes)?void 0:p.align)?c.AlignmentType.JUSTIFIED:void 0,style:(null==(f=e.attributes)?void 0:f["code-block"])?"code_block":(null==(b=e.attributes)?void 0:b.blockquote)?"block_quote":(null==(v=e.attributes)?void 0:v.citation)?"citation":void 0})}(p)));a++}return u}(e.paragraphs,n));for(let e of v)n.addSection({children:e});return function(e,t){return s(this,void 0,void 0,function*(){if(!t||!t.exportAs||"doc"===t.exportAs)return e;if("blob"===t.exportAs)return c.Packer.toBlob(e);if("buffer"===t.exportAs)return console.log("returning buffer"),c.Packer.toBuffer(e);if("base64"===t.exportAs)return c.Packer.toBase64String(e);throw Error("Please set exportAs configuration to blob, buffer, doc, or base64.")})}(n,t)})}},607:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(35),t),i(r(679),t)},679:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},687:e=>{"use strict";e.exports=n}},o={},e.exports=function e(t){if(o[t])return o[t].exports;var r=o[t]={exports:{}};return i[t].call(r.exports,r,r.exports,e),r.exports}(607)},7626:function(e,t){t.plural_EN=function(e){return 1!==e?"p":"s"}},5853:function(e,t,r){"use strict";e.exports={}},4699:function(e,t,r){"use strict";e.exports={}},7984:function(e,t,r){"use strict";e.exports={}},752:function(e,t,r){"use strict";e.exports={}}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.loaded=!0,o.exports}r.m=e,r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.k=e=>""+e+".css",r.g=(()=>{if("object"==typeof globalThis)return globalThis;try{return this||Function("return this")()}catch(e){if("object"==typeof window)return window}})(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),r.rv=()=>"1.5.2",(()=>{r.g.importScripts&&(e=r.g.location+"");var e,t=r.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var i=n.length-1;i>-1&&(!e||!/^http(s?):/.test(e));)e=n[i--].src}if(!e)throw Error("Automatic publicPath is not supported in this browser");r.p=e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/")})(),r.ruid="bundler=rspack@1.5.2",(()=>{"use strict";var e,t,n,i={};r.r(i),r.d(i,{Attributor:()=>sg,AttributorStore:()=>sT,BlockBlot:()=>sM,ClassAttributor:()=>sx,ContainerBlot:()=>sB,EmbedBlot:()=>sF,InlineBlot:()=>sL,LeafBlot:()=>sk,ParentBlot:()=>sR,Registry:()=>sy,Scope:()=>sm,ScrollBlot:()=>sz,StyleAttributor:()=>s_,TextBlot:()=>sX});var o=r(3201),s=r.n(o);r(5853),r(4699),r(752),r(7984);var a=function(e){return e.HOME="HOME",e.ABOUT="ABOUT",e.DEFINE_BOX="DEFINE_BOX",e.CREATE_SCENARIO="CREATE_SCENARIO",e.SHOW_SCENARIO="SHOW_SCENARIO",e.DECISION_SUPPORT="DECISION_SUPPORT",e.SETTINGS="SETTINGS",e.HELP="HELP",e}({});function l(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)0>t.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}"function"==typeof SuppressedError&&SuppressedError;let c=()=>"idxxxxxxxx".replace(/[x]/g,()=>(16*Math.random()|0).toString(16)),u=(e,t=2,r="0")=>String(e).padStart(t,r),d={view:({attrs:e})=>s()("span.mandatory",Object.assign({},e),"*")},h=()=>({view:e=>{var t=e.attrs,{label:r,id:n,isMandatory:i,isActive:o,className:a,initialValue:c}=t,u=l(t,["label","id","isMandatory","isActive","className","initialValue"]);return r?s()("label",Object.assign(Object.assign({},u),{className:[a,o?"active":""].filter(Boolean).join(" ").trim()||void 0,for:n,oncreate:({dom:e})=>{c&&e.classList.add("active")}}),[s().trust(r),i?s()(d):void 0]):void 0}}),p=()=>({view:({attrs:{helperText:e,dataError:t,dataSuccess:r,className:n}})=>e||t||r?s()("span.helper-text.left",{className:n,"data-error":t,"data-success":r},t?s().trust(t):r?s().trust(r):e?s().trust(e):""):void 0}),f=()=>{let e={id:c(),isActive:!1,internalValue:"",isOpen:!1,suggestions:[],selectedIndex:-1,inputElement:null},t=e=>"value"in e&&void 0!==e.value&&"function"==typeof e.oninput,r=(r,n)=>{t(n)||(e.internalValue=r.key),e.isOpen=!1,e.selectedIndex=-1,n.oninput&&n.oninput(r.key),n.onchange&&n.onchange(r.key),n.onAutocomplete&&n.onAutocomplete(r.key),s().redraw()},n=t=>{let r=t.target,n=r.closest(".autocomplete-wrapper"),i=r.closest(".autocomplete-content");n||i||(e.isOpen=!1,e.selectedIndex=-1)};return{oninit:({attrs:r})=>{t(r)||(e.internalValue=r.defaultValue||""),document.addEventListener("click",n)},onremove:()=>{document.removeEventListener("click",n)},view:({attrs:n})=>{let i=n.id||e.id,{label:o,helperText:a,onchange:c,newRow:u,className:d="col s12",style:f,iconName:g,isMandatory:b,data:v={},limit:y=1/0,minLength:w=1}=n,x=l(n,["label","helperText","onchange","newRow","className","style","iconName","isMandatory","data","limit","minLength"]),E=t(n),_=E?n.value||"":e.internalValue;e.suggestions=((e,t,r,n)=>!e||e.length<n?[]:Object.entries(t||{}).filter(([t])=>t.toLowerCase().includes(e.toLowerCase())).map(([e,t])=>({key:e,value:t})).slice(0,r))(_,v,y,w);let T=_.length>=w&&Object.keys(v).some(e=>e.toLowerCase()===_.toLowerCase());e.isOpen=e.suggestions.length>0&&_.length>=w&&!T;let O=RegExp(`(${_})`,"i");return s()(".input-field.autocomplete-wrapper",{className:u?d+" clear":d,style:f},[g?s()("i.material-icons.prefix",g):"",s()("input",Object.assign(Object.assign({},x),{className:"autocomplete",type:"text",tabindex:0,id:i,value:E?_:void 0,oncreate:t=>{e.inputElement=t.dom,!E&&n.defaultValue&&(t.dom.value=n.defaultValue)},oninput:t=>{let r=t.target.value;e.selectedIndex=-1,E||(e.internalValue=r),n.oninput&&n.oninput(r),c&&c(r)},onkeydown:t=>{((t,n)=>{if(e.isOpen)switch(t.key){case"ArrowDown":t.preventDefault(),e.selectedIndex=Math.min(e.selectedIndex+1,e.suggestions.length-1);break;case"ArrowUp":t.preventDefault(),e.selectedIndex=Math.max(e.selectedIndex-1,-1);break;case"Enter":t.preventDefault(),e.selectedIndex>=0&&e.suggestions[e.selectedIndex]&&(e.isOpen=!1,r(e.suggestions[e.selectedIndex],n));break;case"Escape":t.preventDefault(),e.isOpen=!1,e.selectedIndex=-1}})(t,n),n.onkeydown&&n.onkeydown(t,_)},onfocus:()=>{if(e.isActive=!0,_.length>=w){let t=Object.keys(v).some(e=>e.toLowerCase()===_.toLowerCase());e.isOpen=e.suggestions.length>0&&!t}},onblur:t=>{e.isActive=!1,setTimeout(()=>{t.relatedTarget&&t.relatedTarget.closest(".autocomplete-content")||(e.isOpen=!1,e.selectedIndex=-1,s().redraw())},150)}})),e.isOpen&&s()("ul.autocomplete-content.dropdown-content",{style:(()=>{if(!e.inputElement)return{display:"block",width:"100%",height:`${50*e.suggestions.length}px`,transformOrigin:"0px 0px",opacity:+!!e.isOpen,transform:"scaleX(1) scaleY(1)"};let t=e.inputElement.getBoundingClientRect().width;return{display:"block",width:`${t}px`,height:`${50*e.suggestions.length}px`,transformOrigin:"0px 0px",opacity:+!!e.isOpen,transform:"scaleX(1) scaleY(1)",position:"absolute",top:"100%",left:"0",zIndex:1e3}})()},e.suggestions.map((t,i)=>s()("li",{key:t.key,class:e.selectedIndex===i?"active":"",onclick:e=>{e.preventDefault(),e.stopPropagation(),r(t,n)},onmouseover:()=>{e.selectedIndex=i,s().redraw()}},[t.value&&t.value.includes("http")?s()("img",{src:t.value,class:"right circle",onerror:e=>{e.target.style.display="none"}}):t.value&&t.value.startsWith("icon:")?s()("i.material-icons",{style:{fontSize:"24px",color:"var(--md-grey-600)"}},t.value.replace("icon:","")):null,s()("span",t.key?s().trust(t.key.replace(O,e=>`<span class="highlight">${e}</span>`)):"")]))),s()(h,{label:o,id:i,isMandatory:b,isActive:e.isActive||_.length>0||!!n.placeholder||!!n.value}),s()(p,{helperText:a})])}}},g=()=>({view:e=>{var t=e.attrs,{iconName:r}=t,n=l(t,["iconName"]);return s()("i.material-icons",n,r)}}),b=(e,t,r="")=>()=>({view:({attrs:n})=>{let{tooltip:i,tooltipPosition:o,tooltipPostion:a,iconName:c,iconClass:u,label:d,className:h,variant:p}=n,f=l(n,["tooltip","tooltipPosition","tooltipPostion","iconName","iconClass","label","className","variant"]),b=[i?"tooltipped":"",t,h].filter(Boolean).join(" ").trim();return s()(e,Object.assign(Object.assign({},f),{className:b,"data-position":i?o||a||"top":void 0,"data-tooltip":i||void 0,type:p||r||"button"}),c?s()(g,{iconName:c,className:u||"left"}):void 0,d||void 0)}}),v=b("a","waves-effect waves-light btn","button");b("a","waves-effect waves-light btn-large","button"),b("a","waves-effect waves-light btn-small","button");let y=b("a","waves-effect waves-teal btn-flat","button"),w=b("button","btn-floating btn-large waves-effect waves-light","button");b("button","btn waves-effect waves-light","submit");let x={caret:["M7 10l5 5 5-5z","M0 0h24v24H0z"],close:["M18.3 5.71a1 1 0 0 0-1.41 0L12 10.59 7.11 5.7A1 1 0 0 0 5.7 7.11L10.59 12l-4.89 4.89a1 1 0 1 0 1.41 1.41L12 13.41l4.89 4.89a1 1 0 0 0 1.41-1.41L13.41 12l4.89-4.89a1 1 0 0 0 0-1.4z","M0 0h24v24H0z"],chevron:["M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z","M0 0h24v24H0z"],expand:["M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z","M0 0h24v24H0z"],collapse:["M19 13H5v-2h14v2z","M0 0h24v24H0z"]},E=()=>({view:({attrs:e})=>{var t;let{name:r,direction:n="down",style:i}=e,o=l(e,["name","direction","style"]),a=null!=(t=({down:0,up:180,left:90,right:-90})[n])?t:0,c=a?`rotate(${a}deg)`:void 0;return s()("svg",Object.assign(Object.assign({},o),{style:Object.assign({transform:c},i),height:"1lh",width:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"}),x[r].map(e=>s()("path",{d:e,fill:e.includes("M0 0h24v24H0z")?"none":"currentColor"})))}}),_=()=>{let e={chipsData:[],selectedChip:null,focused:!1,inputValue:"",inputId:c(),autocompleteItems:[],selectedAutocompleteIndex:-1,showAutocomplete:!1},t=null,r=()=>{var r;if(!(null==(r=null==t?void 0:t.attrs.autocompleteOptions)?void 0:r.data)){e.autocompleteItems=[];return}let{data:n,minLength:i=1}=t.attrs.autocompleteOptions,o=e.inputValue.toLowerCase();if(o.length<i){e.autocompleteItems=[],e.showAutocomplete=!1;return}let s=(e=>Array.isArray(e)?e.map(e=>"string"==typeof e?{tag:e}:e):Object.entries(e).map(([e,t])=>({tag:e,value:t||e})))(n).filter(e=>e.tag.toLowerCase().includes(o)),a=t.attrs.autocompleteOptions.limit||1/0;e.autocompleteItems=s.slice(0,a),e.showAutocomplete=e.autocompleteItems.length>0,e.selectedAutocompleteIndex=-1},n=t=>{i({tag:t.tag,image:t.image,alt:t.alt}),e.inputValue="",e.showAutocomplete=!1,e.selectedAutocompleteIndex=-1},i=r=>{if(!t)return;let{limit:n=1/0,onChipAdd:i,onchange:o}=t.attrs;((e,t)=>!!e.tag&&""!==e.tag.trim()&&!t.some(t=>t.tag===e.tag))(r,e.chipsData)&&!(e.chipsData.length>=n)&&(e.chipsData=[...e.chipsData,r],e.inputValue="",i&&i(r),o&&o(e.chipsData))},o=r=>{if(!t)return;let{onChipDelete:n,onchange:i}=t.attrs,o=e.chipsData[r];e.chipsData=e.chipsData.filter((e,t)=>t!==r),e.selectedChip=null,n&&n(o),i&&i(e.chipsData)},a=r=>{if(!t)return;let{onChipSelect:n}=t.attrs;e.selectedChip=r,n&&e.chipsData[r]&&n(e.chipsData[r])},l=r=>{let s=r.target;if(e.showAutocomplete){if("ArrowDown"===r.key){r.preventDefault(),e.selectedAutocompleteIndex=Math.min(e.selectedAutocompleteIndex+1,e.autocompleteItems.length-1);let n=null==t?void 0:t.dom.querySelector(".autocomplete-item.selected");n&&n.scrollIntoView({block:"nearest"});return}if("ArrowUp"===r.key){r.preventDefault(),e.selectedAutocompleteIndex=Math.max(e.selectedAutocompleteIndex-1,-1);let n=null==t?void 0:t.dom.querySelector(".autocomplete-item.selected");n&&n.scrollIntoView({block:"nearest"});return}if("Enter"===r.key&&e.selectedAutocompleteIndex>=0){r.preventDefault(),n(e.autocompleteItems[e.selectedAutocompleteIndex]);return}}"Enter"===r.key&&s.value.trim()?(r.preventDefault(),i({tag:s.value.trim()})):"Backspace"===r.key&&!s.value&&e.chipsData.length>0?(r.preventDefault(),o(e.chipsData.length-1)):"ArrowLeft"===r.key&&!s.value&&e.chipsData.length&&(r.preventDefault(),a(e.chipsData.length-1))};return{oninit:({attrs:t})=>{e.chipsData=t.data||[]},oncreate:e=>{t=e},onremove:()=>{t=null},view:({attrs:i})=>{let{id:c,required:u,isMandatory:d=u,className:f="col s12",label:g,helperText:b,placeholder:v,secondaryPlaceholder:y}=i;return s()(".input-field",{id:c,className:f},[s()(".chips.chips-initial",{class:`chips-container${e.focused?" focused":""}${v?" chips-placeholder":""}`},[e.chipsData.map((r,n)=>s()(".chip",{key:`${r.tag}-${n}`,tabindex:0,class:e.selectedChip===n?"selected":void 0,onkeydown:r=>((r,n)=>{if("Backspace"===r.key||"Delete"===r.key){r.preventDefault(),o(n);let t=Math.max(n-1,0);e.chipsData.length&&a(t)}else if("ArrowLeft"===r.key&&n>0)a(n-1);else if("ArrowRight"===r.key)if(n<e.chipsData.length-1)a(n+1);else{let e=null==t?void 0:t.dom.querySelector(".chips-input");e&&e.focus()}})(r,n)},[r.image&&s()("img",{src:r.image,alt:r.alt||r.tag}),r.tag,s()(E,{name:"close",className:"close",onclick:e=>{e.stopPropagation(),o(n)}})])),s()("input[type=text].chips-input.input.browser-default",{id:e.inputId,title:"label",value:e.inputValue,placeholder:!e.chipsData.length&&v?v:e.chipsData.length&&y?y:"",oninput:t=>{e.inputValue=t.target.value,r()},onfocus:()=>{e.focused=!0,e.selectedChip=null,r()},onblur:()=>{e.focused=!1,setTimeout(()=>{e.showAutocomplete=!1,e.selectedChip=null},150)},onkeydown:l}),e.showAutocomplete&&s()("ul.autocomplete-content.dropdown-content",{style:{display:"block",opacity:1,transform:"scaleX(1) scaleY(1)",position:"absolute",width:"100%",left:0,top:"100%",maxHeight:"200px",overflow:"auto",zIndex:1e3,backgroundColor:"var(--mm-surface-color, #fff)",boxShadow:"0 2px 2px 0 var(--mm-shadow-penumbra, rgba(0,0,0,0.14)), 0 3px 1px -2px var(--mm-shadow-umbra, rgba(0,0,0,0.12)), 0 1px 5px 0 var(--mm-shadow-ambient, rgba(0,0,0,0.2))"}},e.autocompleteItems.map((t,r)=>s()("li.autocomplete-item",{key:t.tag,class:e.selectedAutocompleteIndex===r?"selected":"",style:{padding:"12px 16px",cursor:"pointer",backgroundColor:e.selectedAutocompleteIndex===r?"var(--mm-border-color, #eee)":"transparent",color:"var(--mm-text-primary, inherit)"},onmousedown:e=>{e.preventDefault(),n(t)},onmouseover:()=>{e.selectedAutocompleteIndex=r}},[t.image&&s()("img.autocomplete-item-image",{src:t.image,alt:t.alt||t.tag,style:{width:"24px",height:"24px",marginRight:"8px",verticalAlign:"middle"}}),s()("span.autocomplete-item-text",t.tag)])))]),g&&s()(h,{label:g,id:e.inputId,isMandatory:d,isActive:!!e.focused||!!e.chipsData.length||!!v}),b&&s()(p,{helperText:b})])}}},T=()=>({view:({attrs:{header:e,body:t,iconName:r,isActive:n,onToggle:i}})=>s()("li",{className:n?"active":""},[e||r?s()(".collapsible-header",{onclick:i},[r?s()("i.material-icons",r):void 0,e?"string"==typeof e?s()("span",e):e:void 0]):void 0,s()(".collapsible-body",{style:{display:n?"block":"none",transition:"display 0.3s ease"}},[s()(".collapsible-body-content",{style:{padding:"2rem"}},t?"string"==typeof t?s()("div",{innerHTML:t}):t:void 0)])])}),O=()=>{let e={activeItems:new Set};return{oninit:({attrs:t})=>{t.items.forEach((t,r)=>{t.active&&e.activeItems.add(r)})},view:({attrs:t})=>{let{items:r,accordion:n=!0,class:i,className:o,style:a,id:l}=t;return r&&r.length>0?s()("ul.collapsible",{class:i||o,style:Object.assign({border:"1px solid #ddd",borderRadius:"2px",margin:"0.5rem 0 1rem 0"},a),id:l},r.map((t,r)=>s()(T,Object.assign(Object.assign({},t),{key:r,isActive:e.activeItems.has(r),onToggle:()=>(t=>{n?e.activeItems.has(t)?e.activeItems.clear():(e.activeItems.clear(),e.activeItems.add(t)):e.activeItems.has(t)?e.activeItems.delete(t):e.activeItems.add(t)})(r)})))):void 0}}};!function(e){e[e.BASIC=0]="BASIC",e[e.LINKS=1]="LINKS",e[e.AVATAR=2]="AVATAR"}(t||(t={}));let A={cancel:"Cancel",clear:"Clear",done:"Ok",previousMonth:"",nextMonth:"",months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],weekdaysAbbrev:["S","M","T","W","T","F","S"]},S=e=>/Date/.test(Object.prototype.toString.call(e))&&!isNaN(e.getTime()),k=e=>{let t=e.getDay();return 0===t||6===t},N=e=>{S(e)&&e.setHours(0,0,0,0)},C=(e,t)=>[31,I(e)?29:28,31,30,31,30,31,31,30,31,30,31][t],I=e=>e%4==0&&e%100!=0||e%400==0,R=(e,t)=>e.getTime()===t.getTime(),P=(e,t,r)=>"iso"===t?L(e):D(e,r),L=e=>{let t=new Date(e.getTime()),r=(e.getDay()+6)%7;t.setDate(t.getDate()-r+3);let n=new Date(t.getFullYear(),0,4),i=(n.getDay()+6)%7;return n.setDate(n.getDate()-i+3),Math.ceil((t.getTime()-n.getTime())/6048e5)+1},D=(e,t)=>{let r=new Date(e.getFullYear(),0,1),n=r.getDay(),i=(t-n+7)%7;0===i&&n!==t&&(i=7);let o=new Date(r.getTime());return(o.setDate(1+i),e<o)?D(new Date(e.getFullYear()-1,11,31),t):Math.floor(Math.floor((e.getTime()-o.getTime())/864e5)/7)+1},j=()=>{let e,t=e=>{let t=10;if(e.yearrange){let r=e.yearrange.split(",");2===r.length&&(t=[parseInt(r[0],10),parseInt(r[1],10)])}else e.yearRange&&(t=e.yearRange);let r="mmm dd, yyyy";e.format?r=e.format:e.displayFormat&&(r=e.displayFormat);let n=Object.assign({autoClose:!1,format:r,parse:null,defaultDate:null,setDefaultDate:!1,disableWeekends:!1,disableDayFn:null,firstDay:0,minDate:null,maxDate:null,yearRange:t,showClearBtn:!1,showWeekNumbers:!1,weekNumbering:"iso",i18n:A,onSelect:null,onOpen:null,onClose:null},e);return n.i18n=Object.assign(Object.assign({},A),e.i18n),n},r=(t,r)=>{if(!t||!S(t))return"";let n=r;return n.replace(/(dddd|ddd|dd|d|mmmm|mmm|mm|m|yyyy|yy)/g,t=>e.formats[t]?String(e.formats[t]()):t)},n=(e,t,r)=>{if(!e||!S(e))return"";let n=t,i={d:()=>e.getDate(),dd:()=>{let t=e.getDate();return(t<10?"0":"")+t},ddd:()=>r.i18n.weekdaysShort[e.getDay()],dddd:()=>r.i18n.weekdays[e.getDay()],m:()=>e.getMonth()+1,mm:()=>{let t=e.getMonth()+1;return(t<10?"0":"")+t},mmm:()=>r.i18n.monthsShort[e.getMonth()],mmmm:()=>r.i18n.months[e.getMonth()],yy:()=>(""+e.getFullYear()).slice(2),yyyy:()=>e.getFullYear()};return n.replace(/(dddd|ddd|dd|d|mmmm|mmm|mm|m|yyyy|yy)/g,e=>i[e]?String(i[e]()):e)},i=(t,r=!1,n)=>{if(!t){e.date=null;return}if("string"==typeof t&&(t=new Date(Date.parse(t))),!S(t))return;let i=n.minDate,s=n.maxDate;S(i)&&t<i?t=i:S(s)&&t>s&&(t=s),e.date=new Date(t.getTime()),N(e.date),o(e.date),!r&&n.onSelect&&n.onSelect(e.date)},o=t=>{S(t)&&(e.calendars=[{month:t.getMonth(),year:t.getFullYear()}])},a=()=>{e.calendars[0]=l(e.calendars[0])},l=e=>(e.month<0&&(e.year-=Math.ceil(Math.abs(e.month)/12),e.month+=12),e.month>11&&(e.year+=Math.floor(Math.abs(e.month)/12),e.month-=12),e),u=()=>({view:({attrs:t})=>{let{opts:r,options:n}=t,o=[],a="false";if(r.isEmpty)if(!r.showDaysInNextAndPreviousMonths)return s()("td.is-empty");else o.push("is-outside-current-month"),o.push("is-selection-disabled");return r.isDisabled&&o.push("is-disabled"),r.isToday&&o.push("is-today"),r.isSelected&&(o.push("is-selected"),a="true"),r.isRangeStart&&(o.push("is-range-start"),a="true"),r.isRangeEnd&&(o.push("is-range-end"),a="true"),r.isInRange&&o.push("is-in-range"),r.isRangePreview&&o.push("is-range-preview"),r.hasEvent&&o.push("has-event"),s()("td",{"data-day":r.day,class:o.join(" "),"aria-selected":a},[s()("button.datepicker-day-button",{type:"button","data-year":r.year,"data-month":r.month,"data-day":r.day,onclick:t=>{let o=t.target;if(!r.isDisabled){let t=parseInt(o.getAttribute("data-year")||"0",10),r=new Date(t,parseInt(o.getAttribute("data-month")||"0",10),parseInt(o.getAttribute("data-day")||"0",10));n.dateRange?((t,r)=>{if(N(t),!e.startDate||e.startDate&&e.endDate)e.startDate=new Date(t.getTime()),e.endDate=null,e.selectionMode="end",e.isSelectingRange=!0;else if(e.startDate&&!e.endDate){if(t<e.startDate?(e.endDate=new Date(e.startDate.getTime()),e.startDate=new Date(t.getTime())):e.endDate=new Date(t.getTime()),r.minDateRange||r.maxDateRange){let n=Math.ceil((e.endDate.getTime()-e.startDate.getTime())/864e5);if(r.minDateRange&&n<r.minDateRange||r.maxDateRange&&n>r.maxDateRange){e.startDate=new Date(t.getTime()),e.endDate=null,e.selectionMode="end";return}}e.selectionMode=null,e.isSelectingRange=!1,r.onSelect&&r.onSelect(e.startDate,e.endDate),r.autoClose&&(e.isOpen=!1)}})(r,n):(i(r,!1,n),n.autoClose&&(e.isOpen=!1))}}},r.day)])}}),d=()=>({view:({attrs:t})=>{let{year:r,month:n,options:i,randId:o}=t,a=new Date,l=C(r,n),c=new Date(r,n,1).getDay(),d=[],h=[];N(a),i.firstDay>0&&(c-=i.firstDay)<0&&(c+=7);let p=0===n?11:n-1,f=11===n?0:n+1,g=0===n?r-1:r,b=11===n?r+1:r,v=C(g,p),y=l+c,w=y;for(;w>7;)w-=7;y+=7-w;for(let t=0,o=0;t<y;t++){let y=new Date(r,n,1+(t-c)),w=!!S(e.date)&&R(y,e.date),x=R(y,a),E=t<c||t>=l+c,_=1+(t-c),T=n,O=r;E&&(t<c?(_=v+_,T=p,O=g):(_-=l,T=f,O=b));let A=i.minDate&&y<i.minDate||i.maxDate&&y>i.maxDate||i.disableWeekends&&k(y)||i.disableDayFn&&i.disableDayFn(y),N=!1,C=!1,I=!1;i.dateRange&&(e.startDate&&R(y,e.startDate)&&(N=!0),e.endDate&&R(y,e.endDate)&&(C=!0),e.startDate&&e.endDate&&y>e.startDate&&y<e.endDate&&(I=!0));let L={day:_,month:T,year:O,hasEvent:!1,isSelected:!i.dateRange&&w,isToday:x,isDisabled:A,isEmpty:E,showDaysInNextAndPreviousMonths:!1,isRangeStart:N,isRangeEnd:C,isInRange:I,isRangePreview:!1};if(0===o&&i.showWeekNumbers){let e=P(new Date(O,T,_),i.weekNumbering,i.firstDay);h.push(s()("td.datepicker-week-number",{title:`Week ${e}`},e))}h.push(s()(u,{opts:L,options:i})),7==++o&&(d.push(s()("tr.datepicker-row",h)),h=[],o=0)}let x=[];i.showWeekNumbers&&x.push(s()("th.datepicker-week-header",{scope:"col",title:"Week"},"Wk"));for(let e=0;e<7;e++){let t=e+i.firstDay;for(;t>=7;)t-=7;x.push(s()("th",{scope:"col"},[s()("abbr",{title:i.i18n.weekdays[t]},i.i18n.weekdaysAbbrev[t])]))}return s()(".datepicker-table-wrapper",[s()("table.datepicker-table",{cellpadding:"0",cellspacing:"0",role:"grid","aria-labelledby":o||"datepicker-controls",class:i.showWeekNumbers?"with-week-numbers":""},[s()("thead",[s()("tr",x)]),s()("tbody",d)])])}}),h=()=>({view:({attrs:t})=>{let{options:r}=t;if(r.dateRange){let t=e.startDate,n=e.endDate;if(t&&n){let e=r.i18n.weekdaysShort[t.getDay()],i=r.i18n.monthsShort[t.getMonth()],o=r.i18n.weekdaysShort[n.getDay()],a=r.i18n.monthsShort[n.getMonth()];return s()(".datepicker-date-display.range-display",[s()("span.year-text",t.getFullYear()),s()("span.date-text",[s()("span.start-date",`${e}, ${i} ${t.getDate()}`),s()("span.range-separator"," - "),s()("span.end-date",`${o}, ${a} ${n.getDate()}`)])])}if(t){let e=r.i18n.weekdaysShort[t.getDay()],n=r.i18n.monthsShort[t.getMonth()];return s()(".datepicker-date-display.range-display",[s()("span.year-text",t.getFullYear()),s()("span.date-text",[s()("span.start-date",`${e}, ${n} ${t.getDate()}`),s()("span.range-separator"," - "),s()("span.end-date.placeholder","Select end date")])])}{let e=new Date;return s()(".datepicker-date-display.range-display",[s()("span.year-text",e.getFullYear()),s()("span.date-text.placeholder","Select date range")])}}{let t=S(e.date)?e.date:new Date,n=r.i18n.weekdaysShort[t.getDay()],i=r.i18n.monthsShort[t.getMonth()],o=t.getDate();return s()(".datepicker-date-display",[s()("span.year-text",t.getFullYear()),s()("span.date-text",`${n}, ${i} ${o}`)])}}}),p=()=>({view:({attrs:t})=>{let r,n,{options:i,randId:o}=t,l=e.calendars[0],c=l.year,u=l.month;return Array.isArray(i.yearRange)?(r=i.yearRange[0],n=i.yearRange[1]):(r=c-i.yearRange,n=c+i.yearRange),s()(".datepicker-controls",{id:o,role:"heading","aria-live":"assertive"},[s()("button.month-prev",{type:"button",onclick:t=>{t.preventDefault(),e.calendars[0].month--,a()}},s()("svg",{fill:"#000000",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg"},[s()("path",{d:"M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"}),s()("path",{d:"M0-.5h24v24H0z",fill:"none"})])),s()(".selects-container",[s()(".select-wrapper.select-month",[s()("input.select-dropdown.dropdown-trigger",{type:"text",readonly:!0,value:i.i18n.months[u],onclick:t=>{t.preventDefault(),e.monthDropdownOpen=!e.monthDropdownOpen,e.yearDropdownOpen=!1}}),e.monthDropdownOpen&&s()(".dropdown-content",i.i18n.months.map((t,r)=>s()(".dropdown-item",{key:r,class:r===u?"selected":"",onclick:t=>{t.stopPropagation(),f(r),e.monthDropdownOpen=!1}},t)))]),s()(".select-wrapper.select-year",[s()("input.select-dropdown.dropdown-trigger",{type:"text",readonly:!0,value:c.toString(),onclick:t=>{t.preventDefault(),e.yearDropdownOpen=!e.yearDropdownOpen,e.monthDropdownOpen=!1}}),e.yearDropdownOpen&&s()(".dropdown-content",((e,t)=>Array.from({length:t-e+1},(t,r)=>e+r))(r,n).map(t=>s()(".dropdown-item",{key:t,class:t===c?"selected":"",onclick:r=>{r.stopPropagation(),g(t),e.yearDropdownOpen=!1}},t)))])]),s()("button.month-next",{type:"button",onclick:t=>{t.preventDefault(),e.calendars[0].month++,a()}},s()("svg",{fill:"#000000",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg"},[s()("path",{d:"M8.59 16.34l4.58-4.59-4.58-4.59L10 5.75l6 6-6 6z"}),s()("path",{d:"M0-.25h24v24H0z",fill:"none"})]))])}}),f=t=>{if(!isNaN(t)&&(e.calendars[0].month=t,a(),e.date&&S(e.date))){let r=e.date.getDate(),n=e.calendars[0].year,i=Math.min(r,C(n,t)),o=new Date(n,t,i);e.date=o,N(e.date)}},g=t=>{if(!isNaN(t)&&(e.calendars[0].year=t,a(),e.date&&S(e.date))){let r=e.date.getMonth(),n=Math.min(e.date.getDate(),C(t,r)),i=new Date(t,r,n);e.date=i,N(e.date)}},b=t=>{let r=t.target;r.closest(".select-wrapper")||r.closest(".dropdown-content")||(e.monthDropdownOpen=!1,e.yearDropdownOpen=!1)};return{oninit:r=>{let n=r.attrs,s=t(n);if(e={id:c(),isOpen:!1,date:null,startDate:null,endDate:null,selectionMode:null,isSelectingRange:!1,calendars:[{month:0,year:0}],monthDropdownOpen:!1,yearDropdownOpen:!1,formats:{d:()=>{var t;return(null==(t=e.date)?void 0:t.getDate())||0},dd:()=>{var t;let r=(null==(t=e.date)?void 0:t.getDate())||0;return(r<10?"0":"")+r},ddd:()=>{var t;return s.i18n.weekdaysShort[(null==(t=e.date)?void 0:t.getDay())||0]},dddd:()=>{var t;return s.i18n.weekdays[(null==(t=e.date)?void 0:t.getDay())||0]},m:()=>{var t;return((null==(t=e.date)?void 0:t.getMonth())||0)+1},mm:()=>{var t;let r=((null==(t=e.date)?void 0:t.getMonth())||0)+1;return(r<10?"0":"")+r},mmm:()=>{var t;return s.i18n.monthsShort[(null==(t=e.date)?void 0:t.getMonth())||0]},mmmm:()=>{var t;return s.i18n.months[(null==(t=e.date)?void 0:t.getMonth())||0]},yy:()=>{var t;return(""+((null==(t=e.date)?void 0:t.getFullYear())||0)).slice(2)},yyyy:()=>{var t;return(null==(t=e.date)?void 0:t.getFullYear())||0}}},s.dateRange)n.initialStartDate&&S(n.initialStartDate)&&(e.startDate=new Date(n.initialStartDate.getTime()),N(e.startDate),o(e.startDate)),n.initialEndDate&&S(n.initialEndDate)&&(e.endDate=new Date(n.initialEndDate.getTime()),N(e.endDate)),e.startDate||e.endDate||o(new Date);else{let e=n.defaultDate;!e&&n.defaultValue&&(e=new Date(n.defaultValue)),S(e)?i(e,!0,s):o(new Date)}document.addEventListener("click",b)},onremove:()=>{document.removeEventListener("click",b)},view:o=>{let a=o.attrs,l=t(a),{id:c=e.id,label:u,dateLabel:f,placeholder:g,disabled:b,readonly:v,required:y,iconName:w,helperText:x,onchange:E,oninput:_,className:T,class:O}=a,A="";if(l.dateRange){let t=a.displayFormat||l.format;if(e.startDate&&e.endDate){let r,i;a.displayFormat?(r=a.displayFormat.replace(/yyyy/gi,e.startDate.getFullYear().toString()).replace(/mm/gi,(e.startDate.getMonth()+1).toString().padStart(2,"0")).replace(/dd/gi,e.startDate.getDate().toString().padStart(2,"0")),i=a.displayFormat.replace(/yyyy/gi,e.endDate.getFullYear().toString()).replace(/mm/gi,(e.endDate.getMonth()+1).toString().padStart(2,"0")).replace(/dd/gi,e.endDate.getDate().toString().padStart(2,"0"))):(r=n(e.startDate,t,l),i=n(e.endDate,t,l)),A=`${r} - ${i}`}else if(e.startDate){let r;r=a.displayFormat?a.displayFormat.replace(/yyyy/gi,e.startDate.getFullYear().toString()).replace(/mm/gi,(e.startDate.getMonth()+1).toString().padStart(2,"0")).replace(/dd/gi,e.startDate.getDate().toString().padStart(2,"0")):n(e.startDate,t,l),A=`${r} - `}}else if(e.date&&(A=r(e.date,l.format)),a.displayFormat){let t=a.displayFormat;e.date&&(A=t=t.replace(/yyyy/gi,e.date.getFullYear().toString()).replace(/mm/gi,(e.date.getMonth()+1).toString().padStart(2,"0")).replace(/dd/gi,e.date.getDate().toString().padStart(2,"0")))}return s()(".input-field",{className:T||O||"col s12"},[w&&s()("i.material-icons.prefix",w),s()("input.datepicker",{id:c,type:"text",value:A,placeholder:g,disabled:b,readonly:v,required:y,onclick:()=>{b||v||(e.isOpen=!0,l.onOpen&&l.onOpen())},oninput:e=>{_&&_(e.target.value)},onchange:e=>{if(E){let t=e.target,n=new Date(t.value);S(n)?(i(n,!1,l),E(r(n,"yyyy-mm-dd"))):E(t.value)}}}),(u||f)&&s()("label",{for:c,class:A||g?"active":""},u||f),x&&s()("span.helper-text",x),e.isOpen&&[s()(".modal.datepicker-modal.open",{id:`modal-${e.id}`,tabindex:0,style:{zIndex:1003,display:"block",opacity:1,top:"10%",transform:"scaleX(1) scaleY(1)"}},[s()(".modal-content.datepicker-container",{onclick:t=>{let r=t.target;r.closest(".select-wrapper")||r.closest(".dropdown-content")||(e.monthDropdownOpen=!1,e.yearDropdownOpen=!1)}},[s()(h,{options:l}),s()(".datepicker-calendar-container",[s()(".datepicker-calendar",[s()(p,{options:l,randId:`datepicker-title-${Math.random().toString(36).slice(2)}`}),s()(d,{year:e.calendars[0].year,month:e.calendars[0].month,options:l})]),s()(".datepicker-footer",[l.showClearBtn&&s()("button.btn-flat.datepicker-clear.waves-effect",{type:"button",style:"",onclick:()=>{i(null,!1,l),e.isOpen=!1}},l.i18n.clear),s()("button.btn-flat.datepicker-cancel.waves-effect",{type:"button",onclick:()=>{e.isOpen=!1,l.onClose&&l.onClose()}},l.i18n.cancel),s()("button.btn-flat.datepicker-done.waves-effect",{type:"button",onclick:()=>{if(e.isOpen=!1,l.dateRange){if(e.startDate&&e.endDate&&E){let t=r(e.startDate,"yyyy-mm-dd"),n=r(e.endDate,"yyyy-mm-dd");E(`${t} - ${n}`)}}else e.date&&E&&E(r(e.date,"yyyy-mm-dd"));l.onClose&&l.onClose()}},l.i18n.done)])])])]),s()(".modal-overlay",{style:{zIndex:1002,display:"block",opacity:.5},onclick:()=>{e.isOpen=!1,l.onClose&&l.onClose()}})]])}}},B={view:({attrs:{show:e,position:t,value:r}})=>e?s()(`.value-tooltip.${t}`,r.toFixed(0)):null},F={view:({attrs:{show:e,orientation:t,value:r}})=>e?s()(`.value.${t}`,r.toFixed(0)):null},U=(e,t,r)=>(e-t)/(r-t)*100,q=(e,t,r,n,i,o)=>Math.round((r+Math.max(0,Math.min(100,o?(t.bottom-e.clientY)/t.height*100:(e.clientX-t.left)/t.width*100))/100*(n-r))/i)*i,z=(e,t,r,n,i)=>{let o=10*i;switch(e){case"ArrowLeft":case"ArrowDown":return Math.max(r,t-i);case"ArrowRight":case"ArrowUp":return Math.min(n,t+i);case"PageDown":return Math.max(r,t-o);case"PageUp":return Math.min(n,t+o);case"Home":return r;case"End":return n;default:return null}},H=(e,t)=>{let{min:r=0,max:n=100,value:i,minValue:o,maxValue:s}=t;void 0!==i?(void 0===e.singleValue&&(e.singleValue=i),e.lastValue===i||e.hasUserInteracted||(e.singleValue=i,e.lastValue=i)):void 0===e.singleValue&&(e.singleValue=r);let a=void 0!==o?o:r,l=void 0!==s?s:n;(void 0===e.rangeMinValue||void 0===e.rangeMaxValue)&&(e.rangeMinValue=a,e.rangeMaxValue=l),e.hasUserInteracted||(void 0===o||e.lastMinValue===o)&&(void 0===s||e.lastMaxValue===s)||(e.rangeMinValue=a,e.rangeMaxValue=l,e.lastMinValue=o,e.lastMaxValue=s),null===e.activeThumb&&(e.activeThumb="min"),void 0===e.isDragging&&(e.isDragging=!1)},X=(e,t,r,n,i)=>{e>t&&(e=t),t<e&&(t=e),n.rangeMinValue=e,n.rangeMaxValue=t,n.hasUserInteracted=!0,i&&r.oninput?r.oninput(e,t):!i&&r.onchange&&r.onchange(e,t)},V={oninit({state:e}){e.componentInitialized||(e.componentInitialized=!0)},onremove({state:e}){e.cleanupMouseEvents&&(e.cleanupMouseEvents(),e.cleanupMouseEvents=null)},view({attrs:e,state:t}){let{cn:r,style:n,iconName:i,id:o,label:a,isMandatory:l,helperText:c,min:u=0,max:d=100,step:f=1,vertical:g=!1,showValue:b=!1,valueDisplay:v,height:y="200px",disabled:w=!1,tooltipPos:x="top",oninput:E,onchange:_}=e,T=v||(b?"always":"none");H(t,e);let O=U(t.singleValue,u,d),A=g?{height:y}:{},S=g?"vertical":"horizontal",k=g?{height:`${O}%`}:{width:`${O}%`},N=g?{bottom:`${O}%`}:{left:`${O}%`},C=g&&("top"===x||"bottom"===x)?"right":x,I=(e,r=!1)=>{t.singleValue=e,t.hasUserInteracted=!0,r&&E?E(e):!r&&_&&_(e)},R=g?"range-field vertical":"range-field";return s()(".input-field",{className:r,style:n},[i?s()("i.material-icons.prefix",i):void 0,s()("input[type=range]",{id:o,value:t.singleValue,min:u,max:d,step:f,style:{display:"none"},disabled:w,tabindex:-1}),s()("div",{class:R,style:A},[s()(`.single-range-slider.${S}`,{tabindex:w?-1:0,role:"slider","aria-valuemin":u,"aria-valuemax":d,"aria-valuenow":t.singleValue,"aria-label":a||"Range slider",onclick:e=>{if(w)return;let t=e.currentTarget.getBoundingClientRect();I(q(e,t,u,d,f,g),!1),e.currentTarget.focus()},onkeydown:e=>{if(w)return;let r=t.singleValue,n=z(e.key,r,u,d,f);null!==n&&(e.preventDefault(),I(n,!1))}},[s()(`.track.${S}`),s()(`.range-progress.${S}`,{style:k}),s()(`.thumb.${S}`,{style:N,onmousedown:e=>{if(w)return;e.preventDefault(),t.isDragging=!0,"auto"===T&&s().redraw();let r=e.currentTarget.parentElement;if(!r)return;let n=e=>{t.isDragging&&r&&(I(q(e,r.getBoundingClientRect(),u,d,f,g),!0),s().redraw())},i=()=>{t.isDragging=!1,t.cleanupMouseEvents&&(t.cleanupMouseEvents(),t.cleanupMouseEvents=null),I(t.singleValue,!1),"auto"===T&&s().redraw()};document.addEventListener("mousemove",n),document.addEventListener("mouseup",i),t.cleanupMouseEvents=()=>{document.removeEventListener("mousemove",n),document.removeEventListener("mouseup",i)}}},s()(B,{value:t.singleValue,position:C,show:"always"===T||"auto"===T&&t.isDragging}))])]),a?s()(h,{label:a,id:o,isMandatory:l,isActive:!0}):null,c?s()(p,{helperText:c}):null])}},$={oninit({state:e}){e.componentInitialized||(e.componentInitialized=!0)},onremove({state:e}){e.cleanupMouseEvents&&(e.cleanupMouseEvents(),e.cleanupMouseEvents=null)},view({attrs:e,state:t}){let{cn:r,style:n,iconName:i,id:o,label:a,isMandatory:l,helperText:c,min:u=0,max:d=100,step:f=1,vertical:g=!1,showValue:b=!1,valueDisplay:v,height:y="200px",disabled:w=!1}=e,x=v||(b?"always":"none");H(t,e);let E=U(t.rangeMinValue,u,d),_=U(t.rangeMaxValue,u,d),T=g?"vertical":"horizontal",O=g?{bottom:`${E}%`,height:`${_-E}%`}:{left:`${E}%`,width:`${_-E}%`},A=(e,t)=>g?{bottom:`${e}%`,zIndex:t?10:5}:{left:`${e}%`,zIndex:t?10:5},S=r=>n=>{if(w)return;n.preventDefault(),t.isDragging=!0,t.activeThumb=r,"auto"===x&&s().redraw();let i=n.currentTarget.parentElement;if(!i)return;let o=n=>{if(!t.isDragging||!i)return;let o=q(n,i.getBoundingClientRect(),u,d,f,g);"min"===r?X(Math.min(o,t.rangeMaxValue),t.rangeMaxValue,e,t,!0):X(t.rangeMinValue,Math.max(o,t.rangeMinValue),e,t,!0),s().redraw()},a=()=>{t.isDragging=!1,t.activeThumb=null,t.cleanupMouseEvents&&(t.cleanupMouseEvents(),t.cleanupMouseEvents=null),X(t.rangeMinValue,t.rangeMaxValue,e,t,!1),"auto"===x&&s().redraw()};document.addEventListener("mousemove",o),document.addEventListener("mouseup",a),t.cleanupMouseEvents=()=>{document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",a)}};return s()(".input-field",{className:r,style:n},[i?s()("i.material-icons.prefix",i):void 0,s()("input[type=range]",{id:o,value:t.rangeMinValue,min:u,max:d,step:f,style:{display:"none"},disabled:w,tabindex:-1}),s()("input[type=range]",{id:`${o}_max`,value:t.rangeMaxValue,min:u,max:d,step:f,style:{display:"none"},disabled:w,tabindex:-1}),s()("div",{className:g?"range-field vertical":"range-field"},[s()(`.double-range-slider.${T}`,{style:g?{height:y}:{},onclick:r=>{if(w)return;let n=r.currentTarget,i=q(r,n.getBoundingClientRect(),u,d,f,g);if(Math.abs(i-t.rangeMinValue)<=Math.abs(i-t.rangeMaxValue)){X(Math.min(i,t.rangeMaxValue),t.rangeMaxValue,e,t,!1),t.activeThumb="min";let r=n.querySelector(".thumb.min-thumb");r&&r.focus()}else{X(t.rangeMinValue,Math.max(i,t.rangeMinValue),e,t,!1),t.activeThumb="max";let r=n.querySelector(".thumb.max-thumb");r&&r.focus()}}},[s()(`.track.${T}`),s()(`.range.${T}`,{style:O}),s()(`.thumb.${T}.min-thumb${"min"===t.activeThumb?".active":""}`,{style:A(E,"min"===t.activeThumb),tabindex:w?-1:0,role:"slider","aria-valuemin":u,"aria-valuemax":t.rangeMaxValue,"aria-valuenow":t.rangeMinValue,"aria-label":`Minimum value: ${t.rangeMinValue}`,"aria-orientation":g?"vertical":"horizontal",onmousedown:S("min"),onclick:e=>{e.stopPropagation(),t.activeThumb="min",e.currentTarget.focus()},onfocus:()=>{t.activeThumb="min"},onkeydown:r=>{if(w)return;let n=t.rangeMinValue,i=z(r.key,n,u,d,f);null!==i&&(r.preventDefault(),X(Math.min(i,t.rangeMaxValue),t.rangeMaxValue,e,t,!1))}},s()(F,{value:t.rangeMinValue,orientation:T,show:"always"===x||"auto"===x&&t.isDragging&&"min"===t.activeThumb})),s()(`.thumb.${T}.max-thumb${"max"===t.activeThumb?".active":""}`,{style:A(_,"max"===t.activeThumb),tabindex:w?-1:0,role:"slider","aria-valuemin":t.rangeMinValue,"aria-valuemax":d,"aria-valuenow":t.rangeMaxValue,"aria-label":`Maximum value: ${t.rangeMaxValue}`,"aria-orientation":g?"vertical":"horizontal",onmousedown:S("max"),onclick:e=>{e.stopPropagation(),t.activeThumb="max",e.currentTarget.focus()},onfocus:()=>{t.activeThumb="max"},onkeydown:r=>{if(w)return;let n=t.rangeMaxValue,i=z(r.key,n,u,d,f);if(null!==i){r.preventDefault();let n=Math.max(i,t.rangeMinValue);X(t.rangeMinValue,n,e,t,!1)}}},s()(F,{value:t.rangeMaxValue,orientation:T,show:"always"===x||"auto"===x&&t.isDragging&&"max"===t.activeThumb}))])]),a?s()(h,{label:a,id:o,isMandatory:l,isActive:!0}):null,c?s()(p,{helperText:c}):null])}},K=()=>({view:({attrs:e})=>{let{currentLength:t,maxLength:r,show:n}=e;return n?s()("span.character-counter",{style:{color:t>r?"#F44336":"#9e9e9e"}},`${t}/${r}`):null}}),W=()=>{let e={id:c(),currentLength:0,hasInteracted:!1,height:void 0,active:!1,textarea:void 0,internalValue:""},t=(t,r)=>{if(!t||!r)return;let n=window.getComputedStyle(t);r.style.fontFamily=n.fontFamily,r.style.fontSize=n.fontSize,r.style.lineHeight=n.lineHeight,r.style.paddingTop=n.paddingTop,r.style.paddingRight=n.paddingRight,r.style.paddingBottom=n.paddingBottom,r.style.paddingLeft=n.paddingLeft,"off"===t.getAttribute("wrap")?(r.style.overflowWrap="normal",r.style.whiteSpace="pre"):(r.style.overflowWrap="break-word",r.style.whiteSpace="pre-wrap"),r.textContent=t.value+"\n";let i=r.innerHTML.replace(/\n/g,"<br>");r.innerHTML=i,t.offsetWidth>0?r.style.width=t.offsetWidth+"px":r.style.width=window.innerWidth/2+"px";let o=t.offsetHeight,s=r.offsetHeight;o<=s?e.height=s+"px":e.height=void 0},r=e=>void 0!==e.value&&(void 0!==e.oninput||void 0!==e.onchange);return{oninit:({attrs:t})=>{let n=r(t),i=t.readonly||t.disabled;void 0===t.value||n||i||console.warn("TextArea received 'value' prop without 'oninput' or 'onchange' handler. Use 'defaultValue' for uncontrolled components or add an event handler for controlled components."),n||(e.internalValue=t.defaultValue||"")},onremove:()=>{},view:({attrs:n})=>{var i,o,a,c;let u,{className:d="col s12",helperText:f,iconName:g,id:b=e.id,value:v,placeholder:y,isMandatory:w,label:x,maxLength:E,oninput:_,onchange:T,onkeydown:O,onkeypress:A,onkeyup:S,onblur:k,style:N}=n,C=l(n,["className","helperText","iconName","id","value","placeholder","isMandatory","label","maxLength","oninput","onchange","onkeydown","onkeypress","onkeyup","onblur","style"]),I=r(n),R=n.readonly||n.disabled;return u=I?v||"":R?null!=(o=null!=(i=n.defaultValue)?i:v)?o:"":null!=(c=null!=(a=e.internalValue)?a:n.defaultValue)?c:"",[s()(".hiddendiv",{style:{visibility:"hidden",position:"absolute",top:"0",left:"0",zIndex:"-1",whiteSpace:"pre-wrap",wordWrap:"break-word",overflowWrap:"break-word"},oncreate:({dom:r})=>{e.textarea&&t(e.textarea,r)},onupdate:({dom:r})=>{e.textarea&&t(e.textarea,r)}}),s()(".input-field",{className:d,style:N},[g?s()("i.material-icons.prefix",g):"",s()("textarea.materialize-textarea",Object.assign(Object.assign({},C),{id:b,tabindex:0,value:I?u:void 0,style:{height:e.height},oncreate:({dom:t})=>{let r=e.textarea=t;I||void 0===n.defaultValue||(r.value=String(n.defaultValue)),E&&(e.currentLength=r.value.length)},onupdate:({dom:t})=>{e.height&&(t.style.height=e.height)},onfocus:()=>{e.active=!0},oninput:t=>{e.active=!0,e.hasInteracted=!1;let r=t.target;E&&(e.currentLength=r.value.length,e.hasInteracted=r.value.length>0),I||(e.internalValue=r.value),_&&_(r.value)},onblur:t=>{e.active=!1,e.hasInteracted=!0,k&&k(t),T&&e.textarea&&T(e.textarea.value)},onkeyup:S?e=>{S(e,e.target.value)}:void 0,onkeydown:O?e=>{O(e,e.target.value)}:void 0,onkeypress:A?e=>{A(e,e.target.value)}:void 0})),s()(h,{label:x,id:b,isMandatory:w,isActive:u||y||e.active,initialValue:""!==u}),s()(p,{helperText:f,dataError:e.hasInteracted&&n.dataError?n.dataError:void 0,dataSuccess:e.hasInteracted&&n.dataSuccess?n.dataSuccess:void 0}),E?s()(K,{currentLength:e.currentLength,maxLength:E,show:e.currentLength>0}):void 0])]}}},G=(e,t="")=>()=>{let r={id:c(),internalValue:void 0,hasInteracted:!1,isValid:!0,active:!1,inputElement:null,rangeMinValue:void 0,rangeMaxValue:void 0,singleValue:void 0,isDragging:!1,activeThumb:null},n=e=>"value"in e&&void 0!==e.value&&("function"==typeof e.oninput||"function"==typeof e.onchange),i=t=>{let r=t.value;return r&&("number"===e||"range"===e)?+r:r};return{oninit:({attrs:t})=>{let i=n(t),o=t.readonly||t.disabled;if(void 0===t.value||i||o||console.warn(`${e} input received 'value' prop without 'oninput' or 'onchange' handler. Use 'defaultValue' for uncontrolled components or add an event handler for controlled components.`),!i){let n=["number","range"].includes(e);void 0!==t.defaultValue?n?r.internalValue=t.defaultValue:r.internalValue=String(t.defaultValue):r.internalValue="color"===e?"#ff0000":n?void 0:""}},view:({attrs:o})=>{var a,c,u,d,f,g;let b,{className:v="col s12",dataError:y,dataSuccess:w,helperText:x,iconName:_,id:T=r.id,placeholder:O,isMandatory:A,label:S,maxLength:k,newRow:N,oninput:C,onchange:I,onkeydown:R,onkeypress:P,onkeyup:L,style:D,validate:j,canClear:B}=o,F=l(o,["className","dataError","dataSuccess","helperText","iconName","id","placeholder","isMandatory","label","maxLength","newRow","oninput","onchange","onkeydown","onkeypress","onkeyup","style","validate","canClear"]),U=[N?"clear":"",t,v].filter(Boolean).join(" ").trim()||void 0,q=!!r.active||null!=(a=r.inputElement)&&!!a.value||!!O||"color"===e||"range"===e;if("range"===e&&(o.minmax||o.valueDisplay))return s()(o.minmax?$:V,Object.assign(Object.assign({},o),{state:r,cn:U,style:D,iconName:_,id:T,label:S,isMandatory:A,helperText:x}));let z=["number","range"].includes(e),H=n(o),X=o.readonly||o.disabled;b=H?o.value:X?null!=(u=null!=(c=o.defaultValue)?c:o.value)?u:z?0:"":null!=(f=null!=(d=r.internalValue)?d:o.defaultValue)?f:z?0:"";let W="range"===e&&!o.minmax;return s()(".input-field",{className:U,style:D},[_?s()("i.material-icons.prefix",_):void 0,s()("input.validate",Object.assign(Object.assign({},F),{type:e,tabindex:0,id:T,placeholder:O,value:H?b:void 0,class:"range"===e&&o.vertical?"range-slider vertical":void 0,style:"range"===e&&o.vertical?{height:o.height||"200px",width:"6px",writingMode:"vertical-lr",direction:"rtl"}:void 0,oncreate:({dom:e})=>{let t=r.inputElement=e;(({autofocus:e})=>!!e&&("boolean"==typeof e?e:e()))(o)&&t.focus(),H||void 0===o.defaultValue||(t.value=String(o.defaultValue))},onkeyup:L?e=>{L(e,i(e.target))}:void 0,onkeydown:R?e=>{R(e,i(e.target))}:void 0,onkeypress:P?e=>{P(e,i(e.target))}:void 0,oninput:t=>{r.active=!0,r.hasInteracted=!1;let n=t.target,o=i(n);if(H||(r.internalValue=o),C&&C(o),W){let e=n.value,t=parseFloat(n.min||"0"),r=parseFloat(n.max||"100"),i=Math.round(100*(parseFloat(e)-t)/(r-t));n.style.setProperty("--range-progress",`${i}%`)}if(j&&n.classList.contains("invalid")&&n.value.length>0){let e=j(b,n);"boolean"==typeof e&&e?(n.classList.remove("invalid"),n.classList.add("valid"),r.isValid=!0):"string"==typeof e&&""===e&&(n.classList.remove("invalid"),n.classList.add("valid"),r.isValid=!0)}else("email"===e||"url"===e)&&n.classList.contains("invalid")&&n.value.length>0&&n.validity.valid&&(n.classList.remove("invalid"),n.classList.add("valid"),r.isValid=!0)},onfocus:()=>{r.active=!0},onblur:t=>{r.active=!1;let n=t.target;if(r.hasInteracted=!0,n&&j){let e=i(n);if(e&&String(e).length>0){let t=j(e,n);r.isValid="boolean"==typeof t&&t,((e,t)=>{"boolean"==typeof t?e.setCustomValidity(t?"":"Custom validation failed"):e.setCustomValidity(t)})(n,t),"boolean"==typeof t?t?(n.classList.remove("invalid"),n.classList.add("valid")):(n.classList.remove("valid"),n.classList.add("invalid")):"string"==typeof t&&(n.classList.remove("valid"),n.classList.add("invalid"),r.isValid=!1)}else n.classList.remove("valid","invalid"),r.isValid=!0}else if("email"===e||"url"===e){let e=i(n);e&&String(e).length>0?(r.isValid=n.validity.valid,n.setCustomValidity(""),r.isValid?(n.classList.remove("invalid"),n.classList.add("valid")):(n.classList.remove("valid"),n.classList.add("invalid"))):(n.classList.remove("valid","invalid"),r.isValid=!0)}else if(z){let e=i(n);null==e||isNaN(Number(e))?(n.classList.remove("valid","invalid"),r.isValid=!0):(r.isValid=n.validity.valid,n.setCustomValidity(""),r.isValid?(n.classList.remove("invalid"),n.classList.add("valid")):(n.classList.remove("valid"),n.classList.add("invalid")))}o.onblur&&o.onblur(t),I&&r.inputElement&&I(i(r.inputElement))}})),B&&"text"===e&&(null==(g=r.inputElement)?void 0:g.value)?s()(E,{name:"close",className:"input-clear-btn",onclick:e=>{e.preventDefault(),e.stopPropagation(),((e,t)=>{if(r.inputElement){r.inputElement.value="",r.inputElement.focus(),r.active=!1;let n=i(r.inputElement);e&&e(n),t&&t(n),r.inputElement.classList.remove("valid","invalid"),r.isValid=!0,s().redraw()}})(C,I)}}):void 0,s()(h,{label:S,id:T,isMandatory:A,isActive:q,initialValue:void 0!==b&&""!==b}),s()(p,{helperText:x,dataError:r.hasInteracted&&!r.isValid?y:void 0,dataSuccess:r.hasInteracted&&r.isValid?w:void 0}),k&&"string"==typeof b?s()(K,{currentLength:b.length,maxLength:k,show:b.length>0}):void 0])}}},Y=G("text");G("password");let Z=G("number"),J=G("url"),Q=G("color");G("range",".range-field");let ee=G("email"),et=()=>{let e,t=!1;return{view:({attrs:r})=>{let{multiple:n,disabled:i,value:o,placeholder:a,onchange:l,className:c="col s12",accept:u,label:d="File"}=r,h=u?u instanceof Array?u.join(", "):u:void 0;return s()(".file-field.input-field",{className:r.class||c},[s()(".btn",[s()("span",d),s()("input[type=file]",{title:d,accept:h,multiple:n,disabled:i,onchange:l?e=>{let r=e.target;r&&r.files&&l&&(t=!0,l(r.files))}:void 0})]),s()(".file-path-wrapper",s()("input.file-path.validate[type=text]",{placeholder:a,oncreate:({dom:t})=>{e=t,o&&(e.value=o)}})),(t||(null==e?void 0:e.value))&&s()("a.waves-effect.waves-teal.btn-flat",{style:{float:"right",position:"relative",top:"-3rem",padding:0},onclick:()=>{t=!1,e.value="",l&&l({})}},s()(E,{name:"close",className:"close"}))])}}},er=()=>{let e;return{view:({attrs:{className:t="col s12",onchange:r,label:n,checked:i,disabled:o,description:a,style:l,inputId:u}})=>(e||(e=u||c()),s()("p",{className:t,style:l},s()("label",{for:e},[s()("input[type=checkbox][tabindex=0]",{className:o?"disabled":void 0,id:e,checked:i,disabled:o,onclick:r?e=>{e.target&&void 0!==e.target.checked&&r(e.target.checked)}:void 0}),n?"string"==typeof n?s()("span",n):n:void 0]),a&&s()(p,{className:"input-checkbox-desc",helperText:a})))}},en={view:({attrs:{options:e,layout:t}})=>{let r=e.map(({component:e,props:t,key:r})=>s()(e,Object.assign(Object.assign({},t),{key:r})));return"horizontal"===t?s()("div.grid-container",r):r}},ei=()=>{let e={componentId:""};return{oninit:({attrs:t})=>{e.componentId=t.id||c()},view:({attrs:{checkedId:t,label:r,options:n,description:i,className:o="col s12",style:a,disabled:l,checkboxClass:c,newRow:u,isMandatory:d,layout:h="vertical",showSelectAll:f=!1,selectAllText:g="Select All",selectNoneText:b="Select None",onchange:v}})=>{let y=void 0!==t?Array.isArray(t)?t:[t]:[],w=[u?"clear":"",o].filter(Boolean).join(" ").trim()||void 0,x=n.map(t=>{let r;return{component:er,props:{disabled:l||t.disabled,label:t.label,onchange:v?e=>((e,t,r,n)=>{let i=r.filter(t=>t!==e);t&&i.push(e),n&&n(i)})(t.id,e,y,v):void 0,className:t.className||c,checked:(r=t.id,y.includes(r)),description:t.description,inputId:`${e.componentId}-${t.id}`},key:t.id}}),E=s()(en,{options:x,layout:h});return s()("div",{id:e.componentId,className:w,style:a},[r&&s()("h5.form-group-label",r+(d?" *":"")),f&&s()("div.select-all-controls",{style:{marginBottom:"10px"}},[s()("a",{href:"#",onclick:e=>{e.preventDefault(),((e,t)=>{let r=e.map(e=>e.id);t&&t(r)})(n,v)},style:{marginRight:"15px"}},g),s()("a",{href:"#",onclick:e=>{e.preventDefault(),(e=>{e&&e([])})(v)}},b)]),i&&s()(p,{helperText:i}),s()("form",{action:"#"},E)])}}},eo=()=>{let e={isOpen:!1,id:""},t=null,r=r=>{e.isOpen=!1,r.onToggle&&r.onToggle(!1),r.onClose&&r.onClose(),t&&(document.removeEventListener("keydown",t),t=null),document.body.style.overflow=""},n=n=>{e.isOpen=!0,n.onToggle&&n.onToggle(!0),t=t=>{"Escape"===t.key&&!1!==n.closeOnEsc&&e.isOpen&&r(n)},document.addEventListener("keydown",t),document.body.style.overflow="hidden"};return{oninit:({attrs:t})=>{e.id=t.id,t.isOpen&&n(t)},onremove:()=>{t&&(document.removeEventListener("keydown",t),t=null),document.body.style.overflow=""},view:({attrs:t})=>{void 0!==t.isOpen&&t.isOpen!==e.isOpen&&(t.isOpen?n(t):r(t));let{id:i,title:o,description:a,fixedFooter:l,bottomSheet:c,buttons:u,richContent:d,className:h,showCloseButton:p=!0,closeOnBackdropClick:f=!0}=t,g=["modal",h||"",l?"modal-fixed-footer":"",c?"bottom-sheet":"",e.isOpen?"active":""].filter(Boolean).join(" ").trim(),b=["modal-overlay",e.isOpen?"active":""].filter(Boolean).join(" ").trim()||void 0;return s()("div",{className:"modal-container"},[s()("div",{className:b,onclick:f?()=>r(t):void 0,style:{display:e.isOpen?"block":"none",position:"fixed",top:"0",left:"0",width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:"1002"}}),s()("div",{id:i,className:g,"aria-hidden":e.isOpen?"false":"true",role:"dialog","aria-labelledby":`${i}-title`,"aria-describedby":a?`${i}-desc`:void 0,style:Object.assign(Object.assign({display:e.isOpen?"flex":"none",position:"fixed"},c?{top:"auto",bottom:"0",left:"0",right:"0",transform:"none",maxWidth:"100%",borderRadius:"8px 8px 0 0"}:{top:"50%",left:"50%",transform:"translate(-50%, -50%)",maxWidth:"75%",borderRadius:"4px"}),{backgroundColor:"var(--mm-modal-background, #fff)",maxHeight:"85%",overflow:"auto",zIndex:"1003",padding:"0",flexDirection:"column",boxShadow:"0 24px 38px 3px rgba(0,0,0,0.14), 0 9px 46px 8px rgba(0,0,0,0.12), 0 11px 15px -7px rgba(0,0,0,0.20)"}),onclick:e=>e.stopPropagation()},[p&&s()("button",{className:"modal-close btn-flat",style:{position:"absolute",top:"8px",right:"8px",padding:"8px",minWidth:"auto",lineHeight:1},onclick:()=>r(t),"aria-label":"Close modal"},"\xd7"),s()(".modal-content",{style:{padding:"24px",paddingTop:p?"48px":"24px",minHeight:"auto",flex:"1 1 auto"}},[s()("h4",{id:`${i}-title`,style:{margin:"0 0 20px 0"}},o),a&&s()("div",Object.assign({id:`${i}-desc`},d&&"string"==typeof a?{innerHTML:a}:{}),d&&"string"==typeof a?void 0:a)]),u&&u.length>0&&s()(".modal-footer",{style:{padding:"4px 6px",borderTop:"1px solid var(--mm-border-color, rgba(160,160,160,0.2))",textAlign:"right"}},u.map(e=>s()(y,Object.assign(Object.assign({},e),{className:`modal-close ${e.className||""}`,onclick:n=>{e.onclick&&e.onclick(n),r(t)}}))))])])}}},es=()=>({view:({attrs:{title:e,href:t,active:r,disabled:n}})=>s()("li",{className:r?"active":n?"disabled":"waves-effect"},"number"==typeof e?s()(s().route.Link,{href:t},e):e)}),ea=()=>{let e={pagIndex:0};return{view:({attrs:{items:t,curPage:r=1,size:n=Math.min(9,t.length)}})=>{let{pagIndex:i}=e,o=i*n,a=o+n,l=i>0,c=a<t.length,u=[{title:s()("a",{onclick:()=>l&&e.pagIndex--},s()("i.material-icons","chevron_left")),disabled:!l},...t.filter((e,t)=>o<=t&&t<a),{title:s()("a",{onclick:()=>c&&e.pagIndex++},s()("i.material-icons","chevron_right")),disabled:!c}];return s()("ul.pagination",u.map((e,t)=>s()(es,Object.assign(Object.assign({title:o+t},e),{active:o+t===r}))))}}},el={dialRadius:135,outerRadius:105,innerRadius:70,tickRadius:20,duration:350,container:null,defaultTime:"now",fromNow:0,showClearBtn:!1,i18n:{cancel:"Cancel",clear:"Clear",done:"Ok"},autoClose:!1,twelveHour:!0,vibrate:!0,onOpen:()=>{},onOpenStart:()=>{},onOpenEnd:()=>{},onCloseStart:()=>{},onCloseEnd:()=>{},onSelect:()=>{}},ec=()=>{let e,t,r=e=>(e<10?"0":"")+e,n=e=>document.createElementNS("http://www.w3.org/2000/svg",e),i=e=>e.targetTouches&&e.targetTouches.length>=1?{x:e.targetTouches[0].clientX,y:e.targetTouches[0].clientY}:{x:e.clientX,y:e.clientY},o=r=>{if(r.preventDefault(),!e.plate)return;let n=e.plate.getBoundingClientRect(),o={x:n.left,y:n.top};e.x0=o.x+t.dialRadius,e.y0=o.y+t.dialRadius,e.moved=!1;let s=i(r);e.dx=s.x-e.x0,e.dy=s.y-e.y0,f(e.dx,e.dy,!1),document.addEventListener("mousemove",a),document.addEventListener("touchmove",a),document.addEventListener("mouseup",l),document.addEventListener("touchend",l)},a=t=>{t.preventDefault();let r=i(t),n=r.x-e.x0,o=r.y-e.y0;e.moved=!0,f(n,o,!1)},l=r=>{r.preventDefault(),document.removeEventListener("mouseup",l),document.removeEventListener("touchend",l),document.removeEventListener("mousemove",a),document.removeEventListener("touchmove",a);let n=i(r),o=n.x-e.x0,s=n.y-e.y0;e.moved&&o===e.dx&&s===e.dy&&f(o,s),"hours"===e.currentView?h("minutes",t.duration/2):t.autoClose&&(e.minutesView&&e.minutesView.classList.add("timepicker-dial-out"),setTimeout(()=>{v()},t.duration/2)),t.onSelect&&t.onSelect(e.hours,e.minutes)},u=n=>{let i=((n||t.defaultTime||"")+"").split(":"),o=!1;if(t.twelveHour&&i.length>1&&(i[1].toUpperCase().indexOf("AM")>-1?(e.amOrPm="AM",o=!0):i[1].toUpperCase().indexOf("PM")>-1&&(e.amOrPm="PM",o=!0),i[1]=i[1].replace("AM","").replace("PM","").trim()),"now"===i[0]){let r=new Date(+new Date+t.fromNow);i=[r.getHours().toString(),r.getMinutes().toString()],t.twelveHour&&(e.amOrPm=parseInt(i[0])>=12?"PM":"AM",o=!1)}let s=+i[0]||0,a=+i[1]||0;t.twelveHour&&(o?0===s&&"AM"===e.amOrPm&&(s=12):s>=12?(e.amOrPm="PM",s>12&&(s-=12)):(e.amOrPm="AM",0===s&&(s=12))),e.hours=s,e.minutes=a,e.spanHours&&(e.spanHours.innerHTML=e.hours.toString()),e.spanMinutes&&(e.spanMinutes.innerHTML=r(e.minutes)),d()},d=()=>{t.twelveHour&&e.amBtn&&e.pmBtn&&(e.amBtn.classList.toggle("text-primary","AM"===e.amOrPm),e.pmBtn.classList.toggle("text-primary","PM"===e.amOrPm))},h=(r,n)=>{let i="hours"===r,o=i?e.hoursView:e.minutesView,s=i?e.minutesView:e.hoursView;e.currentView=r,e.spanHours&&e.spanHours.classList.toggle("text-primary",i),e.spanMinutes&&e.spanMinutes.classList.toggle("text-primary",!i),s&&s.classList.add("timepicker-dial-out"),o&&(o.style.visibility="visible",o.classList.remove("timepicker-dial-out")),p(n),e.toggleViewTimer&&clearTimeout(e.toggleViewTimer),e.toggleViewTimer=window.setTimeout(()=>{s&&(s.style.visibility="hidden")},t.duration)},p=r=>{let n=e.currentView,i=e[n],o="hours"===n,s=Math.PI/(o?6:30)*i,a=o&&i>0&&i<13?t.innerRadius:t.outerRadius,l=Math.sin(s)*a,c=-Math.cos(s)*a;r&&e.canvas?(e.canvas.classList.add("timepicker-canvas-out"),setTimeout(()=>{e.canvas&&e.canvas.classList.remove("timepicker-canvas-out"),f(l,c)},r)):f(l,c)},f=(n,i,o,s)=>{let a=Math.atan2(n,-i),l="hours"===e.currentView,c=Math.PI/(l||o?6:30),u=Math.sqrt(n*n+i*i),d=l&&u<(t.outerRadius+t.innerRadius)/2,h=d?t.innerRadius:t.outerRadius;t.twelveHour&&(h=t.outerRadius),a<0&&(a=2*Math.PI+a);let p=Math.round(a/c);if(a=p*c,t.twelveHour?l?0===p&&(p=12):(o&&(p*=5),60===p&&(p=0)):l?(12===p&&(p=0),p=d?0===p?12:p:0===p?0:p+12):(o&&(p*=5),60===p&&(p=0)),e[e.currentView]!==p&&(e.vibrateTimer&&clearTimeout(e.vibrateTimer),t.vibrate&&navigator.vibrate&&(navigator.vibrate(10),e.vibrateTimer=window.setTimeout(()=>{e.vibrateTimer=void 0},100))),e[e.currentView]=p,l&&e.spanHours?e.spanHours.innerHTML=p.toString():!l&&e.spanMinutes&&(e.spanMinutes.innerHTML=r(p)),e.hand&&e.bg){let r=Math.sin(a)*(h-t.tickRadius),n=-Math.cos(a)*(h-t.tickRadius),i=Math.sin(a)*h,o=-Math.cos(a)*h;e.hand.setAttribute("x2",r.toString()),e.hand.setAttribute("y2",n.toString()),e.bg.setAttribute("cx",i.toString()),e.bg.setAttribute("cy",o.toString())}},g=t=>{e.amOrPm=t,d()},b=()=>{e.isOpen&&(e.isOpen=!1,t.onCloseStart&&t.onCloseStart(),t.onCloseEnd&&t.onCloseEnd())},v=n=>{let i=n?"":r(e.hours)+":"+r(e.minutes);return!n&&t.twelveHour&&(i=`${i} ${e.amOrPm}`),b(),i},y=()=>({view:({attrs:i})=>{let{showClearBtn:a,clearLabel:l,closeLabel:c,doneLabel:u}=i;return[s()(".modal-content.timepicker-container",[s()(".timepicker-digital-display",[s()(".timepicker-text-container",[s()(".timepicker-display-column",[s()("span.timepicker-span-hours",{class:"hours"===e.currentView?"text-primary":"",onclick:()=>h("hours"),oncreate:t=>{e.spanHours=t.dom}},e.hours.toString()),":",s()("span.timepicker-span-minutes",{class:"minutes"===e.currentView?"text-primary":"",onclick:()=>h("minutes"),oncreate:t=>{e.spanMinutes=t.dom}},r(e.minutes))]),t.twelveHour&&s()(".timepicker-display-column.timepicker-display-am-pm",[s()(".timepicker-span-am-pm",{oncreate:t=>{e.spanAmPm=t.dom}},[s()(".am-btn",{class:"AM"===e.amOrPm?"text-primary":"",onclick:()=>g("AM"),oncreate:t=>{e.amBtn=t.dom}},"AM"),s()(".pm-btn",{class:"PM"===e.amOrPm?"text-primary":"",onclick:()=>g("PM"),oncreate:t=>{e.pmBtn=t.dom}},"PM")])])])]),s()(".timepicker-analog-display",[s()(".timepicker-plate",{oncreate:t=>{e.plate=t.dom,e.plate.addEventListener("mousedown",o),e.plate.addEventListener("touchstart",o)},onremove:()=>{e.plate&&(e.plate.removeEventListener("mousedown",o),e.plate.removeEventListener("touchstart",o))}},[s()(".timepicker-canvas",{oncreate:r=>{e.canvas=r.dom,(()=>{if(!e.canvas)return;let r=t.dialRadius,i=t.tickRadius,o=2*r,s=n("svg");s.setAttribute("class","timepicker-svg"),s.setAttribute("width",o.toString()),s.setAttribute("height",o.toString());let a=n("g");a.setAttribute("transform",`translate(${r},${r})`);let l=n("circle");l.setAttribute("class","timepicker-canvas-bearing"),l.setAttribute("cx","0"),l.setAttribute("cy","0"),l.setAttribute("r","4");let c=n("line");c.setAttribute("x1","0"),c.setAttribute("y1","0");let u=n("circle");u.setAttribute("class","timepicker-canvas-bg"),u.setAttribute("r",i.toString()),a.appendChild(c),a.appendChild(u),a.appendChild(l),s.appendChild(a),e.canvas.appendChild(s),e.hand=c,e.bg=u,e.bearing=l,e.g=a})(),setTimeout(()=>p(),10)}}),s()(".timepicker-dial.timepicker-hours",{oncreate:r=>{e.hoursView=r.dom,(()=>{if(e.hoursView)if(t.twelveHour)for(let r=1;r<13;r++){let n=document.createElement("div");n.className="timepicker-tick";let i=r/6*Math.PI,o=t.outerRadius;n.style.left=t.dialRadius+Math.sin(i)*o-t.tickRadius+"px",n.style.top=t.dialRadius-Math.cos(i)*o-t.tickRadius+"px",n.innerHTML=0===r?"00":r.toString(),e.hoursView.appendChild(n)}else for(let r=0;r<24;r++){let n=document.createElement("div");n.className="timepicker-tick";let i=r/6*Math.PI,o=r>0&&r<13?t.innerRadius:t.outerRadius;n.style.left=t.dialRadius+Math.sin(i)*o-t.tickRadius+"px",n.style.top=t.dialRadius-Math.cos(i)*o-t.tickRadius+"px",n.innerHTML=0===r?"00":r.toString(),e.hoursView.appendChild(n)}})()}}),s()(".timepicker-dial.timepicker-minutes.timepicker-dial-out",{oncreate:n=>{e.minutesView=n.dom,(()=>{if(e.minutesView)for(let n=0;n<60;n+=5){let i=document.createElement("div");i.className="timepicker-tick";let o=n/30*Math.PI;i.style.left=t.dialRadius+Math.sin(o)*t.outerRadius-t.tickRadius+"px",i.style.top=t.dialRadius-Math.cos(o)*t.outerRadius-t.tickRadius+"px",i.innerHTML=r(n),e.minutesView.appendChild(i)}})()}})]),s()(".timepicker-footer",{oncreate:t=>{e.footer=t.dom}},[s()("button.btn-flat.timepicker-clear.waves-effect",{type:"button",tabindex:t.twelveHour?"3":"1",style:a?"":"visibility: hidden;",onclick:()=>v(!0)},l),s()(".confirmation-btns",[s()("button.btn-flat.timepicker-close.waves-effect",{type:"button",tabindex:t.twelveHour?"3":"1",onclick:()=>b()},c),s()("button.btn-flat.timepicker-close.waves-effect",{type:"button",tabindex:t.twelveHour?"3":"1",onclick:()=>v()},u)])])])])]}});return{oninit:r=>{let n=r.attrs;t=Object.assign(Object.assign({},el),n),e={id:c(),isOpen:!1,hours:12,minutes:0,amOrPm:"AM",currentView:"hours",moved:!1,x0:0,y0:0,dx:0,dy:0},n.defaultValue&&u(n.defaultValue)},onremove:()=>{e.toggleViewTimer&&clearTimeout(e.toggleViewTimer),e.vibrateTimer&&clearTimeout(e.vibrateTimer),document.removeEventListener("mousemove",a),document.removeEventListener("touchmove",a),document.removeEventListener("mouseup",l),document.removeEventListener("touchend",l)},view:({attrs:r})=>{let{id:n=e.id,label:i,placeholder:o,disabled:a,readonly:l,required:c,iconName:d,helperText:p,onchange:f,oninput:g,useModal:v=!0,showClearBtn:w=!1,clearLabel:x="Clear",closeLabel:E="Cancel",twelveHour:_,className:T,class:O}=r,A=e.hours;t.twelveHour&&("PM"===e.amOrPm&&12!==e.hours?A=e.hours+12:"AM"===e.amOrPm&&12===e.hours&&(A=0));let S=void 0!==e.hours&&void 0!==e.minutes?((e,t,r)=>{if(!r)return`${e.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`;{let r=0===e?12:e>12?e-12:e,n=e>=12?"PM":"AM";return`${r}:${t.toString().padStart(2,"0")} ${n}`}})(A,e.minutes,_||!1):"";return s()(".input-field",{className:T||O||"col s12"},[d&&s()("i.material-icons.prefix",d),s()("input.timepicker",{id:n,type:v?"text":"time",value:v?S:void 0!==e.hours&&void 0!==e.minutes?`${e.hours.toString().padStart(2,"0")}:${e.minutes.toString().padStart(2,"0")}`:"",placeholder:v?o:void 0,disabled:a,readonly:l,required:c,onclick:()=>{a||l||!v||!e.isOpen&&(e.isOpen=!0,u(S),h("hours"),t.onOpen&&t.onOpen(),t.onOpenStart&&t.onOpenStart(),t.onOpenEnd&&t.onOpenEnd())},onchange:t=>{if(!v){let r=t.target.value,[n,i]=r.split(":").map(Number);e.hours=n,e.minutes=i,f&&f(r)}},oninput:e=>{!v&&g&&g(e.target.value)}}),i&&s()("label",{for:n,class:S||o?"active":""},i),p&&s()("span.helper-text",p),v&&e.isOpen&&[s()(".modal-overlay",{style:{zIndex:1002,display:"block",opacity:.5},onclick:()=>b()}),s()(".modal.timepicker-modal.open",{style:{zIndex:1003,display:"block",opacity:1,top:"10%",transform:"scaleX(1) scaleY(1)"}},s()(y,{showClearBtn:w,clearLabel:x,closeLabel:E,doneLabel:"OK"}))]])}}};class eu{constructor(e,t={}){this.el=e,this.options=Object.assign(Object.assign({},eu.defaults),t),this.state={originalOffset:this.el.getBoundingClientRect().top+window.pageYOffset},this.el.M_Pushpin=this,this._setupEventHandlers(),this._updateElementPosition()}static getInstance(e){return e.M_Pushpin}destroy(){this.el.style.position="",this.el.style.top="",this.el.style.left="",this._removeEventHandlers(),this.el.M_Pushpin=void 0}_setupEventHandlers(){this._updateElementPositionBound=this._updateElementPosition.bind(this),window.addEventListener("scroll",this._updateElementPositionBound),window.addEventListener("resize",this._updateElementPositionBound)}_removeEventHandlers(){window.removeEventListener("scroll",this._updateElementPositionBound),window.removeEventListener("resize",this._updateElementPositionBound)}_updateElementPosition(){let e=window.pageYOffset;e>this.state.originalOffset-this.options.offset?this.options.bottom!==1/0&&e>this.options.bottom?(this._removePinClasses(),this.el.classList.add("pin-bottom"),this.el.style.position="absolute",this.el.style.top=this.options.bottom-this.el.offsetHeight+"px",this.el.style.left="",this.options.onPositionChange&&this.options.onPositionChange("pin-bottom")):(this._removePinClasses(),this.el.classList.add("pinned"),this.el.style.position="fixed",this.el.style.top=this.options.top+"px",this.el.style.left=this.el.getBoundingClientRect().left+"px",this.options.onPositionChange&&this.options.onPositionChange("pinned")):(this._removePinClasses(),this.el.classList.add("pin-top"),this.el.style.position="",this.el.style.top="",this.el.style.left="",this.options.onPositionChange&&this.options.onPositionChange("pin-top"))}_removePinClasses(){this.el.classList.remove("pin-top"),this.el.classList.remove("pinned"),this.el.classList.remove("pin-bottom")}_updatePosition(){this.state.originalOffset=this.el.getBoundingClientRect().top+window.pageYOffset,this._updateElementPosition()}}eu.defaults={top:0,bottom:1/0,offset:0,onPositionChange:void 0};let ed=()=>({view:({attrs:{id:e,groupId:t,label:r,onchange:n,className:i="col s12",checked:o,disabled:a,inputId:l}})=>{let c=l||`${t}-${e}`;return s()("p",{className:i},s()("label",{for:c},[s()("input[type=radio][tabindex=0]",{id:c,name:t,disabled:a,checked:o,onclick:n?()=>n(e):void 0}),s()("span",s().trust(r))]))}}),eh=()=>{let e={groupId:c(),componentId:"",internalCheckedId:void 0},t=e=>void 0!==e.checkedId&&"function"==typeof e.onchange;return{oninit:({attrs:r})=>{e.componentId=r.id||c();let n=t(r);void 0===r.checkedId||n||r.disabled||console.warn("RadioButtons component received 'checkedId' prop without 'onchange' handler. Use 'defaultCheckedId' for uncontrolled components or add 'onchange' for controlled components."),n||(e.internalCheckedId=r.defaultCheckedId)},view:({attrs:r})=>{var n,i;let o,{checkedId:a,newRow:l,className:c="col s12",label:u="",disabled:d,description:h,options:p,isMandatory:f,checkboxClass:g,layout:b="vertical",onchange:v}=r,{groupId:y,componentId:w}=e,x=t(r);o=x?a:d?null!=(n=r.defaultCheckedId)?n:a:null!=(i=e.internalCheckedId)?i:r.defaultCheckedId;let E=t=>{x||(e.internalCheckedId=t),v&&v(t)},_=[l?"clear":"",c].filter(Boolean).join(" ").trim()||void 0,T=p.map(e=>({component:ed,props:Object.assign(Object.assign({},e),{onchange:E,groupId:y,disabled:d||e.disabled,className:g,checked:e.id===o,inputId:`${w}-${e.id}`}),key:e.id})),O=s()(en,{options:T,layout:b});return s()("div",{id:w,className:_},[u&&s()("h5.form-group-label",u+(f?" *":"")),h&&s()("p.helper-text",s().trust(h)),s()("form",{action:"#"},O)])}}},ep=()=>{let e={id:"",isOpen:!1,focusedIndex:-1,inputRef:null,dropdownRef:null,internalSelectedIds:[]},t=e=>void 0!==e.checkedId&&void 0!==e.onchange,r=(e,t)=>t.some(t=>t===e),n=(r,n,i)=>{let o,s=t(i),a=s?void 0!==i.checkedId?Array.isArray(i.checkedId)?i.checkedId:[i.checkedId]:[]:e.internalSelectedIds;n?o=a.includes(r)?a.filter(e=>e!==r):[...a,r]:(o=[r],e.isOpen=!1),s||(e.internalSelectedIds=o),i.onchange&&i.onchange(o)},i=t=>{t.target.closest(".input-field.select-space")||(e.isOpen=!1,s().redraw())};return{oninit:({attrs:r})=>{e.id=r.id||c();let n=t(r);void 0===r.checkedId||n||r.disabled||console.warn("Select component received 'checkedId' prop without 'onchange' handler. Use 'defaultCheckedId' for uncontrolled components or add 'onchange' for controlled components."),n||(e.internalSelectedIds=void 0!==r.defaultCheckedId?Array.isArray(r.defaultCheckedId)?r.defaultCheckedId:[r.defaultCheckedId]:[]),document.addEventListener("click",i)},onremove:()=>{document.removeEventListener("click",i)},view:({attrs:i})=>{var o;let a,l=t(i),{disabled:c}=i;if(l)a=void 0!==i.checkedId?Array.isArray(i.checkedId)?i.checkedId:[i.checkedId]:[];else if(c){let e=null!=(o=i.defaultCheckedId)?o:i.checkedId;a=void 0!==e?Array.isArray(e)?e:[e]:[]}else a=e.internalSelectedIds;let{newRow:u,className:d="col s12",key:f,options:g,multiple:b=!1,label:v,helperText:y,placeholder:w="",isMandatory:x,iconName:_,style:T}=i,O=u?`${d} clear`:d,A=g.filter(e=>r(e.id,a));return s()(".input-field.select-space",{className:O,key:f,style:T},[_&&s()("i.material-icons.prefix",_),s()(".select-wrapper",{onkeydown:c?void 0:t=>((t,r)=>{let{options:i}=r,o=i.filter(e=>!e.disabled);switch(t.key){case"ArrowDown":if(t.preventDefault(),e.isOpen){let t=Math.min(o.findIndex(t=>t===i[e.focusedIndex])+1,o.length-1),r=o[t];e.focusedIndex=i.findIndex(e=>e===r)}else e.isOpen=!0,e.focusedIndex=0;break;case"ArrowUp":if(t.preventDefault(),e.isOpen){let t=Math.max(o.findIndex(t=>t===i[e.focusedIndex])-1,0),r=o[t];e.focusedIndex=i.findIndex(e=>e===r)}break;case"Enter":case" ":if(t.preventDefault(),e.isOpen&&e.focusedIndex>=0&&e.focusedIndex<i.length){let t=i[e.focusedIndex];t&&!t.disabled&&n(t.id,r.multiple||!1,r)}else e.isOpen||(e.isOpen=!0,e.focusedIndex=0);break;case"Escape":t.preventDefault(),e.isOpen=!1,e.focusedIndex=-1}})(t,i),tabindex:c?-1:0,"aria-expanded":e.isOpen?"true":"false","aria-haspopup":"listbox",role:"combobox"},[s()("input[type=text][readonly=true].select-dropdown.dropdown-trigger",{id:e.id,value:A.length>0?A.map(e=>e.label||e.id).join(", "):w,oncreate:({dom:t})=>{e.inputRef=t},onclick:t=>{t.preventDefault(),t.stopPropagation(),c||(e.isOpen=!e.isOpen)}}),e.isOpen&&s()("ul.dropdown-content.select-dropdown",{tabindex:0,oncreate:({dom:t})=>{e.dropdownRef=t},onremove:()=>{e.dropdownRef=null},style:((e,t=!1,r,n=!1)=>{let i;if(!e)return{display:"block",opacity:1,position:"absolute",top:t?0:"100%",left:"0",zIndex:1e3,width:"100%"};let o=e.getBoundingClientRect(),s=window.innerHeight,a=200;if(r){let e=new Set,t=0;r.filter(e=>!e.divider).forEach(r=>{t++,r.group&&e.add(r.group)}),a=52*t+52*e.size}let l=s-o.bottom,c=o.top,u=l<a&&c>l,d=u?c:l;u&&(d=o.top-10);let h=a>d,p=h?d:a;if(u){let e=o.top;i=p<=e?12-p+52*!!n:-e+5}else i=t?0:"100%";let f={display:"block",opacity:1,position:"absolute",top:"number"==typeof i?`${i}px`:i,left:"0",zIndex:1e3,width:`${o.width}px`};return h&&(f.maxHeight=`${p}px`,f.overflowY="auto"),f})(e.inputRef,!0,g)},[w&&s()("li.disabled",{tabindex:0},s()("span",w)),g.filter(e=>!e.group).map(t=>s()("li",Object.assign({key:t.id,class:t.disabled?"disabled":e.focusedIndex===g.indexOf(t)?"focused":""},t.disabled?{}:{onclick:e=>{e.stopPropagation(),n(t.id,b,i)}}),s()("span",b?s()("label",{for:t.id},s()("input",{id:t.id,type:"checkbox",checked:a.includes(t.id),disabled:!!t.disabled||void 0,onclick:e=>{e.stopPropagation()}}),s()("span",t.label)):t.label))),Object.entries(g.filter(e=>e.group).reduce((e,t)=>{let r=t.group;return e[r]||(e[r]=[]),e[r].push(t),e},{})).map(([t,o])=>[s()("li.optgroup",{key:`group-${t}`,tabindex:0},s()("span",t)),...o.map(t=>s()("li",Object.assign({key:t.id,class:`optgroup-option${t.disabled?" disabled":""}${r(t.id,a)?" selected":""}${e.focusedIndex===g.indexOf(t)?" focused":""}`},t.disabled?{}:{onclick:e=>{e.stopPropagation(),n(t.id,b,i)}}),s()("span",b?s()("label",{for:t.id},s()("input",{id:t.id,type:"checkbox",checked:a.includes(t.id),disabled:!!t.disabled||void 0,onclick:e=>{e.stopPropagation()}}),s()("span",t.label)):t.label)))]).reduce((e,t)=>e.concat(t),[])]),s()(E,{name:"caret",direction:"down",class:"caret"})]),v&&s()(h,{id:e.id,label:v,isMandatory:x}),y&&s()(p,{helperText:y})])}}},ef=()=>{let e={id:c(),checked:!1};return{oninit:({attrs:{checked:t}})=>{e.checked=t||!1},view:({attrs:t})=>{let r=t.id||e.id,{checked:n,label:i,left:o,right:a,disabled:c,newRow:u,onchange:d,isMandatory:p,className:f="col s12"}=t,g=l(t,["checked","label","left","right","disabled","newRow","onchange","isMandatory","className"]),b=["input-field",u?"clear":"",f].filter(Boolean).join(" ").trim()||void 0;return s()("div",{className:b,onclick:e=>{d&&d(!n),e.preventDefault()}},[i&&s()(h,{label:i||"",id:r,isMandatory:p,className:"active"}),s()(".switch",g,s()("label",[s()("span",o||"Off"),s()("input[type=checkbox]",{id:r,disabled:c,checked:n}),s()("span.lever"),s()("span",a||"On")]))])}}},em=()=>{let e=()=>e=>{let t=r(e.title,e.id);return Object.assign(Object.assign({},e),{tabId:t,anchorId:`anchor-${t}`})},t={activeTabId:"",isDragging:!1,startX:0,translateX:0,indicatorStyle:{left:"0px",width:"0px"},lastIndicatorUpdate:""},r=(e,t)=>t||e.replace(/ /g,"").toLowerCase(),n=()=>{let e=document.getElementById(t.activeTabId);if(e){let r=e.closest(".tabs");if(r){let n=r.getBoundingClientRect(),i=e.getBoundingClientRect(),o=`${i.left-n.left}px`,s=`${i.width}px`;(t.indicatorStyle.left!==o||t.indicatorStyle.width!==s)&&(t.indicatorStyle={left:o,width:s})}}},i=e=>{e.touches&&0!==e.touches.length&&(t.isDragging=!0,t.startX=e.touches[0].clientX)},o=(e,r)=>{let n=r?e.find(e=>e.tabId===r):void 0;if(n)return t.activeTabId=n.tabId,n;let i=t.activeTabId&&e.find(e=>e.tabId===t.activeTabId);if(i)return i;let o=e.find(e=>!e.disabled&&!e.href);if(o)return t.activeTabId=o.tabId,o};return{oninit:({attrs:t})=>{o(t.tabs.map(e()),t.selectedTabId)},oncreate:()=>{n(),s().redraw()},view:({attrs:a})=>{let{tabWidth:l,tabs:c,className:u,style:d,swipeable:h=!1}=a,p=["fill"===l?"tabs-fixed-width":"",u].filter(Boolean).join(" ").trim()||void 0,f=c.map(e()),g=o(f,a.selectedTabId);return n(),s()(".row",[s()(".col.s12",s()("ul.tabs",{className:p,style:d},[...f.map(e=>{let{className:r,title:n,anchorId:i,tabId:o,disabled:u,target:d,href:h}=e,p=["tab","fixed"===l?`col s${Math.floor(12/c.length)}`:"",r].filter(Boolean).join(" ").trim();return s()("li",{key:o,id:o,className:p,disabled:u},s()("a",{id:i,className:e.tabId===t.activeTabId?"active":void 0,target:d,href:h||`#${i}`,onclick:u||h?void 0:e=>{e.preventDefault(),((e,r,n)=>{console.log({state:t,tabId:e}),t.activeTabId!==e&&(t.activeTabId=e,n.onShow&&n.onShow(r),n.onTabChange&&n.onTabChange(e))})(o,e.target,a)},style:u?{opacity:"0.6",cursor:"not-allowed"}:void 0},n))}),s()("li.indicator",{key:"indicator",style:{display:t.activeTabId?"block":"none",left:t.indicatorStyle.left,width:t.indicatorStyle.width,transition:"left 0.35s ease, width 0.35s ease"}})]),g&&s()(".col.s12",{ontouchstart:h?i:void 0,ontouchend:h?e=>((e,n)=>{if(!t.isDragging||!e.changedTouches||0===e.changedTouches.length)return;let i=e.changedTouches[0].clientX-t.startX;if(Math.abs(i)>50){let e=n.tabs.findIndex(e=>r(e.title,e.id)===t.activeTabId);if(i>0&&e>0){let i=n.tabs[e-1];if(!i.disabled&&!i.href){let e=r(i.title,i.id);t.activeTabId=e,n.onTabChange&&n.onTabChange(e)}}else if(i<0&&e<n.tabs.length-1){let i=n.tabs[e+1];if(!i.disabled&&!i.href){let e=r(i.title,i.id);t.activeTabId=e,n.onTabChange&&n.onTabChange(e)}}}t.isDragging=!1,t.translateX=0})(e,a):void 0,style:h?{touchAction:"pan-y"}:void 0},s()(".tab-content",{className:g.contentClass},g.vnode)))])}}};class eg{constructor(e={}){this.options=Object.assign(Object.assign({},eg.defaults),e),this.state={panning:!1,timeRemaining:this.options.displayLength,startingXPos:0,xPos:0,velocityX:0,time:0,deltaX:0,wasSwiped:!1},0===eg._toasts.length&&eg._createContainer(),eg._toasts.push(this),this.el=this._createToast(),this._animateIn(),this._setTimer()}static getInstance(e){return e.M_Toast}static _createContainer(){let e=document.createElement("div");e.setAttribute("id","toast-container"),e.addEventListener("touchstart",eg._onDragStart),e.addEventListener("touchmove",eg._onDragMove),e.addEventListener("touchend",eg._onDragEnd),e.addEventListener("mousedown",eg._onDragStart),document.addEventListener("mousemove",eg._onDragMove),document.addEventListener("mouseup",eg._onDragEnd),document.body.appendChild(e),eg._container=e}static _removeContainer(){document.removeEventListener("mousemove",eg._onDragMove),document.removeEventListener("mouseup",eg._onDragEnd),eg._container&&(eg._container.remove(),eg._container=null)}static _xPos(e){return e.targetTouches&&e.targetTouches.length>=1?e.targetTouches[0].clientX:e.clientX}static dismissAll(){eg._toasts.forEach(e=>e.dismiss())}_createToast(){let e=document.createElement("div");e.classList.add("toast"),this.options.classes&&e.classList.add(...this.options.classes.split(" "));let t=this.options.html;return"object"==typeof t&&t&&"nodeType"in t?e.appendChild(t):e.innerHTML=t,e.M_Toast=this,eg._container.appendChild(e),e}_animateIn(){this.el.style.cssText=`
      transform: translateY(35px);
      opacity: 0;
      transition: transform ${this.options.inDuration}ms cubic-bezier(0.215, 0.61, 0.355, 1),
                  opacity ${this.options.inDuration}ms cubic-bezier(0.215, 0.61, 0.355, 1);
    `,setTimeout(()=>{this.el.style.transform="translateY(0)",this.el.style.opacity="1"},10)}_setTimer(){this.state.timeRemaining!==1/0&&(this.state.counterInterval=window.setInterval(()=>{this.state.panning||(this.state.timeRemaining-=20),this.state.timeRemaining<=0&&this.dismiss()},20))}dismiss(){this.state.counterInterval&&window.clearInterval(this.state.counterInterval);let e=this.el.offsetWidth*this.options.activationPercent;this.state.wasSwiped&&(this.el.style.transition="transform .05s, opacity .05s",this.el.style.transform=`translateX(${e}px)`,this.el.style.opacity="0"),this.el.style.cssText+=`
      transition: opacity ${this.options.outDuration}ms cubic-bezier(0.165, 0.84, 0.44, 1),
                  margin-top ${this.options.outDuration}ms cubic-bezier(0.165, 0.84, 0.44, 1);
      opacity: 0;
      margin-top: -40px;
    `,setTimeout(()=>{this.options.completeCallback&&this.options.completeCallback(),this.el.remove();let e=eg._toasts.indexOf(this);e>-1&&eg._toasts.splice(e,1),0===eg._toasts.length&&eg._removeContainer()},this.options.outDuration)}}eg._toasts=[],eg._container=null,eg._draggedToast=null,eg.defaults={html:"",displayLength:4e3,inDuration:300,outDuration:375,classes:"",completeCallback:void 0,activationPercent:.8},eg._onDragStart=e=>{let t=e.target.closest(".toast");if(t){let r=t.M_Toast;r&&(r.state.panning=!0,eg._draggedToast=r,r.el.classList.add("panning"),r.el.style.transition="",r.state.startingXPos=eg._xPos(e),r.state.time=Date.now(),r.state.xPos=eg._xPos(e))}},eg._onDragMove=e=>{if(eg._draggedToast){e.preventDefault();let t=eg._draggedToast;t.state.deltaX=Math.abs(t.state.xPos-eg._xPos(e)),t.state.xPos=eg._xPos(e),t.state.velocityX=t.state.deltaX/(Date.now()-t.state.time),t.state.time=Date.now();let r=t.state.xPos-t.state.startingXPos,n=t.el.offsetWidth*t.options.activationPercent;t.el.style.transform=`translateX(${r}px)`,t.el.style.opacity=String(1-Math.abs(r/n))}},eg._onDragEnd=()=>{if(eg._draggedToast){let e=eg._draggedToast;e.state.panning=!1,e.el.classList.remove("panning"),Math.abs(e.state.xPos-e.state.startingXPos)>e.el.offsetWidth*e.options.activationPercent||e.state.velocityX>1?(e.state.wasSwiped=!0,e.dismiss()):(e.el.style.transition="transform .2s, opacity .2s",e.el.style.transform="",e.el.style.opacity=""),eg._draggedToast=null}};class eb{constructor(e,t={}){this.el=e,this.options=Object.assign(Object.assign({},eb.defaults),t),this.state={isOpen:!1,isHovered:!1,isFocused:!1,xMovement:0,yMovement:0},this.el.M_Tooltip=this,this._appendTooltipEl(),this._setupEventHandlers()}static getInstance(e){return e.M_Tooltip}destroy(){this.tooltipEl.remove(),this._removeEventHandlers(),this.el.M_Tooltip=void 0}_appendTooltipEl(){let e=document.createElement("div");e.classList.add("material-tooltip"),this.tooltipEl=e;let t=document.createElement("div");t.classList.add("tooltip-content"),t.innerHTML=this.options.html||"",e.appendChild(t),document.body.appendChild(e)}_updateTooltipContent(){let e=this.tooltipEl.querySelector(".tooltip-content");e&&(e.innerHTML=this.options.html||"")}_setupEventHandlers(){this._handleMouseEnterBound=this._handleMouseEnter.bind(this),this._handleMouseLeaveBound=this._handleMouseLeave.bind(this),this._handleFocusBound=this._handleFocus.bind(this),this._handleBlurBound=this._handleBlur.bind(this),this.el.addEventListener("mouseenter",this._handleMouseEnterBound),this.el.addEventListener("mouseleave",this._handleMouseLeaveBound),this.el.addEventListener("focus",this._handleFocusBound,!0),this.el.addEventListener("blur",this._handleBlurBound,!0)}_removeEventHandlers(){this.el.removeEventListener("mouseenter",this._handleMouseEnterBound),this.el.removeEventListener("mouseleave",this._handleMouseLeaveBound),this.el.removeEventListener("focus",this._handleFocusBound,!0),this.el.removeEventListener("blur",this._handleBlurBound,!0)}open(e=!0){this.state.isOpen||(this.state.isOpen=!0,this.options=Object.assign(Object.assign({},this.options),this._getAttributeOptions()),this._updateTooltipContent(),this._setEnterDelayTimeout(e))}close(){this.state.isOpen&&(this.state.isHovered=!1,this.state.isFocused=!1,this.state.isOpen=!1,this._setExitDelayTimeout())}_setExitDelayTimeout(){this.state.exitDelayTimeout&&clearTimeout(this.state.exitDelayTimeout),this.state.exitDelayTimeout=window.setTimeout(()=>{this.state.isHovered||this.state.isFocused||this._animateOut()},this.options.exitDelay)}_setEnterDelayTimeout(e){this.state.enterDelayTimeout&&clearTimeout(this.state.enterDelayTimeout),this.state.enterDelayTimeout=window.setTimeout(()=>{(this.state.isHovered||this.state.isFocused||e)&&this._animateIn()},this.options.enterDelay)}_positionTooltip(){let e=this.el,t=this.tooltipEl,r=e.offsetHeight,n=e.offsetWidth,i=t.offsetHeight,o=t.offsetWidth,s=this.options.margin;this.state.xMovement=0,this.state.yMovement=0;let a=e.getBoundingClientRect(),l=a.top+window.pageYOffset,c=a.left+window.pageXOffset;switch(this.options.position){case"top":l+=-i-s,c+=n/2-o/2,this.state.yMovement=-this.options.transitionMovement;break;case"right":l+=r/2-i/2,c+=n+s,this.state.xMovement=this.options.transitionMovement;break;case"left":l+=r/2-i/2,c+=-o-s,this.state.xMovement=-this.options.transitionMovement;break;default:l+=r+s,c+=n/2-o/2,this.state.yMovement=this.options.transitionMovement}let u=this._repositionWithinScreen(c,l,o,i);this.tooltipEl.style.top=u.y+"px",this.tooltipEl.style.left=u.x+"px"}_repositionWithinScreen(e,t,r,n){let i=window.pageXOffset,o=window.pageYOffset,s=e-i,a=t-o,l=this.options.margin+this.options.transitionMovement;return s<l?s=l:s+r>window.innerWidth-l&&(s=window.innerWidth-r-l),a<l?a=l:a+n>window.innerHeight-l&&(a=window.innerHeight-n-l),{x:s+i,y:a+o}}_animateIn(){this._positionTooltip(),this.tooltipEl.style.visibility="visible",this.tooltipEl.style.cssText+=`
      opacity: 0;
      transform: translate(0, 0);
      transition: opacity ${this.options.inDuration}ms cubic-bezier(0.215, 0.61, 0.355, 1),
                  transform ${this.options.inDuration}ms cubic-bezier(0.215, 0.61, 0.355, 1);
    `,setTimeout(()=>{this.tooltipEl.style.opacity="1",this.tooltipEl.style.transform=`translate(${this.state.xMovement}px, ${this.state.yMovement}px)`},10)}_animateOut(){this.tooltipEl.style.cssText+=`
      transition: opacity ${this.options.outDuration}ms cubic-bezier(0.215, 0.61, 0.355, 1),
                  transform ${this.options.outDuration}ms cubic-bezier(0.215, 0.61, 0.355, 1);
      opacity: 0;
      transform: translate(0, 0);
    `,setTimeout(()=>{this.tooltipEl.style.visibility="hidden"},this.options.outDuration)}_handleMouseEnter(){this.state.isHovered=!0,this.state.isFocused=!1,this.open(!1)}_handleMouseLeave(){this.state.isHovered=!1,this.state.isFocused=!1,this.close()}_handleFocus(){this.state.isFocused=!0,this.open(!1)}_handleBlur(){this.state.isFocused=!1,this.close()}_getAttributeOptions(){let e={},t=this.el.getAttribute("data-tooltip"),r=this.el.getAttribute("data-position");return t&&(e.html=t),r&&["top","bottom","left","right"].includes(r)&&(e.position=r),e}}eb.defaults={exitDelay:200,enterDelay:0,html:null,margin:5,inDuration:250,outDuration:200,position:"bottom",transitionMovement:10};let ev={theme:"Theme:",light:"Light",dark:"Dark",auto:"Auto",lightTitle:"Light theme",darkTitle:"Dark theme",autoTitle:"Auto theme (system preference)",switchToDark:"Switch to dark theme",switchToLight:"Switch to light theme"};class ey{static setTheme(e){this.currentTheme=e;let t=document.documentElement;"auto"===e?t.removeAttribute("data-theme"):t.setAttribute("data-theme",e);try{localStorage.setItem("mm-theme",e)}catch(e){}}static getTheme(){return this.currentTheme}static getEffectiveTheme(){return"auto"!==this.currentTheme?this.currentTheme:"undefined"!=typeof window&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}static initialize(){let e="auto";try{let t=localStorage.getItem("mm-theme");t&&["light","dark","auto"].includes(t)&&(e=t)}catch(e){}this.setTheme(e)}static toggle(){let e=this.getEffectiveTheme();this.setTheme("light"===e?"dark":"light")}}ey.currentTheme="auto";let ew=()=>({oninit:()=>{"undefined"!=typeof window&&ey.initialize()},view:({attrs:e={}})=>{let t=ey.getEffectiveTheme(),r=Object.assign(Object.assign({},ev),e.i18n);return s()("button.btn-flat.theme-toggle",{class:e.className||"",onclick:()=>{ey.toggle()},title:"light"===t?r.switchToDark:r.switchToLight,style:"margin: 0; height: 64px; line-height: 64px; border-radius: 0; min-width: 64px; padding: 0;"},[s()("i.material-icons",{style:"color: inherit; font-size: 24px;"},"light"===t?"dark_mode":"light_mode")])}}),ex=()=>({view:({attrs:e})=>{let{node:t,level:r,isSelected:n,isExpanded:i,isFocused:o,showConnectors:s,iconType:a,selectionMode:l,onToggleExpand:c,onToggleSelect:u,onFocus:d}=e,h=t.children&&t.children.length>0,p=24*r;return m("li.tree-node",{class:[n&&"selected",o&&"focused",t.disabled&&"disabled",h&&"has-children",e.isLastInBranch&&"tree-last-in-branch"].filter(Boolean).join(" ")||void 0,"data-node-id":t.id,"data-level":r},[m(".tree-node-content",{style:{paddingLeft:`${p}px`},onclick:t.disabled?void 0:()=>{"none"!==l&&u(t.id),d(t.id)},onkeydown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),t.disabled||"none"===l||u(t.id))},tabindex:t.disabled?-1:0,role:"multiple"===l?"option":"treeitem","aria-selected":"none"!==l?n.toString():void 0,"aria-expanded":h?i.toString():void 0,"aria-disabled":t.disabled?"true":void 0},[s&&r>0&&m(".tree-connectors",Array.from({length:r},(e,t)=>m(".tree-connector",{key:t,style:{left:`${24*t+12}px`}}))),h?m(".tree-expand-icon",{onclick:e=>{e.stopPropagation(),t.disabled||c(t.id)},class:a},["plus-minus"===a?m("span.tree-plus-minus",i?"":"+"):"triangle"===a?m("span.tree-triangle",{class:i?"expanded":void 0},""):"chevron"===a?m(E,{name:"chevron",direction:i?"down":"right",class:"tree-chevron-icon"}):m(E,{name:"caret",direction:i?"down":"right",class:"tree-caret-icon"})]):m(".tree-expand-spacer"),"multiple"===l&&m(".tree-selection-indicator",[m("input[type=checkbox]",{checked:n,disabled:t.disabled,onchange:()=>{t.disabled||u(t.id)},onclick:e=>e.stopPropagation()})]),t.icon&&m("i.tree-node-icon.material-icons",t.icon),m("span.tree-node-label",t.label)]),h&&i&&m("ul.tree-children",{role:"group","aria-expanded":"true"},t.children.map((t,n)=>{var i,o,h,p,f,g;let b=null!=(o=null==(i=e.treeState)?void 0:i.selectedIds.has(t.id))&&o,v=null!=(p=null==(h=e.treeState)?void 0:h.expandedIds.has(t.id))&&p,y=(null==(f=e.treeState)?void 0:f.focusedNodeId)===t.id,w=[...e.currentPath||[],n],x=null!=(g=e.treeAttrs)&&!!g.data&&((e,t)=>{let r=t;for(let t=0;t<e.length;t++){let n=e[t];if(n!==r.length-1)return!1;if(t<e.length-1){let e=r[n];e.children&&(r=e.children)}}return!0})(w,e.treeAttrs.data);return m(ex,{key:t.id,node:t,level:r+1,isSelected:b,isExpanded:v,isFocused:y,showConnectors:s,iconType:a,selectionMode:l,onToggleExpand:c,onToggleSelect:u,onFocus:d,isLastInBranch:x,currentPath:w,treeState:e.treeState,treeAttrs:e.treeAttrs})}))])}});var eE=[{threshold:0,color:"#ddeced"},{threshold:1,color:"#FF7800"},{threshold:2,color:"#ffff00"},{threshold:3,color:"#ff0000"}],e_={version:1,lastUpdate:new Date().valueOf(),scenarios:[],scenario:{id:"demo1",label:"Demo",desc:"Demo scenario",includeDecisionSupport:!1,hideInconsistentValues:!0,inconsistencies:{},categories:[{id:"threat",label:"Threat",componentIds:["ThreatDirection","Impact","Motivation","ModusOperandiDuringExecution","Equipment","Responsibility"]},{id:"context",label:"Context",componentIds:["WeatherType","WeatherBehaviour","TypeOfObject","AvailableBudget","OpenCompartments","Location"]}],components:[{id:"ThreatDirection",label:"Threat direction",values:[{id:"df62efe6",label:"Hannibal"},{id:"70630364",label:"The Romans"},{id:"82d5d4f5",label:"Herbert Hoover"}]},{id:"Impact",label:"Impact",values:[{id:"5c532a23",label:"Low"},{id:"16ad9a77",label:"Medium"},{id:"b894abb6",label:"High"}]},{id:"Motivation",label:"Motivation",values:[{id:"f4ab7a7a",label:"Money"},{id:"ff550f8f",label:"Justice"},{id:"22b4867e",label:"Revenge"}]},{id:"ModusOperandiDuringExecution",label:"Modus operandi during execution",values:[{id:"7ed25fa5",label:"Sniper attack",type:"ModusOperandiDuringExecution"},{id:"1f9b68c9",label:"Kidnapping",type:"ModusOperandiDuringExecution"},{id:"5cc5e352",label:"Singing",type:"ModusOperandiDuringExecution"}]},{id:"Equipment",label:"Equipment",values:[{id:"b4218a1f",label:"None"},{id:"8f6185f7",label:"Drone"},{id:"cb02878d",label:"Bomb"},{id:"9d645efb",label:"Helicopter"},{id:"3a4398c7",label:"Hammer"}]},{id:"Responsibility",label:"Responsibility",values:[{id:"f44d22be",label:"Private"},{id:"20f9a6ed",label:"Public"}]},{id:"WeatherType",label:"Weather type",values:[{id:"b9fe2b73",label:"Rainy"},{id:"478581c1",label:"Sunny"},{id:"b855ac10",label:"Windy"},{id:"24c73f36",label:"Cloudy"}]},{id:"WeatherBehaviour",label:"Weather behaviour",values:[{id:"0ff8041e",label:"Stable"},{id:"894a9bcb",label:"Changing"}]},{id:"TypeOfObject",label:"Type of object",values:[{id:"29a303b3",label:"Church"},{id:"2e7df143",label:"Park"},{id:"e11282fb",label:"Palace"},{id:"9a1b3256",label:"Airport"}]},{id:"AvailableBudget",label:"Available budget",values:[{id:"90e1ba48",label:"Knowledge"},{id:"f961174c",label:"Water"}]},{id:"OpenCompartments",label:"Open compartments",values:[{id:"01c3940a",label:"Open"},{id:"56b7fa45",label:"Closed"}]},{id:"Location",label:"Location",values:[{id:"ea57f820",label:"Vietnam"},{id:"b8bd8bc3",label:"Washington"},{id:"8fb1e1ab",label:"Buitenpost"}]}],narratives:[],thresholdColors:eE}},eT=function(){return{id:c(),label:"NEW SCENARIO",desc:"",includeDecisionSupport:!1,hideInconsistentValues:!1,inconsistencies:{},categories:[],components:[],narratives:[],thresholdColors:eE}},eO=function(){return{version:1,lastUpdate:new Date().valueOf(),scenarios:[],scenario:eT(),personas:[]}},eA=[eO(),e_],eS=[{id:"airport",name:"Airport",key:"aeroway",value:"aerodrome"},{id:"cafe",name:"Cafe",key:"amenity",value:"bar"},{id:"church",name:"Church",key:"building",value:"church"},{id:"city_square",name:"City square",key:"place",value:"square"},{id:"flats",name:"Flats",key:'"building:levels"',value:'"([6-9]|d{2,})"'},{id:"gas_station",name:"Gas station",key:"amenity",value:"fuel"},{id:"hospital",name:"Hospital",key:"amenity",value:"hospital"},{id:"hotel",name:"Hotel",key:"tourism",value:"hotel"},{id:"palace",name:"Palace",key:"castle_type",value:"palace"},{id:"parking",name:"Parking",key:"amenity",value:"parking"},{id:"restaurant",name:"Restaurant",key:"amenity",value:"restaurant"},{id:"shopping_street",name:"Shopping street",key:"highway",value:"pedestrian"},{id:"stadspoort",name:"Stadspoort",key:"historic",value:"city_gate"},{id:"statue",name:"Statue",key:"memorial",value:"statue"}].map(function(e){return e.id});let ek=r.p+"c17103ea2cc7dd72.jpg",eN=r.p+"b2d5fba9d32dafca.jpg",eC=r.p+"48096cd40fc6c8f4.jpg",eI=r.p+"b1fdba939c2f5297.jpg",eR=r.p+"b5debe6fe4b3afaa.jpg",eP=r.p+"c0a54ea4c215265b.jpg",eL=r.p+"ac6f14e91d7cc000.jpg",eD=r.p+"ba0a433953d69a08.jpg",eM=r.p+"6aa44cc8a896a39b.jpg",ej=r.p+"25d2d2ded0ed6bd2.jpg",eB=r.p+"8863b9b162df0d4b.jpg",eF=r.p+"2a66fb742825ed15.jpg",eU=r.p+"2903f3ef3d7fd72a.jpg",eq=r.p+"a367bff23ca073b5.jpg",ez=r.p+"19a125c7f0ba3fa2.jpg",eH=r.p+"bba1fa90de604384.jpg",eX=r.p+"af8481c371fe65d4.jpg",eV=r.p+"48018dc5c5a48420.jpg",e$=r.p+"732359e869ab9c7f.jpg",eK=r.p+"815dc185f97fe0f0.jpg",eW=r.p+"d5c5fa50c124e713.jpg",eG=r.p+"63b233d30242a82f.jpg",eY=r.p+"29563f51b25aeccf.jpg",eZ=r.p+"a05b2084c8422157.jpg",eJ=r.p+"30dc14f001d32564.jpg",eQ=r.p+"31f4ec5bc001c757.jpg",e0=r.p+"dc24f937096fd880.jpg",e1=r.p+"ac78245de3c16d35.jpg",e2=r.p+"0ffecf2e012cd292.jpg",e5=r.p+"8083e6f74664f9d7.jpg",e3=r.p+"f475a19983f3f16e.jpg",e4=r.p+"0f5cead64acae32f.jpg",e6=r.p+"1b7f3792f2a7e1ae.jpg",e8=r.p+"b9cb6abc844bba28.jpg",e9=r.p+"ca5055f62f785dee.jpg",e7=r.p+"b414869356c66f77.jpg",te=r.p+"52dc0b012211bb98.jpg",tt=r.p+"933a961b2cc4ccc6.jpg",tr=r.p+"c303e41cff62a1c7.jpg",tn=r.p+"a17c8d1ae56d42b0.jpg",ti=r.p+"cf19dfc144092334.jpg",to=r.p+"fd9eb7c66db099c8.jpg",ts=r.p+"56060654829facad.jpg",ta=r.p+"b9564e9dfbe51f1d.jpg",tl=r.p+"2bbc81bcce4f948d.jpg",tc=r.p+"20b3f24a471fc2ab.jpg",tu=r.p+"ba5d690ec2286324.jpg",td=r.p+"c10098320d985597.jpg",th=r.p+"5e7d4c1aca78dfce.jpg",tp=r.p+"e885f489d7f73419.jpg",tf=r.p+"c4f3277fa4912730.jpg",tm=r.p+"b4f38543d0f4fad3.jpg",tg=r.p+"75430f3874b4d2a3.jpg",tb=r.p+"705b062d96e89833.jpg",tv=r.p+"1173a280cc7db935.jpg",ty=r.p+"d7d2291761e806f7.jpg",tw=r.p+"65b21c37b85863e4.jpg",tx=r.p+"925d5acba6a06c43.jpg",tE=r.p+"5de0d68bafbc35f6.jpg",t_=r.p+"92e47ed0191af049.jpg",tT=r.p+"e7a42b5c01fab2eb.jpg",tO=r.p+"2eedda4586c2d0f4.jpg",tA=r.p+"a1b42cdb8d767016.jpg",tS=r.p+"a1444c5ba7467f47.jpg",tk=r.p+"432a5d4490d0d359.jpg",tN=r.p+"5e17705bb3caace1.jpg",tC=r.p+"e3191876e312bd1a.jpg",tI=r.p+"f7126b8735cda4e7.jpg",tR=r.p+"c98b9e495f5b24fa.jpg",tP=r.p+"70ca9c5b29427f85.jpg",tL=r.p+"df4e7a224bdfe8df.jpg",tD=r.p+"a1fab39fe8a0c3e6.jpg",tM=r.p+"de82680488daf92f.jpg",tj=r.p+"d4ef1e1ea05262bf.jpg",tB=r.p+"2cbc15021ccfe071.jpg",tF=r.p+"b01fde9aa9bd4dbe.jpg",tU=r.p+"84797a40859fed04.jpg",tq=r.p+"096fa9e7fcccc9b0.jpg",tz=r.p+"9599745fc7af8a66.jpg",tH=r.p+"12de43f34486fb0e.jpg",tX=r.p+"b65e7b542f5220b9.jpg",tV=r.p+"8a07f04c16108db2.jpg",t$=r.p+"dbba424353e700a7.jpg",tK=r.p+"2a2bafda1f141fbd.jpg",tW=r.p+"8db11414829ba136.jpg",tG=r.p+"86d2e40850d6267d.jpg",tY=r.p+"774b2c7bbd638c55.jpg",tZ=r.p+"cb40059f01133457.jpg";var tJ=[{id:"cook1",img:ek,label:"Cook 1"},{id:"cook2",img:eN,label:"Cook 2"},{id:"cook3",img:eC,label:"Cook 3"},{id:"elderly_man1",img:eI,label:"Elderly man 1"},{id:"elderly_man2",img:eR,label:"Elderly man 2"},{id:"elderly_man3",img:eP,label:"Elderly man 3"},{id:"elderly_man4",img:eL,label:"Elderly man 4"},{id:"farmer1",img:eD,label:"Farmer 1"},{id:"farmer2",img:eM,label:"Farmer 2"},{id:"farmer3",img:ej,label:"Farmer 3"},{id:"female_student1",img:eB,label:"Female student 1"},{id:"female_student2",img:eF,label:"Female student 2"},{id:"nurse1",img:eU,label:"Nurse 1"},{id:"nurse2",img:eq,label:"Nurse 2"},{id:"nurse3",img:ez,label:"Nurse 3"},{id:"nurse4",img:eH,label:"Nurse 4"},{id:"young_mother1",img:eX,label:"Young mother 1"},{id:"young_mother2",img:eV,label:"Young mother 2"},{id:"young_mother3",img:e$,label:"Young mother 3"},{id:"young_mother4",img:eK,label:"Young mother 4"},{id:"elderly_man_wheelchair1",img:eW,label:"Elderly man in wheelchair 1"},{id:"elderly_man_wheelchair2",img:eG,label:"Elderly man in wheelchair 2"},{id:"elderly_man_wheelchair3",img:eY,label:"Elderly man in wheelchair 3"},{id:"middle_aged_male_truck_driver1",img:eZ,label:"Middle-aged male truckdriver 1"},{id:"middle_aged_male_truck_driver2",img:eJ,label:"Middle-aged male truckdriver 2"},{id:"middle_aged_male_truck_driver3",img:eQ,label:"Middle-aged male truckdriver 3"},{id:"middle_aged_male_truck_driver4",img:e0,label:"Middle-aged male truckdriver 4"},{id:"male_indian_student1",img:e1,label:"Male Indian student 1"},{id:"male_indian_student2",img:e2,label:"Male Indian student 2"},{id:"male_indian_student3",img:e5,label:"Male Indian student 3"},{id:"male_indian_student4",img:e3,label:"Male Indian student 4"},{id:"female_worker_with_laptop1",img:e4,label:"Female worker with laptop 1"},{id:"female_worker_with_laptop2",img:e6,label:"Female worker with laptop 2"},{id:"female_worker_with_laptop3",img:e8,label:"Female worker with laptop 3"},{id:"female_worker_with_laptop4",img:e9,label:"Female worker with laptop 4"},{id:"families1",img:e7,label:"Families 1"},{id:"families2",img:te,label:"Families 2"},{id:"families3",img:tt,label:"Families 3"},{id:"families4",img:tr,label:"Families 4"},{id:"families5",img:tn,label:"Families 5"},{id:"families6",img:ti,label:"Families 6"},{id:"families7",img:to,label:"Families 7"},{id:"families8",img:ts,label:"Families 8"},{id:"families9",img:ta,label:"Families 9"},{id:"families10",img:tl,label:"Families 10"},{id:"families11",img:tc,label:"Families 11"},{id:"families12",img:tu,label:"Families 12"},{id:"families13",img:td,label:"Families 13"},{id:"families14",img:th,label:"Families 14"},{id:"families15",img:tp,label:"Families 15"},{id:"female_speaker1",img:tf,label:"Female speaker 1"},{id:"female_speaker2",img:tm,label:"Female speaker 2"},{id:"female_speaker3",img:tg,label:"Female speaker 3"},{id:"female_speaker4",img:tb,label:"Female speaker 4"},{id:"construction_worker1",img:tv,label:"Construction worker 1"},{id:"construction_worker2",img:ty,label:"Construction worker 2"},{id:"construction_worker3",img:tw,label:"Construction worker 3"},{id:"construction_worker4",img:tx,label:"Construction worker 4"},{id:"elderly_woman_wheelchair1",img:tE,label:"Elderly woman in wheelchair 1"},{id:"elderly_woman_wheelchair2",img:t_,label:"Elderly woman in wheelchair 2"},{id:"elderly_woman_wheelchair3",img:tT,label:"Elderly woman in wheelchair 3"},{id:"elderly_woman_wheelchair4",img:tO,label:"Elderly woman in wheelchair 4"},{id:"female_teacher1",img:tA,label:"Female teacher 1"},{id:"female_teacher2",img:tS,label:"Female teacher 2"},{id:"male_teacher1",img:tk,label:"Male teacher 1"},{id:"male_teacher2",img:tN,label:"Male teacher 2"},{id:"male_zzp1",img:tC,label:"Male worker with laptop"},{id:"male_zzp2",img:tI,label:"Male worker with laptop"},{id:"male_zzp3",img:tR,label:"Male worker with laptop"},{id:"male_zzp4",img:tP,label:"Male worker with laptop"},{id:"business_woman1",img:tL,label:"Business woman 1"},{id:"business_woman2",img:tD,label:"Business woman 2"},{id:"business_woman3",img:tM,label:"Business woman 3"},{id:"business_woman4",img:tj,label:"Business woman 4"},{id:"climate_girl1",img:tB,label:"Climate girl 1"},{id:"climate_girl2",img:tF,label:"Climate girl 2"},{id:"climate_girl3",img:tU,label:"Climate girl 3"},{id:"climate_girl4",img:tq,label:"Climate girl 4"},{id:"taxi_driver1",img:tz,label:"Taxi driver 1"},{id:"taxi_driver2",img:tH,label:"Taxi driver 2"},{id:"taxi_driver3",img:tX,label:"Taxi driver 3"},{id:"taxi_driver4",img:tV,label:"Taxi driver 4"},{id:"tech_guy1",img:t$,label:"Tech guy 1"},{id:"tech_guy2",img:tK,label:"Tech guy 2"},{id:"tech_guy3",img:tW,label:"Tech guy 3"},{id:"tech_guy4",img:tG,label:"Tech guy 4"},{id:"middleaged_man_suit1",img:tY,label:"Middleaged man in suit 1"},{id:"middleaged_man_suit2",img:tZ,label:"Middleaged man in suit 2"},{id:"middleaged_man_suit3",img:r.p+"8c764a5d7c201ddf.jpg",label:"Middleaged man in suit 3"},{id:"middleaged_man_suit4",img:r.p+"9e6a81093a180964.jpg",label:"Middleaged man in suit 4"}];let tQ=r.p+"110fb094e6327dbf.svg";var t0=r(5723);function t1(e,t,r,n,i,o,s){try{var a=e[o](s),l=a.value}catch(e){r(e);return}a.done?t(l):Promise.resolve(l).then(n,i)}function t2(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function s(e){t1(o,n,i,s,a,"next",e)}function a(e){t1(o,n,i,s,a,"throw",e)}s(void 0)})}}function t5(e,t){var r,n,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(l){var c=[a,l];if(r)throw TypeError("Generator is already executing.");for(;s&&(s=0,c[0]&&(o=0)),o;)try{if(r=1,n&&(i=2&c[0]?n.return:c[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,c[1])).done)return i;switch(n=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===c[0]||2===c[0])){o=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(6===c[0]&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],n=0}finally{r=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var t3=function(){var e,t="undefined"!=typeof window?window:void 0;if(!t)throw Error("indexedDB cannot get window");var r=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB;if("undefined"!=typeof window&&!r)throw Error("indexDB not supported");var n=r.open("ldb",1);n.onsuccess=function(){e=this.result},n.onerror=function(e){console.error("indexedDB request error"),console.error(e)},n.onupgradeneeded=function(t){e=null,(t&&t.target&&t.target.result.createObjectStore("s",{keyPath:"k"})).transaction.oncomplete=function(t){e=t.target.db}};var i={get:function(t){return new Promise(function(r){if(!e)return void setTimeout(function(){return t2(function(){return t5(this,function(e){switch(e.label){case 0:return[4,i.get(t)];case 1:return[2,r.apply(void 0,[e.sent()])]}})})()},50);e.transaction("s").objectStore("s").get(t).onsuccess=function(e){r(e.target.result&&e.target.result.v||null)}})},set:function(t,r){return new Promise(function(n){if(!e)return void setTimeout(function(){return t2(function(){return t5(this,function(e){switch(e.label){case 0:return[4,i.set(t,r)];case 1:return[2,n.apply(void 0,[e.sent()])]}})})()},50);var o=e.transaction("s","readwrite");o.oncomplete=function(){return n()},o.objectStore("s").put({k:t,v:r}),o.commit()})},delete:function(t){return new Promise(function(r){if(!e)return void setTimeout(function(){return t2(function(){return t5(this,function(e){switch(e.label){case 0:return[4,i.delete(t)];case 1:return[2,r.apply(void 0,[e.sent()])]}})})()},50);e.transaction("s","readwrite").objectStore("s").delete(t).onsuccess=function(){r()}})},list:function(){return new Promise(function(t){if(!e)return void setTimeout(function(){return t2(function(){return t5(this,function(e){switch(e.label){case 0:return[4,i.list()];case 1:return[2,t.apply(void 0,[e.sent()])]}})})()},50);e.transaction("s").objectStore("s").getAllKeys().onsuccess=function(e){t(e.target.result||null)}})},getAll:function(){return new Promise(function(t){if(!e)return void setTimeout(function(){return t2(function(){return t5(this,function(e){switch(e.label){case 0:return[4,i.getAll()];case 1:return[2,t.apply(void 0,[e.sent()])]}})})()},50);e.transaction("s").objectStore("s").getAll().onsuccess=function(e){t(e.target.result||null)}})},clear:function(){return new Promise(function(t){if(!e)return void setTimeout(function(){return t2(function(){return t5(this,function(e){switch(e.label){case 0:return[4,i.clear()];case 1:return[2,t.apply(void 0,[e.sent()])]}})})()},50);e.transaction("s","readwrite").objectStore("s").clear().onsuccess=function(){t()}})}};return i}();let t4=[],t6=[],t8=[],t9=[],t7=[],re={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},rt=RegExp(`[${Object.keys(re).join("")}]`,"g"),rr=e=>e.replace(rt,e=>re[e]),rn=(e,t)=>{let r=t.trim();return/^<\/?(ul|ol|li|h|p|bl|table|tr|td)/i.test(r)?`
${t}
`:`
<p>
${r}
</p>
`},ri=e=>{if(0===e.length)return"";let t="",r=[];for(let n=0;n<e.length;n++){let i=e[n],o=n<e.length-1?e[n+1]:null;for(;r.length>0&&r[r.length-1].level>i.level;){let e=r.pop();e.hasOpenLi&&(t+="</li>"),t+=`</${e.type}>`}if(r.length>0&&r[r.length-1].level===i.level&&r[r.length-1].type!==i.type){let e=r.pop();e.hasOpenLi&&(t+="</li>"),t+=`</${e.type}>`}(0===r.length||r[r.length-1].level<i.level)&&(t+=`<${i.type}>`,r.push({type:i.type,level:i.level,hasOpenLi:!1})),r.length>0&&r[r.length-1].hasOpenLi&&r[r.length-1].level===i.level&&(t+="</li>",r[r.length-1].hasOpenLi=!1),t+=`<li>${i.content}`,r[r.length-1].hasOpenLi=!0,(!o||o.level<=i.level)&&(t+="</li>",r[r.length-1].hasOpenLi=!1)}for(;r.length>0;){let e=r.pop();e.hasOpenLi&&(t+="</li>"),t+=`</${e.type}>`}return t},ro=(e,t,r,n="")=>{let i=r.split("|").filter((e,t,r)=>t>0&&t<r.length-1).map(e=>/:-+:/g.test(e)?"center":/-+:/g.test(e)?"right":/:-+/.test(e)?"left":""),o=e=>{let t=i[e];return t?` align="${t}"`:""},s=t.split("|").filter((e,t,r)=>t>0&&t<r.length-1).map(e=>e.trim()),a=[],l=0;for(let e=0;e<s.length;e++){if(l>0){l--;continue}let t=s[e];if(t.trim()){let r=1;for(let t=e+1;t<s.length&&(!s[t]||""===s[t].trim());t++)r++;r>1?(l=r-1,a.push(`<th${o(e)} colspan="${r}">${t}</th>`)):a.push(`<th${o(e)}>${t}</th>`)}}return`
<table><tbody><tr>${a.join("")}</tr>${n.split("\n").map(e=>e.trim()).filter(e=>e&&e.length).map(e=>{let t=e.split("|").filter((e,t,r)=>t>0&&t<r.length-1).map(e=>e.trim()),r=[],n=0;for(let e=0;e<t.length;e++){if(n>0){n--;continue}let i=t[e];if(i.trim()){let s=1;for(let r=e+1;r<t.length&&(!t[r]||""===t[r].trim());r++)s++;s>1?(n=s-1,r.push(`<td${o(e)} colspan="${s}">${i}</td>`)):r.push(`<td${o(e)}>${i}</td>`)}}return`<tr>${r.join("")}</tr>`}).join("")}</tbody></table>
`},rs=[[/\r\n/g,"\n"],[/\n(#+)(.*)/g,(e,t,r="")=>{let n=t.length;return`<h${n}>${r.trim()}</h${n}>`}],[/!\[([^\[]+)\]\((?:javascript:)?([^\)]+)\)/g,'<img src="$2" alt="$1">'],[/\[([^\[]+)\]\((?:javascript:)?([^\)]+)\)/g,'<a href="$2">$1</a>'],[/([^\\])(\*\*|__)(.*?(_|\*)?)\2/g,"$1<strong>$3</strong>"],[/([^\\])(\*|_)(.*?)\2/g,"$1<em>$3</em>"],[/\\_/g,"&#95;"],[/\~\~(.*?)\~\~/g,"<del>$1</del>"],[/\:\"(.*?)\"\:/g,"<q>$1</q>"],[/\n( *)[-*+] \[([xX ])\](.*)/g,(e,t,r,n)=>`
{{LISTITEM:ul:${Math.floor(t.length/2)}:<input type="checkbox"${"x"===r.toLowerCase()?" checked":""} disabled> ${n.trim()}}}
`],[/\n( *)(\*|-|\+)(.*)/g,(e,t,r,n)=>`
{{LISTITEM:ul:${Math.floor(t.length/2)}:${n.trim()}}}
`],[/\n( *)([0-9]+\.) (.*)/g,(e,t,r,n)=>`
{{LISTITEM:ol:${Math.floor(t.length/2)}:${n.trim()}}}
`],[/\n(&gt;|\>)(.*)/g,(e,t,r="")=>`
<blockquote>${r.trim()}</blockquote>`],[/(\^)(.*?)\1/g,"<sup>$2</sup>"],[/(\~)(.*?)\1/g,"<sub>$2</sub>"],[/\n-{5,}/g,"\n<hr />"],[/\n\[(.+?)\]\n( *\|[^\n]+\|\r?\n)((?: *\|:?[ -]+:?)+ *\|)(\n(?: *\|[^\n]+\|\r?\n?)*)?/g,(e,t,r,n,i="")=>ro(0,r,n,i).replace("<table>",`<table><caption>${t.trim()}</caption>`)],[/( *\|[^\n]+\|\r?\n)((?: *\|:?[ -]+:?)+ *\|)(\n(?: *\|[^\n]+\|\r?\n?)*)?/g,ro],[/\[\^([^\]]+)\](?!:)/g,(e,t)=>`<sup id="fnref:${t}"><a href="#fn:${t}">[${t}]</a></sup>`],[/\[\^([^\]]+)\]:\s*((?:[^\n]*\n?)*)/g,(e,t,r)=>(t7.push([t,r.trim()]),"")],[/\n([A-Z][A-Za-z\s]*?)\s:\s*([A-Z][^\n]*)/g,(e,t,r)=>`
<dl><dt>${t.trim()}</dt><dd>${r.trim()}</dd></dl>
`]],ra=[[/\s?<\/[ou]l>\s?<[ou]l>/g,"",3],[/<\/blockquote>\n<blockquote>/g,"<br>\n"],[/https?:\/\/[^"']*/g,e=>e.replace(/<\/?em>/g,"_")],[/&#95;/g,"_"]],rl=(e,t=!1,r=!1)=>(t4.length=0,t6.length=0,t8.length=0,t9.length=0,t7.length=0,e=(e=(e=(e=`
${e}
`.replace(/\n\s*```\w*\n([^]*?)\n\s*```\s*\n/g,(e,t)=>(t4.push(t),`
<pre>{{CODEBLOCKPH${t4.length-1}}}</pre>
`))).replace(/\n\s*\$\$([^]*?)\$\$\s*\n/g,(e,t)=>(t8.push(t.trim()),`
{{MATHBLOCKPH${t8.length-1}}}
`))).replace(/`([^`]+)`/g,(e,t)=>(t6.push(t),`{{INLINECODEPH${t6.length-1}}}`))).replace(/\$([^$\n]+)\$/g,(e,t)=>(t9.push(t),`{{INLINEMATHPH${t9.length-1}}}`)),rs.forEach(([t,r,n=1])=>{for(let i=0;i<n;i++)e=e.replace(t,r)}),e=(e=(e=>{if(!e.includes("{{LISTITEM:"))return e;let t=e.split("\n"),r=[],n=[];for(let e of t){let t=e.match(/\{\{LISTITEM:([^:]+):([^:]+):(.+)\}\}/);t?n.push({type:t[1],level:parseInt(t[2]),content:t[3],originalLine:e}):""!==e.trim()&&n.length>0&&(r.push([...n]),n=[])}if(n.length>0&&r.push(n),0===r.length)return e;for(let t of r){let r=ri(t);e=e.replace(t[0].originalLine,r);for(let r=1;r<t.length;r++)e=e.replace(t[r].originalLine,"")}return e})(e)).replace(/\n([^\n]+)\n/g,rn),ra.forEach(([t,r,n=1])=>{for(let i=0;i<n;i++)e=e.replace(t,r)}),e=(e=(e=(e=(e=e.replace(/<pre>{{CODEBLOCKPH(\d+)}}<\/pre>/g,(e,t)=>{let r=t4[parseInt(t)];return`<pre>${rr(r)}</pre>`})).replace(/{{MATHBLOCKPH(\d+)}}/g,(e,t)=>{let r=t8[parseInt(t)];return`<div class="math-block">${rr(r)}</div>`})).replace(/{{INLINECODEPH(\d+)}}/g,(e,t)=>{let r=t6[parseInt(t)];return`<code>${rr(r)}</code>`})).replace(/{{INLINEMATHPH(\d+)}}/g,(e,t)=>{let r=t9[parseInt(t)];return`<span class="math-inline">${rr(r)}</span>`})).trim()+(0===t7.length?"":`
<div class="footnotes">
  <hr>
  <ol>
    ${t7.map(([e,t])=>`
    <li id="fn:${e}">
      ${t}
      <sup><a href="#fnref:${e}"></a></sup>
    </li>`).join("\n")}
  </ol>
</div>`),t&&(e=e.replace(/^<p>([\s\S]*)<\/p>$/,"$1")),r&&(e=e.replace(/<a href="/g,'<a target="_blank" href="')),e),rc=e=>e.charAt(0).toUpperCase()+e.slice(1),ru=(e,t=2,r="0")=>e.toString().length>=t?e.toString():ru(r+e,t,r),rd=e=>e?`${ru(e.getHours())}:${ru(e.getMinutes())}`:"00:00",rh=(e,t)=>{if(e&&t)return t.replace(/\[(\w+)\]/g,".$1").replace(/^\./,"").split(".").reduce((e,t)=>{if(null!=e){if(Array.isArray(e)){let r=/([A-Z]\w+)/.exec(t);if(r){let n=r[0][0].toLowerCase()+r[0].substr(1)||t;return e.find(e=>"object"==typeof e&&null!==e&&n in e&&e[n]===t)}return e[parseInt(t,10)]}return"object"==typeof e&&null!==e&&t in e?e[t]:void 0}},e)},rp=/([^ =><!]*)\s*([=><!]*)\s*(\S*)/i,rf=/^\s*!\s*/,rm=/===?|[^<>=]/i,rg=(e,...t)=>{let r=e instanceof Array?e:[e];return 0===e.length||r.some(e=>{var r;return r=rm.test(e)?[t[0]]:t.reduce((e,t)=>t instanceof Array?[...e,...t]:[...e,t],[]),e.split(/&|;/).map(e=>e.trim()).reduce((e,t)=>{let n=rf.test(t),i=n?t.replace(rf,""):t;return e=e&&r.filter(Boolean).reduce((e,t)=>e||((e,t)=>{if(!t||0===Object.keys(t).length)return!1;let r=rp.exec(e);if(r){let[e,n,i,o]=r,s=rh(t,n.trim());if(void 0===s||"string"==typeof s&&0===s.length)return!1;if(!i||!o)return!0;{let t=isNaN(+o)?"true"===o||"false"!==o&&o:+o;switch(i){case"=":case"==":case"===":return s instanceof Array?s.indexOf(t)>=0:s===t;case"!=":case"!==":return s instanceof Array?s.indexOf(t)>=0:s!==t;case"<=":return s<=t;case">=":return s>=t;case"<":return s<t;case">":return s>t;default:return console.error(`Unrecognized operand (${i}) in expression: ${e}`),!1}}}return!0})(i.trim(),t),!1),n?!e:e},!0)})},rb=(e,t)=>rh(t.filter(Boolean).reduceRight((e,t)=>({...t,...e})),e.trim()),rv=(e,t)=>void 0!==rb(e,t),ry=/{{\s*([^\s"'`:]*):?([^\s]*)\s*}}/g,rw=(e,...t)=>{let r;if(!ry.test(e))return!0;ry.lastIndex=0;let n=!0;do(r=ry.exec(e))&&(r.index===ry.lastIndex&&ry.lastIndex++,r.forEach((e,r,[,i])=>{n=n&&rv(i,t)}));while(n&&null!==r);return n},rx=(e,t)=>{if(void 0===e)return"";if(e instanceof Array)return e.map(e=>rx(e,t)).join(", ");if(!t)return e.toString();if("boolean"==typeof e){let r=t.indexOf(":");return e?t.substring(0,r):t.substring(r+1)}switch(t){default:return e.toString();case"date":return new Date(e).toLocaleDateString();case"time":return new Date(e).toLocaleTimeString();case"iso":return new Date(e).toISOString();case"utc":return new Date(e).toUTCString()}},rE=(e,...t)=>e.replace(ry,(e,r,n)=>{let i=rb(r.trim(),t);return!i||i instanceof Array?e:rx(i,n)}),r_=e=>{if(null===e)return e;if(e instanceof Date)return new Date(e.getTime());if(e instanceof Array){let t=[];return e.forEach(e=>{t.push(e)}),t.map(e=>r_(e))}if("object"==typeof e){let t={...e};return Object.keys(t).forEach(e=>{t[e]=r_(t[e])}),t}return e},rT=(e="")=>e.replace(/\s|,|\./g,"").toLowerCase(),rO=(e,t,r=1)=>{let n=[];for(let i=e;i<=t;i+=r)n.push(i);return n},rA=e=>{if(null!==e&&"object"==typeof e){for(let t of["title","label","alt","name"])if(t in e&&"string"==typeof e[t])return e[t]}},rS=()=>({view:({attrs:{md:e="",removeParagraphs:t=!1,externalLinks:r=!1,...n}})=>s()(".slimdown-view.markdown",n,s().trust(rl(e,t,r)))}),rk=()=>({view:({attrs:{type:e,props:t,label:r="",initialValue:n,inline:i=!1}})=>{let o={className:t.className||"col s12"};if(n instanceof Array&&n.length>3)return s()(".readonly",o,[s()("label",r),s()(rS,{md:"\n- "+n.join("\n- ")})]);if("string"==typeof n){let t=`${r.trim()}: `;return s()(".readonly",o,"url"===e?[s()("label",t),s()("a[target=_blank]",{href:n},n)]:"color"===e?[s()("label",t),s()(".color",{style:{height:"1rem",width:"40px",borderRadius:"4px",backgroundColor:n}})]:[s()("label",r),s()(rS,{md:n})])}let a=n instanceof Array?n.join(", "):n;return s()(".readonly",o,[r&&s()("label",r),i?s()("span",a?`: ${a}`:s().trust("&nbsp;")):s()("p",a||s().trust("&nbsp;"))])}}),rN=(e,t="default")=>`mui_${t}_${e}_${c()}`,rC=()=>{let e,t={},r=(e,r)=>{let n=e instanceof Array?e.length:e.hasOwnProperty(r)?e[r].length:0,i=t.onNewItem?t.onNewItem(e,r,n):{};e instanceof Array?e.push(i):e.hasOwnProperty(r)&&Array.isArray(e[r])?e[r].push(i):e[r]=[i]},n=e=>{e.preventDefault()};return{oninit:({attrs:{i18n:r={},field:{id:n="",sortProperty:i,onNewItem:o}}})=>{t.editLabel=r.editRepeat||`Edit ${String(n)}`,t.createLabel=r.createRepeat||`Create new ${String(n)}`,t.onNewItem=o,e=(e=>{if(!e)return(e,t)=>0;let t="!"===e[0],r=t?e.substring(1):e;return t?(e,t)=>e[r]>t[r]?-1:+(e[r]<t[r]):(e,t)=>e[r]>t[r]?1:e[r]<t[r]?-1:0})(i)},view:({attrs:{field:i,obj:o,context:a,className:l=i.className||"col s12",section:c,containerId:u,disabled:d="boolean"==typeof i.disabled?i.disabled:void 0,readonly:h,i18n:p={},onchange:f}})=>{let{filterValue:g}=t,{id:b,label:v,type:x,min:E,max:_,pageSize:T,propertyFilter:O,filterLabel:A,readonly:S=h,repeatItemClass:k=""}=i,N=((e,t)=>e instanceof Array?e:(e.hasOwnProperty(t)&&Array.isArray(e[t])||(e[t]=[]),e[t]))(o,b),C=g?rT(g):void 0,I=O&&C&&C.length>2?N.filter(e=>rT(`${e[O]}`).indexOf(C)>=0):N,R=(e=>{let t=window.location.hash||"",r=t.indexOf("?");return -1===r?null:new URLSearchParams(t.substring(r+1)).get(e)})(String(b)),P=R?Math.min(I.length,+R):1,L=T&&I&&(P-1)*T<I.length?P:1,D=T?Math.ceil(I.length/T):0,j=!!(_&&I.length>=_),B=!d&&!S&&(!E||I.length>E),F=location.hash?location.hash.split("?")[0].replace("#!",""):"",U=(e=>{let t="";if(e&&e.length>0){let r=e.indexOf("?");-1!==r?t=e.substring(r+1).split("#")[0]:e.startsWith("?")&&(t=e.slice(1).split("#")[0])}else{let e=window.location,r=e.search??"";if(r.startsWith("?")&&(r=r.slice(1)),r)t=r;else if("string"==typeof e.href&&-1!==e.href.indexOf("?"))t=e.href.substring(e.href.indexOf("?")+1).split("#")[0];else{let r=e.hash??"",n=r.indexOf("?");-1!==n&&(t=r.substring(n+1))}}let r={};if(!t)return r;for(let e of t.split("&").filter(Boolean)){let t=e.indexOf("="),n=-1===t?e:e.substring(0,t),i=-1===t?void 0:e.substring(t+1),o=decodeURIComponent(n),s=void 0===i||decodeURIComponent(i);if(o.match(/\[(\d+)?\]$/)){let e=o.replace(/\[(\d+)?\]$/,""),t=r[e];void 0===t?t=[]:"string"!=typeof t&&"boolean"!=typeof t||(t=[t]);let n=t;/\[\d+\]$/.test(o)?n[+/\[(\d+)\]/.exec(o)[1]]=s:n.push(s),r[e]=n}else void 0===r[o]?r[o]=s:"string"==typeof r[o]||"boolean"==typeof r[o]?r[o]=[r[o],s]:r[o].push(s)}return r})(location.hash),q=30+10*Math.floor(Math.log10(I.length)),z=0===D;return[[s()("div",{id:String(b),className:"mui-repeat-list "+l},[s()(".row.mui-repeat-list-controls",s()(".col.s12",[s()(y,{iconName:d||S||j?"":"add",iconClass:"right",label:v,onclick:()=>{r(o,String(b)),b&&s().route.set(F,Object.assign(U,{[b]:I.length})),f&&f(o)},style:{padding:0},className:"left",disabled:d||j,readonly:S}),D>1&&s()(".right",s()(ea,{curPage:L,items:rO(1,D).map(e=>({href:((e,t,r)=>{let n=Object.assign({},t,r);return`${e}?${Object.keys(n).map(e=>`${e}=${n[e]}`).join("&")}`})(F,U,{[b]:e})}))})),(I.length>1||g)&&O&&!d&&s()(Y,{style:"margin-top: -6px; margin-bottom: -1rem;",iconName:"filter_list",iconClass:"small",placeholder:A,onkeyup:(e,r)=>t.filterValue=r,className:"right",disabled:d,readonly:S})])),I&&I.length>0&&"string"!=typeof x&&I.sort(e).filter(T?(e,t)=>(L-1)*T<=t&&t<L*T:()=>!0).map((e,r)=>s()(".mui-repeat-item",{key:`item-${P}-${T?(L-1)*T+r:r}`,draggable:z,ondragstart:z?e=>{e.dataTransfer?.setData("text/plain",r.toString())}:void 0,ondragover:z?n:void 0,ondrop:z?e=>((e,t,r,n,i)=>{let o=parseInt(e.dataTransfer?.getData("text")||"0",10),s=[...r[n]],[a]=s.splice(o,1);s.splice(t,0,a),r[n]=s,i&&i(r),e.preventDefault()})(e,r,o,b,f):void 0,style:{display:"flex",cursor:z?"move":void 0}},[B&&[(!T||T>1)&&s()("span.mui-show-item-number left",{style:`flex: 0 0 ${q}px;`},`[${(T?(L-1)*T+r:r)+1}]`)],[s()(".row.repeat-item",{className:k,key:`repeat-${P}-${T?(L-1)*T+r:r}`,style:"flex: 1;"},[x&&s()(rL,{form:x,obj:e,i18n:p,context:a instanceof Array?[o,...a]:[o,a],section:c,containerId:u,disabled:d,readonly:S,onchange:()=>f&&f(o)})])],B&&[s()(y,{iconName:"delete",className:"mui-delete-item",iconClass:"mui-delete-icon",style:{flex:"0 0 20px",padding:0},disabled:d,readonly:S,onclick:()=>{t.curItemIdx=T?(L-1)*T+r:r}})]])),!(d||j||S||!I||0===I.length||1===T)&&s()(w,{iconName:"add",className:"row mui-add-new-item btn-small right",title:v,style:"padding: 0; margin-top: -10px; margin-right: -25px",onclick:()=>{r(o,String(b)),s().route.set(F,Object.assign(U,{[b]:I.length})),f&&f(o)}})])],void 0!==t.curItemIdx&&s()(eo,{id:"deleteItem",isOpen:void 0!==t.curItemIdx,onClose:()=>{t.curItemIdx=void 0,s().redraw()},fixedFooter:!0,title:p.deleteItem||"Delete item",description:s()(rL,{form:x,obj:I[t.curItemIdx],context:a instanceof Array?[o,...a]:[o,a],section:c,containerId:u,readonly:!0,i18n:p}),buttons:[{label:p.disagree||"Disagree"},{label:p.agree||"Agree",onclick:()=>{void 0!==t.curItemIdx&&(I.splice(t.curItemIdx,1),o instanceof Array?o=[...I]:o[b]=[...I],f&&f(o))}}]})]}}},rI=()=>{let e={};return{oninit:({attrs:{i18n:t={}}})=>{let{raw:r="RAW",view:n="VIEW"}=t;e.raw=r,e.view=n},view:({attrs:{field:{id:t="",type:r,onSelect:n},obj:i,context:o,containerId:a,disabled:l,readonly:c,i18n:u,onchange:d}})=>{if(i instanceof Array)return;let h=i[t],p=h?JSON.parse(h):void 0,f=p&&p.features||[],g=[],b={title:e.raw,vnode:s()(W,{class:"col s12",initialValue:p?JSON.stringify(p,null,2):void 0,placeholder:"Enter GeoJSON",onchange:e=>i[t]=e})};if(!r||"string"==typeof r)return;let v=r.length>0?r[0].id:void 0,y={title:e.view,vnode:f.length?s()(O,{oncreate:({dom:t})=>e.dom=t,onOpenStart:n?t=>{let r=e.dom.children||[];for(let e=0;e<r.length;e++)if(r[e]===t)return void n(e,f[e])}:void 0,className:"geojson-feature-list",items:f.map((e,n)=>(e.properties||(e.properties={}),{id:"erik_"+n,key:n,header:v&&e.properties[v]||e.geometry.type,body:s()(".row",s()(rL,{class:"col s12",form:r,obj:e.properties,i18n:u,context:o instanceof Array?[i,...o]:[i,o],containerId:a,disabled:l,readonly:c,onchange:(e,r)=>{r&&(f[n].properties=r),i[t]=JSON.stringify(p,null,2),d&&d(i)}}))}))}):s()("span","...")};return g.push(y),g.push(b),s()(em,{tabs:g,tabWidth:"fill"})}}},rR=e=>{let{autogenerate:t,value:r,options:n}=e;return t?"none":r?"string"==typeof r?"md":"number"==typeof r?"number":"boolean"==typeof r?"checkbox":"none":n&&n.length>0?"select":"none"},rP=((e={},t={})=>()=>{let r={key:Date.now(),stableId:void 0};return{oninit:({attrs:{field:e,obj:t}})=>{let{id:n=""}=e,i=t&&"object"==typeof t&&"id"in t?String(t.id):"default";r.stableId=rN(String(n),i)},view:({attrs:{i18n:n,field:i,obj:o,autofocus:a,onchange:l,context:u=[],containerId:d,disabled:h,readonly:p}})=>{let{id:g="",type:b,disabled:v=h,readonly:w=p,value:x,required:E,autogenerate:T,show:O,label:A,description:S,i18n:k=n||{},checkAllOptions:N,transform:C,effect:I,onkeyup:R,onkeydown:P,onblur:L}=i,D=!O||rg(O,o,...u);if(O&&!D||A&&!rw(A,o,...u)||x&&!rw(x,o,...u)||S&&!rw(S,o,...u))return;let B="string"==typeof i.options?rb(i.options,[o,...u]):i.options,F=B&&B instanceof Array?B.filter(e=>"string"==typeof e||void 0!==e.id&&(e.label||isNaN(Number(e.id)))&&(!e.show||rg(e.show,o,...u))).map(e=>"string"==typeof e?{id:e,label:rc(e)}:e.label?e:{...e,label:rc(e.id)}):[],U="boolean"==typeof h&&h,q=o&&"object"==typeof o&&"id"in o?String(o.id):"default",z=((e,t=!1,r=!1,n="default",i,o)=>{let{id:s="",label:a,description:l,required:c,multiple:u,className:d,checkboxClass:h,icon:p,iconClass:f,placeholder:g,maxLength:b,minLength:v,max:y,min:w,step:x,dateTimeOutput:E,dateTimeSeconds:_,dateFormat:T,twelveHour:O}=e,A={id:o||rN(String(s),n),label:a};return void 0===a&&s&&(A.label=rc(String(s))),l&&(A.helperText=rl(l,!0)),d&&(A.className=d),p&&(A.iconName=p),f&&(A.iconClass=f),h&&(A.checkboxClass=h),g&&(A.placeholder=g),c&&(A.isMandatory=!0,A["aria-required"]="true"),u&&(A.multiple=u),r&&(A.disabled=!0,A["aria-disabled"]="true"),t&&(A.autofocus=!0),void 0!==b&&(A.maxLength=b),void 0!==v&&(A.minLength=v),void 0!==y&&(A.max=y),void 0!==w&&(A.min=w),void 0!==x&&(A.step=x),E&&(A.dateTimeOutput=E),_&&(A.dateTimeSeconds=_),T&&(A.dateFormat=T),O&&(A.twelveHour=O),A})(i,a,"boolean"==typeof v||void 0===v?U||v:U||rg(v,o,...u),q,0,r.stableId);A&&(z.label=rl(rE(z.label||A,o,...u),!0)),x&&(z.value=rE(z.value||x,o,...u)),S&&(z.description=rl(rE(z.description||S,o,...u),!0));let H=E?e=>!(e instanceof Array)||e&&e.length>0:void 0;if(o instanceof Array)return void console.warn("Only a repeat list can deal with arrays!");let X=async e=>{if(void 0===e||"undefined"===e)return delete o[g],void l(o);if(o[g]=C?C("to",e):e,!I)return l(o);let t=await I(o,o[g],u);l(void 0!==t?t:o)};if(b instanceof Array)return g?("object"!=typeof o||o.hasOwnProperty(g)||(o[g]={}),s()(".muf-form",{className:i.className},[s()(".muf-form-header",s().trust(rl(z.label||rc(String(g)),!0))),z.description&&s()("div",s().trust(rl(z.description))),s()(".row",s()(rL,{...z,i18n:k,readonly:w,form:b,obj:o[g],context:u instanceof Array?[o,...u]:[o,u],oninput:()=>l&&l(o),containerId:d}))])):void console.warn("Missing ID for type "+JSON.stringify(b));T&&!o[g]&&(o[g]="guid"===T?"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}):"id"===T?c():Date.now());let V="object"==typeof o&&o.hasOwnProperty(g)&&void 0!==o[g]?C?C("from",o[g]):o[g]:z.value;g&&void 0!==x&&void 0!==V&&(o[g]=C?C("to",V):V);let[$,K]=N?N.split("|"):["",""];if(w&&b&&0>["md","none"].indexOf(b)){if(t.hasOwnProperty(b))return s()(t[b],{iv:V,field:i,props:z,label:z.label,obj:o,context:u});if(b&&e.hasOwnProperty(b))return s()(e[b],{iv:V,field:i,props:z,label:z.label,onchange:X,obj:o,context:u});switch(b){case"time":{let e=k.dateTimeOptions?{hour:"2-digit",minute:"2-digit",second:void 0,...k.dateTimeOptions,weekday:void 0,month:void 0,day:void 0,year:void 0}:void 0,t="number"==typeof V||"string"==typeof V||V instanceof Date?new Date(V):void 0,r=t?t.toLocaleTimeString(k.locales,e):"";return s()(rk,{props:z,label:z.label,initialValue:r})}case"date":{let e=k.dateTimeOptions?{...k.dateTimeOptions,hour:void 0,hour12:void 0,minute:void 0,second:void 0}:void 0,t="number"==typeof V||"string"==typeof V||V instanceof Date?new Date(V):void 0,r=t?t.toLocaleDateString(k.locales,e):"";return s()(rk,{props:z,label:z.label,initialValue:r})}case"datetime":{let e=k.dateTimeOptions?{hour:"2-digit",minute:"2-digit",month:"numeric",day:"numeric",...k.dateTimeOptions}:void 0,t="number"==typeof V||"string"==typeof V||V instanceof Date?new Date(V):void 0,r=t?t.toLocaleTimeString(k.locales,e):"";return s()(rk,{props:z,label:z.label,initialValue:r})}case"switch":case"checkbox":{let e=V?"":"";return s()(rk,{props:z,label:z.label,initialValue:e,inline:!0})}case"tags":{let e=V||[];return s()(rk,{props:z,label:z.label,initialValue:e})}case"options":case"select":{let e=void 0!==V?V instanceof Array?V:[V]:[],t=F.filter(t=>e.indexOf(t.id)>=0),r=t&&0===t.length?"?":1===t.length?t[0].label:t.map(e=>e.label);return s()(rk,{props:z,label:z.label,initialValue:r})}case"radio":{let e=F.filter(e=>e.id===V),t=e&&e.length?e[0].label:"?";return s()(rk,{props:z,label:z.label,initialValue:t})}case"base64":{let e=!(!V||!/data:image/i.test(V)),t=i.label||rA(o)||i.placeholder||"Uploaded image";return e&&s()("div",{role:"img","aria-label":"string"==typeof t?t:"Image"},s()("img.responsive-img",{src:V,alt:"string"==typeof t?t:"Image",style:{maxHeight:`${i.max||50}px`}}))}case"file":return s()("div",z,(V instanceof Array?V:[V]).map((e="")=>{let t=/data:image|.jpg$|.jpeg$|.png$|.gif$|.svg$|.bmp$|.tif$|.tiff$/i.test(e),r=`${new URL(i.url).origin}${e}`;return s()("a[target=_blank]",{href:r},t?s()("img",{src:r,alt:i.label||i.placeholder||e||"File image",style:{maxHeight:`${i.max||50}px`}}):s()(rk,{props:z,label:i.placeholder||"File",initialValue:e}))}));case"md":case"markdown":{let e="string"==typeof V&&V?rl(V):"";return s()(rk,{props:z,label:z.label,initialValue:e})}default:return s()(rk,{props:z,type:b,label:z.label,initialValue:V})}}if(b&&e.hasOwnProperty(b))return s()(e[b],{iv:V,field:i,props:z,label:z.label,onchange:X,obj:o,context:u});switch(b){case"colour":case"color":return s()(Q,{...z,value:V,oninput:X,onblur:L});case"time":{let{twelveHour:e=!1}=z,t=V?"number"==typeof V||"string"==typeof V?new Date(V):V:new Date,r=rd(t);return o[g]=C?C("to",t):t,s()(ec,{...z,twelveHour:e,value:r,oninput:e=>{let r=e.split(":").map(e=>+e);t.setHours(r[0],r[1]),X(t)},container:d})}case"date":{let{format:e="mmmm d, yyyy"}=z,t="number"==typeof V||"string"==typeof V?new Date(V):V;o[g]=t?C?C("to",t.valueOf()):t.valueOf():t;let{min:r,max:n}=z,i=r?!t||r<t.valueOf()?new Date(r):t:void 0,a=n?!t||n>t.valueOf()?new Date(n):t:void 0;return s()(j,{...z,minDate:i,maxDate:a,setDefaultDate:!!t,format:e,value:t,oninput:e=>{X(new Date(e))},container:d})}case"datetime":{let{label:e,className:t="col s12",dateTimeSeconds:r=!1,twelveHour:n=!1,format:i="mmmm d, yyyy",...o}=z,a="number"==typeof V||"string"==typeof V?new Date(V):V,l={initialDateTime:a},c=a||void 0,u=a?rd(a):"",{min:h,max:p}=z,f=h?!a||h<a.valueOf()?new Date(h):a:void 0,g=p?!a||p>a.valueOf()?new Date(p):a:void 0,b=z.dateTimeOutput||"UTC",v=e=>{l.initialDateTime=e,X("UTC"===b?e.toUTCString():"ISO"===b?e.toISOString():e.valueOf())};return s()("div",{className:t},s()(".row",[s()(r?".col.s6":".col.s8",{style:"padding: 0"},s()(j,{...o,label:e,minDate:f,maxDate:g,setDefaultDate:!!a,format:i,value:c,container:d,oninput:e=>{let t=new Date(l.initialDateTime);t.setFullYear(e.getFullYear()),t.setMonth(e.getMonth()),t.setDate(e.getDate()),v(t)}})),s()(".col.s4",{style:"min-width: 6rem; padding-right: 0; padding-left: 0"},s()(ec,{...o,label:"",helperText:"",twelveHour:n,value:u,container:d,oninput:e=>{let t=e.split(":").map(e=>+e),r=l.initialDateTime||new Date((new Date).setSeconds(0,0));r.setHours(t[0],t[1]),v(r)}})),r&&s()(Z,{style:"min-width: 4rem; padding-right: 0; padding-left: 0",className:"col s2",min:0,max:59,oninput:e=>{let t=l.initialDateTime||new Date((new Date).setSeconds(0,0));t.setSeconds(e,0),v(t)}})]))}case"email":return s()(ee,{...z,validate:H,autofocus:a,oninput:X,value:V,onkeydown:P,onkeyup:R,onblur:L});case"number":return s()(Z,{...z,validate:H,autofocus:a,oninput:X,value:V,onkeydown:P,onkeyup:R,onblur:L});case"radio":return s()(eh,{label:"",...z,options:F,checkedId:V,onchange:X});case"checkbox":{let e=!!V;return s()(er,{...z,checked:e,oninput:X})}case"options":return[[s()(ei,{key:r.key,checkboxClass:"col s6 m4 l3",className:"input-field col s12",...z,disabled:z.disabled||!F||0===F.length,options:F,checkedId:V,onchange:e=>X(1===e.length?e[0]:e.filter(e=>null!==e))})],void 0!==N&&s()(".col.s12.option-buttons",[s()(y,{disabled:z.disabled,label:$,iconName:"check",onclick:()=>{r.key=Date.now(),X(F.map(e=>"string"==typeof e?e:e.id))}}),K&&s()(y,{disabled:z.disabled,label:K,iconName:"check_box_outline_blank",onclick:()=>{let e=o[g]||[];e.length=0,r.key=Date.now(),X(e)}})])];case"select":return s()(ep,{placeholder:z.multiple?k.pickOneOrMore||"Pick one or more":k.pickOne||"Pick one",...z,disabled:z.disabled||!F||0===F.length,options:F,checkedId:V,onchange:e=>X(1!==e.length||z.multiple?e.filter(e=>null!==e||void 0!==e):e[0])});case"markdown":case"md":{let{label:e,className:t="col s12"}=z,r=rE((g?V:x||e)||"",o,...u);return s()(rS,{md:r,className:t})}case"section":return s()(".divider");case"switch":{let e=F&&F.length>0?F[0].label??"":"",t=F&&F.length>1?F[1].label??"":"";return s()(ef,{...z,left:e,right:t,checked:V,onchange:X})}case"tags":{let e=(V?V instanceof Array?V:[V]:[]).map(e=>({tag:e})),t=F&&F.length>0?{data:F.reduce((e,t)=>(e[t.id]=null,e),{}),limit:i.maxLength||1/0,minLength:i.minLength||1}:void 0,{label:r,isMandatory:n,className:o,helperText:a}=z;return s()(_,{className:o,label:r,isMandatory:n,helperText:a,placeholder:i.placeholder||"Add a tag",secondaryPlaceholder:i.secondaryPlaceholder||"+tag",data:e,onchange:e=>X(e.map(e=>e.tag)),autocompleteOptions:t})}case"autocomplete":{let e=F&&F.length>0?{data:F.reduce((e,t)=>(e[t.id]=null,e),{}),limit:i.maxLength||1/0,minLength:i.minLength||1}:{data:{}},{label:t,isMandatory:r,className:n,helperText:o}=z;return s()(f,{value:V,className:n,label:t,isMandatory:r,helperText:o,oninput:X,onblur:L,placeholder:i.placeholder||"...",...e})}case"textarea":return s()(W,{...z,validate:H,autofocus:a,oninput:X,value:V,onkeyup:R,onkeydown:P,onblur:L});case"file":{let{url:e,placeholder:t}=i;if(!e)throw Error('Input field "url" not defined, which indicates the URL to the upload folder.');let r=F?F.map(e=>"string"==typeof e?e:String(e.id)):void 0;return s()(et,{...z,accept:r,placeholder:t,onchange:t=>{if(!t||t.length<1)return void X("");let r=new FormData;r.append("file",t[0]),s().request({method:"POST",url:e,body:r}).then(e=>X(e)).catch(console.error)},value:V})}case"base64":{let e=!(!V||!/data:image/i.test(V)),{placeholder:t}=i,r=F?F.map(e=>"string"==typeof e?e:e.id).join(","):void 0,n=i.label||rA(o)||i.placeholder||"Uploaded image";return e?s()("div",[s()("img.responsive-img",{src:V,alt:"string"==typeof n?n:"Uploaded image",style:{maxHeight:`${i.max||50}px`}}),s()(y,{iconName:"clear","aria-label":"Remove image",onclick:()=>X("")})]):s()(et,{...z,accept:r,placeholder:t,oninput:e=>{if(!e||e.length<1)return void X("");let t=new FileReader;t.onloadend=()=>{"string"==typeof t.result&&X(t.result),s().redraw()},t.readAsDataURL(e[0])},value:V})}case"url":return s()(J,{placeholder:"http(s)://www.example.com",...z,validate:H,autofocus:a,oninput:X,value:V,onkeydown:P,onkeyup:R,onblur:L});case"text":return s()(Y,{...z,maxLength:i.max||void 0,validate:H,autofocus:a,oninput:X,value:V,onkeydown:P,onkeyup:R,onblur:L});default:return}}}})({},{}),rL=()=>{let e=new Map;return{view:({attrs:{i18n:t,form:r,obj:n,onchange:i,disabled:o,readonly:a,context:l,section:c}})=>{let u=e=>i&&i(((e,t)=>t.filter(e=>e.required&&(e.id,!0)).reduce((t,r)=>t&&!(r.id&&(void 0===e[r.id]||e[r.id]instanceof Array&&0===e[r.id].length||"string"==typeof e[r.id]&&0===e[r.id].length)),!0))(e,r),e),d=(t=>{if(e.has(t))return e.get(t);let r=t?(()=>{let e=!1;return({type:r,id:n})=>"section"===r?(e=n===t,!1):e})():e=>!0;return e.set(t,r),r})(c),h=l||[],p=[];for(let e of r){if(!d(e)||e.show&&!rg(e.show,n,...h.filter(e=>"object"==typeof e&&null!==e&&!("id"in e&&"label"in e))))continue;e.type||(e.type=rR(e));let r={i18n:t,field:e,obj:n,onchange:u,disabled:o,readonly:a,context:h,section:c,containerId:"body"};void 0===e.repeat||!1===e.repeat?p.push(s()(rP,r)):"geojson"===e.repeat?p.push(s()(rI,r)):p.push(s()(rC,r))}return p}}};function rD(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function rM(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t}function rj(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}function rB(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r})(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}function rF(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r,n,i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var o=[],s=!0,a=!1;try{for(i=i.call(e);!(s=(r=i.next()).done)&&(o.push(r.value),!t||o.length!==t);s=!0);}catch(e){a=!0,n=e}finally{try{s||null==i.return||i.return()}finally{if(a)throw n}}return o}}(e,t)||rq(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rU(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function rq(e,t){if(e){if("string"==typeof e)return rD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rD(e,t)}}var rz="SG_LANGUAGE",rH="SG_MODEL_SAVED",rX=function(e){return e&&e.length>0?e.charAt(0).toUpperCase()+e.slice(1):e},rV=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=new Date(e);return"".concat(t.getFullYear(),"-").concat(u(t.getMonth()+1),"-").concat(u(t.getDate()))},r$=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"and",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=!(arguments.length>3)||void 0===arguments[3]||arguments[3],i=e.filter(function(e){return e});return 0===i.length?"":r+(1===i.length?i[0]:"".concat(i.slice(0,i.length-1).map(function(e,t){return 0!==t&&void 0!==e&&n?e.toLowerCase():e}).join(", ")," ").concat(t," ").concat(n?i[i.length-1].toLowerCase():i[i.length-1]))},rK=function(e){if(0!==e.length){var t=Math.floor(Math.random()*e.length);return e[t]}},rW=function(e){if(null===e)return e;if(rM(e,Date))return new Date(e.getTime());if(rM(e,Array)){var t=[];return e.forEach(function(e){t.push(e)}),t.map(function(e){return rW(e)})}if((void 0===e?"undefined":rU(e))==="object"){var r=rj({},e);return Object.keys(r).forEach(function(e){r[e]=rW(r[e])}),r}return e},rG=function(e,t){var r,n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=n?"spark_collection":((null==(r=e.scenario)?void 0:r.label)||"spark")+"_model";return t&&(i+="_".concat(t)),"".concat(i.replace(/\s/g,"_"),"_v").concat(u(e.version||1,3),"_").concat(rV()).toLowerCase()},rY=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.categories,n=e.components,i=e.inconsistencies,o=0;do{var s=function(){var e=rj({},t),o=!0,s=!1,a=void 0;try{for(var l,c=r[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var u=function(){var t=l.value,r=n.filter(function(e){return t.componentIds&&t.componentIds.includes(e.id)}).map(function(e){var t=e.values?e.values.reduce(function(e,t){return e+(i[t.id]?Object.keys(i[t.id]).length:0)},0):0;return rB(rj({},e),{inc:t})}).sort(function(e,t){return e.inc>t.inc?-1:1}),o=[],s=!0,a=!1,c=void 0;try{for(var u,d=r[Symbol.iterator]();!(s=(u=d.next()).done);s=!0){var h=function(){var t=u.value;if(e.hasOwnProperty(t.id)){var r=e[t.id];if(r&&r.length){if(r.some(function(e){return o.includes(e)}))return{v:!1};r.forEach(function(e){i[e]&&Object.keys(i[e]).forEach(function(t){return i[e][t]&&o.push(t)})})}return"continue"}var n=t.values&&t.values.map(function(e){return e.id}).filter(function(e){return!o.includes(e)});if(!n||0===n.length)return{v:!1};var s=rK(n);if(!s)return{v:!1};i[s]&&Object.keys(i[s]).forEach(function(e){return i[s][e]&&o.push(e)}),e[t.id]=[s]}();if("object"===rU(h))return{v:h.v}}}catch(e){a=!0,c=e}finally{try{s||null==d.return||d.return()}finally{if(a)throw c}}}();if("object"===rU(u))return u.v}}catch(e){s=!0,a=e}finally{try{o||null==c.return||c.return()}finally{if(s)throw a}}return e}();if(s)return{id:c(),components:s,included:!1};o++}while(o<100);return!1},rZ=function(e,t){t&&t.preventDefault();var r=document.getElementById(e);r?r.scrollIntoView({behavior:"smooth"}):console.log("Element with id ".concat(e," not found."))},rJ=function(){window.scrollTo({top:0,behavior:"smooth"})},rQ=function(e,t){var r=e.components,n=rj({components:{}},function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,["components"]));return t.filter(function(e){return r.hasOwnProperty(e.id)}).forEach(function(e){n.components[e.id]=r[e.id].filter(function(t){var r;return null==(r=e.values)?void 0:r.find(function(e){return e.id===t})})}),n},r0=function(e){return e.map(function(e){return rB(rj({},e),{group:e.included?n("GROUP","SELECTED"):n("GROUP","UNSELECTED")})}).sort(function(e,t){return e.included&&t.included?(e.label||"").localeCompare(t.label):e.included?-1:1})},r1=["#2c7bb6","#abd9e9","#ffffbf","#fdae61","#d7191c"],r2=function(e){var t=btoa(e);return"data:image/svg+xml;base64,".concat(t)},r5=function(e,t){var r=.1*t;return'<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(t,'" height="').concat(t,'">\n    <circle cx="').concat(t/2,'" cy="').concat(t/2,'" r="').concat((t-r)/2,'" fill="').concat(e,'" stroke="black" stroke-width="').concat(r,'" /></svg>')},r3=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=1,n=e.match(/^(.*?)(\d+)$/);n&&(e=n[1].trim(),r=parseInt(n[2])+1);for(var i="".concat(e," ").concat(r);t.includes(i);)r++,i="".concat(e," ").concat(r);return i},r4=function(e){var t=[],r=e.split("\n"),n=!1,i=1,o=!1;return r.forEach(function(e,s){var a=e.match(/^(#{1,6})\s+(.+)$/);if(a){var l=a[1].length,c=a[2];t.push({insert:c}),t.push({insert:"\n",attributes:{header:l}});return}var u=e.match(/^(\d+)\.\s+(.+)$/);if(u){var d=u[2];n?i++:i=parseInt(u[1]),r6(d,t),t.push({insert:"\n",attributes:{list:"ordered"}}),n=!0,o=!1;return}var h=e.match(/^[*-]\s+(.+)$/);if(h){r6(h[1],t),t.push({insert:"\n",attributes:{list:"bullet"}}),o=!0,n=!1;return}if(""===e.trim()){t.push({insert:"\n"}),n=!1,o=!1,i=1;return}if(r6(e,t),t.push({insert:"\n"}),n||o){var p=r[s+1]||"",f=p.match(/^\d+\.\s+.+$/),g=p.match(/^[*-]\s+.+$/);f||g||(n=!1,o=!1,i=1)}}),{ops:t}},r6=function(e,t){r8(e).forEach(function(e){e.isBold?t.push({insert:e.text,attributes:{bold:!0}}):r9(e.text,t)})},r8=function(e){for(var t=[],r=e;r.length>0;){var n=r.match(/\*\*(.+?)\*\*/);if(!n){t.push({text:r,isBold:!1});break}var i=r.indexOf(n[0]);i>0&&t.push({text:r.substring(0,i),isBold:!1}),t.push({text:n[1],isBold:!0}),r=r.substring(i+n[0].length)}return t},r9=function(e,t){for(var r=e;r.length>0;){var n=r.match(/\*(.+?)\*/);if(!n){r.length>0&&t.push({insert:r});break}var i=r.indexOf(n[0]);i>0&&t.push({insert:r.substring(0,i)}),t.push({insert:n[1],attributes:{italic:!0}}),r=r.substring(i+n[0].length)}},r7=function(){var e=new Map;return function(t){if(e.has(t))return e.get(t);var r=t.replace(/^#/,"").toLowerCase();3===r.length&&(r=r.split("").map(function(e){return e+e}).join(""));var n=parseInt(r.slice(0,2),16)/255,i=parseInt(r.slice(2,4),16)/255,o=parseInt(r.slice(4,6),16)/255,s=function(e){return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)},a=.2126*s(n)+.7152*s(i)+.0722*s(o)>.179?"#000000":"#ffffff";return e.set(t,a),a}}(),ne=function(e){3===(e=e.replace(/^#/,"")).length&&(e=e.split("").map(function(e){return e+e}).join(""));var t=parseInt(e.slice(0,2),16)/255,r=parseInt(e.slice(2,4),16)/255,n=parseInt(e.slice(4,6),16)/255,i=Math.max(t,r,n),o=Math.min(t,r,n),s=0,a=0,l=(i+o)/2;if(i!==o){var c=i-o;switch(a=l>.5?c/(2-i-o):c/(i+o),i){case t:s=(r-n)/c+6*(r<n);break;case r:s=(n-t)/c+2;break;case n:s=(t-r)/c+4}s/=6}return[360*s,100*a,100*l]},nt=function(e,t,r){var n=function(t){return(t+e/30)%12},i=(t/=100)*Math.min(r/=100,1-r),o=function(e){return r-i*Math.max(-1,Math.min(n(e)-3,Math.min(9-n(e),1)))},s=function(e){return Math.round(255*e).toString(16).padStart(2,"0")};return"#".concat(s(o(0))).concat(s(o(8))).concat(s(o(4)))},nr=function(){var e=new Map;return function(t){var r=t.toLowerCase();if(e.has(r))return e.get(r);var n=rF(ne(r),3),i=nt(n[0],n[1],100-n[2]);return e.set(r,i),i}}(),nn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if(!t||0===t.length){var r="#ccc";return{OTHER:[r,r7(r)]}}var n=((function(e){if(Array.isArray(e))return rD(e)})(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||rq(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).sort(function(e,t){return e.threshold-t.threshold}),i=e.filter(function(e){return e.included}).reduce(function(e,t){return Object.keys(t.components||{}).forEach(function(r){var n=!0,i=!1,o=void 0;try{for(var s,a=t.components[r][Symbol.iterator]();!(n=(s=a.next()).done);n=!0){var l=s.value;e[l]=(e[l]||0)+1}}catch(e){i=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw o}}}),e},{}),o=Array(n[n.length-1].threshold+1),s=0,a=!0,l=!1,c=void 0;try{for(var u,d=n[Symbol.iterator]();!(a=(u=d.next()).done);a=!0)for(var h=u.value;s<=h.threshold&&s<o.length;)o[s]=h.color,s++}catch(e){l=!0,c=e}finally{try{a||null==d.return||d.return()}finally{if(l)throw c}}for(var p=0;p<o.length;p++)o[p]||(o[p]=n[0].color);var f=Object.entries(i).reduce(function(e,t){var r=rF(t,2),i=r[0],s=r[1],a=s<o.length?o[s]:n[n.length-1].color;return e[i]=[a,r7(a)],e},{}),g=o[0]||n[0].color;return f.OTHER=[g,r7(g)],f};function ni(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function no(e,t,r,n,i,o,s){try{var a=e[o](s),l=a.value}catch(e){r(e);return}a.done?t(l):Promise.resolve(l).then(n,i)}function ns(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function s(e){no(o,n,i,s,a,"next",e)}function a(e){no(o,n,i,s,a,"throw",e)}s(void 0)})}}function na(e){return function(e){if(Array.isArray(e))return ni(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return ni(e,void 0);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ni(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nl(e,t){var r,n,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(l){var c=[a,l];if(r)throw TypeError("Generator is already executing.");for(;s&&(s=0,c[0]&&(o=0)),o;)try{if(r=1,n&&(i=2&c[0]?n.return:c[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,c[1])).done)return i;switch(n=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===c[0]||2===c[0])){o=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(6===c[0]&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],n=0}finally{r=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var nc="SG_MODEL",nu=function(e){document.title="ScenarioSpark: ".concat(e)},nd=function(e,t){rJ(),e.update({page:t})},nh=function(e,t,r,n){uB&&uB.switchTo(t,r,n),e.update({page:t})},np=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return ns(function(){return nl(this,function(i){switch(i.label){case 0:var o;if(localStorage.setItem(rH,"false"),t.lastUpdate=Date.now(),t.scenarios||(t.scenarios=[]),!r)return[3,2];if(!((o=t.scenario)&&(o.inconsistencies||(o.inconsistencies={}),o.categories||(o.categories=[]),o.components||(o.components=[]),o.narratives||(o.narratives=[]),o.narratives=o.narratives.map(function(e){return rQ(e,o.components)}),void 0===o.hideInconsistentValues&&(o.hideInconsistentValues=!0),o.thresholdColors||(o.thresholdColors=eE),o.narratives.forEach(function(e){e.components||(e.components={}),e.id||(e.id=c()),e.label||(e.label="UNKNOWN")}),o.categories.forEach(function(e){e.componentIds||(e.componentIds=[]),e.id||(e.id=c()),e.label||(e.label="UNKNOWN")}),o.components.forEach(function(e){e.values||(e.values=[]),e.id||(e.id=c()),e.label||(e.label="UNKNOWN")}),1)))return alert(n("JSON_NOT_VALID")),[2];return[4,t3.set(nc,JSON.stringify(t))];case 1:return i.sent(),e.update({model:function(){return t},activeTooltip:"",title:t.scenario.label,curNarrative:function(){},excludedComps:function(){return{}},lockedComps:function(){return{}}}),[3,4];case 2:return[4,t3.set(nc,JSON.stringify(t))];case 3:i.sent(),e.update({model:function(){return t}}),i.label=4;case 4:return localStorage.setItem(rH,"false"),[2]}})})()},nf=function(e,t){return ns(function(){var r;return nl(this,function(n){return r=e.getState().model,t.id||(t.id=c()),r.scenario.narratives?t.saved?r.scenario.narratives=r.scenario.narratives.map(function(e){return e.id!==t.id?e:t}):(t.saved=!0,r.scenario.narratives.push(t)):(t.saved=!0,r.scenario.narratives=[t]),e.update({curNarrative:function(){return t}}),np(e,r),[2]})})()},nm=function(e,t){return ns(function(){return nl(this,function(r){switch(r.label){case 0:if(!t.saved)return[3,2];return[4,nf(e,t)];case 1:r.sent(),r.label=2;case 2:return e.update({curNarrative:t}),[2]}})})()},ng=function(e,t,r,n){var i=e.state.model,o=i.scenario.components.filter(function(e){return e.id===t}).shift();if(!o)return void console.error("Scenario component not found!");var s=o.values,a=void 0===s?[]:s;o.values="update"===n?a.map(function(e){return e.id===r.id?r:e}):"delete"===n?a.filter(function(e){return e.id!==r.id}):na(a).concat([r]),"delete"===n&&(i.scenario.narratives=i.scenario.narratives.map(function(e){return rQ(e,i.scenario.components)})),np(e,i)},nb=function(e,t,r,n,i){var o=e.state.model,s=o.scenario.components.filter(function(e){return e.id===t}).shift();if(!s)return void console.error("Scenario component not found!");var a=s.values,l=void 0===a?[]:a,c=l.find(function(e){return e.id===r});c&&l.find(function(e){return e.id===n})&&(s.values=l.filter(function(e){return e.id!==r}).reduce(function(e,t){return t.id===n?i?(e.push(c),e.push(t)):(e.push(t),e.push(c)):e.push(t),e},[]),np(e,o))},nv=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nI.currentLocale;return ns(function(){return nl(this,function(t){switch(t.label){case 0:return localStorage.setItem(rz,e),[4,nI.loadAndSetLocale(e)];case 1:return t.sent(),[2]}})})()},ny={services:[{onchange:function(e){var t,r;return null==(r=e.model)||null==(t=r.scenario)?void 0:t.label},run:function(e){var t,r,n=null==(r=e.state.model)||null==(t=r.scenario)?void 0:t.label;nu(n),e.update({title:n})}}],initial:{title:"",page:a.HOME,model:e_}},nw=(0,t0.meiosisSetup)({app:ny});e=nw().update,ns(function(){var t,r,n,i;return nl(this,function(o){switch(o.label){case 0:return[4,t3.get(nc)];case 1:return nu(i=(null==(t=(n=(r=o.sent())?JSON.parse(r):e_).scenario)?void 0:t.label)||""),e({model:function(){return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({},n)},title:i}),[2]}})})(),nw.map(function(){return s().redraw()});var nx=function(e){return e&&"object"==typeof e};function nE(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=this.opts,n=r.array;r.array=!0;var i=this.apply(null,e);return r.array=n,i}function n_(e,t){e=e||{},(t=t||{}).resolveAliases&&(e=n_.resolveAliases(e));var r={};function n(e,t,i){return function(e,t,r,n,i,o){i=i||{};var s=n[e],a=nx(s),l=a||null!=t||null!=r;if(l){if(nx(t)){var c=r;r=t,t=c}if(r=r||{},a){var u=null!=t&&s[t]||s["*"];if(null!=u)s=u;else if("number"==typeof t){var d,h,p=i.pluralize;d=s,h=Math.abs(t),s=null!=d[h=p?p(h):h]?d[h]:null!=d.n?d.n:void 0}}}if("string"!=typeof s){if(!1===i.useKeyForMissingTranslation)return;s=e,i.debug&&(null!=t?(s="@@"+e+"."+t+"@@",console.warn('No translation or pluralization form found for "'+t+'" in'+e)):(s="@@"+s+"@@",console.warn('Translation for "'+e+'" not found.')))}if(l){var f=s,g=r,b=t,v=i,y=o[f];if(null==y){var w=f.replace(/\{(\w+)\}/g,"{x}$1{x}").split("{x}");y=w.length>1?w:w[0],o[f]=y}return y.pop?function(e,t,r,n){for(var i=n.array?e.slice():e[0],o=e.length,s=1;s<o;s+=2){var a=e[s],l=t[a];null==l&&("n"===a&&null!=r?l=r:(n.debug&&console.warn('No "'+a+'" in placeholder object:',t),l="{"+a+"}")),n.array?i[s]=l:i+=l+e[s+1]}return i}(y,g,b,v):y}return s}(e,t,i,n.keys,n.opts,r)}return n.arr=nE,n.keys=e||{},n.opts=t,n}n_.resolveAliases=function(e){var t={};return function r(n){if(nx(n)){var i;return i=r,Object.keys(n).reduce(function(e,t){return e[t]=i(n[t],t),e},{})}return n.replace(/{{(.*?)}}/g,function(n,i){if(t[i])throw Error('Circular reference for "'+i+'" detected');t[i]=!0;var o=i,s="",a=i.match(/^(.+)\[(.+)\]$/);a&&(o=a[1],s=a[2]);var l=e[o];if(nx(l))if(s)l=l[s];else throw Error("You can't alias objects");if(null==l)throw Error('No translation for alias "'+i+'"');var c=r(l);return t[i]=!1,c})}(e)};var nT=r(7626);function nO(e,t,r,n,i,o,s){try{var a=e[o](s),l=a.value}catch(e){r(e);return}a.done?t(l):Promise.resolve(l).then(n,i)}function nA(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function s(e){nO(o,n,i,s,a,"next",e)}function a(e){nO(o,n,i,s,a,"throw",e)}s(void 0)})}}function nS(e,t){var r,n,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(l){var c=[a,l];if(r)throw TypeError("Generator is already executing.");for(;s&&(s=0,c[0]&&(o=0)),o;)try{if(r=1,n&&(i=2&c[0]?n.return:c[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,c[1])).done)return i;switch(n=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===c[0]||2===c[0])){o=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(6===c[0]&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],n=0}finally{r=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var nk={HOME:{TITLE:"home",ROUTE:"/home"},ABOUT:{TITLE:"About the app",ROUTE:"/about"},DEFINE_BOX:{TITLE:"Morphological box",ROUTE:"/define"},SETTINGS:{TITLE:"Settings",ROUTE:"/settings"},CREATE_SCENARIO:{TITLE:"Create scenario",ROUTE:"/create"},SHOW_SCENARIO:{TITLE:"Show scenarios",ROUTE:"/show"},DECISION_SUPPORT:{TITLE:"Decision support",ROUTE:"/decide"},DOWNLOAD:{COLLECTION:"Save collection",MODEL:"Save scenario file"},UPLOAD:{COLLECTION:"Load collection",MODEL:"Load scenario file"},CANCEL:"Cancel",DELETE:"Delete",AND:"and",YES:"Yes",NO:"No",OK:"Ok",NAME:"Name",DESCRIPTION:"Description",NEW_BOX:"New morphological box",CATEGORIES:"Categories",DIMENSION:"Key driver",DIMENSION_SELECTED:"Selected drivers",DIMENSIONS:"Drivers",KEY_VALUE:"Key value",CONTEXT:"Context",NONE:"None",LOCATION:"Location",LOCATION_TYPE:"Location type",COORDINATES:"Coordinates",LOCATION_NAME:"Location name",LATITUDE:"Latitude",LONGITUDE:"Longitude",MANUAL:"Manual mode",Type:"Type",PICK_FROM_LIST:"Pick from list",ENTER_KEY_VALUE:"Enter key value",EDIT_COMPONENT:"Edit component",ADD_COMPONENT:"Add component",GENERATE_NARRATIVE:"Generate",CLEAR_NARRATIVE:"Clear",NAME_NARRATIVE:"Title of current narrative",SAVE_NARRATIVE:"Save",SAVED_NARRATIVES:"Saved scenarios",NARRATIVE:"narrative",INCLUDE_NARRATIVE:"Include scenario",NARRATIVE_INCLUDED:"Scenario is included",SELECT_NARRATIVE:"Select narrative",SELECT_SCENARIO:"Select scenario",KEY:"Key",VALUE:"Value",MODEL:"Model",SELECTION:"Selected value",EDITOR_PLACEHOLDER:"Edit narrative",THRESHOLDS:"Thresholds colors reflecting component options",THRESHOLD:"Threshold value",COLOR:"Color",ORDER:"Order",COMBINATIONS:{POSSIBLE:"Combinations are possible",IMPOSSIBLE:"Combinations are impossible",IMPROBABLE:"Combinations are improbable"},DELETE_ITEM:{title:"Delete {item}",description:"Are you certain you want to delete this {item}. There is no turning back?"},NEW_SCENARIO:"New scenario",NEW_MODEL:{btn:"New collection",title:"Choose a new scenario model and erase everything",description:"Are you sure that you want to delete your existing collection and start one of the available new ones? There is no way back.",choose:"Choose your new collection",remove:"Remove all key values"},DELETE_MODEL:{btn:"Delete scenario",title:"Delete the selected scenario",description:"Are you sure that you want to delete your scenario? There is no way back."},INCONSISTENCIES:{title:"Edit inconsistencies",SELECT_ROW_CATEGORY:"Select row category",SELECT_COLUMN_CATEGORY:"Select column category",SELECT_CATEGORIES_TO_START:"Select categories to start"},saveButton:{label:"Save",tooltip:"Save unsaved changes"},i18n:{editRepeat:"Edit",createRepeat:"Add",deleteItem:"Delete",agree:"Yes",disagree:"No",pick:"Pick",pickOne:"Pick one",pickOneOrMore:"Pick one or more",cancel:"Cancel",save:"Save"},COMP:{AVAILABLEBUDGET:"Budget",BEHAVIOURDURINGPREPARATION:"Behaviour during preparation",CAPABILITIES:"Capability",COMPARTMENTSPRESENT:"Compartments present",CRIMINALPHASE:"Criminal phase",DURATION:"Duration",EQUIPMENT:"Equipment",EXISTINGINFRA:"Existing infra",IMPACT:"Impact",INTENT:"Bystander intent",LOCATION:"Location",LOCATION2:"Location",MODUSOPERANDIDURINGEXECUTION:"Mode of operation",MOTIVATION:"Motivation",NARRATIVE:"Narrative",NARRATIVE_PLACEHOLDER:"Describe the context in which the incident took place, such as a description of the (geographic) location, the person or building that must be protected, the way an actor obtains information, at what time did the action take place, under what weather circumstances, how many persons were involved in the action, from which organisation, how did they obtain access, or which means/weapons were employed.",OBJECT:"Object",OPENCOMPARTMENTS:"Open compartment",PEOPLEDENSITY:"Person density",PERSONS:"Person",PHYSICALANGLEOFATTACKDURINGEXECUTION:"Physical angle of attack",PHYSICAL_ANGLE:"Physical angle",PRIVACYAWARENESS:"Privacy awareness",RELATIONOWNEROBJECTANDOWNERSECURITYSYSTEM:"Relation owner object and owner security system",RESPONSIBILITY:"Responsibility",SCENARIOS:"Scenario",SECURITYAWARENESS:"Security awareness",TARGETTYPE:"Target type",THREATDIRECTION:"Threat direction",ACTOR:"Actor",ACTION:"Action",ACCESS:"Access",MEANS:"Means",TYPEOFENVIRONMENT:"Environment type",TYPEOFOBJECT:"Type of object",WEAPON:"Weapon",WEATHERBEHAVIOUR:"Weather behaviour",WEATHERTYPE:"Weather condition",PI:"Protected interest (target)",MEANSWEAPON:"Means/weapon",MISSIONCONTEXT:"Mission context",ADVERSARY:"Adversary",C2HEADQUARTERS:"C2-HQ location",TARGET:"Target",DELIBERATEACTION:"Deliberate action",MEANS2:"Means of attack",MEANS3:"Means for action",MEANS4:"Means for access",ACCESS2:"Means of access",MEANS2ACCESS:"Means to access"},MODEL_NAMES:{0:"Empty model",1:"Simple model (in English)"},MODEL_DESC:{0:"An empty scenario model.",1:"A scenario model with a threat and a context category."},JSON_NOT_VALID:"JSON model file not valid! Aborting.",NO_NARRATIVE:"Narrative not generated in 100 tries!",SPEC_CATS:"First specify some categories, where each category contains some key drivers.",EXPORT2WORD:{TITLE:"Export to Word",DESC:"Which scenario do you want to export?",CURRENT:"Current",SELECTED:"Selected",ALL:"All"},HIDE_INCONSISTENT:"Hide inconsistent combinations",GOAL:{TITLE:"Goal",DESC:"ScenarioSpark is a web application that can be used to systematically create and manage a set of scenarios for risk management activities."},USAGE:{TITLE:"Usage",DESC:"ScenarioSpark supports the user in creating and compiling a representative set of scenarios that can be used in the various steps of the risk management process."},SECURITY:{TITLE:"Security",DESC:"All information used and entered is processed and stored exclusively locally."},SUMMARY:"A free tool to support you in creating new scenarios using a morphological box. First, you define the aspects that are of interest in your domain. Next, you specify variations for each aspect. And finally, you either manually create new scenarios, or become inspired by generating possible scenarios automatically.",SET_LANGUAGE:"Set language",SCENARIO_LOADED_MSG:"Scenario successfully loaded",COLLECTION_LOADED_MSG:"The scenario collection is loaded",SCENARIO_NOT_LOADED_MSG:"The scenario is not loaded",SCENARIO_CREATED_MSG:"A new scenario is created",COPY_TO_CLIPBOARD:"Copy table to clipboard",GROUP:{SELECTED:"Selected scenarios",UNSELECTED:"Unselected scenarios"},CLONE_NARRATIVE:"Clone",INCLUDE_DECISION_SUPPORT:"Activate decision support",IS_DECISION_CATEGORY:"For decision support",PROBABILITY:"Probability of occurence",IMPACT:"Impact",RISK:"Risk",RISK_PLACEHOLDER:"Probability x Impact",PROB5:{0:"Very low",1:"Low",2:"Medium",3:"High",4:"Very high"},IMP5:{0:"Very low",1:"Low",2:"Medium",3:"High",4:"Very high"},RISK5:{0:"Very low",1:"Low",2:"Medium",3:"High",4:"Very high"},SUGGESTED_APPROACH:{TITLE:"Suggested approach",DESC:"The suggested approach is a (risk-)weighted combination of the selected counter-measures."},TEMPLATE:{TITLE:"Template string for fluid text",DESC:"Write a paragraph where XXX is replaced by the value for key factor 1, etc. Empty lines are converted to paragraphs."},SELECT_PERSONA:"Select relevant persona for scenario",PERSONA_IMPRESSION:"Impression",PERSONA:{1:"Persona",n:"Personas"},IMAGE:"Image",SAVE:"Save",EDIT:"Edit",LLM:"LLM",SERVICE:"Service",PROVIDER:"Provider",SYSTEM_PROMPT:"System prompt",USER_PROMPT:"User prompt",TEMPERATURE:{BTN:"Temperature",DESC:"How creative should the LLM be (max = 1)?"},API_KEY:"API key",URL:"URL",ASK_LLM:"Ask LLM",INCLUDE_LLM:"Include in LLM",OLLAMA_URL:"Hostname (and port)",ADV_EDIT:"Code editor",TOGGLE:{SHOW:"Show table",HIDE:"Hide table"},AUTO_CREATE:{BTN:"Auto create",COUNT:"LLM auto create count",COUNT_DESC:"How many scenarios do you want to generate at once?"},AUTO_CREATE_MSG:{1:"Auto create 1 scenario",n:"Auto create {n} scenarios"},COPY_BOX:{LABEL:"Copy box",TITLE:"Copy table to clipboard",TOAST:"Morphological box copied to clipboard."}},nN={HOME:{TITLE:"home",ROUTE:"/home"},ABOUT:{TITLE:"over de app",ROUTE:"/over"},DEFINE_BOX:{TITLE:"Morfologische box",ROUTE:"/definieer"},SETTINGS:{TITLE:"Instellingen",ROUTE:"/instellingen"},CREATE_SCENARIO:{TITLE:"Maak scenario",ROUTE:"/maak"},SHOW_SCENARIO:{TITLE:"Toon scenario's",ROUTE:"/toon"},DECISION_SUPPORT:{TITLE:"Beslisondersteuning",ROUTE:"/beslis"},DOWNLOAD:{COLLECTION:"Bewaar collectie",MODEL:"Bewaar scenario bestand"},UPLOAD:{COLLECTION:"Lees collectie",MODEL:"Lees scenario bestand"},CANCEL:"Afbreken",DELETE:"Verwijderen",AND:"en",YES:"Ja",NO:"Nee",OK:"Ok",NAME:"Naam",DESCRIPTION:"Omschrijving",NEW_BOX:"Nieuwe morfologische box",CATEGORIES:"Categorie\xebn",DIMENSION:"Hoofdfactor",DIMENSION_SELECTED:"Geselecteerde stuurfactoren",DIMENSIONS:"Stuurfactoren",KEY_VALUE:"Waarde",CONTEXT:"Context",NONE:"Geen",LOCATION:"Locatie",LOCATION_TYPE:"Locatietype",COORDINATES:"Coordinaten",LOCATION_NAME:"Locatienaam",LATITUDE:"Latitude",LONGITUDE:"Longitude",MANUAL:"Manuele mode",Type:"Type",PICK_FROM_LIST:"Kies uit de lijst",ENTER_KEY_VALUE:"Vul een sleutel en waarde in",EDIT_COMPONENT:"Bewerk optie",ADD_COMPONENT:"Nieuwe optie",GENERATE_NARRATIVE:"Genereer",CLEAR_NARRATIVE:"Wis",NARRATIVE:"verhaallijn",NAME_NARRATIVE:"Titel van huidige verhaallijn",SAVE_NARRATIVE:"Bewaar",SAVED_NARRATIVES:"Bewaarde scenario's",INCLUDE_NARRATIVE:"Selecteer scenario",NARRATIVE_INCLUDED:"GESELECTEERD",SELECT_NARRATIVE:"Selecteer verhaallijn",SELECT_SCENARIO:"Selecteer scenario",KEY:"Sleutel",VALUE:"Waarde",MODEL:"Model",SELECTION:"Geselecteerde waarde",EDITOR_PLACEHOLDER:"Bewerk verhaallijn",THRESHOLDS:"Kleuren voor weergave gebruik van opties",THRESHOLD:"Drempelwaarde",COLOR:"Kleur",ORDER:"Volgorde",COMBINATIONS:{POSSIBLE:"Combinaties zijn mogelijk",IMPOSSIBLE:"Combinaties zijn onmogelijk",IMPROBABLE:"Combinaties zijn onwaarschijnlijk"},DELETE_ITEM:{title:"Verwijder {item}",description:"Weet u zeker dat u de {item} wilt verwijderen? Dit kan niet ongedaan gemaakt worden."},NEW_SCENARIO:"Nieuw scenario",NEW_MODEL:{btn:"Nieuwe collectie",title:"Kies een nieuw scenario en wis alles",description:"Weet u zeker dat u de huidige collectie wilt wissen, en met \xe9\xe9n van onderstaande modellen wilt verdergaan? Er is geen weg terug.",choose:"Kies uw nieuwe scenario",remove:"Verwijder alle reeds ingevulde waarden"},DELETE_MODEL:{btn:"Verwijder scenario",title:"Verwijder het geselecteerde scenario",description:"Weet u zeker dat u uw scenario wilt verwijderen? Er is geen weg terug."},INCONSISTENCIES:{title:"Bewerk inconsistencies",SELECT_ROW_CATEGORY:"Selecteer rij categorie",SELECT_COLUMN_CATEGORY:"Selecteer kolom categorie",SELECT_CATEGORIES_TO_START:"Selecteer categorie\xebn om te beginnen"},saveButton:{label:"Opslaan",tooltip:"Sla aanpassingen op"},i18n:{editRepeat:"Bewerk",createRepeat:"Nieuw",deleteItem:"Verwijder",agree:"Ja",disagree:"Nee",pick:"Kies",pickOne:"Kies \xe9\xe9n",pickOneOrMore:"Kies \xe9\xe9n of meer",cancel:"Afbreken",save:"Opslaan"},COMP:{AVAILABLEBUDGET:"Budget",BEHAVIOURDURINGPREPARATION:"Gedrag tijdens voorbereiding",CAPABILITIES:"Capability",COMPARTMENTSPRESENT:"Aanwezige compartimenten",CRIMINALPHASE:"Criminele fase",DURATION:"Duur",EQUIPMENT:"Materieel",EXISTINGINFRA:"Bestaande infra",IMPACT:"Impact",INTENT:"Intentie publiek",LOCATION:"TBB: locatie",LOCATION2:"Locatie",MODUSOPERANDIDURINGEXECUTION:"Modus operandus",MOTIVATION:"Motivatie",NARRATIVE:"Verhaallijn",NARRATIVE_PLACEHOLDER:"Beschrijf de context waarin het incident plaatsvindt, zoals een nadere beschrijving van de (geografische) locatie, de te beschermen persoon of gebouw, de wijze waarop een actor informatie verzamelt, op welk tijdstip vindt de actie plaats, onder welke weersomstandigheden, hoeveel personen zijn er betrokken bij de actie, van welke organisatie, hoe kregen ze toegang, of welke middelen/wapens werden ingezet.",OBJECT:"Object",OPENCOMPARTMENTS:"Open compartiment",PEOPLEDENSITY:"Personendichtheid",PERSONS:"Persoon",PHYSICALANGLEOFATTACKDURINGEXECUTION:"Fysieke aanvalshoek",PHYSICAL_ANGLE:"Fysieke hoek",PRIVACYAWARENESS:"Privacy-bewustzijn",RELATIONOWNEROBJECTANDOWNERSECURITYSYSTEM:"Relatie eigenaar object en eigenaar beveiligingssysteem",RESPONSIBILITY:"Verantwoordelijkheid",SCENARIOS:"Scenario",SECURITYAWARENESS:"Beveiligingsbewustzijn",TARGETTYPE:"Doeltype",THREATDIRECTION:"Dreigingsrichting",ACTOR:"Actor",ACTION:"Moedwillige actie",ACCESS:"Wijze van toegang",MEANS:"Middel / wapen",TYPEOFENVIRONMENT:"Omgevingstype",TYPEOFOBJECT:"Objecttype",WEAPON:"Wapen",WEATHERBEHAVIOUR:"Weersgedrag",WEATHERTYPE:"Weersconditie",PI:"TBB: Soort doelwit",MEANSWEAPON:"Middel/wapen",MISSIONCONTEXT:"Missiecontext",ADVERSARY:"Tegenstander",C2HEADQUARTERS:"C2-HQ locatie",TARGET:"Doelwit",DELIBERATEACTION:"Moedwillige actie",MEANS2:"Aanslagmiddel",MEANS3:"Middel tbv actie",MEANS4:"Middel tbv toegang",ACCESS2:"Wijze van binnendringen",MEANS2ACCESS:"Middel om binnen te dringen"},MODEL_NAMES:{0:"Leeg model",1:"Simpel model (in Engels)"},MODEL_DESC:{0:"Een leeg scenario model.",1:"Een scenario model met een dreigings- en contextcategorie."},JSON_NOT_VALID:"JSON bestand niet valide! Het inladen wordt afgebroken.",NO_NARRATIVE:"Er kon geen verhaallijn gegenereerd worden na 100 pogingen!",SPEC_CATS:"Definieer eerst 1 of 2 categorie\xebn, met in iedere categorie enkele hoofdfactoren.",EXPORT2WORD:{TITLE:"Exporteer naar Word",DESC:"Welke scenario's wilt u exporteren?",CURRENT:"Huidige",SELECTED:"Selectie",ALL:"Allemaal"},HIDE_INCONSISTENT:"Verberg inconsistente combinaties",GOAL:{TITLE:"Doel",DESC:"ScenarioSpark is een webapplicatie waarmee systematisch een set scenarios ten behoeve van risicomanagement- activiteiten kan worden gemaakt en beheerd."},USAGE:{TITLE:"Gebruik",DESC:"ScenarioSpark ondersteunt de gebruiker bij het op- en samenstellen van een representatieve set scenarios die gebruikt kan worden in de diverse stappen van het risicomanagement proces. "},SECURITY:{TITLE:"Security",DESC:"Alle gebruikte en ingevoerde informatie wordt uitsluitend lokaal verwerkt en opgeslagen."},SUMMARY:"Een gratis hulpmiddel om u te ondersteunen bij het cre\xebren van nieuwe scenario's met behulp van een morfologische doos. Eerst definieert u de aspecten die van belang zijn voor uw domein. Vervolgens specificeert u variaties voor elk aspect. En ten slotte cre\xeber je handmatig nieuwe scenario's, of laat u zich inspireren door mogelijke scenario's te genereren.",SET_LANGUAGE:"Kies de taal",SCENARIO_LOADED_MSG:"Het scenario is ingeladen",COLLECTION_LOADED_MSG:"De scenario's zijn ingeladen",SCENARIO_NOT_LOADED_MSG:"Het scenario is niet ingeladen",SCENARIO_CREATED_MSG:"Een nieuw scenario is aangemaakt",COPY_TO_CLIPBOARD:"Kopieer tabel naar het plakbord",GROUP:{SELECTED:"Geselecteerd",UNSELECTED:"Niet geselecteerd"},CLONE_NARRATIVE:"Kopieer",INCLUDE_DECISION_SUPPORT:"Activeer beslisondersteuning",IS_DECISION_CATEGORY:"Voor beslisondersteuning",PROBABILITY:"Kans van optreden",IMPACT:"Impact",RISK:"Risico",RISK_PLACEHOLDER:"Kans x Impact",PROB5:{0:"Zeer laag",1:"Laag",2:"Gemiddeld",3:"Hoog",4:"Zeer hoog"},IMP5:{0:"Zeer laag",1:"Laag",2:"Gemiddeld",3:"Hoog",4:"Zeer hoog"},RISK5:{0:"Zeer laag",1:"Laag",2:"Gemiddeld",3:"Hoog",4:"Zeer hoog"},SUGGESTED_APPROACH:{TITLE:"Aanbevolen aanpak",DESC:"De aanbevolen aanpak is gebaseerd op een risicogewogen combinatie van de gekozen maatregelen."},TEMPLATE:{TITLE:"Template om de stuurfactoren te vertalen naar een lopende tekst.",DESC:"Schrijf een paragraaf waarbij XXX zal vervangen worden door de waarde van factor 1, etc. Lege regels worden omgezet naar paragrafen."},SELECT_PERSONA:"Selecteer relevante persona's",PERSONA_IMPRESSION:"Impressie",PERSONA:{1:"Persona",n:"Personas"},IMAGE:"Afbeelding",EDIT:"Bewerken",SAVE:"Opslaan",LLM:"LLM",SERVICE:"Service",PROVIDER:"Provider",SYSTEM_PROMPT:"Systeem prompt",USER_PROMPT:"Gebruiker prompt",TEMPERATURE:{BTN:"Temperatuur",DESC:"Hoe creatief mag de LLM zijn (max = 1)?"},API_KEY:"API sleutel",URL:"URL",ASK_LLM:"Vraag LLM",INCLUDE_LLM:"Stuur naar LLM",OLLAMA_URL:"Domeinnaam (en poort)",ADV_EDIT:"Code editor",TOGGLE:{SHOW:"Toon tabel",HIDE:"Verberg tabel"},AUTO_CREATE:{BTN:"Autom.",COUNT:"LLM auto gen aantal",COUNT_DESC:"Hoeveel verhaallijnen moeten automatisch gemaakt worden?"},AUTO_CREATE_MSG:{1:"Genereer 1 scenario automatisch",n:"Genereer {n} scenario's automatisch"},COPY_BOX:{LABEL:"Kopieer box",TITLE:"Kopieer box naar clipboard",TOAST:"Morphologische box is gekopieerd naar het clipboard."}},nC=[],nI={defaultLocale:"en",currentLocale:"en",locales:{},init:function(e,t){return nA(function(){var r;return nS(this,function(n){switch(n.label){case 0:return nI.locales=e,(r=Object.keys(e).filter(function(t){return e[t].default}).shift())&&(nI.defaultLocale=r||t),document.documentElement.setAttribute("lang",t),[4,nR(t)];case 1:return n.sent(),[2]}})})()},addOnChangeListener:function(e){nC.push(e)},loadAndSetLocale:nR,i18n:{}};function nR(e){return nA(function(){var t;return nS(this,function(r){var i;return i=e,t=Object.keys(nI.locales).indexOf(i)>=0?e:nI.defaultLocale,nI.currentLocale=t,nI.i18n={editRepeat:(n=n_("nl"===e?nN:nk,{debug:!0,array:!0,resolveAliases:!0,pluralize:nT.plural_EN,useKeyForMissingTranslation:!0}))("i18n","editRepeat"),createRepeat:n("i18n","createRepeat"),deleteItem:n("i18n","deleteItem"),agree:n("i18n","agree"),disagree:n("i18n","disagree"),pickOne:n("i18n","pickOne"),pickOneOrMore:n("i18n","pickOneOrMore"),cancel:n("i18n","cancel"),save:n("i18n","save")},nC.forEach(function(e){return e(nI.currentLocale,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nI.currentLocale;return nI.locales[e].dir||"ltr"}())}),[2]})})()}let nP=r.p+"e8244ad7ec8b2937.png",nL=r.p+"ec3f975a962f44ff.png";function nD(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function nM(e,t,r,n,i,o,s){try{var a=e[o](s),l=a.value}catch(e){r(e);return}a.done?t(l):Promise.resolve(l).then(n,i)}function nj(e){return function(e){if(Array.isArray(e))return nD(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return nD(e,void 0);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nD(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var nB=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nI.currentLocale;return(e=function(){return function(e,t){var r,n,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(l){var c=[a,l];if(r)throw TypeError("Generator is already executing.");for(;s&&(s=0,c[0]&&(o=0)),o;)try{if(r=1,n&&(i=2&c[0]?n.return:c[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,c[1])).done)return i;switch(n=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===c[0]||2===c[0])){o=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(6===c[0]&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],n=0}finally{r=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(e){switch(e.label){case 0:return localStorage.setItem(rz,t),[4,nI.loadAndSetLocale(t)];case 1:return e.sent(),[2]}})},function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function s(e){nM(o,n,i,s,a,"next",e)}function a(e){nM(o,n,i,s,a,"throw",e)}s(void 0)})})()},nF=function(){return{view:function(e){var t,r,n=e.children,i=e.attrs,o=function(e){return i.state.page===e.id?".active":""},a=uB.getList().filter(function(e){var t,r;return("boolean"==typeof e.visible?e.visible:e.visible(null==(r=i.state)||null==(t=r.model)?void 0:t.scenario))||o(e)}),l=nI.currentLocale;return s()(".main",{style:"overflow-x: hidden"},[s()(".navbar-fixed",s()("nav",s()(".nav-wrapper",[s()("a.brand-logo[href=#].show-on-large",{style:"margin-left: 20px"},[s()("img[width=140][height=60][src=".concat(tQ,"][alt=TNO]"),{style:"margin-left: -5px;"}),s()(".title.show-on-med-and-up.truncate",null==(r=i.state.model)||null==(t=r.scenario)?void 0:t.label)]),s()(s().route.Link,{className:"sidenav-trigger","data-target":"slide-out",href:s().route.get()},s()(g,{iconName:"menu",className:"hide-on-large-and-up black-text",style:"margin-left: 5px;"})),s()("ul#dropdown_languages.dropdown-content",[s()("li",s()("a",{href:"#!",onclick:function(){return nB("nl")}},[s()("img",{src:nP,alt:"Nederlands",title:"Nederlands",disabled:"nl"===l,class:"nl"===l?"disabled-image":"clickable"}),"Nederlands"])),s()("li",s()("a",{href:"#!",onclick:function(){return nB("en")}},[s()("img",{src:nL,alt:"English",title:"English",disabled:"en"===l,class:"en"===l?"disabled-image":"clickable"}),"English"]))]),s().apply(void 0,["ul#slide-out.sidenav.hide-on-large-and-up",{}].concat(nj(a.map(function(e){return s()("li.tooltip".concat(o(e),".unselectable"),[s()("a",{href:uB.href(e.id)},s()(g,{className:e.iconClass?" ".concat(e.iconClass):"",iconName:"string"==typeof e.icon?e.icon:e.icon()}),("string"==typeof e.title?e.title:e.title()).toUpperCase())])})),[s()("li",s()(ew))])),s().apply(void 0,["ul.right.hide-on-med-and-down"].concat(nj(a.map(function(e){return s()("li.tooltip".concat(o(e),".unselectable"),[s()(g,{className:"hoverable"+(e.iconClass?" ".concat(e.iconClass):""),style:"font-size: 2.2rem; width: 4rem;",iconName:"string"==typeof e.icon?e.icon:e.icon(),onclick:function(){return nh(i,e.id)}}),s()("span.tooltiptext",("string"==typeof e.title?e.title:e.title()).toUpperCase())])})),[s()("li",s()(ew))]))]))),s()(".container",n)])}}};let nU=r.p+"094cb0b3bbf09476.png",nq=r.p+"c74483ed5cfc0c92.png",nz=r.p+"c4f17dae74c10fe5.png",nH=r.p+"c03c2e1f7852da96.png",nX=r.p+"bb94794d7d411f8a.png",nV=r.p+"7dcc9881475f4790.png";var n$="_ScenarioSpark is ontwikkeld als ondersteunend instrument voor de methode Risicomanagement Integrale Beveiliging. Specifiek biedt ScenarioSpark vooral ondersteuning bij de uitvoering van stap 2 van deze methode. Het betreft de stap waarin onder meer de te behandelen dreigingsscenarios voor de TBBs worden bepaald._\n\n![De zes stappen van de methode Risicomanagement Integrale Beveiliging](".concat(nU,")"),nK="### Het ontwikkelen van creatieve scenarios\n\nNavigeer in het hoofdmenu naar maak scenario.\n\n![Menubalk met instellingen](".concat(nq,")\n![Model en inconsistenties](").concat(nX,")\n\nDe pagina bestaat uit een aantal componenten:\n\n1. Drie knoppen: genereer, wis en 'bewaar;\n2. Een drop down menu waarin eerder gegenereerde scenarios weer opgeroepen kunnen worden;\n3. De factoren waaruit de morfologische box is opgebouwd;\n4. Een slotje achter ieder van de factoren;\n5. Een beschrijvende titel die kan worden toegekend aan het scenario;\n6. Een vinkje dat aangeeft of het scenario is geselecteerd voor evaluatie;\n7. Een tekst vak waarin de scenariostam verder kan worden uitgewerkt, eventueel met opmaak en/of afbeeldingen.\n\nDoor op genereer te klikken wordt er aan de hand van de morfologische box een scenario gegeneerd waarbij random een optie wordt toegekend aan elk van de factoren. De gebruiker heeft een aantal mogelijkheden:\n\n1. Het scenario houden zoals is gegenereerd door de morfologische box;\n2. Enkele factoren vastzetten door middel van het slotje en nieuwe opties genereren voor de andere factoren door opnieuw op genereer te klikken;\n3. Een scenario wijzigen of aanvullen door zelf een optie te kiezen voor een factor of meerdere opties te selecteren voor een factor;\n4. Een compleet nieuw scenario door de tool laten genereren;\n5. Een eigen scenario te cre\xebren door handmatig optie(s) voor elke factor te selecteren.\n\nIndien de gebruiker tevreden is met het gegenereerde scenario kan ervoor worden gekozen het scenario toe te voegen aan de lijst met de te evalueren dreigingsscenarios. Het scenario kan worden uitgeschreven tot een verhaal en er kan een titel worden gegeven om het scenario herkenbaar en ondubbelzinnig te maken.\n\n### Het samenstellen van een beperkte, maar toch representatieve set van scenarios.\n\n#### Modus uitsluiten inconsistenties\n\nSommige combinaties van opties van factoren zijn onmogelijk of onwaarschijnlijk. Denk bijvoorbeeld aan een cybercrimineel (actor) die fysieke informatie steelt (doelwit) door middel van een ramvoertuig (middel/ wapen). Om deze reden is er in ScenarioSpark een kruistabel toegevoegd die weergeeft wanneer combinaties van opties van factoren mogelijk, onmogelijk of onwaarschijnlijk zijn. Wanneer de modus uitsluiten inconsistenties is aangevinkt in instellingen, is het niet mogelijk om handmatig een optie voor een factor te kiezen die onmogelijk of onwaarschijnlijk is in combinatie met de reeds geselecteerde opties voor de andere factoren."),nW="### Aanpassen morfologische box\n\nHet aanpassen van de morfologische box kan worden gedaan in instellingen onder het kopje model.\n\n![Menubalk met instellingen](".concat(nz,")\n\n### Aanpassen categorie\xebn\nDoor het instellen van categorie\xebn kan de morfologische box in meerdere delen worden gesplitst (zoals dreigingen, objecten, omstandigheden). Deze mogelijkheid wordt niet gebruikt binnen de context van de Tweede Kamer.\n\n### Selectie getoonde factoren\n\nIn dit drop down menu kan een selectie worden gemaakt van de factoren die meegenomen worden in de morfologische box.\n\n### Aanpassen factoren\n\nNieuwe factoren kunnen worden toegevoegd door op het plusje naast factoren te klikken. Er dienen een aantal gegevens te worden ingevuld:\n\n1. Volgorde (de plek in de morfologische box waar de factor komt te staan);\n2. Manuele mode (bij het automatisch genereren van een scenario wordt deze factor overgeslagen, en dient dus manueel gekozen te worden);\n3. Naam;\n4. Omschrijving.\n\nFactoren kunnen worden gewijzigd door naar de desbetreffende factor te navigeren. Factoren kunnen worden verwijderd door aan de rechterkant op het kruisje te klikken.\n\n### Aanpassen opties binnen factoren\n\nHet aanpassen van opties binnen factoren gebeurt op de pagina van de morfologische box zelf.\n\n![Genereren van varianten](").concat(nH,")\n\nEr kunnen nieuwe opties worden toegevoegd en bestaande opties worden gewijzigd of verwijderd. Om een nieuwe optie toe te voegen dient geklikt te worden op het plusje naast de factor, die tevoorschijn komt door met de muis over de factor te hoveren. Een optie kan worden bewerkt of verwijderd door op het pennetje te klikken dat tevoorschijn komt door met de muis over de optie te hoveren.\n\n### Aanpassen consistenties\n\nHet aanpassen van consistenties kan door op de pagina instellingen te navigeren naar bewerk inconsitenties.\n\n![Model en inconsistenties](").concat(nV,")\n\nScenarioSpark beschikt over een kruistabel waarin voor alle combinaties van opties van factoren is aangegeven of het mogelijk, onwaarschijnlijk of onmogelijk is. Dit kruistabel dient handmatig te worden aangepast. Er kan een rij en een kolom worden gekozen, die beiden een factor representeren. Vervolgens kan worden aangegeven per combinatie van de opties van de factoren of de combinatie als mogelijk, onmogelijk of onwaarschijnlijk wordt geacht. Hoe meer factoren er zijn, hoe meer combinaties moeten worden gecheckt. Houd er dus rekening mee dat dit de nodige tijd in beslag neemt. Indien een nieuwe optie wordt toegevoegd aan een factor in de morfologische box, dient voor de nieuwe optie alle combinaties met bestaande opties van andere factoren beoordeeld te worden.\n\nLet op: na het toevoegen van nieuwe opties in de morfologische box wordt geen enkele combinatie met deze nieuwe optie uitgesloten. Indien u wilt voorkomen dat niet-realistische scenarios worden gegeneerd in de scenariogenerator, dient u handmatig de niet- realistische combinaties hier af te vinken.\n\n### Aanpassen kleurweergave\n\nMet behulp van kleuren kan voor de opties in de morfologische box worden aangegeven hoe vaak deze is gebruikt in een scenario. De keuze van de gebruikte kleuren, het aantal verschillende kleuren en de bandbreedtes waarin dezelfde kleur gegeven wordt, kan naar vrijheid worden ingevuld. Een optie krijgt de kleur van de bandbreedte als het aantal keer dat deze voorkomt groter of gelijk is aan het getal dat wordt ingevoerd als drempelwaarde bij de bandbreedte, zolang er geen hogere drempelwaarde bestaat waar dit ook voor geldt.\n\n### Aanpassen taal\n\nDe taalinstelling van de tool kan worden aangepast door de gewenste vlag op de homepagina te selecteren, of het menu rechtsboven te gebruiken."),nG=function(){return{oninit:function(e){return nd(e.attrs,a.ABOUT)},view:function(){var e=/#([a-zA-Z]*)/.exec(s().route.get());return e&&e.length>0&&setTimeout(function(){return rZ(e[1])},0),s()(".markdown",[s()("aside#toc",[s()(".center-align",[s()("ul.list-inline",[s()("li",s()("a",{href:"#goal",onclick:function(e){return rZ("goal",e)}},"Doel van ScenarioSpark")),s()("li"," | "),s()("li",s()("a",{href:"#usage",onclick:function(e){return rZ("usage",e)}},"Hoe te gebruiken")),s()("li"," | "),s()("li",s()("a",{href:"#settings",onclick:function(e){return rZ("settings",e)}},"Beheer")),s()("li"," | "),s()("li",s()("a",{href:"#security",onclick:function(e){return rZ("security",e)}},"Security"))])])]),s()("main",[s()("header",[s()("h1","Achtergrond"),s().trust(rl(n$))]),s()("section#goal",[s()("h2","Doel van ScenarioSpark"),s().trust(rl("ScenarioSpark is ontwikkeld om de risicomanager te ondersteunen in twee uitdagingen:\n\n- Het op een creatieve manier ontwikkelen van plausibele scenarios;\n- Het samenstellen van een beperkte, maar toch representatieve set van scenarios.\n\n### Het ontwikkelen van creatieve scenarios\n\nZoals we in het recente verleden hebben gezien, blijven terroristen en andere criminelen voortdurend nieuwe manieren bedenken om onze samenleving aan te vallen. Voor een goede beveiliging is het belangrijk dat we niet alleen bekende dreigingen beoordelen, maar ook creatieve dreigingsscenario's bedenken om buiten de gebaande paden te denken. Dit is makkelijker gezegd dan gedaan, omdat recente ervaringen vaak onze gedachten sturen. ScenarioSpark is ontwikkeld om hierin te ondersteunen door willekeurig (dus niet be\xefnvloed door vooroordelen of ervaringen uit het verleden) potentieel valide scenariostammen te genereren. Op basis van de gegenereerde suggesties kan de gebruiker vervolgens bepalen welke interessant zijn om uit te werken en in de risicoanalyse mee te nemen.\n\n### Het samenstellen van een beperkte, maar toch representatieve set van scenarios\n\nHet maken van een compleet overzicht van alle risicos in alle situaties op alle te beschermen belangen is in het algemeen niet realistisch. Er zijn immers zoveel variaties mogelijk dat volledige analyse hiervan niet haalbaar is. In de praktijk wordt daarom getracht een beperkte set scenarios te kiezen waarmee toch een goed, representatief beeld ontstaat van alle mogelijke risicos.\n\nScenarioSpark ondersteunt hierin door inzicht te geven in welke mate een set geselecteerde scenarios de totale risico-ruimte afdekt en welke overlappen er in die set zitten. Hiertoe wordt gebruik gemaakt van een zogenaamde morfologische box. Dat is een matrix waarin de kolommen worden gevormd door alle relevante factoren die een scenario karakteriseren, en waarin de rijen worden gevormd door de opties voor ieder van die factoren (de mogelijke waarden die de factoren kunnen aannemen). In ScenarioSpark wordt een scenario gekarakteriseerd door de keuze van \xe9\xe9n of meer opties voor iedere factor.\n\nUit alle gegenereerde of gedefinieerde scenarios kan de gebruiker de scenarios selecteren die worden toegevoegd aan de set met te evalueren dreigingsscenarios. In de morfologische box wordt aan de hand van een kleurcodering aangegeven hoe vaak bepaalde opties voorkomen in deze set.\n\nOp deze wijze kan met ScenarioSpark een set scenarios worden samengesteld waarin de te analyseren factoren van risicos zo effici\xebnt mogelijk worden behandeld in de (beperkte) set met scenarios. Bovendien wordt voorkomen dat belangrijke factoren over het hoofd worden gezien."))]),s()("section#usage",[s()("h2","Hoe te gebruiken"),s().trust(rl(nK))]),s()("section#settings",[s()("h2","Beheer"),s().trust(rl(nW))]),s()("section#security",[s()("h2","Security"),s().trust(rl("Omdat de informatie die in ScenarioSpark wordt gezet vertrouwelijk kan zijn, is bij het ontwerp van deze applicatie hiermee rekening gehouden door de volgende uitgangspunten te hanteren:\n\n-	ScenarioSpark wordt geladen vanaf een website. De enige informatie die hierbij over het net gaat, is de werking van het programma. Eenmaal ingeladen in de computer, is een verbinding met internet dus ook niet meer noodzakelijk;\n-	Alle informatie die door ScenarioSpark wordt gebruikt, blijft op de computer van de gebruiker (hetzij in de Browsercache, hetzij in een bewaard bestand). De mate van beveiliging van deze gegevens is hiermee gelijk aan de mate van beveiliging van de betreffende computer en volledig controleerbaar door de beheerder van de betreffende computer. Dit betreft zowel de gebruikersinstellingen, de opzet van de morfologische box, als de scenarios.\n-	Het programma biedt de mogelijkheid deze informatie op te slaan en in te lezen. De informatie wordt altijd opgeslagen in de download map van de browser (dit is de enige map waarvoor de browser schrijfrechten heeft). Het inlezen van een bestand kan vanaf elke locatie.\n"))])])])}}};let nY=r.p+"eba062b63d668de7.webp";function nZ(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function nJ(e,t,r,n,i,o,s){try{var a=e[o](s),l=a.value}catch(e){r(e);return}a.done?t(l):Promise.resolve(l).then(n,i)}function nQ(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function s(e){nJ(o,n,i,s,a,"next",e)}function a(e){nJ(o,n,i,s,a,"throw",e)}s(void 0)})}}function n0(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}function n1(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r})(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}function n2(e){return function(e){if(Array.isArray(e))return nZ(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return nZ(e,void 0);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nZ(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n5(e,t){var r,n,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(l){var c=[a,l];if(r)throw TypeError("Generator is already executing.");for(;s&&(s=0,c[0]&&(o=0)),o;)try{if(r=1,n&&(i=2&c[0]?n.return:c[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,c[1])).done)return i;switch(n=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===c[0]||2===c[0])){o=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(6===c[0]&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],n=0}finally{r=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var n3=function(){return{view:function(e){var t=e.attrs,r=t.components,i=t.narratives,o=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e.attrs,["components","narratives"]),l=r.reduce(function(e,t){return t.values&&t.values.forEach(function(t){e[t.id]=t.label}),e},{});return s()(".table-container",s()(".table",s()("table.responsive-table.highlight",[s()("thead",s()("tr",s()("th",{style:"text-align: right"},n("NAME")),r.map(function(e){return s()("th",e.label)}))),s()("tbody",(void 0===i?[]:i).map(function(e){return s()("tr",s()("th.bold.truncate",{style:"text-align: left"},s()("a",{href:uB.href(a.SHOW_SCENARIO),title:e.label,onclick:function(){o.update({curNarrative:function(){return e}})}},rX(e.label))),r.map(function(t){var r=e.components[t.id]&&e.components[t.id].length>0&&e.components[t.id].map(function(e){return l[e]||'<span class="red-text">Missing component ID: '.concat(e,"</span>")}).join(", ");return r?s()("td.truncate",{title:r},s().trust(r)):e[t.id]?s()("td",l[e[t.id]]):s()("td.center-align.missing",s()(g,{iconName:"clear",className:"red-text"}))}))}))])))}}},n4=function(){var e=window.File&&window.FileReader&&window.FileList&&window.Blob,t=0,r=!1;return{oninit:function(e){nd(e.attrs,a.HOME)},view:function(i){var o=i.attrs,l=o.state,c=l.model,u=l.language,d=c.scenarios,h=c.scenario,p=h.id,f=h.label,b=h.narratives,w=h.components,x=h.categories,E=(void 0===b?[]:b).filter(function(e){return e.included}).sort(function(e,t){return(e.label||"").localeCompare(t.label)});return[s()("div",{style:"position: relative;"},[s()(".hero-section",s()(".hero-container",[s()(".hero-image-wrapper",s()("img.hero-image[alt=ScenarioSpark - A scenario generating tool combining morphological analysis with LLM technology]",{src:nY})),s()(".hero-actions",s()(".language-switcher",[s()(".language-option",{onclick:function(){return nv("nl")}},[s()("img",{src:nP,alt:"Nederlands",title:"Nederlands",disabled:"nl"===u,class:"nl"===u?"disabled-image":"clickable"}),s()("span","Nederlands")]),s()(".language-option",{onclick:function(){return nv("en")}},[s()("img",{src:nL,alt:"English",title:"English",disabled:"en"===u,class:"en"===u?"disabled-image":"clickable"}),s()("span","English")])]))])),E.length>0&&x.length>0&&[s()(".row",s()(".col.s12",[s()("h4",n("SAVED_NARRATIVES"))])),x.length>1?s()(em,{tabs:x.map(function(e){return{title:e.label,vnode:s()(n3,n1(n0({},o),{narratives:E,components:w.filter(function(t){return e.componentIds&&e.componentIds.includes(t.id)})}))}})}):s()(".narratives",s()(n3,n1(n0({},o),{narratives:E,components:w.filter(function(e){return x[0].componentIds&&x[0].componentIds.includes(e.id)})})))],s()(".row",s()(".col.s12.m8.l6.offset-m2.offset-l3",s()(".flex-row",s()(ep,{key:p,iconName:"cases",className:"flex-grow",label:n("SELECT_SCENARIO"),checkedId:p,options:[{id:p,label:f}].concat(n2(void 0===d?[]:d)),onchange:function(e){return nQ(function(){return n5(this,function(t){switch(t.label){case 0:var r;return[4,(r=e[0],ns(function(){var e,t,n,i,s;return nl(this,function(a){switch(a.label){case 0:if(t=(e=o.getState().model).scenario,s=(i=void 0===(n=e.scenarios)?[]:n).find(function(e){return e.id===r}),!(t&&s))return[3,2];return e.scenarios=[t].concat(na(i.filter(function(e){return e.id!==r}))),e.scenario=s,o.update({model:function(){return e},activeTooltip:"",title:s.label,curNarrative:function(){},excludedComps:function(){return{}},lockedComps:function(){return{}}}),[4,t3.set(nc,JSON.stringify(e))];case 1:a.sent(),a.label=2;case 2:return[2]}})})())];case 1:return t.sent(),[2]}})})()}}),s()(".icon-buttons",{key:"icons"},s()(y,{className:"icon-button",iconName:"add",title:n("NEW_SCENARIO"),onclick:function(){return nQ(function(){return n5(this,function(e){switch(e.label){case 0:return c.scenarios||(c.scenarios=[]),c.scenarios=[c.scenario].concat(n2(c.scenarios)),c.scenario=eT(),[4,np(o,c,!0)];case 1:return e.sent(),M.toast({html:n("SCENARIO_CREATED_MSG")}),nh(o,a.SETTINGS),[2]}})})()}}),s()(y,{className:"icon-button",iconName:"download",title:n("DOWNLOAD","MODEL"),onclick:function(){var e=document.getElementById("downloadAnchorElem");if(e){var t=void 0===c.version?1:++c.version,r="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(n1(n0({},c.scenario),{version:t})));e.setAttribute("href",r),e.setAttribute("download","".concat(rG(c,void 0,!1),".json")),e.click(),localStorage.setItem(rH,"true")}}}),e&&s()(y,{className:"icon-button",iconName:"upload",title:n("UPLOAD","MODEL"),onclick:function(){var e=document.getElementById("selectFiles");e.onchange=function(){if(e){var t=e.files;if(t&&(!t||!(t.length<=0))){var r=t&&t.item(0),i=r&&/json$/i.test(r.name),s=new FileReader;s.onload=function(e){return nQ(function(){var t,r;return n5(this,function(s){return i&&((r=JSON.parse((e&&e.target&&e.target.result).toString()))&&r.id&&r.label&&c.scenario.id!==r.id&&!(null==(t=c.scenarios)?void 0:t.some(function(e){return e.id===r.id}))?(c.scenarios||(c.scenarios=[]),c.scenarios=[c.scenario].concat(n2(c.scenarios)),c.scenario=r,np(o,c,!0),M.toast({html:n("SCENARIO_LOADED_MSG")})):M.toast({html:n("SCENARIO_NOT_LOADED_MSG")})),[2]})})()},r&&(i?s.readAsText(r):s.readAsArrayBuffer(r))}}},e.click()}}),s()(y,{className:"icon-button",iconName:"delete",title:n("DELETE"),variant:"button"}))))),s()(".buttons.center",{style:"margin: 10px auto;"},[s()(v,{iconName:"clear",disabled:!1,className:"btn-large",label:n("NEW_MODEL","btn"),variant:"button"}),s()("a#downloadAnchorElem",{style:"display:none"}),s()(v,{iconName:"download",disabled:!1,className:"btn-large",label:n("DOWNLOAD","COLLECTION"),onclick:function(){var e=document.getElementById("downloadAnchorElem");if(e){var t=void 0===c.version?1:++c.version,r="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(n1(n0({},c),{version:t})));e.setAttribute("href",r),e.setAttribute("download","".concat(rG(c),".json")),e.click(),localStorage.setItem(rH,"true")}}}),s()("input#selectFiles[type=file][accept=.json]",{style:"display:none"}),e&&s()(v,{iconName:"upload",className:"btn-large",label:n("UPLOAD","COLLECTION"),onclick:function(){var e=document.getElementById("selectFiles");e.onchange=function(){if(e){var t=e.files;if(t&&(!t||!(t.length<=0))){var r=t&&t.item(0),i=r&&/json$/i.test(r.name),s=new FileReader;s.onload=function(e){return nQ(function(){var t;return n5(this,function(r){if(i&&(t=JSON.parse((e&&e.target&&e.target.result).toString()))){var s;np(o,t.version?t:Object.keys(s=t).reduce(function(e,t){if("scenarios"===t){var r=s[t].current;e.scenario.id=r.id,e.scenario.label=r.name,e.scenario.desc=r.desc,e.scenario.hideInconsistentValues=!0,e.scenario.inconsistencies=r.inconsistencies.reduce(function(e,t){var r=rF(t.ids,2),n=r[0],i=r[1],o=t.type;e[n]||(e[n]={}),e[i]||(e[i]={});var s="totally"===o;return e[n][i]=s,e[i][n]=s,e},{}),e.scenario.narratives=r.narratives.map(function(e){var t=e.id,r=e.name,n=e.components,i=e.narrative,o=e.included;return{id:t,label:r,components:Object.keys(n).reduce(function(e,t){return e[t]=[n[t]],e},{}),desc:i,included:o,saved:!0,personaEffects:{}}}),e.scenario.categories=Object.keys(r.categories).map(function(e){return{id:e,label:e,componentIds:r.categories[e]}})}else{e.scenario.components||(e.scenario.components=[]);var i=s[t].list,o=i.reduce(function(e,t){return t.context&&t.context.type&&("LOCATION"===t.context.type&&0>=e.indexOf("location")?e.push("location"):"LOCATIONTYPE"===t.context.type&&0>=e.indexOf("locationType")&&e.push("locationType")),e},[]);if(e.scenario.components.push({id:t,label:n("COMP",t.toUpperCase()),contexts:o,values:i.map(function(e){var t=e.name,r=e.id,n=e.desc,i=e.context,o=i?"LOCATION"===i.type?"location":"LOCATIONTYPE"===i.type?"locationType":"none":void 0,s=i&&"LOCATION"===i.type?i.data.NAME?"name":i.data.COORDINATES?"coords":void 0:void 0,a=rF("coords"===s&&i.data.COORDINATES?i.data.COORDINATES.split(/,/).map(function(e){return+e}):[void 0,void 0],2),l=a[0],c=a[1],u=i&&"LOCATIONTYPE"===i.type?eS.indexOf(Object.keys(i.data).shift())>=0?"list":"keyValue":void 0,d="list"===u?Object.keys(i.data).shift():void 0,h=rF(("keyValue"===u?Object.entries(i.data).shift():void 0)||[void 0,void 0],2),p=h[0],f=h[1];return{id:r,label:t,desc:n,context:o,location:i&&"LOCATION"===i.type?i.data.NAME:void 0,locationType:s,locationTypeType:u,lat:l,lon:c,osmTypeId:d,key:p,value:f}})}),e.scenario.thresholdColors=eE,e.scenario.categories){var a=1,l=e.scenario.categories.filter(function(e){return e.componentIds}).reduce(function(e,t){var r;return null==(r=t.componentIds)||r.forEach(function(t){return e[t]=a++}),e},{});e.scenario.components=e.scenario.components.map(function(e){return rB(rj({},e),{order:l[e.id]})}),e.scenario.components.sort(function(e,t){return e.order>t.order?1:-1})}}return e},{scenario:{},version:1,lastUpdata:Date.now(),scenarios:[]}),!0),M.toast({html:n("COLLECTION_LOADED_MSG")})}return[2]})})()},r&&(i?s.readAsText(r):s.readAsArrayBuffer(r))}}},e.click()}})]),s()(".section",s()(".row.container.center",[s()(".row",s()(".col.s12.align-center",[s()("h5","ScenarioSpark")])),s()(".row",[s()(".col.s12.m4",s()(".icon-block",[s()(".center",s()(g,{iconName:"ads_click"})),s()("h5.center",s()(s().route.Link,{href:n("ABOUT","ROUTE")+"#goal"},n("GOAL","TITLE"))),s()("p",n("GOAL","DESC"))])),s()(".col.s12.m4",s()(".icon-block",[s()(".center",s()(g,{iconName:"settings"})),s()("h5.center",s()(s().route.Link,{href:n("ABOUT","ROUTE")+"#usage"},n("USAGE","TITLE"))),s()("p",n("USAGE","DESC"))])),s()(".col.s12.m4",s()(".icon-block",[s()(".center",s()(g,{iconName:"lock"})),s()("h5.center",s()(s().route.Link,{href:n("ABOUT","ROUTE")+"#security"},n("SECURITY","TITLE"))),s()("p",n("SECURITY","DESC"))]))])])),s()(eo,{id:"delete_model",title:n("DELETE_MODEL","title"),description:s()(".row",[s()(".col.s12",[n("DELETE_MODEL","description")])]),buttons:[{label:n("CANCEL"),iconName:"cancel"},{label:n("OK"),iconName:"delete",onclick:function(){return nQ(function(){return n5(this,function(e){switch(e.label){case 0:return c.scenario=c.scenarios&&c.scenarios.length>0?c.scenarios[0]:eT(),c.scenarios=c.scenarios.filter(function(e){return e.id!==c.scenario.id}),[4,np(o,c,!0)];case 1:return e.sent(),[2]}})})()}}]}),s()(eo,{id:"clearAll",title:n("NEW_MODEL","title"),description:s()(".row",[s()(".col.s12",[n("NEW_MODEL","description")]),s()(".col.s12",[s()(".row",s()(eh,{label:n("NEW_MODEL","choose"),checkedId:1,options:eA.map(function(e,t){return{id:t+1,label:"<strong>".concat(n("MODEL_NAMES",t),": </strong>").concat(n("MODEL_DESC",t))}}),onchange:function(e){return t=e-1}})),s()(".row",s()(er,{label:n("NEW_MODEL","remove"),checked:r,onchange:function(e){return r=e}}))])]),buttons:[{label:n("CANCEL"),iconName:"cancel"},{label:n("OK"),iconName:"delete",onclick:function(){return nQ(function(){return n5(this,function(e){switch(e.label){case 0:return[4,np(o,eA[t],!0)];case 1:return e.sent(),uB.switchTo(0===t?a.SETTINGS:a.DEFINE_BOX),[2]}})})()}}]})])]}}},n6=function(){return{view:function(e){var t=e.attrs;return s()(".col.s12.center-align",t,s()(".preloader-wrapper.big.active",s()(".spinner-layer.spinner-blue-only",[s()(".circle-clipper.left",s()(".circle")),s()(".gap.patch",s()(".circle")),s()(".circle-clipper.right",s()(".circle"))])))}}},n8=function(e){var t=e.replace("#","");return(299*parseInt(t.substring(0,2),16)+587*parseInt(t.substring(2,4),16)+114*parseInt(t.substring(4,6),16))/1e3>125?"black":"white"},n9={view:function(e){var t=e.attrs.items;return s()(".legend",{style:{display:"fixed"}},s()(".legend-items",{style:{top:0,right:0,display:"flex",alignItems:"center",gap:"8px"}},t.map(function(e,r){return s()("div",{key:r,style:{display:"flex",alignItems:"center",justifyContent:"center",width:"40px",height:"40px",backgroundColor:e.color,color:n8(e.color),borderRadius:"8px"}},r===t.length-1?"".concat(e.threshold,"+"):"".concat(e.threshold,"x"))})))}};function n7(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function ie(e,t,r,n,i,o,s){try{var a=e[o](s),l=a.value}catch(e){r(e);return}a.done?t(l):Promise.resolve(l).then(n,i)}function it(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function s(e){ie(o,n,i,s,a,"next",e)}function a(e){ie(o,n,i,s,a,"throw",e)}s(void 0)})}}function ir(e){return function(e){if(Array.isArray(e))return n7(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return n7(e,void 0);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n7(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ii(e,t){var r,n,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(l){var c=[a,l];if(r)throw TypeError("Generator is already executing.");for(;s&&(s=0,c[0]&&(o=0)),o;)try{if(r=1,n&&(i=2&c[0]?n.return:c[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,c[1])).done)return i;switch(n=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===c[0]||2===c[0])){o=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(6===c[0]&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],n=0}finally{r=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var io=function(){return{view:function(e){var t=e.attrs,r=t.rowComponent,n=t.rowValue,i=t.colComponent,o=t.colValue;return s()(".tooltip-content",[s()("strong","Combination:"),s()("div","".concat(r,": ").concat(n)),s()("div","".concat(i,": ").concat(o))])}}},is=function(){var e=!1;return{view:function(t){var r=t.attrs,n=r.rowId,i=r.colId,o=r.inconsistencies,a=r.callback,l=r.disabled,c=r.rowComponent,u=r.rowValue,d=r.colComponent,h=r.colValue,p=o[n],f=void 0!==p?p[i]:void 0;return s()(".cell-with-tooltip",{style:"position: relative;",onmouseover:function(){e=!0},onmouseout:function(){e=!1}},[s()(g,{className:l?"disabled-cell":"clickable",style:l?"opacity: 0.3; cursor: not-allowed;":"color: ".concat(void 0===f?"#4CAF50":f?"#F44336":"#FF9800","; font-size: 1.2rem;"),iconName:void 0===f?"check_circle_outline":f?"radio_button_unchecked":"blur_circular",onclick:function(e){return it(function(){return ii(this,function(t){switch(t.label){case 0:if(e.stopPropagation(),l)return[2];switch(f){case!0:o[n][i]=o[i][n]=!1;break;case!1:delete o[n][i],delete o[i][n];break;default:o[n]||(o[n]={}),o[i]||(o[i]={}),o[n][i]=o[i][n]=!0}return[4,a()];case 1:return t.sent(),[2]}})})()}}),e&&s()(".tooltip",{style:"\n            position: absolute;\n            bottom: 30px;\n            left: 50%;\n            transform: translateX(-50%);\n            background-color: #333;\n            color: white;\n            padding: 8px;\n            border-radius: 4px;\n            z-index: 1000;\n            width: max-content;\n            max-width: 250px;\n            box-shadow: 0 2px 10px rgba(0,0,0,0.2);\n          "},s()(io,{rowComponent:c,rowValue:u,colComponent:d,colValue:h}))])}}},ia=function(){return{view:function(){return s()(".card.legend-card",{style:"padding: 4px; margin: 0;"},[s()("ul.legend-list",{style:"list-style-type: none; padding-left: 0; margin: 0;"},[s()("li",[s()(g,{style:"vertical-align: middle; color: #4CAF50;",iconName:"check_circle_outline"})," "+n("COMBINATIONS","POSSIBLE")]),s()("li",[s()(g,{style:"vertical-align: middle; color: #F44336;",iconName:"radio_button_unchecked"})," "+n("COMBINATIONS","IMPOSSIBLE")]),s()("li",[s()(g,{style:"vertical-align: middle; color: #FF9800;",iconName:"blur_circular"})," "+n("COMBINATIONS","IMPROBABLE")])])])}}},il=function(e,t){var r={};return t.forEach(function(e){var t,n;r[e.id]=(t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({},e),n=n={components:[]},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t)}),e.forEach(function(e){if(e.values&&0!==e.values.length){var n=t.filter(function(t){var r;return null==(r=t.componentIds)?void 0:r.includes(e.id)}).map(function(e){return e.id});n.length?n.forEach(function(t){r[t]&&r[t].components.push(e)}):(r.uncategorized||(r.uncategorized={id:"uncategorized",label:"Uncategorized",components:[]}),r.uncategorized.components.push(e))}}),Object.values(r).filter(function(e){return e.components.length>0})},ic=function(){var e="",t="";return{oninit:function(r){var n=r.attrs.state.model,i=(void 0===n?{scenario:{}}:n).scenario,o=(void 0===i?{categories:[]}:i).categories;o&&o.length&&(e=t=o[0].id)},view:function(r){var i=r.attrs,o=i.state.model,a=o.scenario.inconsistencies,l=il(o.scenario.components.filter(function(e){return e.id&&e.label}),o.scenario.categories||[]),c=l.find(function(t){return t.id===e}),u=l.find(function(e){return e.id===t}),d=e===t,h=function(e){var t=[],r=0,n=!0,i=!1,o=void 0;try{for(var s,a=e.components[Symbol.iterator]();!(n=(s=a.next()).done);n=!0){var l=s.value;if(l.values&&0!==l.values.length){var c=r;r+=l.values.length,t.push({component:l,startIndex:c,endIndex:r-1})}}}catch(e){i=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw o}}return{indexes:t,totalValues:r}},p=c?h(c):null,f=u?h(u):null,g=d&&u?u.components:(null==u?void 0:u.components)||[];return s()(".inconsistencies-editor",[s()(".category-selectors.row",[s()(ep,{checkedId:e,iconName:"view_stream",className:"col s12 m4",placeholder:n("i18n","pickOne"),label:n("INCONSISTENCIES","SELECT_ROW_CATEGORY"),options:l.map(function(e){return{id:e.id,label:e.label}}),onchange:function(t){return e=t[0]}}),s()(ep,{checkedId:t,iconName:"view_column",className:"col s12 m4",placeholder:n("i18n","pickOne"),label:n("INCONSISTENCIES","SELECT_COLUMN_CATEGORY"),options:l.map(function(e){return{id:e.id,label:e.label}}),onchange:function(e){return t=e[0]}}),s()(".col.s12.m4",s()(ia))]),c&&u&&p&&f&&s()(".matrix-container.row",[s()(".col.s12",[s()(".inconsistency-matrix.card",[s()("table.matrix-table.highlight",{style:"border-collapse: collapse; position: relative;"},[s()("thead",{style:"position: sticky; top: 0; z-index: 20; background: white;"},[s()("tr",[s()("th.corner-cell",{rowspan:2,colspan:2})].concat(ir(g.map(function(e,t){return s()("th.component-header",{colspan:e.values.length,style:"background-color: ".concat(t%2==0?"#f5f9ff":"#ffffff",";")},e.label)}).filter(Boolean)))),s()("tr.value-header-row",ir(g.flatMap(function(e,t){return e.values&&0!==e.values.length?e.values.map(function(e,r){return s()("th.value-header",{style:"background-color: ".concat(t%2==0?"#f5f9ff":"#ffffff",";").concat(0===r?"border-left: 2px solid #333;":"")},s()("div",e.label))}):[]})))]),s()("tbody",ir(c.components.flatMap(function(e,t){return e.values&&0!==e.values.length?e.values.map(function(r,n){var l;return s()("tr",{style:"background-color: ".concat(t%2==0?"#f5f9ff":"#ffffff",";\n                                  ").concat(0===n?"border-top: 2px solid #333;":"")},[0===n?s()("th.component-name",{rowspan:null==(l=e.values)?void 0:l.length,style:"background-color: ".concat(t%2==0?"#f5f9ff":"#ffffff",";")},e.label):null,s()("th.value-name",{style:"left: ".concat(120,"px;\n                                      background-color: ").concat(t%2==0?"#f5f9ff":"#ffffff",";")},r.label)].concat(ir(g.flatMap(function(l,c){return l.values&&0!==l.values.length?l.values.map(function(u,h){var p=e.id===l.id||d&&(t<c||t===c&&n<h);return s()("td.matrix-cell",{style:"background-color: ".concat(p?"#f0f0f0":c%2==0&&t%2==0||c%2==1&&t%2==1?"#f5f9ff":"#ffffff",";\n                                              ").concat(0===h?"border-left: 2px solid #333;":"")},!p&&s()(is,{rowId:r.id,colId:u.id,inconsistencies:a,callback:function(){return it(function(){return ii(this,function(e){switch(e.label){case 0:return[4,np(i,o)];case 1:return[2,e.sent()]}})})()},rowComponent:e.label,rowValue:r.label,colComponent:l.label,colValue:u.label,disabled:p}))}):[]}))))}):[]})))])])])]),(!c||!u)&&s()(".col.s12.center-align",s()("p.flow-text",n("INCONSISTENCIES","SELECT_CATEGORIES_TO_START")))])}}};function iu(e,t,r,n,i,o,s){try{var a=e[o](s),l=a.value}catch(e){r(e);return}a.done?t(l):Promise.resolve(l).then(n,i)}function id(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function s(e){iu(o,n,i,s,a,"next",e)}function a(e){iu(o,n,i,s,a,"throw",e)}s(void 0)})}}function ih(e,t){var r,n,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(l){var c=[a,l];if(r)throw TypeError("Generator is already executing.");for(;s&&(s=0,c[0]&&(o=0)),o;)try{if(r=1,n&&(i=2&c[0]?n.return:c[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,c[1])).done)return i;switch(n=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===c[0]||2===c[0])){o=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(6===c[0]&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],n=0}finally{r=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var ip=function(){return{view:function(e){var t=e.attrs,r=t.state.model;return s()(rL,{i18n:nI.i18n,form:[{id:"llm",label:n("LLM"),type:[{id:"id",label:"Service",type:"select",className:"col s12 m3",options:[{id:"ollama",label:"Ollama"},{id:"gemini",label:"Gemini"},{id:"claude",label:"Claude"},{id:"openai",label:"OpenAI"}]},{id:"model",label:n("MODEL"),value:"llama3.3",className:"col s12 m3",type:"text"},{id:"temperature",label:n("TEMPERATURE","BTN"),description:n("TEMPERATURE","DESC"),className:"col s12 m3",type:"number",value:"0.7",min:0,max:1,step:.1},{id:"autoLLMCount",label:n("AUTO_CREATE","COUNT"),description:n("AUTO_CREATE","COUNT_DESC"),className:"col s12 m3",type:"number",value:"10",min:0,max:100,step:1},{id:"apiKey",show:"id!=ollama",label:n("API_KEY"),type:"text"},{id:"systemPrompt",show:"id!=ollama",label:n("SYSTEM_PROMPT"),type:"textarea"},{id:"userPrompt",label:n("USER_PROMPT"),type:"textarea"},{id:"url",label:n("URL"),description:n("OLLAMA_URL"),type:"url",className:"col s12 m6",show:"id=ollama"}]}],obj:r.scenario,onchange:function(){console.log("LLMSelector model:",r.scenario.llm),np(t,r)}})}}},im=function(e,t,r,n){return id(function(){var i,o,s,a,l,c,u,d,h,p;return ih(this,function(f){switch(f.label){case 0:switch(i=e.id,o=e.apiKey,s=e.systemPrompt,a=e.url,l=e.userPrompt,c=e.model,console.log("Generating story with:",e,t,n),i){case"ollama":u=a,c||(c="gemma3");break;case"gemini":u="https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent",c||(c="gemini-pro");break;case"claude":u="https://api.anthropic.com/v1/messages",c||(c="claude-3-5-sonnet-latest");break;case"openai":u="https://api.openai.com/v1/chat/completions",c||(c="gpt-4o-mini");break;default:throw Error("Unknown service: ".concat(i))}return d=r.filter(function(e){return e.includeLLM}).reduce(function(e,t){var r;return null==(r=t.componentIds)||r.forEach(function(t){return e.add(t)}),e},new Set),h=n&&n.filter(function(e){return d.has(e.id)}).reduce(function(e,t){return t.values&&t.values.forEach(function(r){e.set(t.id+r.id,"".concat(r.label).concat(r.desc?" (".concat(r.desc,")"):""))}),e},new Map),console.log(p=n.filter(function(e){return d.has(e.id)&&t.components[e.id]}).map(function(e){var r=t.components[e.id].map(function(t){return h.get(e.id+t)}).join(", ");return"- ".concat(e.label).concat(e.desc?" (".concat(e.desc,")"):"",": ").concat(r)}).join("\n")),[4,function(e,t,r,n,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.7,s=arguments.length>6?arguments[6]:void 0;return id(function(){var a,l,c,u,d,h,p,f,g,b,v,y,w,x,E,_,T,O;return ih(this,function(A){switch(A.label){case 0:switch(l={"Content-Type":"application/json"},e){case"ollama":t="".concat(t).concat(t.endsWith("/")?"":"/","api/generate"),a={model:r,prompt:i+"\n\nRespond using JSON.",format:{type:"object",properties:{title:{type:"string",description:"The title of the story"},content:{type:"string",description:"The main content of the story"}},required:["title","content"],additionalProperties:!1},stream:!1,options:{temperature:o}};break;case"claude":if(!s)throw Error("API key required for Claude");l["x-api-key"]=s,a={model:r,system:n,messages:[{role:"user",content:i}],temperature:o};break;case"openai":if(!s)throw Error("API key required for OpenAI");l.Authorization="Bearer ".concat(s),a={model:r,messages:[{role:"system",content:n},{role:"user",content:i}],temperature:o,stream:!1};break;case"gemini":if(!s)throw Error("API key required for Gemini");t="".concat(t,"?key=").concat(s),a={contents:[{role:"user",parts:[{text:"".concat(n,"\n\n").concat(i)}]}],generationConfig:{temperature:o}};break;default:throw Error("Unsupported provider: ".concat(e))}console.log("Request to ".concat(e,":"),JSON.stringify({url:t,headers:l,body:a},null,2)),c=3,u=0,A.label=1;case 1:if(!(u<c))return[3,9];A.label=2;case 2:return A.trys.push([2,7,,8]),[4,fetch(t,{method:"POST",headers:l,body:JSON.stringify(a)})];case 3:if((d=A.sent()).ok)return[3,5];return[4,d.text()];case 4:throw h=A.sent(),Error("Error: ".concat(d.status," ").concat(d.statusText," - ").concat(h));case 5:return[4,d.json()];case 6:switch(p=A.sent(),e){case"ollama":try{return[2,p.response?JSON.parse(p.response):void 0]}catch(e){return console.error(e),[2,""]}case"claude":return[2,null==(g=p.content)||null==(f=g[0])?void 0:f.text];case"openai":return[2,null==(y=p.choices)||null==(v=y[0])||null==(b=v.message)?void 0:b.content];case"gemini":return[2,null==(T=p.candidates)||null==(_=T[0])||null==(E=_.content)||null==(x=E.parts)||null==(w=x[0])?void 0:w.text];default:return[2,void 0]}case 7:return O=A.sent(),console.error("Attempt ".concat(u+1," failed:"),O),u++,[3,8];case 8:return[3,1];case 9:return[2,void 0]}})})()}(i,u,c,null!=s?s:"You are a helpfull AI storywriter.",(null!=l?l:"")+"\n\nCreate a story with the following elements:\n\n"+p,.7,o)];case 1:return[2,f.sent()]}})})()},ig=function(e,t){var r=[],n=e.label,i=e.componentIds;return r.push("# ".concat(n)),r.push(""),(void 0===i?[]:i).map(function(e){return t.find(function(t){return t.id===e})}).filter(Boolean).forEach(function(e,t){var n=e.id,i=e.label,o=e.desc,s=e.values,a="".concat(t+1,". ").concat(i," [").concat(n,"]").concat(o?": ".concat(o):"");r.push(a),(void 0===s?[]:s).forEach(function(e){var t="   - ".concat(e.label," [").concat(e.id,"]").concat(e.desc?": ".concat(e.desc):"");r.push(t)}),r.push("")}),r.join("\n")},ib=function(e){for(var t=void 0,r=void 0,n=[],i=e.split("\n"),o=null,s=0;s<i.length;s++){var a=i[s].replace(/\*{2,3}/g,"").trim();if(console.log(a),""!==a){if(a.startsWith("# ")){var l=a.match(/^#\s+(.+?)(?:\s*:\s*(.+))?$/);l&&(t=l[1],r=l[2])}var u=a.match(/^(\d+)\.\s+(.+?)(?:\s+\[([^\]]+)\])?(?:\s*:\s*(.+))?$/);if(u){o&&n.push(o);var d=u[2].trim();o={id:u[3]||c(),label:d,desc:u[4],values:[]}}else if(a.startsWith("-")&&o){var h=a.match(/^-\s+(.+?)(?:\s+\[([^\]]+)\])?(?:\s*:\s*(.+))?$/);if(h){var p=h[2]||c(),f=h[1].trim(),g=h[3];o.values.push({id:p,label:f,desc:g})}}}}return o&&n.push(o),{label:t,desc:r,keyDrivers:n}};function iv(e,t,r,n,i,o,s){try{var a=e[o](s),l=a.value}catch(e){r(e);return}a.done?t(l):Promise.resolve(l).then(n,i)}function iy(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function s(e){iv(o,n,i,s,a,"next",e)}function a(e){iv(o,n,i,s,a,"throw",e)}s(void 0)})}}function iw(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}function ix(e,t){var r,n,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(l){var c=[a,l];if(r)throw TypeError("Generator is already executing.");for(;s&&(s=0,c[0]&&(o=0)),o;)try{if(r=1,n&&(i=2&c[0]?n.return:c[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,c[1])).done)return i;switch(n=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===c[0]||2===c[0])){o=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(6===c[0]&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],n=0}finally{r=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var iE=function(){var e=[{id:"id",autogenerate:"id"},{id:"label",type:"text",className:"col s12 m6",label:n("NAME")},{id:"hideInconsistentValues",type:"checkbox",className:"col s6 m3 mt25",label:n("HIDE_INCONSISTENT")},{id:"includeDecisionSupport",type:"checkbox",className:"col s6 m3 mt25",label:n("INCLUDE_DECISION_SUPPORT")},{id:"desc",type:"textarea",label:n("DESCRIPTION")},{id:"template",type:"textarea",label:n("TEMPLATE","TITLE"),description:n("TEMPLATE","DESC").replace("XXX","{1}")},{id:"personas",type:"select",show:["includeDecisionSupport=true"],multiple:!0,options:"personas",label:n("SELECT_PERSONA")},{id:"categories",label:n("CATEGORIES"),type:[{id:"id",autogenerate:"id"},{id:"label",className:"col s4 m3 l3",type:"text",label:n("NAME")},{id:"desc",className:"col s4 m6 l3",type:"text",label:n("DESCRIPTION")},{id:"decisionSupport",type:"checkbox",className:"col s6 m3 l3 mt25",label:n("IS_DECISION_CATEGORY")},{id:"includeLLM",type:"checkbox",className:"col s6 m3 l3 mt25",label:n("INCLUDE_LLM")},{id:"componentIds",type:"select",multiple:!0,label:n("DIMENSION_SELECTED"),options:"components"}],repeat:!0,pageSize:1,max:4},{id:"components",type:[{id:"id",autogenerate:"id"},{id:"order",type:"number",className:"col s3 m2",label:n("ORDER")},{id:"manual",type:"switch",className:"switch col s3 m2",label:n("MANUAL")},{id:"label",type:"text",className:"col s6 m8",label:n("NAME")},{id:"desc",type:"text",className:"col s12",label:n("DESCRIPTION")}],repeat:!0,pageSize:1,sortProperty:"order",label:n("DIMENSIONS")},{id:"thresholdColors",label:n("THRESHOLDS"),repeat:!0,sortProperty:"threshold",pageSize:1,type:[{id:"threshold",label:n("THRESHOLD"),type:"number",min:0,className:"col s6"},{id:"color",label:n("COLOR"),type:"color",className:"col s6"}]}],t=!1;return{oninit:function(e){return nd(e.attrs,a.SETTINGS)},view:function(r){var i=r.attrs,o=i.state.model,a=o.personas,l=void 0===a?[]:a;return[s()(".settings-page.row",{key:o.version},[s()(em,{tabs:[{title:n("MODEL"),vnode:s()(".model-settings",[s()(".row",s()(y,{className:"right",iconName:"delete",label:n("DELETE"),modalId:"deleteModel"}),s()(y,{iconName:"auto_fix_high",className:"right",label:n("ADV_EDIT"),modalId:"mdEditor"})),s()(".row",s()(rL,{obj:o.scenario,form:e,i18n:nI.i18n,context:[{personas:l}],onchange:function(){return iy(function(){return ix(this,function(e){switch(e.label){case 0:return[4,np(i,o)];case 1:return e.sent(),[2]}})})()}}))])},{title:n("INCONSISTENCIES","title"),vnode:s()(ic,iw({},i))},{title:"LLM",vnode:s()(".llm-settings",[s()(ip,iw({},i))])},{title:n("PERSONA",2),vnode:s()(".persona-settings",[s()(".row",s()(y,{label:t?n("SAVE"):n("EDIT"),iconName:t?"save":"edit",className:"right",onclick:function(){return t=!t}})),t?s()(".row",s()(rL,{obj:o,i18n:nI.i18n,context:[{images:tJ.reduce(function(e,t){return e[t.id]=t.img,e},{})}],form:[{id:"personas",label:n("PERSONA",2),repeat:!0,pageSize:100,type:[{id:"id",autogenerate:"id"},{id:"label",type:"text",className:"col s12 m6",label:n("NAME")},{id:"url",type:"select",className:"col s12 m6",options:tJ,label:n("IMAGE")},{id:"desc",type:"textarea",className:"col s12",label:n("DESCRIPTION")}]}],onchange:function(){return iy(function(){return ix(this,function(e){switch(e.label){case 0:return[4,np(i,o)];case 1:return e.sent(),[2]}})})()}})):s()(".row",l.map(function(e){var t;return s()(".col.s12.m6.l4",s()(".card large",[s()(".card-image",[s()("img",{src:null==(t=tJ.find(function(t){return t.id===e.url}))?void 0:t.img,style:"width: 100%"}),s()(".span.card-title",e.label)]),s()(".card-content",s()("p",e.desc))]))}))])}]}),s()(eo,{id:"deleteModel",title:n("DELETE_ITEM","title",{item:n("MODEL")}),description:n("DELETE_ITEM","description",{item:n("MODEL")}),buttons:[{label:n("CANCEL")},{label:n("OK"),onclick:function(){np(i,eO())}}]}),s()(eo,{id:"mdEditor",title:n("ADV_EDIT"),description:s()(i_,i),bottomSheet:!0,fixedFooter:!0,buttons:[{label:n("CANCEL")}]})])]}}},i_=function(){var e,t,r;return{oninit:function(){t=void 0,r=void 0},view:function(i){var o=i.attrs,a=o.state.model;if(a.scenario){var l=a.scenario,u=l.categories,d=void 0===u?[]:u,h=l.components,p=void 0===h?[]:h;return 1===d.length&&(e=d[0]),!t&&e&&(t=r=ig(e,a.scenario.components)),s()(".md-editor.row",[1===d.length?s()(Y,{label:n("CATEGORIES"),className:"col s6",initialValue:null==e?void 0:e.label,readOnly:!0}):s()(ep,{label:n("CATEGORIES"),className:"col s6",placeholder:n("i18n","pickOne"),initialValue:null==e?void 0:e.id,options:d,onchange:function(r){t=void 0,e=d.find(function(e){return e.id===r[0]})}}),s()(y,{iconName:"add",className:"col s1",onclick:function(){var r={id:c(),label:n("NEW_BOX"),componentIds:[]};e=r,a.scenario.categories?a.scenario.categories.push(r):a.scenario.categories=[r],t=void 0,np(o,a)}}),s()(y,{label:n("SAVE"),className:"col offset-s2 s3",iconName:"save",disabled:r===t,onclick:function(){if(r){var t=ib(r),n=t.label,i=t.desc,s=t.keyDrivers,l=void 0===s?[]:s;if(e){n&&(e.label=n),i&&(e.desc=i);var c=new Set(e.componentIds);e.componentIds=l.map(function(e){return e.id}),e.componentIds.forEach(function(e){return c.delete(e)}),a.scenario.categories=d.map(function(t){return t.id===(null==e?void 0:e.id)?e:t});var u=l.reduce(function(e,t){return e.set(t.id,t),e},new Map);a.scenario.components=p.filter(function(e){return!c.has(e.id)}).map(function(e){var t=u.get(e.id);return t?(e.label=t.label,e.desc=t.desc,e.values=t.values,u.delete(e.id),t):e}),l.filter(function(e){return u.has(e.id)}).forEach(function(e){return a.scenario.components.push(e)})}np(o,a)}}}),s()(W,{initialValue:r,disabled:!e,onchange:function(e){r=e,console.log(e)}})])}}}};function iT(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function iO(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}function iA(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r})(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}function iS(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r,n,i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var o=[],s=!0,a=!1;try{for(i=i.call(e);!(s=(r=i.next()).done)&&(o.push(r.value),!t||o.length!==t);s=!0);}catch(e){a=!0,n=e}finally{try{s||null==i.return||i.return()}finally{if(a)throw n}}return o}}(e,t)||iN(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ik(e){return function(e){if(Array.isArray(e))return iT(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||iN(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function iN(e,t){if(e){if("string"==typeof e)return iT(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return iT(e,t)}}var iC=function(){var e,t,r=!1;return{oninit:function(r){var n=r.attrs,i=n.item,o=n.form,s=n.contexts,a=s&&s.length>0&&"none"!==s[0];t=o.filter(function(e){return"context"!==e.id||a}).map(function(e){var t,r;return"context"===e.id&&a&&e.options&&(t=e.options,null!=(r=Array)&&"undefined"!=typeof Symbol&&r[Symbol.hasInstance]?!!r[Symbol.hasInstance](t):t instanceof r)?iA(iO({},e),{options:e.options.filter(function(e){return"none"===e.id||s.indexOf(e.id)>=0})}):e}),e=iO({},i)},view:function(i){var o=i.attrs,a=o.item,l=o.id,c=o.color;return s()("li.kanban-item.card.widget[draggable=true]",{key:l,id:"ki_".concat(a.id),ondragstart:function(e){var t;null==(t=e.dataTransfer)||t.setData(l,JSON.stringify([l,a.id]))},ondragover:function(e){var t;(null==(t=e.dataTransfer)?void 0:t.types.includes(l.toLowerCase()))&&e.preventDefault()},ondrop:function(e){e.preventDefault();var t,r=null==(t=e.dataTransfer)?void 0:t.getData(l);if(r){var n=iS(JSON.parse(r),2),i=(n[0],n[1]),s=e.currentTarget;if(i&&s&&i!==a.id&&s){var c=e.clientY-s.getBoundingClientRect().top,u=s.clientHeight;nb(o,l,i,a.id,c<=u/2)}}}},[s()(".card-content",{style:{backgroundColor:c[0]},onmouseenter:function(){var e="".concat(a.label||"").concat(a.desc?": ".concat(a.desc):"");o.update({activeTooltip:e})},onmouseleave:function(){o.update({activeTooltip:void 0})}},[s()("span.card-title",{style:{color:c[1]}},rX(a.label)),s()(y,{className:"top-right widget-link",iconName:"edit",iconClass:"no-gutter",onclick:function(){r=!0}})]),s()(eo,{id:"modal_".concat(a.id),title:n("EDIT_COMPONENT"),isOpen:r,fixedFooter:!0,onClose:function(){return r=!1},description:s()(".row",s()(rL,{form:t,obj:e,i18n:nI.i18n})),buttons:[{label:n("CANCEL")},{label:n("DELETE"),onclick:function(){ng(o,l,e,"delete")}},{label:n("OK"),onclick:function(){ng(o,l,e,"update")}}]})])}}},iI=function(){var e={},t=!1;return{view:function(r){var i=r.attrs,o=i.sc,a=i.form,l=o.id;return s()("li.kanban-header.widget",{key:"header"},[s()(".span.title.truncate.left.ml10",{onmouseenter:o.desc?function(){i.update({activeTooltip:"".concat(o.label||"",": ").concat(o.desc)})}:void 0,onmouseleave:o.desc?function(){i.update({activeTooltip:void 0})}:void 0},o.label),s()(y,{className:"widget-link",iconName:"add",iconClass:"right",i18n:nI.i18n,onclick:function(){return t=!0}}),s()(eo,{id:o.id,title:n("ADD_COMPONENT"),fixedFooter:!0,isOpen:t,onClose:function(){return t=!1},description:s()(".row",s()(rL,{form:a,obj:e,i18n:nI.i18n})),buttons:[{label:n("CANCEL")},{label:n("OK"),onclick:function(){var t=iO({},e);e={},ng(i,l,t,"create")}}]})])}}},iR=function(){return{view:function(e){var t,r=e.attrs,n=r.sc,i=r.form,o=r.compColor;return s()("li",{key:n.id},[s()("ul.kanban-row",s()(iI,iA(iO({},r),{sc:n,form:i})),null==(t=n.values)?void 0:t.map(function(e){return s()(iC,iA(iO({key:e.id},r),{id:n.id,contexts:n.contexts,item:e,form:i,color:o[e.id]||o.OTHER}))}))])}}},iP=function(){return{view:function(e){var t=e.attrs,r=t.form,n=t.categoryId,i=t.compColor,o=t.state.model.scenario,a=o.categories,l=o.components,c=a[n],u=l.filter(function(e){return c.componentIds&&c.componentIds.indexOf(e.id)>=0});return s()("ul.kanban",[u.map(function(e){return s()(iR,iA(iO({},t),{sc:e,form:r,compColor:i}))})])}}},iL=function(){var e,t=function(t){o!==t&&i!==t&&(o=t,l=!0,s().redraw(),clearTimeout(e),e=window.setTimeout(function(){i=t,l=!1,s().redraw()},200))},r=function(){clearTimeout(e),e=window.setTimeout(function(){i="",o="",l=!1,s().redraw()},200)},i="",o="",l=!1,c=[{id:"id",autogenerate:"id"},{id:"label",type:"text",label:n("NAME")},{id:"desc",type:"textarea",label:n("DESCRIPTION")}],u=0,d={},h=[],p=function(e){e&&(h="light"===ey.getEffectiveTheme()?ik(e):e.map(function(e){return{threshold:e.threshold,color:nr(e.color)}}))},f=function(e,t){var r=[],n=e.narratives.filter(function(e){return e.included}),i=!0,o=!1,s=void 0;try{for(var a,l=t[Symbol.iterator]();!(i=(a=l.next()).done);i=!0)!function(){var t=a.value,i=e.components.filter(function(e){var r;return null==(r=t.componentIds)?void 0:r.includes(e.id)}),o=iD({components:i,narratives:n,compColor:d,includeDescriptions:!1});r.push(o)}()}catch(e){o=!0,s=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw s}}var c=r.join("\n\n"),u=rl(c,!0);navigator.clipboard.write([new ClipboardItem({"text/html":new Blob([u],{type:"text/html"}),"text/plain":new Blob([c],{type:"text/plain"})})])};return{oninit:function(e){nd(e.attrs,a.DEFINE_BOX)},view:function(e){var o=e.attrs,a=o.state,g=a.activeTooltip,b=a.model.scenario;g?t(g):r();var v=b.categories,w=b.thresholdColors,x=b.narratives,E=void 0===x?[]:x;return p(void 0===w?[]:w),(0===Object.keys(d).length||u!==E.length)&&(u=E.length,d=nn(E,h)),[s()(".create-box-page",[s()(y,{style:{marginTop:"20px",marginBottom:"-40px"},className:"right",label:n("COPY_BOX","LABEL"),iconName:"content_copy",title:n("COPY_BOX","TITLE"),onclick:function(){f(b,v),new eg({html:n("COPY_BOX","TOAST")})}}),s()(n9,{items:h}),v.length>1&&v[0].componentIds&&v[1].componentIds?s()(em,{tabs:v.map(function(e,t){return{id:e.id,title:e.label,vnode:s()(iP,iA(iO({},o),{compColor:d,categoryId:t,form:c}))}})}):1===v.length&&v[0].componentIds?s()(iP,iA(iO({},o),{compColor:d,categoryId:0,form:c})):s()(".row.mt10",s()(".col.s12",n("SPEC_CATS"))),i&&s()(".popupContainer",{className:"show"},s()(".popupContent.center",{class:l?"fade-out":void 0},s()(rS,{md:i,removeParagraphs:!0})))])]}}},iD=function(e){var t=function(e){var t=z.map(function(t){var r;return null!=(r=t[e])?r:""});$.push("| ".concat(t.join(" | ")," |"))},r=e.components,n=e.narratives,i=e.compColor,o=e.includeDescriptions,s=void 0!==o&&o,a=e.resolveIds,l=new Map,c=new Set,u=!0,d=!1,h=void 0;try{for(var p,f,g=r[Symbol.iterator]();!(u=(f=g.next()).done);u=!0){var b=f.value,v=!0,y=!1,w=void 0;try{for(var x,E=(b.values||[])[Symbol.iterator]();!(v=(x=E.next()).done);v=!0){var _=x.value;l.set(_.id,_),c.add(_.id)}}catch(e){y=!0,w=e}finally{try{v||null==E.return||E.return()}finally{if(y)throw w}}}}catch(e){d=!0,h=e}finally{try{u||null==g.return||g.return()}finally{if(d)throw h}}var T=null!=a?a:function(e,t){var r=[],n=function(e){"string"==typeof e&&t.has(e)?r.push(e):Array.isArray(e)&&e.forEach(n)};return e&&(void 0===e?"undefined":e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e)=="object"&&("components"in e&&Object.values(e.components||{}).forEach(n),"selections"in e&&Object.values(e.selections||{}).forEach(n),"items"in e&&n(e.items)),r},O={},A=!0,S=!1,k=void 0;try{for(var N,C=(n||[])[Symbol.iterator]();!(A=(N=C.next()).done);A=!0){var I=N.value,R=T(I,c),P=!0,L=!1,D=void 0;try{for(var j,B=R[Symbol.iterator]();!(P=(j=B.next()).done);P=!0){var F=j.value;O[F]=(O[F]||0)+1}}catch(e){L=!0,D=e}finally{try{P||null==B.return||B.return()}finally{if(L)throw D}}}}catch(e){S=!0,k=e}finally{try{A||null==C.return||C.return()}finally{if(S)throw k}}for(var U=function(e){var t=iS(i[e]||["#999999","#ffffff"],1)[0];return'<span style="color:'.concat(t,'"></span>')},q=r.map(function(e){return e.label}),z=r.map(function(e){var t=[],r=!0,n=!1,i=void 0;try{for(var o,a=(e.values||[])[Symbol.iterator]();!(r=(o=a.next()).done);r=!0){var l,c=o.value,u=null!=(l=O[c.id])?l:0,d=rX(c.label),h=s&&c.desc?"  ".concat(c.desc):"";t.push("".concat(U(c.id)," ").concat(d," (").concat(u,"x)").concat(h))}}catch(e){n=!0,i=e}finally{try{r||null==a.return||a.return()}finally{if(n)throw i}}return t}),H=(p=Math).max.apply(p,[0].concat(ik(z.map(function(e){return e.length})))),X="| ".concat(q.join(" | ")," |"),V="| ".concat(q.map(function(){return"---"}).join(" | ")," |"),$=[],K=0;K<H;K++)t(K);return[X,V].concat(ik($)).join("\n")};let iM=function(e,t){return e===t||e!=e&&t!=t},ij=function(e,t){for(var r=e.length;r--;)if(iM(e[r][0],t))return r;return -1};var iB=Array.prototype.splice;function iF(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}iF.prototype.clear=function(){this.__data__=[],this.size=0},iF.prototype.delete=function(e){var t=this.__data__,r=ij(t,e);return!(r<0)&&(r==t.length-1?t.pop():iB.call(t,r,1),--this.size,!0)},iF.prototype.get=function(e){var t=this.__data__,r=ij(t,e);return r<0?void 0:t[r][1]},iF.prototype.has=function(e){return ij(this.__data__,e)>-1},iF.prototype.set=function(e,t){var r=this.__data__,n=ij(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};var iU="object"==typeof global&&global&&global.Object===Object&&global,iq="object"==typeof self&&self&&self.Object===Object&&self,iz=iU||iq||Function("return this")(),iH=iz.Symbol,iX=Object.prototype,iV=iX.hasOwnProperty,i$=iX.toString,iK=iH?iH.toStringTag:void 0;let iW=function(e){var t=iV.call(e,iK),r=e[iK];try{e[iK]=void 0;var n=!0}catch(e){}var i=i$.call(e);return n&&(t?e[iK]=r:delete e[iK]),i};var iG=Object.prototype.toString,iY=iH?iH.toStringTag:void 0;let iZ=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":iY&&iY in Object(e)?iW(e):iG.call(e)},iJ=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},iQ=function(e){if(!iJ(e))return!1;var t=iZ(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t};var i0=iz["__core-js_shared__"],i1=function(){var e=/[^.]+$/.exec(i0&&i0.keys&&i0.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),i2=Function.prototype.toString;let i5=function(e){if(null!=e){try{return i2.call(e)}catch(e){}try{return e+""}catch(e){}}return""};var i3=/^\[object .+?Constructor\]$/,i4=Object.prototype,i6=Function.prototype.toString,i8=i4.hasOwnProperty,i9=RegExp("^"+i6.call(i8).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");let i7=function(e){return!!iJ(e)&&(!i1||!(i1 in e))&&(iQ(e)?i9:i3).test(i5(e))},oe=function(e,t){var r=null==e?void 0:e[t];return i7(r)?r:void 0};var ot=oe(iz,"Map"),or=oe(Object,"create"),on=Object.prototype.hasOwnProperty,oi=Object.prototype.hasOwnProperty;function oo(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}oo.prototype.clear=function(){this.__data__=or?or(null):{},this.size=0},oo.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=!!t,t},oo.prototype.get=function(e){var t=this.__data__;if(or){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return on.call(t,e)?t[e]:void 0},oo.prototype.has=function(e){var t=this.__data__;return or?void 0!==t[e]:oi.call(t,e)},oo.prototype.set=function(e,t){var r=this.__data__;return this.size+=+!this.has(e),r[e]=or&&void 0===t?"__lodash_hash_undefined__":t,this};let os=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e},oa=function(e,t){var r=e.__data__;return os(t)?r["string"==typeof t?"string":"hash"]:r.map};function ol(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function oc(e){var t=this.__data__=new iF(e);this.size=t.size}ol.prototype.clear=function(){this.size=0,this.__data__={hash:new oo,map:new(ot||iF),string:new oo}},ol.prototype.delete=function(e){var t=oa(this,e).delete(e);return this.size-=!!t,t},ol.prototype.get=function(e){return oa(this,e).get(e)},ol.prototype.has=function(e){return oa(this,e).has(e)},ol.prototype.set=function(e,t){var r=oa(this,e),n=r.size;return r.set(e,t),this.size+=+(r.size!=n),this},oc.prototype.clear=function(){this.__data__=new iF,this.size=0},oc.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},oc.prototype.get=function(e){return this.__data__.get(e)},oc.prototype.has=function(e){return this.__data__.has(e)},oc.prototype.set=function(e,t){var r=this.__data__;if(r instanceof iF){var n=r.__data__;if(!ot||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new ol(n)}return r.set(e,t),this.size=r.size,this};var ou=function(){try{var e=oe(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();let od=function(e,t,r){"__proto__"==t&&ou?ou(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r},oh=function(e,t,r){(void 0===r||iM(e[t],r))&&(void 0!==r||t in e)||od(e,t,r)},op=function(e,t,r){for(var n=-1,i=Object(e),o=r(e),s=o.length;s--;){var a=o[++n];if(!1===t(i[a],a,i))break}return e};var of="object"==typeof exports&&exports&&!exports.nodeType&&exports,om=of&&"object"==typeof module&&module&&!module.nodeType&&module,og=om&&om.exports===of?iz.Buffer:void 0,ob=og?og.allocUnsafe:void 0;let ov=function(e,t){if(t)return e.slice();var r=e.length,n=ob?ob(r):new e.constructor(r);return e.copy(n),n};var oy=iz.Uint8Array;let ow=function(e){var t=new e.constructor(e.byteLength);return new oy(t).set(new oy(e)),t},ox=function(e,t){var r=t?ow(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)},oE=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t};var o_=Object.create,oT=function(){function e(){}return function(t){if(!iJ(t))return{};if(o_)return o_(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();let oO=function(e,t){return function(r){return e(t(r))}};var oA=oO(Object.getPrototypeOf,Object),oS=Object.prototype;let ok=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||oS)},oN=function(e){return"function"!=typeof e.constructor||ok(e)?{}:oT(oA(e))},oC=function(e){return null!=e&&"object"==typeof e},oI=function(e){return oC(e)&&"[object Arguments]"==iZ(e)};var oR=Object.prototype,oP=oR.hasOwnProperty,oL=oR.propertyIsEnumerable,oD=oI(function(){return arguments}())?oI:function(e){return oC(e)&&oP.call(e,"callee")&&!oL.call(e,"callee")},oM=Array.isArray;let oj=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=0x1fffffffffffff},oB=function(e){return null!=e&&oj(e.length)&&!iQ(e)};var oF="object"==typeof exports&&exports&&!exports.nodeType&&exports,oU=oF&&"object"==typeof module&&module&&!module.nodeType&&module,oq=oU&&oU.exports===oF?iz.Buffer:void 0;let oz=(oq?oq.isBuffer:void 0)||function(){return!1};var oH=Object.prototype,oX=Function.prototype.toString,oV=oH.hasOwnProperty,o$=oX.call(Object);let oK=function(e){if(!oC(e)||"[object Object]"!=iZ(e))return!1;var t=oA(e);if(null===t)return!0;var r=oV.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&oX.call(r)==o$};var oW={};oW["[object Float32Array]"]=oW["[object Float64Array]"]=oW["[object Int8Array]"]=oW["[object Int16Array]"]=oW["[object Int32Array]"]=oW["[object Uint8Array]"]=oW["[object Uint8ClampedArray]"]=oW["[object Uint16Array]"]=oW["[object Uint32Array]"]=!0,oW["[object Arguments]"]=oW["[object Array]"]=oW["[object ArrayBuffer]"]=oW["[object Boolean]"]=oW["[object DataView]"]=oW["[object Date]"]=oW["[object Error]"]=oW["[object Function]"]=oW["[object Map]"]=oW["[object Number]"]=oW["[object Object]"]=oW["[object RegExp]"]=oW["[object Set]"]=oW["[object String]"]=oW["[object WeakMap]"]=!1;let oG=function(e){return function(t){return e(t)}};var oY="object"==typeof exports&&exports&&!exports.nodeType&&exports,oZ=oY&&"object"==typeof module&&module&&!module.nodeType&&module,oJ=oZ&&oZ.exports===oY&&iU.process,oQ=function(){try{var e=oZ&&oZ.require&&oZ.require("util").types;if(e)return e;return oJ&&oJ.binding&&oJ.binding("util")}catch(e){}}(),o0=oQ&&oQ.isTypedArray,o1=o0?oG(o0):function(e){return oC(e)&&oj(e.length)&&!!oW[iZ(e)]};let o2=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]};var o5=Object.prototype.hasOwnProperty;let o3=function(e,t,r){var n=e[t];o5.call(e,t)&&iM(n,r)&&(void 0!==r||t in e)||od(e,t,r)},o4=function(e,t,r,n){var i=!r;r||(r={});for(var o=-1,s=t.length;++o<s;){var a=t[o],l=n?n(r[a],e[a],a,r,e):void 0;void 0===l&&(l=e[a]),i?od(r,a,l):o3(r,a,l)}return r},o6=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n};var o8=/^(?:0|[1-9]\d*)$/;let o9=function(e,t){var r=typeof e;return!!(t=null==t?0x1fffffffffffff:t)&&("number"==r||"symbol"!=r&&o8.test(e))&&e>-1&&e%1==0&&e<t};var o7=Object.prototype.hasOwnProperty;let se=function(e,t){var r=oM(e),n=!r&&oD(e),i=!r&&!n&&oz(e),o=!r&&!n&&!i&&o1(e),s=r||n||i||o,a=s?o6(e.length,String):[],l=a.length;for(var c in e)(t||o7.call(e,c))&&!(s&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||o9(c,l)))&&a.push(c);return a},st=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t};var sr=Object.prototype.hasOwnProperty;let sn=function(e){if(!iJ(e))return st(e);var t=ok(e),r=[];for(var n in e)"constructor"==n&&(t||!sr.call(e,n))||r.push(n);return r},si=function(e){return oB(e)?se(e,!0):sn(e)},so=function(e,t,r,n,i,o,s){var a=o2(e,r),l=o2(t,r),c=s.get(l);if(c)return void oh(e,r,c);var u=o?o(a,l,r+"",e,t,s):void 0,d=void 0===u;if(d){var h=oM(l),p=!h&&oz(l),f=!h&&!p&&o1(l);(u=l,h||p||f)?oM(a)?u=a:oC(a)&&oB(a)?u=oE(a):p?(d=!1,u=ov(l,!0)):f?(d=!1,u=ox(l,!0)):u=[]:oK(l)||oD(l)?(u=a,oD(a))?u=o4(a,si(a)):(!iJ(a)||iQ(a))&&(u=oN(l)):d=!1}d&&(s.set(l,u),i(u,l,n,o,s),s.delete(l)),oh(e,r,u)},ss=function e(t,r,n,i,o){t!==r&&op(r,function(s,a){if(o||(o=new oc),iJ(s))so(t,r,a,n,e,i,o);else{var l=i?i(o2(t,a),s,a+"",t,r,o):void 0;void 0===l&&(l=s),oh(t,a,l)}},si)},sa=function(e){return e},sl=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)};var sc=Math.max,su=Date.now,sd=function(e){var t=0,r=0;return function(){var n=su(),i=16-(n-r);if(r=n,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(ou?function(e,t){return ou(e,"toString",{configurable:!0,enumerable:!1,value:function(){return t},writable:!0})}:sa);let sh=function(e,t){var r;return sd((r=sc(void 0===(r=t)?e.length-1:r,0),function(){for(var t=arguments,n=-1,i=sc(t.length-r,0),o=Array(i);++n<i;)o[n]=t[r+n];n=-1;for(var s=Array(r+1);++n<r;)s[n]=t[n];return s[r]=sa(o),sl(e,this,s)}),e+"")},sp=function(e,t,r){if(!iJ(r))return!1;var n=typeof t;return("number"==n?!!(oB(r)&&o9(t,r.length)):"string"==n&&t in r)&&iM(r[t],e)};var sf=function(e){return sh(function(t,r){var n=-1,i=r.length,o=i>1?r[i-1]:void 0,s=i>2?r[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,s&&sp(r[0],r[1],s)&&(o=i<3?void 0:o,i=1),t=Object(t);++n<i;){var a=r[n];a&&e(t,a,n,o)}return t})}(function(e,t,r){ss(e,t,r)}),sm=(e=>(e[e.TYPE=3]="TYPE",e[e.LEVEL=12]="LEVEL",e[e.ATTRIBUTE=13]="ATTRIBUTE",e[e.BLOT=14]="BLOT",e[e.INLINE=7]="INLINE",e[e.BLOCK=11]="BLOCK",e[e.BLOCK_BLOT=10]="BLOCK_BLOT",e[e.INLINE_BLOT=6]="INLINE_BLOT",e[e.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",e[e.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",e[e.ANY=15]="ANY",e))(sm||{});class sg{constructor(e,t,r={}){this.attrName=e,this.keyName=t;let n=sm.TYPE&sm.ATTRIBUTE;this.scope=null!=r.scope?r.scope&sm.LEVEL|n:sm.ATTRIBUTE,null!=r.whitelist&&(this.whitelist=r.whitelist)}static keys(e){return Array.from(e.attributes).map(e=>e.name)}add(e,t){return!!this.canAdd(e,t)&&(e.setAttribute(this.keyName,t),!0)}canAdd(e,t){return null==this.whitelist||("string"==typeof t?this.whitelist.indexOf(t.replace(/["']/g,""))>-1:this.whitelist.indexOf(t)>-1)}remove(e){e.removeAttribute(this.keyName)}value(e){let t=e.getAttribute(this.keyName);return this.canAdd(e,t)&&t?t:""}}class sb extends Error{constructor(e){super(e="[Parchment] "+e),this.message=e,this.name=this.constructor.name}}let sv=class e{constructor(){this.attributes={},this.classes={},this.tags={},this.types={}}static find(e,t=!1){if(null==e)return null;if(this.blots.has(e))return this.blots.get(e)||null;if(t){let r=null;try{r=e.parentNode}catch{return null}return this.find(r,t)}return null}create(t,r,n){let i=this.query(r);if(null==i)throw new sb(`Unable to create ${r} blot`);let o=r instanceof Node||r.nodeType===Node.TEXT_NODE?r:i.create(n),s=new i(t,o,n);return e.blots.set(s.domNode,s),s}find(t,r=!1){return e.find(t,r)}query(e,t=sm.ANY){let r;return"string"==typeof e?r=this.types[e]||this.attributes[e]:e instanceof Text||e.nodeType===Node.TEXT_NODE?r=this.types.text:"number"==typeof e?e&sm.LEVEL&sm.BLOCK?r=this.types.block:e&sm.LEVEL&sm.INLINE&&(r=this.types.inline):e instanceof Element&&((e.getAttribute("class")||"").split(/\s+/).some(e=>!!(r=this.classes[e])),r=r||this.tags[e.tagName]),null==r?null:"scope"in r&&t&sm.LEVEL&r.scope&&t&sm.TYPE&r.scope?r:null}register(...e){return e.map(e=>{let t="blotName"in e,r="attrName"in e;if(!t&&!r)throw new sb("Invalid definition");if(t&&"abstract"===e.blotName)throw new sb("Cannot register abstract class");let n=t?e.blotName:r?e.attrName:void 0;return this.types[n]=e,r?"string"==typeof e.keyName&&(this.attributes[e.keyName]=e):t&&(e.className&&(this.classes[e.className]=e),e.tagName&&(Array.isArray(e.tagName)?e.tagName=e.tagName.map(e=>e.toUpperCase()):e.tagName=e.tagName.toUpperCase(),(Array.isArray(e.tagName)?e.tagName:[e.tagName]).forEach(t=>{(null==this.tags[t]||null==e.className)&&(this.tags[t]=e)}))),e})}};sv.blots=new WeakMap;let sy=sv;function sw(e,t){return(e.getAttribute("class")||"").split(/\s+/).filter(e=>0===e.indexOf(`${t}-`))}let sx=class extends sg{static keys(e){return(e.getAttribute("class")||"").split(/\s+/).map(e=>e.split("-").slice(0,-1).join("-"))}add(e,t){return!!this.canAdd(e,t)&&(this.remove(e),e.classList.add(`${this.keyName}-${t}`),!0)}remove(e){sw(e,this.keyName).forEach(t=>{e.classList.remove(t)}),0===e.classList.length&&e.removeAttribute("class")}value(e){let t=(sw(e,this.keyName)[0]||"").slice(this.keyName.length+1);return this.canAdd(e,t)?t:""}};function sE(e){let t=e.split("-"),r=t.slice(1).map(e=>e[0].toUpperCase()+e.slice(1)).join("");return t[0]+r}let s_=class extends sg{static keys(e){return(e.getAttribute("style")||"").split(";").map(e=>e.split(":")[0].trim())}add(e,t){return!!this.canAdd(e,t)&&(e.style[sE(this.keyName)]=t,!0)}remove(e){e.style[sE(this.keyName)]="",e.getAttribute("style")||e.removeAttribute("style")}value(e){let t=e.style[sE(this.keyName)];return this.canAdd(e,t)?t:""}},sT=class{constructor(e){this.attributes={},this.domNode=e,this.build()}attribute(e,t){t?e.add(this.domNode,t)&&(null!=e.value(this.domNode)?this.attributes[e.attrName]=e:delete this.attributes[e.attrName]):(e.remove(this.domNode),delete this.attributes[e.attrName])}build(){this.attributes={};let e=sy.find(this.domNode);if(null==e)return;let t=sg.keys(this.domNode),r=sx.keys(this.domNode),n=s_.keys(this.domNode);t.concat(r).concat(n).forEach(t=>{let r=e.scroll.query(t,sm.ATTRIBUTE);r instanceof sg&&(this.attributes[r.attrName]=r)})}copy(e){Object.keys(this.attributes).forEach(t=>{let r=this.attributes[t].value(this.domNode);e.format(t,r)})}move(e){this.copy(e),Object.keys(this.attributes).forEach(e=>{this.attributes[e].remove(this.domNode)}),this.attributes={}}values(){return Object.keys(this.attributes).reduce((e,t)=>(e[t]=this.attributes[t].value(this.domNode),e),{})}},sO=class{constructor(e,t){this.scroll=e,this.domNode=t,sy.blots.set(t,this),this.prev=null,this.next=null}static create(e){let t,r;if(null==this.tagName)throw new sb("Blot definition missing tagName");return Array.isArray(this.tagName)?("string"==typeof e?parseInt(r=e.toUpperCase(),10).toString()===r&&(r=parseInt(r,10)):"number"==typeof e&&(r=e),t="number"==typeof r?document.createElement(this.tagName[r-1]):r&&this.tagName.indexOf(r)>-1?document.createElement(r):document.createElement(this.tagName[0])):t=document.createElement(this.tagName),this.className&&t.classList.add(this.className),t}get statics(){return this.constructor}attach(){}clone(){let e=this.domNode.cloneNode(!1);return this.scroll.create(e)}detach(){null!=this.parent&&this.parent.removeChild(this),sy.blots.delete(this.domNode)}deleteAt(e,t){this.isolate(e,t).remove()}formatAt(e,t,r,n){let i=this.isolate(e,t);if(null!=this.scroll.query(r,sm.BLOT)&&n)i.wrap(r,n);else if(null!=this.scroll.query(r,sm.ATTRIBUTE)){let e=this.scroll.create(this.statics.scope);i.wrap(e),e.format(r,n)}}insertAt(e,t,r){let n=null==r?this.scroll.create("text",t):this.scroll.create(t,r),i=this.split(e);this.parent.insertBefore(n,i||void 0)}isolate(e,t){let r=this.split(e);if(null==r)throw Error("Attempt to isolate at end");return r.split(t),r}length(){return 1}offset(e=this.parent){return null==this.parent||this===e?0:this.parent.children.offset(this)+this.parent.offset(e)}optimize(e){!this.statics.requiredContainer||this.parent instanceof this.statics.requiredContainer||this.wrap(this.statics.requiredContainer.blotName)}remove(){null!=this.domNode.parentNode&&this.domNode.parentNode.removeChild(this.domNode),this.detach()}replaceWith(e,t){let r="string"==typeof e?this.scroll.create(e,t):e;return null!=this.parent&&(this.parent.insertBefore(r,this.next||void 0),this.remove()),r}split(e,t){return 0===e?this:this.next}update(e,t){}wrap(e,t){let r="string"==typeof e?this.scroll.create(e,t):e;if(null!=this.parent&&this.parent.insertBefore(r,this.next||void 0),"function"!=typeof r.appendChild)throw new sb(`Cannot wrap ${e}`);return r.appendChild(this),r}};sO.blotName="abstract";let sA=sO,sS=class extends sA{static value(e){return!0}index(e,t){return this.domNode===e||this.domNode.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(t,1):-1}position(e,t){let r=Array.from(this.parent.domNode.childNodes).indexOf(this.domNode);return e>0&&(r+=1),[this.parent.domNode,r]}value(){return{[this.statics.blotName]:this.statics.value(this.domNode)||!0}}};sS.scope=sm.INLINE_BLOT;let sk=sS;class sN{constructor(){this.head=null,this.tail=null,this.length=0}append(...e){if(this.insertBefore(e[0],null),e.length>1){let t=e.slice(1);this.append(...t)}}at(e){let t=this.iterator(),r=t();for(;r&&e>0;)e-=1,r=t();return r}contains(e){let t=this.iterator(),r=t();for(;r;){if(r===e)return!0;r=t()}return!1}indexOf(e){let t=this.iterator(),r=t(),n=0;for(;r;){if(r===e)return n;n+=1,r=t()}return -1}insertBefore(e,t){null!=e&&(this.remove(e),e.next=t,null!=t?(e.prev=t.prev,null!=t.prev&&(t.prev.next=e),t.prev=e,t===this.head&&(this.head=e)):null!=this.tail?(this.tail.next=e,e.prev=this.tail,this.tail=e):(e.prev=null,this.head=this.tail=e),this.length+=1)}offset(e){let t=0,r=this.head;for(;null!=r;){if(r===e)return t;t+=r.length(),r=r.next}return -1}remove(e){this.contains(e)&&(null!=e.prev&&(e.prev.next=e.next),null!=e.next&&(e.next.prev=e.prev),e===this.head&&(this.head=e.next),e===this.tail&&(this.tail=e.prev),this.length-=1)}iterator(e=this.head){return()=>{let t=e;return null!=e&&(e=e.next),t}}find(e,t=!1){let r=this.iterator(),n=r();for(;n;){let i=n.length();if(e<i||t&&e===i&&(null==n.next||0!==n.next.length()))return[n,e];e-=i,n=r()}return[null,0]}forEach(e){let t=this.iterator(),r=t();for(;r;)e(r),r=t()}forEachAt(e,t,r){if(t<=0)return;let[n,i]=this.find(e),o=e-i,s=this.iterator(n),a=s();for(;a&&o<e+t;){let n=a.length();e>o?r(a,e-o,Math.min(t,o+n-e)):r(a,0,Math.min(n,e+t-o)),o+=n,a=s()}}map(e){return this.reduce((t,r)=>(t.push(e(r)),t),[])}reduce(e,t){let r=this.iterator(),n=r();for(;n;)t=e(t,n),n=r();return t}}function sC(e,t){let r=t.find(e);if(r)return r;try{return t.create(e)}catch{let r=t.create(sm.INLINE);return Array.from(e.childNodes).forEach(e=>{r.domNode.appendChild(e)}),e.parentNode&&e.parentNode.replaceChild(r.domNode,e),r.attach(),r}}let sI=class e extends sA{constructor(e,t){super(e,t),this.uiNode=null,this.build()}appendChild(e){this.insertBefore(e)}attach(){super.attach(),this.children.forEach(e=>{e.attach()})}attachUI(t){null!=this.uiNode&&this.uiNode.remove(),this.uiNode=t,e.uiClass&&this.uiNode.classList.add(e.uiClass),this.uiNode.setAttribute("contenteditable","false"),this.domNode.insertBefore(this.uiNode,this.domNode.firstChild)}build(){this.children=new sN,Array.from(this.domNode.childNodes).filter(e=>e!==this.uiNode).reverse().forEach(e=>{try{let t=sC(e,this.scroll);this.insertBefore(t,this.children.head||void 0)}catch(e){if(e instanceof sb)return;throw e}})}deleteAt(e,t){if(0===e&&t===this.length())return this.remove();this.children.forEachAt(e,t,(e,t,r)=>{e.deleteAt(t,r)})}descendant(t,r=0){let[n,i]=this.children.find(r);return null==t.blotName&&t(n)||null!=t.blotName&&n instanceof t?[n,i]:n instanceof e?n.descendant(t,i):[null,-1]}descendants(t,r=0,n=Number.MAX_VALUE){let i=[],o=n;return this.children.forEachAt(r,n,(r,n,s)=>{(null==t.blotName&&t(r)||null!=t.blotName&&r instanceof t)&&i.push(r),r instanceof e&&(i=i.concat(r.descendants(t,n,o))),o-=s}),i}detach(){this.children.forEach(e=>{e.detach()}),super.detach()}enforceAllowedChildren(){let t=!1;this.children.forEach(r=>{t||this.statics.allowedChildren.some(e=>r instanceof e)||(r.statics.scope===sm.BLOCK_BLOT?(null!=r.next&&this.splitAfter(r),null!=r.prev&&this.splitAfter(r.prev),r.parent.unwrap(),t=!0):r instanceof e?r.unwrap():r.remove())})}formatAt(e,t,r,n){this.children.forEachAt(e,t,(e,t,i)=>{e.formatAt(t,i,r,n)})}insertAt(e,t,r){let[n,i]=this.children.find(e);if(n)n.insertAt(i,t,r);else{let e=null==r?this.scroll.create("text",t):this.scroll.create(t,r);this.appendChild(e)}}insertBefore(e,t){null!=e.parent&&e.parent.children.remove(e);let r=null;this.children.insertBefore(e,t||null),e.parent=this,null!=t&&(r=t.domNode),(this.domNode.parentNode!==e.domNode||this.domNode.nextSibling!==r)&&this.domNode.insertBefore(e.domNode,r),e.attach()}length(){return this.children.reduce((e,t)=>e+t.length(),0)}moveChildren(e,t){this.children.forEach(r=>{e.insertBefore(r,t)})}optimize(e){if(super.optimize(e),this.enforceAllowedChildren(),null!=this.uiNode&&this.uiNode!==this.domNode.firstChild&&this.domNode.insertBefore(this.uiNode,this.domNode.firstChild),0===this.children.length)if(null!=this.statics.defaultChild){let e=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(e)}else this.remove()}path(t,r=!1){let[n,i]=this.children.find(t,r),o=[[this,t]];return n instanceof e?o.concat(n.path(i,r)):(null!=n&&o.push([n,i]),o)}removeChild(e){this.children.remove(e)}replaceWith(t,r){let n="string"==typeof t?this.scroll.create(t,r):t;return n instanceof e&&this.moveChildren(n),super.replaceWith(n)}split(e,t=!1){if(!t){if(0===e)return this;if(e===this.length())return this.next}let r=this.clone();return this.parent&&this.parent.insertBefore(r,this.next||void 0),this.children.forEachAt(e,this.length(),(e,n,i)=>{let o=e.split(n,t);null!=o&&r.appendChild(o)}),r}splitAfter(e){let t=this.clone();for(;null!=e.next;)t.appendChild(e.next);return this.parent&&this.parent.insertBefore(t,this.next||void 0),t}unwrap(){this.parent&&this.moveChildren(this.parent,this.next||void 0),this.remove()}update(e,t){let r=[],n=[];e.forEach(e=>{e.target===this.domNode&&"childList"===e.type&&(r.push(...e.addedNodes),n.push(...e.removedNodes))}),n.forEach(e=>{if(null!=e.parentNode&&"IFRAME"!==e.tagName&&document.body.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)return;let t=this.scroll.find(e);null!=t&&(null==t.domNode.parentNode||t.domNode.parentNode===this.domNode)&&t.detach()}),r.filter(e=>e.parentNode===this.domNode&&e!==this.uiNode).sort((e,t)=>e===t?0:e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1).forEach(e=>{let t=null;null!=e.nextSibling&&(t=this.scroll.find(e.nextSibling));let r=sC(e,this.scroll);(r.next!==t||null==r.next)&&(null!=r.parent&&r.parent.removeChild(this),this.insertBefore(r,t||void 0))}),this.enforceAllowedChildren()}};sI.uiClass="";let sR=sI,sP=class e extends sR{static create(e){return super.create(e)}static formats(t,r){let n=r.query(e.blotName);if(null==n||t.tagName!==n.tagName){if("string"==typeof this.tagName)return!0;if(Array.isArray(this.tagName))return t.tagName.toLowerCase()}}constructor(e,t){super(e,t),this.attributes=new sT(this.domNode)}format(t,r){if(t!==this.statics.blotName||r){let e=this.scroll.query(t,sm.INLINE);null!=e&&(e instanceof sg?this.attributes.attribute(e,r):r&&(t!==this.statics.blotName||this.formats()[t]!==r)&&this.replaceWith(t,r))}else this.children.forEach(t=>{t instanceof e||(t=t.wrap(e.blotName,!0)),this.attributes.copy(t)}),this.unwrap()}formats(){let e=this.attributes.values(),t=this.statics.formats(this.domNode,this.scroll);return null!=t&&(e[this.statics.blotName]=t),e}formatAt(e,t,r,n){null!=this.formats()[r]||this.scroll.query(r,sm.ATTRIBUTE)?this.isolate(e,t).format(r,n):super.formatAt(e,t,r,n)}optimize(t){super.optimize(t);let r=this.formats();if(0===Object.keys(r).length)return this.unwrap();let n=this.next;n instanceof e&&n.prev===this&&function(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let r in e)if(e[r]!==t[r])return!1;return!0}(r,n.formats())&&(n.moveChildren(this),n.remove())}replaceWith(e,t){let r=super.replaceWith(e,t);return this.attributes.copy(r),r}update(e,t){super.update(e,t),e.some(e=>e.target===this.domNode&&"attributes"===e.type)&&this.attributes.build()}wrap(t,r){let n=super.wrap(t,r);return n instanceof e&&this.attributes.move(n),n}};sP.allowedChildren=[sP,sk],sP.blotName="inline",sP.scope=sm.INLINE_BLOT,sP.tagName="SPAN";let sL=sP,sD=class e extends sR{static create(e){return super.create(e)}static formats(t,r){let n=r.query(e.blotName);if(null==n||t.tagName!==n.tagName){if("string"==typeof this.tagName)return!0;if(Array.isArray(this.tagName))return t.tagName.toLowerCase()}}constructor(e,t){super(e,t),this.attributes=new sT(this.domNode)}format(t,r){let n=this.scroll.query(t,sm.BLOCK);null!=n&&(n instanceof sg?this.attributes.attribute(n,r):t!==this.statics.blotName||r?r&&(t!==this.statics.blotName||this.formats()[t]!==r)&&this.replaceWith(t,r):this.replaceWith(e.blotName))}formats(){let e=this.attributes.values(),t=this.statics.formats(this.domNode,this.scroll);return null!=t&&(e[this.statics.blotName]=t),e}formatAt(e,t,r,n){null!=this.scroll.query(r,sm.BLOCK)?this.format(r,n):super.formatAt(e,t,r,n)}insertAt(e,t,r){if(null==r||null!=this.scroll.query(t,sm.INLINE))super.insertAt(e,t,r);else{let n=this.split(e);if(null!=n){let e=this.scroll.create(t,r);n.parent.insertBefore(e,n)}else throw Error("Attempt to insertAt after block boundaries")}}replaceWith(e,t){let r=super.replaceWith(e,t);return this.attributes.copy(r),r}update(e,t){super.update(e,t),e.some(e=>e.target===this.domNode&&"attributes"===e.type)&&this.attributes.build()}};sD.blotName="block",sD.scope=sm.BLOCK_BLOT,sD.tagName="P",sD.allowedChildren=[sL,sD,sk];let sM=sD,sj=class extends sR{checkMerge(){return null!==this.next&&this.next.statics.blotName===this.statics.blotName}deleteAt(e,t){super.deleteAt(e,t),this.enforceAllowedChildren()}formatAt(e,t,r,n){super.formatAt(e,t,r,n),this.enforceAllowedChildren()}insertAt(e,t,r){super.insertAt(e,t,r),this.enforceAllowedChildren()}optimize(e){super.optimize(e),this.children.length>0&&null!=this.next&&this.checkMerge()&&(this.next.moveChildren(this),this.next.remove())}};sj.blotName="container",sj.scope=sm.BLOCK_BLOT;let sB=sj,sF=class extends sk{static formats(e,t){}format(e,t){super.formatAt(0,this.length(),e,t)}formatAt(e,t,r,n){0===e&&t===this.length()?this.format(r,n):super.formatAt(e,t,r,n)}formats(){return this.statics.formats(this.domNode,this.scroll)}},sU={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},sq=class extends sR{constructor(e,t){super(null,t),this.registry=e,this.scroll=this,this.build(),this.observer=new MutationObserver(e=>{this.update(e)}),this.observer.observe(this.domNode,sU),this.attach()}create(e,t){return this.registry.create(this,e,t)}find(e,t=!1){let r=this.registry.find(e,t);return r?r.scroll===this?r:t?this.find(r.scroll.domNode.parentNode,!0):null:null}query(e,t=sm.ANY){return this.registry.query(e,t)}register(...e){return this.registry.register(...e)}build(){null!=this.scroll&&super.build()}detach(){super.detach(),this.observer.disconnect()}deleteAt(e,t){this.update(),0===e&&t===this.length()?this.children.forEach(e=>{e.remove()}):super.deleteAt(e,t)}formatAt(e,t,r,n){this.update(),super.formatAt(e,t,r,n)}insertAt(e,t,r){this.update(),super.insertAt(e,t,r)}optimize(e=[],t={}){super.optimize(t);let r=t.mutationsMap||new WeakMap,n=Array.from(this.observer.takeRecords());for(;n.length>0;)e.push(n.pop());let i=(e,t=!0)=>{null==e||e===this||null!=e.domNode.parentNode&&(r.has(e.domNode)||r.set(e.domNode,[]),t&&i(e.parent))},o=e=>{r.has(e.domNode)&&(e instanceof sR&&e.children.forEach(o),r.delete(e.domNode),e.optimize(t))},s=e;for(let t=0;s.length>0;t+=1){if(t>=100)throw Error("[Parchment] Maximum optimize iterations reached");for(s.forEach(e=>{let t=this.find(e.target,!0);null!=t&&(t.domNode===e.target&&("childList"===e.type?(i(this.find(e.previousSibling,!1)),Array.from(e.addedNodes).forEach(e=>{let t=this.find(e,!1);i(t,!1),t instanceof sR&&t.children.forEach(e=>{i(e,!1)})})):"attributes"===e.type&&i(t.prev)),i(t))}),this.children.forEach(o),n=(s=Array.from(this.observer.takeRecords())).slice();n.length>0;)e.push(n.pop())}}update(e,t={}){e=e||this.observer.takeRecords();let r=new WeakMap;e.map(e=>{let t=this.find(e.target,!0);return null==t?null:r.has(t.domNode)?(r.get(t.domNode).push(e),null):(r.set(t.domNode,[e]),t)}).forEach(e=>{null!=e&&e!==this&&r.has(e.domNode)&&e.update(r.get(e.domNode)||[],t)}),t.mutationsMap=r,r.has(this.domNode)&&super.update(r.get(this.domNode),t),this.optimize(e,t)}};sq.blotName="scroll",sq.defaultChild=sM,sq.allowedChildren=[sM,sB],sq.scope=sm.BLOCK_BLOT,sq.tagName="DIV";let sz=sq,sH=class e extends sk{static create(e){return document.createTextNode(e)}static value(e){return e.data}constructor(e,t){super(e,t),this.text=this.statics.value(this.domNode)}deleteAt(e,t){this.domNode.data=this.text=this.text.slice(0,e)+this.text.slice(e+t)}index(e,t){return this.domNode===e?t:-1}insertAt(e,t,r){null==r?(this.text=this.text.slice(0,e)+t+this.text.slice(e),this.domNode.data=this.text):super.insertAt(e,t,r)}length(){return this.text.length}optimize(t){super.optimize(t),this.text=this.statics.value(this.domNode),0===this.text.length?this.remove():this.next instanceof e&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())}position(e,t=!1){return[this.domNode,e]}split(e,t=!1){if(!t){if(0===e)return this;if(e===this.length())return this.next}let r=this.scroll.create(this.domNode.splitText(e));return this.parent.insertBefore(r,this.next||void 0),this.text=this.statics.value(this.domNode),r}update(e,t){e.some(e=>"characterData"===e.type&&e.target===this.domNode)&&(this.text=this.statics.value(this.domNode))}value(){return this.text}};sH.blotName="text",sH.scope=sm.INLINE_BLOT;let sX=sH;var sV=r(9228);let s$=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e};var sK=oO(Object.keys,Object),sW=Object.prototype.hasOwnProperty;let sG=function(e){if(!ok(e))return sK(e);var t=[];for(var r in Object(e))sW.call(e,r)&&"constructor"!=r&&t.push(r);return t},sY=function(e){return oB(e)?se(e):sG(e)},sZ=function(e,t){for(var r=-1,n=null==e?0:e.length,i=0,o=[];++r<n;){var s=e[r];t(s,r,e)&&(o[i++]=s)}return o},sJ=function(){return[]};var sQ=Object.prototype.propertyIsEnumerable,s0=Object.getOwnPropertySymbols,s1=s0?function(e){return null==e?[]:sZ(s0(e=Object(e)),function(t){return sQ.call(e,t)})}:sJ;let s2=function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e};var s5=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)s2(t,s1(e)),e=oA(e);return t}:sJ;let s3=function(e,t,r){var n=t(e);return oM(e)?n:s2(n,r(e))},s4=function(e){return s3(e,sY,s1)},s6=function(e){return s3(e,si,s5)};var s8=oe(iz,"DataView"),s9=oe(iz,"Promise"),s7=oe(iz,"Set"),ae=oe(iz,"WeakMap"),at="[object Map]",ar="[object Promise]",an="[object Set]",ai="[object WeakMap]",ao="[object DataView]",as=i5(s8),aa=i5(ot),al=i5(s9),ac=i5(s7),au=i5(ae),ad=iZ;(s8&&ad(new s8(new ArrayBuffer(1)))!=ao||ot&&ad(new ot)!=at||s9&&ad(s9.resolve())!=ar||s7&&ad(new s7)!=an||ae&&ad(new ae)!=ai)&&(ad=function(e){var t=iZ(e),r="[object Object]"==t?e.constructor:void 0,n=r?i5(r):"";if(n)switch(n){case as:return ao;case aa:return at;case al:return ar;case ac:return an;case au:return ai}return t});let ah=ad;var ap=Object.prototype.hasOwnProperty;let af=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&ap.call(e,"index")&&(r.index=e.index,r.input=e.input),r},am=function(e,t){var r=t?ow(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)};var ag=/\w*$/;let ab=function(e){var t=new e.constructor(e.source,ag.exec(e));return t.lastIndex=e.lastIndex,t};var av=iH?iH.prototype:void 0,ay=av?av.valueOf:void 0;let aw=function(e,t,r){var n=e.constructor;switch(t){case"[object ArrayBuffer]":return ow(e);case"[object Boolean]":case"[object Date]":return new n(+e);case"[object DataView]":return am(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return ox(e,r);case"[object Map]":case"[object Set]":return new n;case"[object Number]":case"[object String]":return new n(e);case"[object RegExp]":return ab(e);case"[object Symbol]":return ay?Object(ay.call(e)):{}}};var ax=oQ&&oQ.isMap,aE=ax?oG(ax):function(e){return oC(e)&&"[object Map]"==ah(e)},a_=oQ&&oQ.isSet,aT=a_?oG(a_):function(e){return oC(e)&&"[object Set]"==ah(e)},aO="[object Arguments]",aA="[object Function]",aS="[object Object]",ak={};ak[aO]=ak["[object Array]"]=ak["[object ArrayBuffer]"]=ak["[object DataView]"]=ak["[object Boolean]"]=ak["[object Date]"]=ak["[object Float32Array]"]=ak["[object Float64Array]"]=ak["[object Int8Array]"]=ak["[object Int16Array]"]=ak["[object Int32Array]"]=ak["[object Map]"]=ak["[object Number]"]=ak[aS]=ak["[object RegExp]"]=ak["[object Set]"]=ak["[object String]"]=ak["[object Symbol]"]=ak["[object Uint8Array]"]=ak["[object Uint8ClampedArray]"]=ak["[object Uint16Array]"]=ak["[object Uint32Array]"]=!0,ak["[object Error]"]=ak[aA]=ak["[object WeakMap]"]=!1;let aN=function e(t,r,n,i,o,s){var a,l=1&r,c=2&r,u=4&r;if(n&&(a=o?n(t,i,o,s):n(t)),void 0!==a)return a;if(!iJ(t))return t;var d=oM(t);if(d){if(a=af(t),!l)return oE(t,a)}else{var h,p,f,g,b=ah(t),v=b==aA||"[object GeneratorFunction]"==b;if(oz(t))return ov(t,l);if(b==aS||b==aO||v&&!o){if(a=c||v?{}:oN(t),!l)return c?(p=(h=a)&&o4(t,si(t),h),o4(t,s5(t),p)):(g=(f=a)&&o4(t,sY(t),f),o4(t,s1(t),g))}else{if(!ak[b])return o?t:{};a=aw(t,b,l)}}s||(s=new oc);var y=s.get(t);if(y)return y;s.set(t,a),aT(t)?t.forEach(function(i){a.add(e(i,r,n,i,t,s))}):aE(t)&&t.forEach(function(i,o){a.set(o,e(i,r,n,o,t,s))});var w=u?c?s6:s4:c?si:sY,x=d?void 0:w(t);return s$(x||t,function(i,o){x&&(i=t[o=i]),o3(a,o,e(i,r,n,o,t,s))}),a},aC=function(e){return aN(e,5)};function aI(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new ol;++t<r;)this.add(e[t])}aI.prototype.add=aI.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},aI.prototype.has=function(e){return this.__data__.has(e)};let aR=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1},aP=function(e,t,r,n,i,o){var s=1&r,a=e.length,l=t.length;if(a!=l&&!(s&&l>a))return!1;var c=o.get(e),u=o.get(t);if(c&&u)return c==t&&u==e;var d=-1,h=!0,p=2&r?new aI:void 0;for(o.set(e,t),o.set(t,e);++d<a;){var f=e[d],g=t[d];if(n)var b=s?n(g,f,d,t,e,o):n(f,g,d,e,t,o);if(void 0!==b){if(b)continue;h=!1;break}if(p){if(!aR(t,function(e,t){if(!p.has(t)&&(f===e||i(f,e,r,n,o)))return p.push(t)})){h=!1;break}}else if(!(f===g||i(f,g,r,n,o))){h=!1;break}}return o.delete(e),o.delete(t),h},aL=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e,n){r[++t]=[n,e]}),r},aD=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r};var aM=iH?iH.prototype:void 0,aj=aM?aM.valueOf:void 0;let aB=function(e,t,r,n,i,o,s){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)break;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":if(e.byteLength!=t.byteLength||!o(new oy(e),new oy(t)))break;return!0;case"[object Boolean]":case"[object Date]":case"[object Number]":return iM(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var a=aL;case"[object Set]":var l=1&n;if(a||(a=aD),e.size!=t.size&&!l)break;var c=s.get(e);if(c)return c==t;n|=2,s.set(e,t);var u=aP(a(e),a(t),n,i,o,s);return s.delete(e),u;case"[object Symbol]":if(aj)return aj.call(e)==aj.call(t)}return!1};var aF=Object.prototype.hasOwnProperty;let aU=function(e,t,r,n,i,o){var s=1&r,a=s4(e),l=a.length;if(l!=s4(t).length&&!s)return!1;for(var c=l;c--;){var u=a[c];if(!(s?u in t:aF.call(t,u)))return!1}var d=o.get(e),h=o.get(t);if(d&&h)return d==t&&h==e;var p=!0;o.set(e,t),o.set(t,e);for(var f=s;++c<l;){var g=e[u=a[c]],b=t[u];if(n)var v=s?n(b,g,u,t,e,o):n(g,b,u,e,t,o);if(!(void 0===v?g===b||i(g,b,r,n,o):v)){p=!1;break}f||(f="constructor"==u)}if(p&&!f){var y=e.constructor,w=t.constructor;y!=w&&"constructor"in e&&"constructor"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof w&&w instanceof w)&&(p=!1)}return o.delete(e),o.delete(t),p};var aq="[object Arguments]",az="[object Array]",aH="[object Object]",aX=Object.prototype.hasOwnProperty;let aV=function(e,t,r,n,i,o){var s=oM(e),a=oM(t),l=s?az:ah(e),c=a?az:ah(t);l=l==aq?aH:l,c=c==aq?aH:c;var u=l==aH,d=c==aH,h=l==c;if(h&&oz(e)){if(!oz(t))return!1;s=!0,u=!1}if(h&&!u)return o||(o=new oc),s||o1(e)?aP(e,t,r,n,i,o):aB(e,t,l,r,n,i,o);if(!(1&r)){var p=u&&aX.call(e,"__wrapped__"),f=d&&aX.call(t,"__wrapped__");if(p||f){var g=p?e.value():e,b=f?t.value():t;return o||(o=new oc),i(g,b,r,n,o)}}return!!h&&(o||(o=new oc),aU(e,t,r,n,i,o))},a$=function(e,t){return function e(t,r,n,i,o){return t===r||(null!=t&&null!=r&&(oC(t)||oC(r))?aV(t,r,n,i,e,o):t!=t&&r!=r)}(e,t)};class aK extends sF{static value(){}optimize(){(this.prev||this.next)&&this.remove()}length(){return 0}value(){return""}}aK.blotName="break",aK.tagName="BR";class aW extends sX{}let aG={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function aY(e){return e.replace(/[&<>"']/g,e=>aG[e])}class aZ extends sL{static allowedChildren=[aZ,aK,sF,aW];static order=["cursor","inline","link","underline","strike","italic","bold","script","code"];static compare(e,t){let r=aZ.order.indexOf(e),n=aZ.order.indexOf(t);return r>=0||n>=0?r-n:e===t?0:e<t?-1:1}formatAt(e,t,r,n){if(0>aZ.compare(this.statics.blotName,r)&&this.scroll.query(r,sm.BLOT)){let i=this.isolate(e,t);n&&i.wrap(r,n)}else super.formatAt(e,t,r,n)}optimize(e){if(super.optimize(e),this.parent instanceof aZ&&aZ.compare(this.statics.blotName,this.parent.statics.blotName)>0){let e=this.parent.isolate(this.offset(),this.length());this.moveChildren(e),e.wrap(this)}}}let aJ=aZ;class aQ extends sM{cache={};delta(){return null==this.cache.delta&&(this.cache.delta=a1(this)),this.cache.delta}deleteAt(e,t){super.deleteAt(e,t),this.cache={}}formatAt(e,t,r,n){t<=0||(this.scroll.query(r,sm.BLOCK)?e+t===this.length()&&this.format(r,n):super.formatAt(e,Math.min(t,this.length()-e-1),r,n),this.cache={})}insertAt(e,t,r){if(null!=r){super.insertAt(e,t,r),this.cache={};return}if(0===t.length)return;let n=t.split("\n"),i=n.shift();i.length>0&&(e<this.length()-1||null==this.children.tail?super.insertAt(Math.min(e,this.length()-1),i):this.children.tail.insertAt(this.children.tail.length(),i),this.cache={});let o=this;n.reduce((e,t)=>((o=o.split(e,!0)).insertAt(0,t),t.length),e+i.length)}insertBefore(e,t){let{head:r}=this.children;super.insertBefore(e,t),r instanceof aK&&r.remove(),this.cache={}}length(){return null==this.cache.length&&(this.cache.length=super.length()+1),this.cache.length}moveChildren(e,t){super.moveChildren(e,t),this.cache={}}optimize(e){super.optimize(e),this.cache={}}path(e){return super.path(e,!0)}removeChild(e){super.removeChild(e),this.cache={}}split(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t&&(0===e||e>=this.length()-1)){let t=this.clone();return 0===e?(this.parent.insertBefore(t,this),this):(this.parent.insertBefore(t,this.next),t)}let r=super.split(e,t);return this.cache={},r}}aQ.blotName="block",aQ.tagName="P",aQ.defaultChild=aK,aQ.allowedChildren=[aK,aJ,sF,aW];class a0 extends sF{attach(){super.attach(),this.attributes=new sT(this.domNode)}delta(){return new sV().insert(this.value(),{...this.formats(),...this.attributes.values()})}format(e,t){let r=this.scroll.query(e,sm.BLOCK_ATTRIBUTE);null!=r&&this.attributes.attribute(r,t)}formatAt(e,t,r,n){this.format(r,n)}insertAt(e,t,r){if(null!=r)return void super.insertAt(e,t,r);let n=t.split("\n"),i=n.pop(),o=n.map(e=>{let t=this.scroll.create(aQ.blotName);return t.insertAt(0,e),t}),s=this.split(e);o.forEach(e=>{this.parent.insertBefore(e,s)}),i&&this.parent.insertBefore(this.scroll.create("text",i),s)}}function a1(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return e.descendants(sk).reduce((e,r)=>0===r.length()?e:e.insert(r.value(),a2(r,{},t)),new sV).insert("\n",a2(e))}function a2(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=!(arguments.length>2)||void 0===arguments[2]||arguments[2];return null==e||("formats"in e&&"function"==typeof e.formats&&(t={...t,...e.formats()},r&&delete t["code-token"]),null==e.parent||"scroll"===e.parent.statics.blotName||e.parent.statics.scope!==e.statics.scope)?t:a2(e.parent,t,r)}a0.scope=sm.BLOCK_BLOT;class a5 extends sF{static blotName="cursor";static className="ql-cursor";static tagName="span";static CONTENTS="\uFEFF";static value(){}constructor(e,t,r){super(e,t),this.selection=r,this.textNode=document.createTextNode(a5.CONTENTS),this.domNode.appendChild(this.textNode),this.savedLength=0}detach(){null!=this.parent&&this.parent.removeChild(this)}format(e,t){if(0!==this.savedLength)return void super.format(e,t);let r=this,n=0;for(;null!=r&&r.statics.scope!==sm.BLOCK_BLOT;)n+=r.offset(r.parent),r=r.parent;null!=r&&(this.savedLength=a5.CONTENTS.length,r.optimize(),r.formatAt(n,a5.CONTENTS.length,e,t),this.savedLength=0)}index(e,t){return e===this.textNode?0:super.index(e,t)}length(){return this.savedLength}position(){return[this.textNode,this.textNode.data.length]}remove(){super.remove(),this.parent=null}restore(){let e;if(this.selection.composing||null==this.parent)return null;let t=this.selection.getNativeRange();for(;null!=this.domNode.lastChild&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);let r=this.prev instanceof aW?this.prev:null,n=r?r.length():0,i=this.next instanceof aW?this.next:null,o=i?i.text:"",{textNode:s}=this,a=s.data.split(a5.CONTENTS).join("");if(s.data=a5.CONTENTS,r)e=r,(a||i)&&(r.insertAt(r.length(),a+o),i&&i.remove());else if(i)e=i,i.insertAt(0,a);else{let t=document.createTextNode(a);e=this.scroll.create(t),this.parent.insertBefore(e,this)}if(this.remove(),t){let o=(e,t)=>r&&e===r.domNode?t:e===s?n+t-1:i&&e===i.domNode?n+a.length+t:null,l=o(t.start.node,t.start.offset),c=o(t.end.node,t.end.offset);if(null!==l&&null!==c)return{startNode:e.domNode,startOffset:l,endNode:e.domNode,endOffset:c}}return null}update(e,t){if(e.some(e=>"characterData"===e.type&&e.target===this.textNode)){let e=this.restore();e&&(t.range=e)}}optimize(e){super.optimize(e);let{parent:t}=this;for(;t;){if("A"===t.domNode.tagName){this.savedLength=a5.CONTENTS.length,t.isolate(this.offset(t),this.length()).unwrap(),this.savedLength=0;break}t=t.parent}}value(){return""}}var a3=r(1343),a4=r.n(a3);let a6=new WeakMap,a8=["error","warn","log","info"],a9="warn";function a7(e){if(a9&&a8.indexOf(e)<=a8.indexOf(a9)){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];console[e](...r)}}function le(e){return a8.reduce((t,r)=>(t[r]=a7.bind(console,r,e),t),{})}le.level=e=>{a9=e},a7.level=le.level;let lt=le("quill:events");["selectionchange","mousedown","mouseup","click"].forEach(e=>{document.addEventListener(e,function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];Array.from(document.querySelectorAll(".ql-container")).forEach(e=>{let r=a6.get(e);r&&r.emitter&&r.emitter.handleDOM(...t)})})});class lr extends a4(){static events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_BLOT_MOUNT:"scroll-blot-mount",SCROLL_BLOT_UNMOUNT:"scroll-blot-unmount",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SCROLL_EMBED_UPDATE:"scroll-embed-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change",COMPOSITION_BEFORE_START:"composition-before-start",COMPOSITION_START:"composition-start",COMPOSITION_BEFORE_END:"composition-before-end",COMPOSITION_END:"composition-end"};static sources={API:"api",SILENT:"silent",USER:"user"};constructor(){super(),this.domListeners={},this.on("error",lt.error)}emit(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return lt.log.call(lt,...t),super.emit(...t)}handleDOM(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];(this.domListeners[e.type]||[]).forEach(t=>{let{node:n,handler:i}=t;(e.target===n||n.contains(e.target))&&i(e,...r)})}listenDOM(e,t,r){this.domListeners[e]||(this.domListeners[e]=[]),this.domListeners[e].push({node:t,handler:r})}}let ln=le("quill:selection");class li{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.index=e,this.length=t}}function lo(e,t){try{t.parentNode}catch(e){return!1}return e.contains(t)}let ls=class{constructor(e,t){this.emitter=t,this.scroll=e,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=this.scroll.create("cursor",this),this.savedRange=new li(0,0),this.lastRange=this.savedRange,this.lastNative=null,this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,()=>{this.mouseDown||this.composing||setTimeout(this.update.bind(this,lr.sources.USER),1)}),this.emitter.on(lr.events.SCROLL_BEFORE_UPDATE,()=>{if(!this.hasFocus())return;let e=this.getNativeRange();null!=e&&e.start.node!==this.cursor.textNode&&this.emitter.once(lr.events.SCROLL_UPDATE,(t,r)=>{try{this.root.contains(e.start.node)&&this.root.contains(e.end.node)&&this.setNativeRange(e.start.node,e.start.offset,e.end.node,e.end.offset);let n=r.some(e=>"characterData"===e.type||"childList"===e.type||"attributes"===e.type&&e.target===this.root);this.update(n?lr.sources.SILENT:t)}catch(e){}})}),this.emitter.on(lr.events.SCROLL_OPTIMIZE,(e,t)=>{if(t.range){let{startNode:e,startOffset:r,endNode:n,endOffset:i}=t.range;this.setNativeRange(e,r,n,i),this.update(lr.sources.SILENT)}}),this.update(lr.sources.SILENT)}handleComposition(){this.emitter.on(lr.events.COMPOSITION_BEFORE_START,()=>{this.composing=!0}),this.emitter.on(lr.events.COMPOSITION_END,()=>{if(this.composing=!1,this.cursor.parent){let e=this.cursor.restore();e&&setTimeout(()=>{this.setNativeRange(e.startNode,e.startOffset,e.endNode,e.endOffset)},1)}})}handleDragging(){this.emitter.listenDOM("mousedown",document.body,()=>{this.mouseDown=!0}),this.emitter.listenDOM("mouseup",document.body,()=>{this.mouseDown=!1,this.update(lr.sources.USER)})}focus(){this.hasFocus()||(this.root.focus({preventScroll:!0}),this.setRange(this.savedRange))}format(e,t){this.scroll.update();let r=this.getNativeRange();if(!(null==r||!r.native.collapsed||this.scroll.query(e,sm.BLOCK))){if(r.start.node!==this.cursor.textNode){let e=this.scroll.find(r.start.node,!1);if(null==e)return;if(e instanceof sk){let t=e.split(r.start.offset);e.parent.insertBefore(this.cursor,t)}else e.insertBefore(this.cursor,r.start.node);this.cursor.attach()}this.cursor.format(e,t),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}getBounds(e){let t,r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this.scroll.length();n=Math.min((e=Math.min(e,i-1))+n,i-1)-e;let[o,s]=this.scroll.leaf(e);if(null==o)return null;if(n>0&&s===o.length()){let[t]=this.scroll.leaf(e+1);if(t){let[r]=this.scroll.line(e),[n]=this.scroll.line(e+1);r===n&&(o=t,s=0)}}[t,s]=o.position(s,!0);let a=document.createRange();if(n>0)return(a.setStart(t,s),[o,s]=this.scroll.leaf(e+n),null==o)?null:([t,s]=o.position(s,!0),a.setEnd(t,s),a.getBoundingClientRect());let l="left";if(t instanceof Text){if(!t.data.length)return null;s<t.data.length?(a.setStart(t,s),a.setEnd(t,s+1)):(a.setStart(t,s-1),a.setEnd(t,s),l="right"),r=a.getBoundingClientRect()}else{if(!(o.domNode instanceof Element))return null;r=o.domNode.getBoundingClientRect(),s>0&&(l="right")}return{bottom:r.top+r.height,height:r.height,left:r[l],right:r[l],top:r.top,width:0}}getNativeRange(){let e=document.getSelection();if(null==e||e.rangeCount<=0)return null;let t=e.getRangeAt(0);if(null==t)return null;let r=this.normalizeNative(t);return ln.info("getNativeRange",r),r}getRange(){let e=this.scroll.domNode;if("isConnected"in e&&!e.isConnected)return[null,null];let t=this.getNativeRange();return null==t?[null,null]:[this.normalizedToRange(t),t]}hasFocus(){return document.activeElement===this.root||null!=document.activeElement&&lo(this.root,document.activeElement)}normalizedToRange(e){let t=[[e.start.node,e.start.offset]];e.native.collapsed||t.push([e.end.node,e.end.offset]);let r=t.map(e=>{let[t,r]=e,n=this.scroll.find(t,!0),i=n.offset(this.scroll);return 0===r?i:n instanceof sk?i+n.index(t,r):i+n.length()}),n=Math.min(Math.max(...r),this.scroll.length()-1),i=Math.min(n,...r);return new li(i,n-i)}normalizeNative(e){if(!lo(this.root,e.startContainer)||!e.collapsed&&!lo(this.root,e.endContainer))return null;let t={start:{node:e.startContainer,offset:e.startOffset},end:{node:e.endContainer,offset:e.endOffset},native:e};return[t.start,t.end].forEach(e=>{let{node:t,offset:r}=e;for(;!(t instanceof Text)&&t.childNodes.length>0;)if(t.childNodes.length>r)t=t.childNodes[r],r=0;else if(t.childNodes.length===r)r=(t=t.lastChild)instanceof Text?t.data.length:t.childNodes.length>0?t.childNodes.length:t.childNodes.length+1;else break;e.node=t,e.offset=r}),t}rangeToNative(e){let t=this.scroll.length(),r=(e,r)=>{e=Math.min(t-1,e);let[n,i]=this.scroll.leaf(e);return n?n.position(i,r):[null,-1]};return[...r(e.index,!1),...r(e.index+e.length,!0)]}setNativeRange(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(ln.info("setNativeRange",e,t,r,n),null!=e&&(null==this.root.parentNode||null==e.parentNode||null==r.parentNode))return;let o=document.getSelection();if(null!=o)if(null!=e){this.hasFocus()||this.root.focus({preventScroll:!0});let{native:s}=this.getNativeRange()||{};if(null==s||i||e!==s.startContainer||t!==s.startOffset||r!==s.endContainer||n!==s.endOffset){e instanceof Element&&"BR"===e.tagName&&(t=Array.from(e.parentNode.childNodes).indexOf(e),e=e.parentNode),r instanceof Element&&"BR"===r.tagName&&(n=Array.from(r.parentNode.childNodes).indexOf(r),r=r.parentNode);let i=document.createRange();i.setStart(e,t),i.setEnd(r,n),o.removeAllRanges(),o.addRange(i)}}else o.removeAllRanges(),this.root.blur()}setRange(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:lr.sources.API;if("string"==typeof t&&(r=t,t=!1),ln.info("setRange",e),null!=e){let r=this.rangeToNative(e);this.setNativeRange(...r,t)}else this.setNativeRange(null);this.update(r)}update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lr.sources.USER,t=this.lastRange,[r,n]=this.getRange();if(this.lastRange=r,this.lastNative=n,null!=this.lastRange&&(this.savedRange=this.lastRange),!a$(t,this.lastRange)){if(!this.composing&&null!=n&&n.native.collapsed&&n.start.node!==this.cursor.textNode){let e=this.cursor.restore();e&&this.setNativeRange(e.startNode,e.startOffset,e.endNode,e.endOffset)}let r=[lr.events.SELECTION_CHANGE,aC(this.lastRange),aC(t),e];this.emitter.emit(lr.events.EDITOR_CHANGE,...r),e!==lr.sources.SILENT&&this.emitter.emit(...r)}}},la=/^[ -~]*$/;function ll(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if("html"in e&&"function"==typeof e.html)return e.html(t,r);if(e instanceof aW)return aY(e.value().slice(t,t+r)).replaceAll(" ","&nbsp;");if(e instanceof sR){if("list-container"===e.statics.blotName){let n=[];return e.children.forEachAt(t,r,(e,t,r)=>{let i="formats"in e&&"function"==typeof e.formats?e.formats():{};n.push({child:e,offset:t,length:r,indent:i.indent||0,type:i.list})}),function e(t,r,n){if(0===t.length){let[t]=lc(n.pop());return r<=0?`</li></${t}>`:`</li></${t}>${e([],r-1,n)}`}let[{child:i,offset:o,length:s,indent:a,type:l},...c]=t,[u,d]=lc(l);if(a>r)return(n.push(l),a===r+1)?`<${u}><li${d}>${ll(i,o,s)}${e(c,a,n)}`:`<${u}><li>${e(t,r+1,n)}`;let h=n[n.length-1];if(a===r&&l===h)return`</li><li${d}>${ll(i,o,s)}${e(c,a,n)}`;let[p]=lc(n.pop());return`</li></${p}>${e(t,r-1,n)}`}(n,-1,[])}let i=[];if(e.children.forEachAt(t,r,(e,t,r)=>{i.push(ll(e,t,r))}),n||"list"===e.statics.blotName)return i.join("");let{outerHTML:o,innerHTML:s}=e.domNode,[a,l]=o.split(`>${s}<`);return"<table"===a?`<table style="border: 1px solid #000;">${i.join("")}<${l}`:`${a}>${i.join("")}<${l}`}return e.domNode instanceof Element?e.domNode.outerHTML:""}function lc(e){let t="ordered"===e?"ol":"ul";switch(e){case"checked":return[t,' data-list="checked"'];case"unchecked":return[t,' data-list="unchecked"'];default:return[t,""]}}function lu(e){return e.reduce((e,t)=>{if("string"==typeof t.insert){let r=t.insert.replace(/\r\n/g,"\n").replace(/\r/g,"\n");return e.insert(r,t.attributes)}return e.push(t)},new sV)}function ld(e,t){let{index:r,length:n}=e;return new li(r+t,n)}let lh=class{constructor(e){this.scroll=e,this.delta=this.getDelta()}applyDelta(e){this.scroll.update();let t=this.scroll.length();this.scroll.batchStart();let r=lu(e),n=new sV;return(function(e){let t=[];return e.forEach(e=>{"string"==typeof e.insert?e.insert.split("\n").forEach((r,n)=>{n&&t.push({insert:"\n",attributes:e.attributes}),r&&t.push({insert:r,attributes:e.attributes})}):t.push(e)}),t})(r.ops.slice()).reduce((e,r)=>{let i=sV.Op.length(r),o=r.attributes||{},s=!1,a=!1;if(null!=r.insert){if(n.retain(i),"string"==typeof r.insert){let n=r.insert;a=!n.endsWith("\n")&&(t<=e||!!this.scroll.descendant(a0,e)[0]),this.scroll.insertAt(e,n);let[i,s]=this.scroll.line(e),l=sf({},a2(i));if(i instanceof aQ){let[e]=i.descendant(sk,s);e&&(l=sf(l,a2(e)))}o=sV.AttributeMap.diff(l,o)||{}}else if("object"==typeof r.insert){let n=Object.keys(r.insert)[0];if(null==n)return e;let i=null!=this.scroll.query(n,sm.INLINE);if(i)(t<=e||this.scroll.descendant(a0,e)[0])&&(a=!0);else if(e>0){let[t,r]=this.scroll.descendant(sk,e-1);t instanceof aW?"\n"!==t.value()[r]&&(s=!0):t instanceof sF&&t.statics.scope===sm.INLINE_BLOT&&(s=!0)}if(this.scroll.insertAt(e,n,r.insert[n]),i){let[t]=this.scroll.descendant(sk,e);if(t){let e=sf({},a2(t));o=sV.AttributeMap.diff(e,o)||{}}}}t+=i}else if(n.push(r),null!==r.retain&&"object"==typeof r.retain){let t=Object.keys(r.retain)[0];if(null==t)return e;this.scroll.updateEmbedAt(e,t,r.retain[t])}Object.keys(o).forEach(t=>{this.scroll.formatAt(e,i,t,o[t])});let l=+!!s,c=+!!a;return t+=l+c,n.retain(l),n.delete(c),e+i+l+c},0),n.reduce((e,t)=>"number"==typeof t.delete?(this.scroll.deleteAt(e,t.delete),e):e+sV.Op.length(t),0),this.scroll.batchEnd(),this.scroll.optimize(),this.update(r)}deleteText(e,t){return this.scroll.deleteAt(e,t),this.update(new sV().retain(e).delete(t))}formatLine(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.scroll.update(),Object.keys(r).forEach(n=>{this.scroll.lines(e,Math.max(t,1)).forEach(e=>{e.format(n,r[n])})}),this.scroll.optimize();let n=new sV().retain(e).retain(t,aC(r));return this.update(n)}formatText(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.keys(r).forEach(n=>{this.scroll.formatAt(e,t,n,r[n])});let n=new sV().retain(e).retain(t,aC(r));return this.update(n)}getContents(e,t){return this.delta.slice(e,e+t)}getDelta(){return this.scroll.lines().reduce((e,t)=>e.concat(t.delta()),new sV)}getFormat(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=[],n=[];0===t?this.scroll.path(e).forEach(e=>{let[t]=e;t instanceof aQ?r.push(t):t instanceof sk&&n.push(t)}):(r=this.scroll.lines(e,t),n=this.scroll.descendants(sk,e,t));let[i,o]=[r,n].map(e=>{let t=e.shift();if(null==t)return{};let r=a2(t);for(;Object.keys(r).length>0;){let t=e.shift();if(null==t)break;r=function(e,t){return Object.keys(t).reduce((r,n)=>{if(null==e[n])return r;let i=t[n];return i===e[n]?r[n]=i:Array.isArray(i)?0>i.indexOf(e[n])?r[n]=i.concat([e[n]]):r[n]=i:r[n]=[i,e[n]],r},{})}(a2(t),r)}return r});return{...i,...o}}getHTML(e,t){let[r,n]=this.scroll.line(e);if(r){let i=r.length();return r.length()>=n+t&&(0!==n||t!==i)?ll(r,n,t,!0):ll(this.scroll,e,t,!0)}return""}getText(e,t){return this.getContents(e,t).filter(e=>"string"==typeof e.insert).map(e=>e.insert).join("")}insertContents(e,t){let r=lu(t),n=new sV().retain(e).concat(r);return this.scroll.insertContents(e,r),this.update(n)}insertEmbed(e,t,r){return this.scroll.insertAt(e,t,r),this.update(new sV().retain(e).insert({[t]:r}))}insertText(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t=t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),this.scroll.insertAt(e,t),Object.keys(r).forEach(n=>{this.scroll.formatAt(e,t.length,n,r[n])}),this.update(new sV().retain(e).insert(t,aC(r)))}isBlank(){if(0===this.scroll.children.length)return!0;if(this.scroll.children.length>1)return!1;let e=this.scroll.children.head;return e?.statics.blotName===aQ.blotName&&!(e.children.length>1)&&e.children.head instanceof aK}removeFormat(e,t){let r=this.getText(e,t),[n,i]=this.scroll.line(e+t),o=0,s=new sV;null!=n&&(o=n.length()-i,s=n.delta().slice(i,i+o-1).insert("\n"));let a=this.getContents(e,t+o).diff(new sV().insert(r).concat(s)),l=new sV().retain(e).concat(a);return this.applyDelta(l)}update(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,n=this.delta;if(1===t.length&&"characterData"===t[0].type&&t[0].target.data.match(la)&&this.scroll.find(t[0].target)){let i=this.scroll.find(t[0].target),o=a2(i),s=i.offset(this.scroll),a=t[0].oldValue.replace(a5.CONTENTS,""),l=new sV().insert(a),c=new sV().insert(i.value()),u=r&&{oldRange:ld(r.oldRange,-s),newRange:ld(r.newRange,-s)};e=new sV().retain(s).concat(l.diff(c,u)).reduce((e,t)=>t.insert?e.insert(t.insert,o):e.push(t),new sV),this.delta=n.compose(e)}else this.delta=this.getDelta(),e&&a$(n.compose(e),this.delta)||(e=n.diff(this.delta,r));return e}},lp=class{static DEFAULTS={};constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.quill=e,this.options=t}},lf=class extends sF{constructor(e,t){super(e,t),this.contentNode=document.createElement("span"),this.contentNode.setAttribute("contenteditable","false"),Array.from(this.domNode.childNodes).forEach(e=>{this.contentNode.appendChild(e)}),this.leftGuard=document.createTextNode("\uFEFF"),this.rightGuard=document.createTextNode("\uFEFF"),this.domNode.appendChild(this.leftGuard),this.domNode.appendChild(this.contentNode),this.domNode.appendChild(this.rightGuard)}index(e,t){return e===this.leftGuard?0:e===this.rightGuard?1:super.index(e,t)}restore(e){let t,r=null,n=e.data.split("\uFEFF").join("");if(e===this.leftGuard)if(this.prev instanceof aW){let e=this.prev.length();this.prev.insertAt(e,n),r={startNode:this.prev.domNode,startOffset:e+n.length}}else t=document.createTextNode(n),this.parent.insertBefore(this.scroll.create(t),this),r={startNode:t,startOffset:n.length};else e===this.rightGuard&&(this.next instanceof aW?(this.next.insertAt(0,n),r={startNode:this.next.domNode,startOffset:n.length}):(t=document.createTextNode(n),this.parent.insertBefore(this.scroll.create(t),this.next),r={startNode:t,startOffset:n.length}));return e.data="\uFEFF",r}update(e,t){e.forEach(e=>{if("characterData"===e.type&&(e.target===this.leftGuard||e.target===this.rightGuard)){let r=this.restore(e.target);r&&(t.range=r)}})}},lm=class{isComposing=!1;constructor(e,t){this.scroll=e,this.emitter=t,this.setupListeners()}setupListeners(){this.scroll.domNode.addEventListener("compositionstart",e=>{this.isComposing||this.handleCompositionStart(e)}),this.scroll.domNode.addEventListener("compositionend",e=>{this.isComposing&&queueMicrotask(()=>{this.handleCompositionEnd(e)})})}handleCompositionStart(e){let t=e.target instanceof Node?this.scroll.find(e.target,!0):null;!t||t instanceof lf||(this.emitter.emit(lr.events.COMPOSITION_BEFORE_START,e),this.scroll.batchStart(),this.emitter.emit(lr.events.COMPOSITION_START,e),this.isComposing=!0)}handleCompositionEnd(e){this.emitter.emit(lr.events.COMPOSITION_BEFORE_END,e),this.scroll.batchEnd(),this.emitter.emit(lr.events.COMPOSITION_END,e),this.isComposing=!1}};class lg{static DEFAULTS={modules:{}};static themes={default:lg};modules={};constructor(e,t){this.quill=e,this.options=t}init(){Object.keys(this.options.modules).forEach(e=>{null==this.modules[e]&&this.addModule(e)})}addModule(e){let t=this.quill.constructor.import(`modules/${e}`);return this.modules[e]=new t(this.quill,this.options.modules[e]||{}),this.modules[e]}}let lb=lg,lv=e=>e.parentElement||e.getRootNode().host||null,ly=e=>{let t=e.getBoundingClientRect(),r="offsetWidth"in e&&Math.abs(t.width)/e.offsetWidth||1,n="offsetHeight"in e&&Math.abs(t.height)/e.offsetHeight||1;return{top:t.top,right:t.left+e.clientWidth*r,bottom:t.top+e.clientHeight*n,left:t.left}},lw=e=>{let t=parseInt(e,10);return Number.isNaN(t)?0:t},lx=(e,t,r,n,i,o)=>e<r&&t>n?0:e<r?-(r-e+i):t>n?t-e>n-r?e+i-r:t-n+o:0,lE=["block","break","cursor","inline","scroll","text"],l_=le("quill"),lT=new sy;sR.uiClass="ql-ui";class lO{static DEFAULTS={bounds:null,modules:{clipboard:!0,keyboard:!0,history:!0,uploader:!0},placeholder:"",readOnly:!1,registry:lT,theme:"default"};static events=lr.events;static sources=lr.sources;static version="2.0.3";static imports={delta:sV,parchment:i,"core/module":lp,"core/theme":lb};static debug(e){!0===e&&(e="log"),le.level(e)}static find(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return a6.get(e)||lT.find(e,t)}static import(e){return null==this.imports[e]&&l_.error(`Cannot import ${e}. Are you sure it was registered?`),this.imports[e]}static register(){if("string"!=typeof(arguments.length<=0?void 0:arguments[0])){let e=arguments.length<=0?void 0:arguments[0],t=!!(arguments.length<=1?void 0:arguments[1]),r="attrName"in e?e.attrName:e.blotName;"string"==typeof r?this.register(`formats/${r}`,e,t):Object.keys(e).forEach(r=>{this.register(r,e[r],t)})}else{let e=arguments.length<=0?void 0:arguments[0],t=arguments.length<=1?void 0:arguments[1],r=!!(arguments.length<=2?void 0:arguments[2]);null==this.imports[e]||r||l_.warn(`Overwriting ${e} with`,t),this.imports[e]=t,(e.startsWith("blots/")||e.startsWith("formats/"))&&t&&"boolean"!=typeof t&&"abstract"!==t.blotName&&lT.register(t),"function"==typeof t.register&&t.register(lT)}}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.options=function(e,t){let r=lA(e);if(!r)throw Error("Invalid Quill container");let n=t.theme&&t.theme!==lO.DEFAULTS.theme?lO.import(`themes/${t.theme}`):lb;if(!n)throw Error(`Invalid theme ${t.theme}. Did you register it?`);let{modules:i,...o}=lO.DEFAULTS,{modules:s,...a}=n.DEFAULTS,l=lS(t.modules);null!=l&&l.toolbar&&l.toolbar.constructor!==Object&&(l={...l,toolbar:{container:l.toolbar}});let c=sf({},lS(i),lS(s),l),u={...o,...lk(a),...lk(t)},d=t.registry;return d?t.formats&&l_.warn('Ignoring "formats" option because "registry" is specified'):d=t.formats?((e,t,r)=>{let n=new sy;return lE.forEach(e=>{let r=t.query(e);r&&n.register(r)}),e.forEach(e=>{let i=t.query(e);i||r.error(`Cannot register "${e}" specified in "formats" config. Are you sure it was registered?`);let o=0;for(;i;)if(n.register(i),i="blotName"in i?i.requiredContainer??null:null,(o+=1)>100){r.error(`Cycle detected in registering blot requiredContainer: "${e}"`);break}}),n})(t.formats,u.registry,l_):u.registry,{...u,registry:d,container:r,theme:n,modules:Object.entries(c).reduce((e,t)=>{let[r,n]=t;if(!n)return e;let i=lO.import(`modules/${r}`);return null==i?(l_.error(`Cannot load ${r} module. Are you sure you registered it?`),e):{...e,[r]:sf({},i.DEFAULTS||{},n)}},{}),bounds:lA(u.bounds)}}(e,t),this.container=this.options.container,null==this.container)return void l_.error("Invalid Quill container",e);this.options.debug&&lO.debug(this.options.debug);let r=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",a6.set(this.container,this),this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.emitter=new lr;let n=sz.blotName,i=this.options.registry.query(n);if(!i||!("blotName"in i))throw Error(`Cannot initialize Quill without "${n}" blot`);if(this.scroll=new i(this.options.registry,this.root,{emitter:this.emitter}),this.editor=new lh(this.scroll),this.selection=new ls(this.scroll,this.emitter),this.composition=new lm(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.uploader=this.theme.addModule("uploader"),this.theme.addModule("input"),this.theme.addModule("uiNode"),this.theme.init(),this.emitter.on(lr.events.EDITOR_CHANGE,e=>{e===lr.events.TEXT_CHANGE&&this.root.classList.toggle("ql-blank",this.editor.isBlank())}),this.emitter.on(lr.events.SCROLL_UPDATE,(e,t)=>{let r=this.selection.lastRange,[n]=this.selection.getRange(),i=r&&n?{oldRange:r,newRange:n}:void 0;lN.call(this,()=>this.editor.update(null,t,i),e)}),this.emitter.on(lr.events.SCROLL_EMBED_UPDATE,(e,t)=>{let r=this.selection.lastRange,[n]=this.selection.getRange(),i=r&&n?{oldRange:r,newRange:n}:void 0;lN.call(this,()=>{let r=new sV().retain(e.offset(this)).retain({[e.statics.blotName]:t});return this.editor.update(r,[],i)},lO.sources.USER)}),r){let e=this.clipboard.convert({html:`${r}<p><br></p>`,text:"\n"});this.setContents(e)}this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable(),this.allowReadOnlyEdits=!1}addContainer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if("string"==typeof e){let t=e;(e=document.createElement("div")).classList.add(t)}return this.container.insertBefore(e,t),e}blur(){this.selection.setRange(null)}deleteText(e,t,r){return[e,t,,r]=lC(e,t,r),lN.call(this,()=>this.editor.deleteText(e,t),r,e,-1*t)}disable(){this.enable(!1)}editReadOnly(e){this.allowReadOnlyEdits=!0;let t=e();return this.allowReadOnlyEdits=!1,t}enable(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];this.scroll.enable(e),this.container.classList.toggle("ql-disabled",!e)}focus(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.selection.focus(),e.preventScroll||this.scrollSelectionIntoView()}format(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:lr.sources.API;return lN.call(this,()=>{let r=this.getSelection(!0),n=new sV;if(null==r)return n;if(this.scroll.query(e,sm.BLOCK))n=this.editor.formatLine(r.index,r.length,{[e]:t});else{if(0===r.length)return this.selection.format(e,t),n;n=this.editor.formatText(r.index,r.length,{[e]:t})}return this.setSelection(r,lr.sources.SILENT),n},r)}formatLine(e,t,r,n,i){let o;return[e,t,o,i]=lC(e,t,r,n,i),lN.call(this,()=>this.editor.formatLine(e,t,o),i,e,0)}formatText(e,t,r,n,i){let o;return[e,t,o,i]=lC(e,t,r,n,i),lN.call(this,()=>this.editor.formatText(e,t,o),i,e,0)}getBounds(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=null;if(!(r="number"==typeof e?this.selection.getBounds(e,t):this.selection.getBounds(e.index,e.length)))return null;let n=this.container.getBoundingClientRect();return{bottom:r.bottom-n.top,height:r.height,left:r.left-n.left,right:r.right-n.left,top:r.top-n.top,width:r.width}}getContents(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getLength()-e;return[e,t]=lC(e,t),this.editor.getContents(e,t)}getFormat(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getSelection(!0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"number"==typeof e?this.editor.getFormat(e,t):this.editor.getFormat(e.index,e.length)}getIndex(e){return e.offset(this.scroll)}getLength(){return this.scroll.length()}getLeaf(e){return this.scroll.leaf(e)}getLine(e){return this.scroll.line(e)}getLines(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MAX_VALUE;return"number"!=typeof e?this.scroll.lines(e.index,e.length):this.scroll.lines(e,t)}getModule(e){return this.theme.modules[e]}getSelection(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e&&this.focus(),this.update(),this.selection.getRange()[0]}getSemanticHTML(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;return"number"==typeof e&&(t=t??this.getLength()-e),[e,t]=lC(e,t),this.editor.getHTML(e,t)}getText(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;return"number"==typeof e&&(t=t??this.getLength()-e),[e,t]=lC(e,t),this.editor.getText(e,t)}hasFocus(){return this.selection.hasFocus()}insertEmbed(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:lO.sources.API;return lN.call(this,()=>this.editor.insertEmbed(e,t,r),n,e)}insertText(e,t,r,n,i){let o;return[e,,o,i]=lC(e,0,r,n,i),lN.call(this,()=>this.editor.insertText(e,t,o),i,e,t.length)}isEnabled(){return this.scroll.isEnabled()}off(){return this.emitter.off(...arguments)}on(){return this.emitter.on(...arguments)}once(){return this.emitter.once(...arguments)}removeFormat(e,t,r){return[e,t,,r]=lC(e,t,r),lN.call(this,()=>this.editor.removeFormat(e,t),r,e)}scrollRectIntoView(e){((e,t)=>{let r=e.ownerDocument,n=t,i=e;for(;i;){let e=i===r.body,t=e?{top:0,right:window.visualViewport?.width??r.documentElement.clientWidth,bottom:window.visualViewport?.height??r.documentElement.clientHeight,left:0}:ly(i),o=getComputedStyle(i),s=lx(n.left,n.right,t.left,t.right,lw(o.scrollPaddingLeft),lw(o.scrollPaddingRight)),a=lx(n.top,n.bottom,t.top,t.bottom,lw(o.scrollPaddingTop),lw(o.scrollPaddingBottom));if(s||a)if(e)r.defaultView?.scrollBy(s,a);else{let{scrollLeft:e,scrollTop:t}=i;a&&(i.scrollTop+=a),s&&(i.scrollLeft+=s);let r=i.scrollLeft-e,o=i.scrollTop-t;n={left:n.left-r,top:n.top-o,right:n.right-r,bottom:n.bottom-o}}i=e||"fixed"===o.position?null:lv(i)}})(this.root,e)}scrollIntoView(){console.warn("Quill#scrollIntoView() has been deprecated and will be removed in the near future. Please use Quill#scrollSelectionIntoView() instead."),this.scrollSelectionIntoView()}scrollSelectionIntoView(){let e=this.selection.lastRange,t=e&&this.selection.getBounds(e.index,e.length);t&&this.scrollRectIntoView(t)}setContents(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:lr.sources.API;return lN.call(this,()=>{e=new sV(e);let t=this.getLength(),r=this.editor.deleteText(0,t),n=this.editor.insertContents(0,e),i=this.editor.deleteText(this.getLength()-1,1);return r.compose(n).compose(i)},t)}setSelection(e,t,r){null==e?this.selection.setRange(null,t||lO.sources.API):([e,t,,r]=lC(e,t,r),this.selection.setRange(new li(Math.max(0,e),t),r),r!==lr.sources.SILENT&&this.scrollSelectionIntoView())}setText(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:lr.sources.API,r=new sV().insert(e);return this.setContents(r,t)}update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lr.sources.USER,t=this.scroll.update(e);return this.selection.update(e),t}updateContents(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:lr.sources.API;return lN.call(this,()=>(e=new sV(e),this.editor.applyDelta(e)),t,!0)}}function lA(e){return"string"==typeof e?document.querySelector(e):e}function lS(e){return Object.entries(e??{}).reduce((e,t)=>{let[r,n]=t;return{...e,[r]:!0===n?{}:n}},{})}function lk(e){return Object.fromEntries(Object.entries(e).filter(e=>void 0!==e[1]))}function lN(e,t,r,n){if(!this.isEnabled()&&t===lr.sources.USER&&!this.allowReadOnlyEdits)return new sV;let i=null==r?null:this.getSelection(),o=this.editor.delta,s=e();if(null!=i&&(!0===r&&(r=i.index),null==n?i=lI(i,s,t):0!==n&&(i=lI(i,r,n,t)),this.setSelection(i,lr.sources.SILENT)),s.length()>0){let e=[lr.events.TEXT_CHANGE,s,o,t];this.emitter.emit(lr.events.EDITOR_CHANGE,...e),t!==lr.sources.SILENT&&this.emitter.emit(...e)}return s}function lC(e,t,r,n,i){let o={};return"number"==typeof e.index&&"number"==typeof e.length?("number"!=typeof t&&(i=n,n=r,r=t),t=e.length,e=e.index):"number"!=typeof t&&(i=n,n=r,r=t,t=0),"object"==typeof r?(o=r,i=n):"string"==typeof r&&(null!=n?o[r]=n:i=r),[e,t,o,i=i||lr.sources.API]}function lI(e,t,r,n){let i,o,s="number"==typeof r?r:0;return null==e?null:(t&&"function"==typeof t.transformPosition?[i,o]=[e.index,e.index+e.length].map(e=>t.transformPosition(e,n!==lr.sources.USER)):[i,o]=[e.index,e.index+e.length].map(e=>e<t||e===t&&n===lr.sources.USER?e:s>=0?e+s:Math.max(t,e+s)),new li(i,o-i))}let lR=class extends sB{};function lP(e){return e instanceof aQ||e instanceof a0}function lL(e){return"function"==typeof e.updateContent}function lD(e,t,r){r.reduce((t,r)=>{let n=sV.Op.length(r),i=r.attributes||{};if(null!=r.insert){if("string"==typeof r.insert){let n=r.insert;e.insertAt(t,n);let[o]=e.descendant(sk,t),s=a2(o);i=sV.AttributeMap.diff(s,i)||{}}else if("object"==typeof r.insert){let n=Object.keys(r.insert)[0];if(null==n)return t;if(e.insertAt(t,n,r.insert[n]),null!=e.scroll.query(n,sm.INLINE)){let[r]=e.descendant(sk,t),n=a2(r);i=sV.AttributeMap.diff(n,i)||{}}}}return Object.keys(i).forEach(r=>{e.formatAt(t,n,r,i[r])}),t+n},t)}let lM=class extends sz{static blotName="scroll";static className="ql-editor";static tagName="DIV";static defaultChild=aQ;static allowedChildren=[aQ,a0,lR];constructor(e,t,r){let{emitter:n}=r;super(e,t),this.emitter=n,this.batch=!1,this.optimize(),this.enable(),this.domNode.addEventListener("dragstart",e=>this.handleDragStart(e))}batchStart(){Array.isArray(this.batch)||(this.batch=[])}batchEnd(){if(!this.batch)return;let e=this.batch;this.batch=!1,this.update(e)}emitMount(e){this.emitter.emit(lr.events.SCROLL_BLOT_MOUNT,e)}emitUnmount(e){this.emitter.emit(lr.events.SCROLL_BLOT_UNMOUNT,e)}emitEmbedUpdate(e,t){this.emitter.emit(lr.events.SCROLL_EMBED_UPDATE,e,t)}deleteAt(e,t){let[r,n]=this.line(e),[i]=this.line(e+t);if(super.deleteAt(e,t),null!=i&&r!==i&&n>0){if(r instanceof a0||i instanceof a0)return void this.optimize();let e=i.children.head instanceof aK?null:i.children.head;r.moveChildren(i,e),r.remove()}this.optimize()}enable(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];this.domNode.setAttribute("contenteditable",e?"true":"false")}formatAt(e,t,r,n){super.formatAt(e,t,r,n),this.optimize()}insertAt(e,t,r){if(e>=this.length())if(null==r||null==this.scroll.query(t,sm.BLOCK)){let e=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(e),null==r&&t.endsWith("\n")?e.insertAt(0,t.slice(0,-1),r):e.insertAt(0,t,r)}else{let e=this.scroll.create(t,r);this.appendChild(e)}else super.insertAt(e,t,r);this.optimize()}insertBefore(e,t){if(e.statics.scope===sm.INLINE_BLOT){let r=this.scroll.create(this.statics.defaultChild.blotName);r.appendChild(e),super.insertBefore(r,t)}else super.insertBefore(e,t)}insertContents(e,t){let r=this.deltaToRenderBlocks(t.concat(new sV().insert("\n"))),n=r.pop();if(null==n)return;this.batchStart();let i=r.shift();if(i){let t="block"===i.type&&(0===i.delta.length()||!this.descendant(a0,e)[0]&&e<this.length()),r="block"===i.type?i.delta:new sV().insert({[i.key]:i.value});lD(this,e,r);let n=+("block"===i.type),o=e+r.length()+n;t&&this.insertAt(o-1,"\n");let s=a2(this.line(e)[0]),a=sV.AttributeMap.diff(s,i.attributes)||{};Object.keys(a).forEach(e=>{this.formatAt(o-1,1,e,a[e])}),e=o}let[o,s]=this.children.find(e);r.length&&(o&&(o=o.split(s),s=0),r.forEach(e=>{if("block"===e.type)lD(this.createBlock(e.attributes,o||void 0),0,e.delta);else{let t=this.create(e.key,e.value);this.insertBefore(t,o||void 0),Object.keys(e.attributes).forEach(r=>{t.format(r,e.attributes[r])})}})),"block"===n.type&&n.delta.length()&&lD(this,o?o.offset(o.scroll)+s:this.length(),n.delta),this.batchEnd(),this.optimize()}isEnabled(){return"true"===this.domNode.getAttribute("contenteditable")}leaf(e){let t=this.path(e).pop();if(!t)return[null,-1];let[r,n]=t;return r instanceof sk?[r,n]:[null,-1]}line(e){return e===this.length()?this.line(e-1):this.descendant(lP,e)}lines(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MAX_VALUE,r=(e,t,n)=>{let i=[],o=n;return e.children.forEachAt(t,n,(e,t,n)=>{lP(e)?i.push(e):e instanceof sB&&(i=i.concat(r(e,t,o))),o-=n}),i};return r(this,e,t)}optimize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!this.batch&&(super.optimize(e,t),e.length>0&&this.emitter.emit(lr.events.SCROLL_OPTIMIZE,e,t))}path(e){return super.path(e).slice(1)}remove(){}update(e){if(this.batch){Array.isArray(e)&&(this.batch=this.batch.concat(e));return}let t=lr.sources.USER;"string"==typeof e&&(t=e),Array.isArray(e)||(e=this.observer.takeRecords()),(e=e.filter(e=>{let{target:t}=e,r=this.find(t,!0);return r&&!lL(r)})).length>0&&this.emitter.emit(lr.events.SCROLL_BEFORE_UPDATE,t,e),super.update(e.concat([])),e.length>0&&this.emitter.emit(lr.events.SCROLL_UPDATE,t,e)}updateEmbedAt(e,t,r){let[n]=this.descendant(e=>e instanceof a0,e);n&&n.statics.blotName===t&&lL(n)&&n.updateContent(r)}handleDragStart(e){e.preventDefault()}deltaToRenderBlocks(e){let t=[],r=new sV;return e.forEach(e=>{let n=e?.insert;if(n)if("string"==typeof n){let i=n.split("\n");i.slice(0,-1).forEach(n=>{r.insert(n,e.attributes),t.push({type:"block",delta:r,attributes:e.attributes??{}}),r=new sV});let o=i[i.length-1];o&&r.insert(o,e.attributes)}else{let i=Object.keys(n)[0];if(!i)return;this.query(i,sm.INLINE)?r.push(e):(r.length()&&t.push({type:"block",delta:r,attributes:{}}),r=new sV,t.push({type:"blockEmbed",key:i,value:n[i],attributes:e.attributes??{}}))}}),r.length()&&t.push({type:"block",delta:r,attributes:{}}),t}createBlock(e,t){let r,n={};Object.entries(e).forEach(e=>{let[t,i]=e;null!=this.query(t,sm.BLOCK&sm.BLOT)?r=t:n[t]=i});let i=this.create(r||this.statics.defaultChild.blotName,r?e[r]:void 0);this.insertBefore(i,t||void 0);let o=i.length();return Object.entries(n).forEach(e=>{let[t,r]=e;i.formatAt(0,o,t,r)}),i}},lj={scope:sm.BLOCK,whitelist:["right","center","justify"]},lB=new sg("align","align",lj),lF=new sx("align","ql-align",lj),lU=new s_("align","text-align",lj);class lq extends s_{value(e){let t=super.value(e);if(!t.startsWith("rgb("))return t;let r=(t=t.replace(/^[^\d]+/,"").replace(/[^\d]+$/,"")).split(",").map(e=>`00${parseInt(e,10).toString(16)}`.slice(-2)).join("");return`#${r}`}}let lz=new sx("color","ql-color",{scope:sm.INLINE}),lH=new lq("color","color",{scope:sm.INLINE}),lX=new sx("background","ql-bg",{scope:sm.INLINE}),lV=new lq("background","background-color",{scope:sm.INLINE});class l$ extends lR{static create(e){let t=super.create(e);return t.setAttribute("spellcheck","false"),t}code(e,t){return this.children.map(e=>1>=e.length()?"":e.domNode.innerText).join("\n").slice(e,e+t)}html(e,t){return`<pre>
${aY(this.code(e,t))}
</pre>`}}class lK extends aQ{static TAB="  ";static register(){lO.register(l$)}}class lW extends aJ{}lW.blotName="code",lW.tagName="CODE",lK.blotName="code-block",lK.className="ql-code-block",lK.tagName="DIV",l$.blotName="code-block-container",l$.className="ql-code-block-container",l$.tagName="DIV",l$.allowedChildren=[lK],lK.allowedChildren=[aW,aK,a5],lK.requiredContainer=l$;let lG={scope:sm.BLOCK,whitelist:["rtl"]},lY=new sg("direction","dir",lG),lZ=new sx("direction","ql-direction",lG),lJ=new s_("direction","direction",lG),lQ={scope:sm.INLINE,whitelist:["serif","monospace"]},l0=new sx("font","ql-font",lQ),l1=new class extends s_{value(e){return super.value(e).replace(/["']/g,"")}}("font","font-family",lQ),l2=new sx("size","ql-size",{scope:sm.INLINE,whitelist:["small","large","huge"]}),l5=new s_("size","font-size",{scope:sm.INLINE,whitelist:["10px","18px","32px"]}),l3=le("quill:keyboard"),l4=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey";class l6 extends lp{static match(e,t){return!["altKey","ctrlKey","metaKey","shiftKey"].some(r=>!!t[r]!==e[r]&&null!==t[r])&&(t.key===e.key||t.key===e.which)}constructor(e,t){super(e,t),this.bindings={},Object.keys(this.options.bindings).forEach(e=>{this.options.bindings[e]&&this.addBinding(this.options.bindings[e])}),this.addBinding({key:"Enter",shiftKey:null},this.handleEnter),this.addBinding({key:"Enter",metaKey:null,ctrlKey:null,altKey:null},()=>{}),/Firefox/i.test(navigator.userAgent)?(this.addBinding({key:"Backspace"},{collapsed:!0},this.handleBackspace),this.addBinding({key:"Delete"},{collapsed:!0},this.handleDelete)):(this.addBinding({key:"Backspace"},{collapsed:!0,prefix:/^.?$/},this.handleBackspace),this.addBinding({key:"Delete"},{collapsed:!0,suffix:/^.?$/},this.handleDelete)),this.addBinding({key:"Backspace"},{collapsed:!1},this.handleDeleteRange),this.addBinding({key:"Delete"},{collapsed:!1},this.handleDeleteRange),this.addBinding({key:"Backspace",altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},this.handleBackspace),this.listen()}addBinding(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=function(e){if("string"==typeof e||"number"==typeof e)e={key:e};else{if("object"!=typeof e)return null;e=aC(e)}return e.shortKey&&(e[l4]=e.shortKey,delete e.shortKey),e}(e);if(null==n)return void l3.warn("Attempted to add invalid keyboard binding",n);"function"==typeof t&&(t={handler:t}),"function"==typeof r&&(r={handler:r}),(Array.isArray(n.key)?n.key:[n.key]).forEach(e=>{let i={...n,key:e,...t,...r};this.bindings[i.key]=this.bindings[i.key]||[],this.bindings[i.key].push(i)})}listen(){this.quill.root.addEventListener("keydown",e=>{if(e.defaultPrevented||e.isComposing||229===e.keyCode&&("Enter"===e.key||"Backspace"===e.key))return;let t=(this.bindings[e.key]||[]).concat(this.bindings[e.which]||[]).filter(t=>l6.match(e,t));if(0===t.length)return;let r=lO.find(e.target,!0);if(r&&r.scroll!==this.quill.scroll)return;let n=this.quill.getSelection();if(null==n||!this.quill.hasFocus())return;let[i,o]=this.quill.getLine(n.index),[s,a]=this.quill.getLeaf(n.index),[l,c]=0===n.length?[s,a]:this.quill.getLeaf(n.index+n.length),u=s instanceof sX?s.value().slice(0,a):"",d=l instanceof sX?l.value().slice(c):"",h={collapsed:0===n.length,empty:0===n.length&&1>=i.length(),format:this.quill.getFormat(n),line:i,offset:o,prefix:u,suffix:d,event:e};t.some(e=>{if(null!=e.collapsed&&e.collapsed!==h.collapsed||null!=e.empty&&e.empty!==h.empty||null!=e.offset&&e.offset!==h.offset)return!1;if(Array.isArray(e.format)){if(e.format.every(e=>null==h.format[e]))return!1}else if("object"==typeof e.format&&!Object.keys(e.format).every(t=>!0===e.format[t]?null!=h.format[t]:!1===e.format[t]?null==h.format[t]:a$(e.format[t],h.format[t])))return!1;return(null==e.prefix||!!e.prefix.test(h.prefix))&&(null==e.suffix||!!e.suffix.test(h.suffix))&&!0!==e.handler.call(this,n,h,e)})&&e.preventDefault()})}handleBackspace(e,t){let r=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(t.prefix)?2:1;if(0===e.index||1>=this.quill.getLength())return;let n={},[i]=this.quill.getLine(e.index),o=new sV().retain(e.index-r).delete(r);if(0===t.offset){let[t]=this.quill.getLine(e.index-1);if(t&&!("block"===t.statics.blotName&&1>=t.length())){let t=i.formats(),r=this.quill.getFormat(e.index-1,1);if(Object.keys(n=sV.AttributeMap.diff(t,r)||{}).length>0){let t=new sV().retain(e.index+i.length()-2).retain(1,n);o=o.compose(t)}}}this.quill.updateContents(o,lO.sources.USER),this.quill.focus()}handleDelete(e,t){let r=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(t.suffix)?2:1;if(e.index>=this.quill.getLength()-r)return;let n={},[i]=this.quill.getLine(e.index),o=new sV().retain(e.index).delete(r);if(t.offset>=i.length()-1){let[t]=this.quill.getLine(e.index+1);if(t){let r=i.formats(),s=this.quill.getFormat(e.index,1);Object.keys(n=sV.AttributeMap.diff(r,s)||{}).length>0&&(o=o.retain(t.length()-1).retain(1,n))}}this.quill.updateContents(o,lO.sources.USER),this.quill.focus()}handleDeleteRange(e){ct({range:e,quill:this.quill}),this.quill.focus()}handleEnter(e,t){let r=Object.keys(t.format).reduce((e,r)=>(this.quill.scroll.query(r,sm.BLOCK)&&!Array.isArray(t.format[r])&&(e[r]=t.format[r]),e),{}),n=new sV().retain(e.index).delete(e.length).insert("\n",r);this.quill.updateContents(n,lO.sources.USER),this.quill.setSelection(e.index+1,lO.sources.SILENT),this.quill.focus()}}function l8(e){return{key:"Tab",shiftKey:!e,format:{"code-block":!0},handler(t,r){let{event:n}=r,{TAB:i}=this.quill.scroll.query("code-block");if(0===t.length&&!n.shiftKey){this.quill.insertText(t.index,i,lO.sources.USER),this.quill.setSelection(t.index+i.length,lO.sources.SILENT);return}let o=0===t.length?this.quill.getLines(t.index,1):this.quill.getLines(t),{index:s,length:a}=t;o.forEach((t,r)=>{e?(t.insertAt(0,i),0===r?s+=i.length:a+=i.length):t.domNode.textContent.startsWith(i)&&(t.deleteAt(0,i.length),0===r?s-=i.length:a-=i.length)}),this.quill.update(lO.sources.USER),this.quill.setSelection(s,a,lO.sources.SILENT)}}}function l9(e,t){return{key:e,shiftKey:t,altKey:null,["ArrowLeft"===e?"prefix":"suffix"]:/^$/,handler(r){let{index:n}=r;"ArrowRight"===e&&(n+=r.length+1);let[i]=this.quill.getLeaf(n);return!(i instanceof sF)||("ArrowLeft"===e?t?this.quill.setSelection(r.index-1,r.length+1,lO.sources.USER):this.quill.setSelection(r.index-1,lO.sources.USER):t?this.quill.setSelection(r.index,r.length+1,lO.sources.USER):this.quill.setSelection(r.index+r.length+1,lO.sources.USER),!1)}}}function l7(e){return{key:e[0],shortKey:!0,handler(t,r){this.quill.format(e,!r.format[e],lO.sources.USER)}}}function ce(e){return{key:e?"ArrowUp":"ArrowDown",collapsed:!0,format:["table"],handler(t,r){let n=e?"prev":"next",i=r.line,o=i.parent[n];if(null!=o){if("table-row"===o.statics.blotName){let e=o.children.head,t=i;for(;null!=t.prev;)t=t.prev,e=e.next;let n=e.offset(this.quill.scroll)+Math.min(r.offset,e.length()-1);this.quill.setSelection(n,0,lO.sources.USER)}}else{let t=i.table()[n];null!=t&&(e?this.quill.setSelection(t.offset(this.quill.scroll)+t.length()-1,0,lO.sources.USER):this.quill.setSelection(t.offset(this.quill.scroll),0,lO.sources.USER))}return!1}}}function ct(e){let{quill:t,range:r}=e,n=t.getLines(r),i={};if(n.length>1){let e=n[0].formats(),t=n[n.length-1].formats();i=sV.AttributeMap.diff(t,e)||{}}t.deleteText(r,lO.sources.USER),Object.keys(i).length>0&&t.formatLine(r.index,1,i,lO.sources.USER),t.setSelection(r.index,lO.sources.SILENT)}l6.DEFAULTS={bindings:{bold:l7("bold"),italic:l7("italic"),underline:l7("underline"),indent:{key:"Tab",format:["blockquote","indent","list"],handler(e,t){return!!t.collapsed&&0!==t.offset||(this.quill.format("indent","+1",lO.sources.USER),!1)}},outdent:{key:"Tab",shiftKey:!0,format:["blockquote","indent","list"],handler(e,t){return!!t.collapsed&&0!==t.offset||(this.quill.format("indent","-1",lO.sources.USER),!1)}},"outdent backspace":{key:"Backspace",collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler(e,t){null!=t.format.indent?this.quill.format("indent","-1",lO.sources.USER):null!=t.format.list&&this.quill.format("list",!1,lO.sources.USER)}},"indent code-block":l8(!0),"outdent code-block":l8(!1),"remove tab":{key:"Tab",shiftKey:!0,collapsed:!0,prefix:/\t$/,handler(e){this.quill.deleteText(e.index-1,1,lO.sources.USER)}},tab:{key:"Tab",handler(e,t){if(t.format.table)return!0;this.quill.history.cutoff();let r=new sV().retain(e.index).delete(e.length).insert("	");return this.quill.updateContents(r,lO.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(e.index+1,lO.sources.SILENT),!1}},"blockquote empty enter":{key:"Enter",collapsed:!0,format:["blockquote"],empty:!0,handler(){this.quill.format("blockquote",!1,lO.sources.USER)}},"list empty enter":{key:"Enter",collapsed:!0,format:["list"],empty:!0,handler(e,t){let r={list:!1};t.format.indent&&(r.indent=!1),this.quill.formatLine(e.index,e.length,r,lO.sources.USER)}},"checklist enter":{key:"Enter",collapsed:!0,format:{list:"checked"},handler(e){let[t,r]=this.quill.getLine(e.index),n={...t.formats(),list:"checked"},i=new sV().retain(e.index).insert("\n",n).retain(t.length()-r-1).retain(1,{list:"unchecked"});this.quill.updateContents(i,lO.sources.USER),this.quill.setSelection(e.index+1,lO.sources.SILENT),this.quill.scrollSelectionIntoView()}},"header enter":{key:"Enter",collapsed:!0,format:["header"],suffix:/^$/,handler(e,t){let[r,n]=this.quill.getLine(e.index),i=new sV().retain(e.index).insert("\n",t.format).retain(r.length()-n-1).retain(1,{header:null});this.quill.updateContents(i,lO.sources.USER),this.quill.setSelection(e.index+1,lO.sources.SILENT),this.quill.scrollSelectionIntoView()}},"table backspace":{key:"Backspace",format:["table"],collapsed:!0,offset:0,handler(){}},"table delete":{key:"Delete",format:["table"],collapsed:!0,suffix:/^$/,handler(){}},"table enter":{key:"Enter",shiftKey:null,format:["table"],handler(e){let t=this.quill.getModule("table");if(t){var r,n,i,o;let[s,a,l,c]=t.getTable(e),u=(r=0,n=a,i=l,o=c,null==n.prev&&null==n.next?null==i.prev&&null==i.next?0===o?-1:1:null==i.prev?-1:1:null==n.prev?-1:null==n.next?1:null);if(null==u)return;let d=s.offset();if(u<0){let t=new sV().retain(d).insert("\n");this.quill.updateContents(t,lO.sources.USER),this.quill.setSelection(e.index+1,e.length,lO.sources.SILENT)}else if(u>0){d+=s.length();let e=new sV().retain(d).insert("\n");this.quill.updateContents(e,lO.sources.USER),this.quill.setSelection(d,lO.sources.USER)}}}},"table tab":{key:"Tab",shiftKey:null,format:["table"],handler(e,t){let{event:r,line:n}=t,i=n.offset(this.quill.scroll);r.shiftKey?this.quill.setSelection(i-1,lO.sources.USER):this.quill.setSelection(i+n.length(),lO.sources.USER)}},"list autofill":{key:" ",shiftKey:null,collapsed:!0,format:{"code-block":!1,blockquote:!1,table:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler(e,t){let r;if(null==this.quill.scroll.query("list"))return!0;let{length:n}=t.prefix,[i,o]=this.quill.getLine(e.index);if(o>n)return!0;switch(t.prefix.trim()){case"[]":case"[ ]":r="unchecked";break;case"[x]":r="checked";break;case"-":case"*":r="bullet";break;default:r="ordered"}this.quill.insertText(e.index," ",lO.sources.USER),this.quill.history.cutoff();let s=new sV().retain(e.index-o).delete(n+1).retain(i.length()-2-o).retain(1,{list:r});return this.quill.updateContents(s,lO.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(e.index-n,lO.sources.SILENT),!1}},"code exit":{key:"Enter",collapsed:!0,format:["code-block"],prefix:/^$/,suffix:/^\s*$/,handler(e){let[t,r]=this.quill.getLine(e.index),n=2,i=t;for(;null!=i&&1>=i.length()&&i.formats()["code-block"];)if(i=i.prev,(n-=1)<=0){let n=new sV().retain(e.index+t.length()-r-2).retain(1,{"code-block":null}).delete(1);return this.quill.updateContents(n,lO.sources.USER),this.quill.setSelection(e.index-1,lO.sources.SILENT),!1}return!0}},"embed left":l9("ArrowLeft",!1),"embed left shift":l9("ArrowLeft",!0),"embed right":l9("ArrowRight",!1),"embed right shift":l9("ArrowRight",!0),"table down":ce(!1),"table up":ce(!0)}};let cr=/font-weight:\s*normal/,cn=["P","OL","UL"],ci=e=>e&&cn.includes(e.tagName),co=/\bmso-list:[^;]*ignore/i,cs=/\bmso-list:[^;]*\bl(\d+)/i,ca=/\bmso-list:[^;]*\blevel(\d+)/i,cl=[function(e){"urn:schemas-microsoft-com:office:word"===e.documentElement.getAttribute("xmlns:w")&&(e=>{let t=Array.from(e.querySelectorAll("[style*=mso-list]")),r=[],n=[];t.forEach(e=>{(e.getAttribute("style")||"").match(co)?r.push(e):n.push(e)}),r.forEach(e=>e.parentNode?.removeChild(e));let i=e.documentElement.innerHTML,o=n.map(e=>((e,t)=>{let r=e.getAttribute("style"),n=r?.match(cs);if(!n)return null;let i=Number(n[1]),o=r?.match(ca),s=o?Number(o[1]):1,a=RegExp(`@list l${i}:level${s}\\s*\\{[^\\}]*mso-level-number-format:\\s*([\\w-]+)`,"i"),l=t.match(a);return{id:i,indent:s,type:l&&"bullet"===l[1]?"bullet":"ordered",element:e}})(e,i)).filter(e=>e);for(;o.length;){let e=[],t=o.shift();for(;t;)e.push(t),t=o.length&&o[0]?.element===t.element.nextElementSibling&&o[0].id===t.id?o.shift():null;let r=document.createElement("ul");e.forEach(e=>{let t=document.createElement("li");t.setAttribute("data-list",e.type),e.indent>1&&t.setAttribute("class",`ql-indent-${e.indent-1}`),t.innerHTML=e.element.innerHTML,r.appendChild(t)});let n=e[0]?.element,{parentNode:i}=n??{};n&&i?.replaceChild(r,n),e.slice(1).forEach(e=>{let{element:t}=e;i?.removeChild(t)})}})(e)},function(e){e.querySelector('[id^="docs-internal-guid-"]')&&(Array.from(e.querySelectorAll('b[style*="font-weight"]')).filter(e=>e.getAttribute("style")?.match(cr)).forEach(t=>{let r=e.createDocumentFragment();r.append(...t.childNodes),t.parentNode?.replaceChild(r,t)}),Array.from(e.querySelectorAll("br")).filter(e=>ci(e.previousElementSibling)&&ci(e.nextElementSibling)).forEach(e=>{e.parentNode?.removeChild(e)}))}],cc=le("quill:clipboard"),cu=[[Node.TEXT_NODE,function(e,t,r){let n=e.data;if(e.parentElement?.tagName==="O:P")return t.insert(n.trim());if(!function e(t){return null!=t&&(cg.has(t)||("PRE"===t.tagName?cg.set(t,!0):cg.set(t,e(t.parentNode))),cg.get(t))}(e)){if(0===n.trim().length&&n.includes("\n")&&(!e.previousElementSibling||!e.nextElementSibling||cm(e.previousElementSibling,r)||cm(e.nextElementSibling,r)))return t;n=(n=n.replace(/[^\S\u00a0]/g," ")).replace(/ {2,}/g," "),(null==e.previousSibling&&null!=e.parentElement&&cm(e.parentElement,r)||e.previousSibling instanceof Element&&cm(e.previousSibling,r))&&(n=n.replace(/^ /,"")),(null==e.nextSibling&&null!=e.parentElement&&cm(e.parentElement,r)||e.nextSibling instanceof Element&&cm(e.nextSibling,r))&&(n=n.replace(/ $/,"")),n=n.replaceAll("\xa0"," ")}return t.insert(n)}],[Node.TEXT_NODE,cy],["br",function(e,t){return cf(t,"\n")||t.insert("\n"),t}],[Node.ELEMENT_NODE,cy],[Node.ELEMENT_NODE,function(e,t,r){let n=r.query(e);if(null==n)return t;if(n.prototype instanceof sF){let t={},i=n.value(e);if(null!=i)return t[n.blotName]=i,new sV().insert(t,n.formats(e,r))}else if(n.prototype instanceof sM&&!cf(t,"\n")&&t.insert("\n"),"blotName"in n&&"formats"in n&&"function"==typeof n.formats)return cp(t,n.blotName,n.formats(e,r),r);return t}],[Node.ELEMENT_NODE,function(e,t,r){let n=sg.keys(e),i=sx.keys(e),o=s_.keys(e),s={};return n.concat(i).concat(o).forEach(t=>{let n=r.query(t,sm.ATTRIBUTE);null!=n&&(s[n.attrName]=n.value(e),s[n.attrName])||(null!=(n=cd[t])&&(n.attrName===t||n.keyName===t)&&(s[n.attrName]=n.value(e)||void 0),null!=(n=ch[t])&&(n.attrName===t||n.keyName===t)&&(s[(n=ch[t]).attrName]=n.value(e)||void 0))}),Object.entries(s).reduce((e,t)=>{let[n,i]=t;return cp(e,n,i,r)},t)}],[Node.ELEMENT_NODE,function(e,t,r){let n={},i=e.style||{};return("italic"===i.fontStyle&&(n.italic=!0),"underline"===i.textDecoration&&(n.underline=!0),"line-through"===i.textDecoration&&(n.strike=!0),(i.fontWeight?.startsWith("bold")||parseInt(i.fontWeight,10)>=700)&&(n.bold=!0),t=Object.entries(n).reduce((e,t)=>{let[n,i]=t;return cp(e,n,i,r)},t),parseFloat(i.textIndent||0)>0)?new sV().insert("	").concat(t):t}],["li",function(e,t,r){let n=r.query(e);if(null==n||"list"!==n.blotName||!cf(t,"\n"))return t;let i=-1,o=e.parentNode;for(;null!=o;)["OL","UL"].includes(o.tagName)&&(i+=1),o=o.parentNode;return i<=0?t:t.reduce((e,t)=>t.insert?t.attributes&&"number"==typeof t.attributes.indent?e.push(t):e.insert(t.insert,{indent:i,...t.attributes||{}}):e,new sV)}],["ol, ul",function(e,t,r){let n="OL"===e.tagName?"ordered":"bullet",i=e.getAttribute("data-checked");return i&&(n="true"===i?"checked":"unchecked"),cp(t,"list",n,r)}],["pre",function(e,t,r){let n=r.query("code-block");return cp(t,"code-block",!n||!("formats"in n)||"function"!=typeof n.formats||n.formats(e,r),r)}],["tr",function(e,t,r){let n=e.parentElement?.tagName==="TABLE"?e.parentElement:e.parentElement?.parentElement;return null!=n?cp(t,"table",Array.from(n.querySelectorAll("tr")).indexOf(e)+1,r):t}],["b",cv("bold")],["i",cv("italic")],["strike",cv("strike")],["style",function(){return new sV}]],cd=[lB,lY].reduce((e,t)=>(e[t.keyName]=t,e),{}),ch=[lU,lV,lH,lJ,l1,l5].reduce((e,t)=>(e[t.keyName]=t,e),{});function cp(e,t,r,n){return n.query(t)?e.reduce((e,n)=>n.insert?n.attributes&&n.attributes[t]?e.push(n):e.insert(n.insert,{...r?{[t]:r}:{},...n.attributes}):e,new sV):e}function cf(e,t){let r="";for(let n=e.ops.length-1;n>=0&&r.length<t.length;--n){let t=e.ops[n];if("string"!=typeof t.insert)break;r=t.insert+r}return r.slice(-1*t.length)===t}function cm(e,t){if(!(e instanceof Element))return!1;let r=t.query(e);return(!r||!(r.prototype instanceof sF))&&["address","article","blockquote","canvas","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","iframe","li","main","nav","ol","output","p","pre","section","table","td","tr","ul","video"].includes(e.tagName.toLowerCase())}let cg=new WeakMap;function cb(e,t,r,n,i){return t.nodeType===t.TEXT_NODE?n.reduce((r,n)=>n(t,r,e),new sV):t.nodeType===t.ELEMENT_NODE?Array.from(t.childNodes||[]).reduce((o,s)=>{let a=cb(e,s,r,n,i);return s.nodeType===t.ELEMENT_NODE&&(a=r.reduce((t,r)=>r(s,t,e),a),a=(i.get(s)||[]).reduce((t,r)=>r(s,t,e),a)),o.concat(a)},new sV):new sV}function cv(e){return(t,r,n)=>cp(r,e,!0,n)}function cy(e,t,r){if(!cf(t,"\n")){if(cm(e,r)&&(e.childNodes.length>0||e instanceof HTMLParagraphElement))return t.insert("\n");if(t.length()>0&&e.nextSibling){let n=e.nextSibling;for(;null!=n;){if(cm(n,r))return t.insert("\n");let e=r.query(n);if(e&&e.prototype instanceof a0)return t.insert("\n");n=n.firstChild}}}return t}function cw(e,t){let r=t;for(let t=e.length-1;t>=0;t-=1){let n=e[t];e[t]={delta:r.transform(n.delta,!0),range:n.range&&cx(n.range,r)},r=n.delta.transform(r),0===e[t].delta.length()&&e.splice(t,1)}}function cx(e,t){if(!e)return e;let r=t.transformPosition(e.index);return{index:r,length:t.transformPosition(e.index+e.length)-r}}class cE extends lp{constructor(e,t){super(e,t),e.root.addEventListener("drop",t=>{t.preventDefault();let r=null;if(document.caretRangeFromPoint)r=document.caretRangeFromPoint(t.clientX,t.clientY);else if(document.caretPositionFromPoint){let e=document.caretPositionFromPoint(t.clientX,t.clientY);(r=document.createRange()).setStart(e.offsetNode,e.offset),r.setEnd(e.offsetNode,e.offset)}let n=r&&e.selection.normalizeNative(r);if(n){let r=e.selection.normalizedToRange(n);t.dataTransfer?.files&&this.upload(r,t.dataTransfer.files)}})}upload(e,t){let r=[];Array.from(t).forEach(e=>{e&&this.options.mimetypes?.includes(e.type)&&r.push(e)}),r.length>0&&this.options.handler.call(this,e,r)}}cE.DEFAULTS={mimetypes:["image/png","image/jpeg"],handler(e,t){this.quill.scroll.query("image")&&Promise.all(t.map(e=>new Promise(t=>{let r=new FileReader;r.onload=()=>{t(r.result)},r.readAsDataURL(e)}))).then(t=>{let r=t.reduce((e,t)=>e.insert({image:t}),new sV().retain(e.index).delete(e.length));this.quill.updateContents(r,lr.sources.USER),this.quill.setSelection(e.index+t.length,lr.sources.SILENT)})}};let c_=["insertText","insertReplacementText"],cT=class extends lp{constructor(e,t){super(e,t),e.root.addEventListener("beforeinput",e=>{this.handleBeforeInput(e)}),/Android/i.test(navigator.userAgent)||e.on(lO.events.COMPOSITION_BEFORE_START,()=>{this.handleCompositionStart()})}deleteRange(e){ct({range:e,quill:this.quill})}replaceText(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(0===e.length)return!1;if(t){let r=this.quill.getFormat(e.index,1);this.deleteRange(e),this.quill.updateContents(new sV().retain(e.index).insert(t,r),lO.sources.USER)}else this.deleteRange(e);return this.quill.setSelection(e.index+t.length,0,lO.sources.SILENT),!0}handleBeforeInput(e){var t;if(this.quill.composition.isComposing||e.defaultPrevented||!c_.includes(e.inputType))return;let r=e.getTargetRanges?e.getTargetRanges()[0]:null;if(!r||!0===r.collapsed)return;let n="string"==typeof(t=e).data?t.data:t.dataTransfer?.types.includes("text/plain")?t.dataTransfer.getData("text/plain"):null;if(null==n)return;let i=this.quill.selection.normalizeNative(r),o=i?this.quill.selection.normalizedToRange(i):null;o&&this.replaceText(o,n)&&e.preventDefault()}handleCompositionStart(){let e=this.quill.getSelection();e&&this.replaceText(e)}},cO=/Mac/i.test(navigator.platform),cA=class extends lp{isListening=!1;selectionChangeDeadline=0;constructor(e,t){super(e,t),this.handleArrowKeys(),this.handleNavigationShortcuts()}handleArrowKeys(){this.quill.keyboard.addBinding({key:["ArrowLeft","ArrowRight"],offset:0,shiftKey:null,handler(e,t){let{line:r,event:n}=t;if(!(r instanceof sR)||!r.uiNode)return!0;let i="rtl"===getComputedStyle(r.domNode).direction;return!!i&&"ArrowRight"!==n.key||!i&&"ArrowLeft"!==n.key||(this.quill.setSelection(e.index-1,e.length+ +!!n.shiftKey,lO.sources.USER),!1)}})}handleNavigationShortcuts(){this.quill.root.addEventListener("keydown",e=>{!e.defaultPrevented&&("ArrowLeft"===e.key||"ArrowRight"===e.key||"ArrowUp"===e.key||"ArrowDown"===e.key||"Home"===e.key||cO&&"a"===e.key&&!0===e.ctrlKey||0)&&this.ensureListeningToSelectionChange()})}ensureListeningToSelectionChange(){if(this.selectionChangeDeadline=Date.now()+100,this.isListening)return;this.isListening=!0;let e=()=>{this.isListening=!1,Date.now()<=this.selectionChangeDeadline&&this.handleSelectionChange()};document.addEventListener("selectionchange",e,{once:!0})}handleSelectionChange(){let e=document.getSelection();if(!e)return;let t=e.getRangeAt(0);if(!0!==t.collapsed||0!==t.startOffset)return;let r=this.quill.scroll.find(t.startContainer);if(!(r instanceof sR)||!r.uiNode)return;let n=document.createRange();n.setStartAfter(r.uiNode),n.setEndAfter(r.uiNode),e.removeAllRanges(),e.addRange(n)}};lO.register({"blots/block":aQ,"blots/block/embed":a0,"blots/break":aK,"blots/container":lR,"blots/cursor":a5,"blots/embed":lf,"blots/inline":aJ,"blots/scroll":lM,"blots/text":aW,"modules/clipboard":class extends lp{static DEFAULTS={matchers:[]};constructor(e,t){super(e,t),this.quill.root.addEventListener("copy",e=>this.onCaptureCopy(e,!1)),this.quill.root.addEventListener("cut",e=>this.onCaptureCopy(e,!0)),this.quill.root.addEventListener("paste",this.onCapturePaste.bind(this)),this.matchers=[],cu.concat(this.options.matchers??[]).forEach(e=>{let[t,r]=e;this.addMatcher(t,r)})}addMatcher(e,t){this.matchers.push([e,t])}convert(e){let{html:t,text:r}=e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(n[lK.blotName])return new sV().insert(r||"",{[lK.blotName]:n[lK.blotName]});if(!t)return new sV().insert(r||"",n);let i=this.convertHTML(t);return cf(i,"\n")&&(null==i.ops[i.ops.length-1].attributes||n.table)?i.compose(new sV().retain(i.length()-1).delete(1)):i}normalizeHTML(e){e.documentElement&&cl.forEach(t=>{t(e)})}convertHTML(e){let t=new DOMParser().parseFromString(e,"text/html");this.normalizeHTML(t);let r=t.body,n=new WeakMap,[i,o]=this.prepareMatching(r,n);return cb(this.quill.scroll,r,i,o,n)}dangerouslyPasteHTML(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:lO.sources.API;if("string"==typeof e){let r=this.convert({html:e,text:""});this.quill.setContents(r,t),this.quill.setSelection(0,lO.sources.SILENT)}else{let n=this.convert({html:t,text:""});this.quill.updateContents(new sV().retain(e).concat(n),r),this.quill.setSelection(e+n.length(),lO.sources.SILENT)}}onCaptureCopy(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.defaultPrevented)return;e.preventDefault();let[r]=this.quill.selection.getRange();if(null==r)return;let{html:n,text:i}=this.onCopy(r,t);e.clipboardData?.setData("text/plain",i),e.clipboardData?.setData("text/html",n),t&&ct({range:r,quill:this.quill})}normalizeURIList(e){return e.split(/\r?\n/).filter(e=>"#"!==e[0]).join("\n")}onCapturePaste(e){if(e.defaultPrevented||!this.quill.isEnabled())return;e.preventDefault();let t=this.quill.getSelection(!0);if(null==t)return;let r=e.clipboardData?.getData("text/html"),n=e.clipboardData?.getData("text/plain");if(!r&&!n){let t=e.clipboardData?.getData("text/uri-list");t&&(n=this.normalizeURIList(t))}let i=Array.from(e.clipboardData?.files||[]);if(!r&&i.length>0)return void this.quill.uploader.upload(t,i);if(r&&i.length>0){let e=new DOMParser().parseFromString(r,"text/html");if(1===e.body.childElementCount&&e.body.firstElementChild?.tagName==="IMG")return void this.quill.uploader.upload(t,i)}this.onPaste(t,{html:r,text:n})}onCopy(e){let t=this.quill.getText(e);return{html:this.quill.getSemanticHTML(e),text:t}}onPaste(e,t){let{text:r,html:n}=t,i=this.quill.getFormat(e.index),o=this.convert({text:r,html:n},i);cc.log("onPaste",o,{text:r,html:n});let s=new sV().retain(e.index).delete(e.length).concat(o);this.quill.updateContents(s,lO.sources.USER),this.quill.setSelection(s.length()-e.length,lO.sources.SILENT),this.quill.scrollSelectionIntoView()}prepareMatching(e,t){let r=[],n=[];return this.matchers.forEach(i=>{let[o,s]=i;switch(o){case Node.TEXT_NODE:n.push(s);break;case Node.ELEMENT_NODE:r.push(s);break;default:Array.from(e.querySelectorAll(o)).forEach(e=>{if(t.has(e)){let r=t.get(e);r?.push(s)}else t.set(e,[s])})}}),[r,n]}},"modules/history":class extends lp{static DEFAULTS={delay:1e3,maxStack:100,userOnly:!1};lastRecorded=0;ignoreChange=!1;stack={undo:[],redo:[]};currentRange=null;constructor(e,t){super(e,t),this.quill.on(lO.events.EDITOR_CHANGE,(e,t,r,n)=>{e===lO.events.SELECTION_CHANGE?t&&n!==lO.sources.SILENT&&(this.currentRange=t):e===lO.events.TEXT_CHANGE&&(this.ignoreChange||(this.options.userOnly&&n!==lO.sources.USER?this.transform(t):this.record(t,r)),this.currentRange=cx(this.currentRange,t))}),this.quill.keyboard.addBinding({key:"z",shortKey:!0},this.undo.bind(this)),this.quill.keyboard.addBinding({key:["z","Z"],shortKey:!0,shiftKey:!0},this.redo.bind(this)),/Win/i.test(navigator.platform)&&this.quill.keyboard.addBinding({key:"y",shortKey:!0},this.redo.bind(this)),this.quill.root.addEventListener("beforeinput",e=>{"historyUndo"===e.inputType?(this.undo(),e.preventDefault()):"historyRedo"===e.inputType&&(this.redo(),e.preventDefault())})}change(e,t){if(0===this.stack[e].length)return;let r=this.stack[e].pop();if(!r)return;let n=this.quill.getContents(),i=r.delta.invert(n);this.stack[t].push({delta:i,range:cx(r.range,i)}),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(r.delta,lO.sources.USER),this.ignoreChange=!1,this.restoreSelection(r)}clear(){this.stack={undo:[],redo:[]}}cutoff(){this.lastRecorded=0}record(e,t){if(0===e.ops.length)return;this.stack.redo=[];let r=e.invert(t),n=this.currentRange,i=Date.now();if(this.lastRecorded+this.options.delay>i&&this.stack.undo.length>0){let e=this.stack.undo.pop();e&&(r=r.compose(e.delta),n=e.range)}else this.lastRecorded=i;0!==r.length()&&(this.stack.undo.push({delta:r,range:n}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift())}redo(){this.change("redo","undo")}transform(e){cw(this.stack.undo,e),cw(this.stack.redo,e)}undo(){this.change("undo","redo")}restoreSelection(e){if(e.range)this.quill.setSelection(e.range,lO.sources.USER);else{let t=function(e,t){let r=t.reduce((e,t)=>e+(t.delete||0),0),n=t.length()-r;return function(e,t){let r=t.ops[t.ops.length-1];return null!=r&&(null!=r.insert?"string"==typeof r.insert&&r.insert.endsWith("\n"):null!=r.attributes&&Object.keys(r.attributes).some(t=>null!=e.query(t,sm.BLOCK)))}(e,t)&&(n-=1),n}(this.quill.scroll,e.delta);this.quill.setSelection(t,lO.sources.USER)}}},"modules/keyboard":l6,"modules/uploader":cE,"modules/input":cT,"modules/uiNode":cA});let cS=new class extends sx{add(e,t){let r=0;if("+1"===t||"-1"===t){let n=this.value(e)||0;r="+1"===t?n+1:n-1}else"number"==typeof t&&(r=t);return 0===r?(this.remove(e),!0):super.add(e,r.toString())}canAdd(e,t){return super.canAdd(e,t)||super.canAdd(e,parseInt(t,10))}value(e){return parseInt(super.value(e),10)||void 0}}("indent","ql-indent",{scope:sm.BLOCK,whitelist:[1,2,3,4,5,6,7,8]}),ck=class extends aQ{static blotName="blockquote";static tagName="blockquote"},cN=class extends aQ{static blotName="header";static tagName=["H1","H2","H3","H4","H5","H6"];static formats(e){return this.tagName.indexOf(e.tagName)+1}};class cC extends lR{}cC.blotName="list-container",cC.tagName="OL";class cI extends aQ{static create(e){let t=super.create();return t.setAttribute("data-list",e),t}static formats(e){return e.getAttribute("data-list")||void 0}static register(){lO.register(cC)}constructor(e,t){super(e,t);let r=t.ownerDocument.createElement("span"),n=r=>{if(!e.isEnabled())return;let n=this.statics.formats(t,e);"checked"===n?(this.format("list","unchecked"),r.preventDefault()):"unchecked"===n&&(this.format("list","checked"),r.preventDefault())};r.addEventListener("mousedown",n),r.addEventListener("touchstart",n),this.attachUI(r)}format(e,t){e===this.statics.blotName&&t?this.domNode.setAttribute("data-list",t):super.format(e,t)}}cI.blotName="list",cI.tagName="LI",cC.allowedChildren=[cI],cI.requiredContainer=cC;let cR=class extends aJ{static blotName="bold";static tagName=["STRONG","B"];static create(){return super.create()}static formats(){return!0}optimize(e){super.optimize(e),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}};class cP extends aJ{static blotName="link";static tagName="A";static SANITIZED_URL="about:blank";static PROTOCOL_WHITELIST=["http","https","mailto","tel","sms"];static create(e){let t=super.create(e);return t.setAttribute("href",this.sanitize(e)),t.setAttribute("rel","noopener noreferrer"),t.setAttribute("target","_blank"),t}static formats(e){return e.getAttribute("href")}static sanitize(e){return cL(e,this.PROTOCOL_WHITELIST)?e:this.SANITIZED_URL}format(e,t){e===this.statics.blotName&&t?this.domNode.setAttribute("href",this.constructor.sanitize(t)):super.format(e,t)}}function cL(e,t){let r=document.createElement("a");r.href=e;let n=r.href.slice(0,r.href.indexOf(":"));return t.indexOf(n)>-1}let cD=class extends aJ{static blotName="script";static tagName=["SUB","SUP"];static create(e){return"super"===e?document.createElement("sup"):"sub"===e?document.createElement("sub"):super.create(e)}static formats(e){return"SUB"===e.tagName?"sub":"SUP"===e.tagName?"super":void 0}},cM=class extends aJ{static blotName="underline";static tagName="U"},cj=class extends lf{static blotName="formula";static className="ql-formula";static tagName="SPAN";static create(e){if(null==window.katex)throw Error("Formula module requires KaTeX.");let t=super.create(e);return"string"==typeof e&&(window.katex.render(e,t,{throwOnError:!1,errorColor:"#f00"}),t.setAttribute("data-value",e)),t}static value(e){return e.getAttribute("data-value")}html(){let{formula:e}=this.value();return`<span>${e}</span>`}},cB=["alt","height","width"],cF=class extends sF{static blotName="image";static tagName="IMG";static create(e){let t=super.create(e);return"string"==typeof e&&t.setAttribute("src",this.sanitize(e)),t}static formats(e){return cB.reduce((t,r)=>(e.hasAttribute(r)&&(t[r]=e.getAttribute(r)),t),{})}static match(e){return/\.(jpe?g|gif|png)$/.test(e)||/^data:image\/.+;base64/.test(e)}static sanitize(e){return cL(e,["http","https","data"])?e:"//:0"}static value(e){return e.getAttribute("src")}format(e,t){cB.indexOf(e)>-1?t?this.domNode.setAttribute(e,t):this.domNode.removeAttribute(e):super.format(e,t)}},cU=["height","width"],cq=class extends a0{static blotName="video";static className="ql-video";static tagName="IFRAME";static create(e){let t=super.create(e);return t.setAttribute("frameborder","0"),t.setAttribute("allowfullscreen","true"),t.setAttribute("src",this.sanitize(e)),t}static formats(e){return cU.reduce((t,r)=>(e.hasAttribute(r)&&(t[r]=e.getAttribute(r)),t),{})}static sanitize(e){return cP.sanitize(e)}static value(e){return e.getAttribute("src")}format(e,t){cU.indexOf(e)>-1?t?this.domNode.setAttribute(e,t):this.domNode.removeAttribute(e):super.format(e,t)}html(){let{video:e}=this.value();return`<a href="${e}">${e}</a>`}},cz=new sx("code-token","hljs",{scope:sm.INLINE});class cH extends aJ{static formats(e,t){for(;null!=e&&e!==t.domNode;){if(e.classList&&e.classList.contains(lK.className))return super.formats(e,t);e=e.parentNode}}constructor(e,t,r){super(e,t,r),cz.add(this.domNode,r)}format(e,t){e!==cH.blotName?super.format(e,t):t?cz.add(this.domNode,t):(cz.remove(this.domNode),this.domNode.classList.remove(this.statics.className))}optimize(){super.optimize(...arguments),cz.value(this.domNode)||this.unwrap()}}cH.blotName="code-token",cH.className="ql-token";class cX extends lK{static create(e){let t=super.create(e);return"string"==typeof e&&t.setAttribute("data-language",e),t}static formats(e){return e.getAttribute("data-language")||"plain"}static register(){}format(e,t){e===this.statics.blotName&&t?this.domNode.setAttribute("data-language",t):super.format(e,t)}replaceWith(e,t){return this.formatAt(0,this.length(),cH.blotName,!1),super.replaceWith(e,t)}}class cV extends l${attach(){super.attach(),this.forceNext=!1,this.scroll.emitMount(this)}format(e,t){e===cX.blotName&&(this.forceNext=!0,this.children.forEach(r=>{r.format(e,t)}))}formatAt(e,t,r,n){r===cX.blotName&&(this.forceNext=!0),super.formatAt(e,t,r,n)}highlight(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(null==this.children.head)return;let r=Array.from(this.domNode.childNodes).filter(e=>e!==this.uiNode),n=`${r.map(e=>e.textContent).join("\n")}
`,i=cX.formats(this.children.head.domNode);if(t||this.forceNext||this.cachedText!==n){if(n.trim().length>0||null==this.cachedText){let t=this.children.reduce((e,t)=>e.concat(a1(t,!1)),new sV),r=e(n,i);t.diff(r).reduce((e,t)=>{let{retain:r,attributes:n}=t;return r?(n&&Object.keys(n).forEach(t=>{[cX.blotName,cH.blotName].includes(t)&&this.formatAt(e,r,t,n[t])}),e+r):e},0)}this.cachedText=n,this.forceNext=!1}}html(e,t){let[r]=this.children.find(e),n=r?cX.formats(r.domNode):"plain";return`<pre data-language="${n}">
${aY(this.code(e,t))}
</pre>`}optimize(e){if(super.optimize(e),null!=this.parent&&null!=this.children.head&&null!=this.uiNode){let e=cX.formats(this.children.head.domNode);e!==this.uiNode.value&&(this.uiNode.value=e)}}}cV.allowedChildren=[cX],cX.requiredContainer=cV,cX.allowedChildren=[cH,a5,aW,aK];class c$ extends lp{static register(){lO.register(cH,!0),lO.register(cX,!0),lO.register(cV,!0)}constructor(e,t){if(super(e,t),null==this.options.hljs)throw Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");this.languages=this.options.languages.reduce((e,t)=>{let{key:r}=t;return e[r]=!0,e},{}),this.highlightBlot=this.highlightBlot.bind(this),this.initListener(),this.initTimer()}initListener(){this.quill.on(lO.events.SCROLL_BLOT_MOUNT,e=>{if(!(e instanceof cV))return;let t=this.quill.root.ownerDocument.createElement("select");this.options.languages.forEach(e=>{let{key:r,label:n}=e,i=t.ownerDocument.createElement("option");i.textContent=n,i.setAttribute("value",r),t.appendChild(i)}),t.addEventListener("change",()=>{e.format(cX.blotName,t.value),this.quill.root.focus(),this.highlight(e,!0)}),null==e.uiNode&&(e.attachUI(t),e.children.head&&(t.value=cX.formats(e.children.head.domNode)))})}initTimer(){let e=null;this.quill.on(lO.events.SCROLL_OPTIMIZE,()=>{e&&clearTimeout(e),e=setTimeout(()=>{this.highlight(),e=null},this.options.interval)})}highlight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.quill.selection.composing)return;this.quill.update(lO.sources.USER);let r=this.quill.getSelection();(null==e?this.quill.scroll.descendants(cV):[e]).forEach(e=>{e.highlight(this.highlightBlot,t)}),this.quill.update(lO.sources.SILENT),null!=r&&this.quill.setSelection(r,lO.sources.SILENT)}highlightBlot(e){var t,r,n;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"plain";if("plain"===(i=this.languages[i]?i:"plain"))return aY(e).split("\n").reduce((e,t,r)=>(0!==r&&e.insert("\n",{[lK.blotName]:i}),e.insert(t)),new sV);let o=this.quill.root.ownerDocument.createElement("div");return o.classList.add(lK.className),t=this.options.hljs,r=i,n=e,o.innerHTML="string"==typeof t.versionString&&parseInt(t.versionString.split(".")[0],10)>=11?t.highlight(n,{language:r}).value:t.highlight(r,n).value,cb(this.quill.scroll,o,[(e,t)=>{let r=cz.value(e);return r?t.compose(new sV().retain(t.length(),{[cH.blotName]:r})):t}],[(e,t)=>e.data.split("\n").reduce((e,t,r)=>(0!==r&&e.insert("\n",{[lK.blotName]:i}),e.insert(t)),t)],new WeakMap)}}c$.DEFAULTS={hljs:window.hljs,interval:1e3,languages:[{key:"plain",label:"Plain"},{key:"bash",label:"Bash"},{key:"cpp",label:"C++"},{key:"cs",label:"C#"},{key:"css",label:"CSS"},{key:"diff",label:"Diff"},{key:"xml",label:"HTML/XML"},{key:"java",label:"Java"},{key:"javascript",label:"JavaScript"},{key:"markdown",label:"Markdown"},{key:"php",label:"PHP"},{key:"python",label:"Python"},{key:"ruby",label:"Ruby"},{key:"sql",label:"SQL"}]};class cK extends aQ{static blotName="table";static tagName="TD";static create(e){let t=super.create();return e?t.setAttribute("data-row",e):t.setAttribute("data-row",cZ()),t}static formats(e){if(e.hasAttribute("data-row"))return e.getAttribute("data-row")}cellOffset(){return this.parent?this.parent.children.indexOf(this):-1}format(e,t){e===cK.blotName&&t?this.domNode.setAttribute("data-row",t):super.format(e,t)}row(){return this.parent}rowOffset(){return this.row()?this.row().rowOffset():-1}table(){return this.row()&&this.row().table()}}class cW extends lR{static blotName="table-row";static tagName="TR";checkMerge(){if(super.checkMerge()&&null!=this.next.children.head){let e=this.children.head.formats(),t=this.children.tail.formats(),r=this.next.children.head.formats(),n=this.next.children.tail.formats();return e.table===t.table&&e.table===r.table&&e.table===n.table}return!1}optimize(e){super.optimize(e),this.children.forEach(e=>{if(null==e.next)return;let t=e.formats(),r=e.next.formats();if(t.table!==r.table){let t=this.splitAfter(e);t&&t.optimize(),this.prev&&this.prev.optimize()}})}rowOffset(){return this.parent?this.parent.children.indexOf(this):-1}table(){return this.parent&&this.parent.parent}}class cG extends lR{static blotName="table-body";static tagName="TBODY"}class cY extends lR{static blotName="table-container";static tagName="TABLE";balanceCells(){let e=this.descendants(cW),t=e.reduce((e,t)=>Math.max(t.children.length,e),0);e.forEach(e=>{Array(t-e.children.length).fill(0).forEach(()=>{let t;null!=e.children.head&&(t=cK.formats(e.children.head.domNode));let r=this.scroll.create(cK.blotName,t);e.appendChild(r),r.optimize()})})}cells(e){return this.rows().map(t=>t.children.at(e))}deleteColumn(e){let[t]=this.descendant(cG);null!=t&&null!=t.children.head&&t.children.forEach(t=>{let r=t.children.at(e);null!=r&&r.remove()})}insertColumn(e){let[t]=this.descendant(cG);null!=t&&null!=t.children.head&&t.children.forEach(t=>{let r=t.children.at(e),n=cK.formats(t.children.head.domNode),i=this.scroll.create(cK.blotName,n);t.insertBefore(i,r)})}insertRow(e){let[t]=this.descendant(cG);if(null==t||null==t.children.head)return;let r=cZ(),n=this.scroll.create(cW.blotName);t.children.head.children.forEach(()=>{let e=this.scroll.create(cK.blotName,r);n.appendChild(e)});let i=t.children.at(e);t.insertBefore(n,i)}rows(){let e=this.children.head;return null==e?[]:e.children.map(e=>e)}}function cZ(){let e=Math.random().toString(36).slice(2,6);return`row-${e}`}cY.allowedChildren=[cG],cG.requiredContainer=cY,cG.allowedChildren=[cW],cW.requiredContainer=cG,cW.allowedChildren=[cK],cK.requiredContainer=cW;let cJ=class extends lp{static register(){lO.register(cK),lO.register(cW),lO.register(cG),lO.register(cY)}constructor(){super(...arguments),this.listenBalanceCells()}balanceTables(){this.quill.scroll.descendants(cY).forEach(e=>{e.balanceCells()})}deleteColumn(){let[e,,t]=this.getTable();null!=t&&(e.deleteColumn(t.cellOffset()),this.quill.update(lO.sources.USER))}deleteRow(){let[,e]=this.getTable();null!=e&&(e.remove(),this.quill.update(lO.sources.USER))}deleteTable(){let[e]=this.getTable();if(null==e)return;let t=e.offset();e.remove(),this.quill.update(lO.sources.USER),this.quill.setSelection(t,lO.sources.SILENT)}getTable(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.quill.getSelection();if(null==e)return[null,null,null,-1];let[t,r]=this.quill.getLine(e.index);if(null==t||t.statics.blotName!==cK.blotName)return[null,null,null,-1];let n=t.parent;return[n.parent.parent,n,t,r]}insertColumn(e){let t=this.quill.getSelection();if(!t)return;let[r,n,i]=this.getTable(t);if(null==i)return;let o=i.cellOffset();r.insertColumn(o+e),this.quill.update(lO.sources.USER);let s=n.rowOffset();0===e&&(s+=1),this.quill.setSelection(t.index+s,t.length,lO.sources.SILENT)}insertColumnLeft(){this.insertColumn(0)}insertColumnRight(){this.insertColumn(1)}insertRow(e){let t=this.quill.getSelection();if(!t)return;let[r,n,i]=this.getTable(t);if(null==i)return;let o=n.rowOffset();r.insertRow(o+e),this.quill.update(lO.sources.USER),e>0?this.quill.setSelection(t,lO.sources.SILENT):this.quill.setSelection(t.index+n.children.length,t.length,lO.sources.SILENT)}insertRowAbove(){this.insertRow(0)}insertRowBelow(){this.insertRow(1)}insertTable(e,t){let r=this.quill.getSelection();if(null==r)return;let n=Array(e).fill(0).reduce(e=>{let r=Array(t).fill("\n").join("");return e.insert(r,{table:cZ()})},new sV().retain(r.index));this.quill.updateContents(n,lO.sources.USER),this.quill.setSelection(r.index,lO.sources.SILENT),this.balanceTables()}listenBalanceCells(){this.quill.on(lO.events.SCROLL_OPTIMIZE,e=>{e.some(e=>!!["TD","TR","TBODY","TABLE"].includes(e.target.tagName)&&(this.quill.once(lO.events.TEXT_CHANGE,(e,t,r)=>{r===lO.sources.USER&&this.balanceTables()}),!0))})}},cQ=le("quill:toolbar");class c0 extends lp{constructor(e,t){if(super(e,t),Array.isArray(this.options.container)){let t=document.createElement("div");t.setAttribute("role","toolbar"),function(e,t){Array.isArray(t[0])||(t=[t]),t.forEach(t=>{let r=document.createElement("span");r.classList.add("ql-formats"),t.forEach(e=>{if("string"==typeof e)c1(r,e);else{let t=Object.keys(e)[0],n=e[t];Array.isArray(n)?function(e,t,r){let n=document.createElement("select");n.classList.add(`ql-${t}`),r.forEach(e=>{let t=document.createElement("option");!1!==e?t.setAttribute("value",String(e)):t.setAttribute("selected","selected"),n.appendChild(t)}),e.appendChild(n)}(r,t,n):c1(r,t,n)}}),e.appendChild(r)})}(t,this.options.container),e.container?.parentNode?.insertBefore(t,e.container),this.container=t}else"string"==typeof this.options.container?this.container=document.querySelector(this.options.container):this.container=this.options.container;if(!(this.container instanceof HTMLElement))return void cQ.error("Container required for toolbar",this.options);this.container.classList.add("ql-toolbar"),this.controls=[],this.handlers={},this.options.handlers&&Object.keys(this.options.handlers).forEach(e=>{let t=this.options.handlers?.[e];t&&this.addHandler(e,t)}),Array.from(this.container.querySelectorAll("button, select")).forEach(e=>{this.attach(e)}),this.quill.on(lO.events.EDITOR_CHANGE,()=>{let[e]=this.quill.selection.getRange();this.update(e)})}addHandler(e,t){this.handlers[e]=t}attach(e){let t=Array.from(e.classList).find(e=>0===e.indexOf("ql-"));if(!t)return;if(t=t.slice(3),"BUTTON"===e.tagName&&e.setAttribute("type","button"),null==this.handlers[t]&&null==this.quill.scroll.query(t))return void cQ.warn("ignoring attaching to nonexistent format",t,e);let r="SELECT"===e.tagName?"change":"click";e.addEventListener(r,r=>{let n;if("SELECT"===e.tagName){if(e.selectedIndex<0)return;let t=e.options[e.selectedIndex];n=!t.hasAttribute("selected")&&(t.value||!1)}else n=!e.classList.contains("ql-active")&&(e.value||!e.hasAttribute("value")),r.preventDefault();this.quill.focus();let[i]=this.quill.selection.getRange();if(null!=this.handlers[t])this.handlers[t].call(this,n);else if(this.quill.scroll.query(t).prototype instanceof sF){if(!(n=prompt(`Enter ${t}`)))return;this.quill.updateContents(new sV().retain(i.index).delete(i.length).insert({[t]:n}),lO.sources.USER)}else this.quill.format(t,n,lO.sources.USER);this.update(i)}),this.controls.push([t,e])}update(e){let t=null==e?{}:this.quill.getFormat(e);this.controls.forEach(r=>{let[n,i]=r;if("SELECT"===i.tagName){let r=null;if(null==e)r=null;else if(null==t[n])r=i.querySelector("option[selected]");else if(!Array.isArray(t[n])){let e=t[n];"string"==typeof e&&(e=e.replace(/"/g,'\\"')),r=i.querySelector(`option[value="${e}"]`)}null==r?(i.value="",i.selectedIndex=-1):r.selected=!0}else if(null==e)i.classList.remove("ql-active"),i.setAttribute("aria-pressed","false");else if(i.hasAttribute("value")){let e=t[n],r=e===i.getAttribute("value")||null!=e&&e.toString()===i.getAttribute("value")||null==e&&!i.getAttribute("value");i.classList.toggle("ql-active",r),i.setAttribute("aria-pressed",r.toString())}else{let e=null!=t[n];i.classList.toggle("ql-active",e),i.setAttribute("aria-pressed",e.toString())}})}}function c1(e,t,r){let n=document.createElement("button");n.setAttribute("type","button"),n.classList.add(`ql-${t}`),n.setAttribute("aria-pressed","false"),null!=r?(n.value=r,n.setAttribute("aria-label",`${t}: ${r}`)):n.setAttribute("aria-label",t),e.appendChild(n)}c0.DEFAULTS={},c0.DEFAULTS={container:null,handlers:{clean(){let e=this.quill.getSelection();null!=e&&(0===e.length?Object.keys(this.quill.getFormat()).forEach(e=>{null!=this.quill.scroll.query(e,sm.INLINE)&&this.quill.format(e,!1,lO.sources.USER)}):this.quill.removeFormat(e.index,e.length,lO.sources.USER))},direction(e){let{align:t}=this.quill.getFormat();"rtl"===e&&null==t?this.quill.format("align","right",lO.sources.USER):e||"right"!==t||this.quill.format("align",!1,lO.sources.USER),this.quill.format("direction",e,lO.sources.USER)},indent(e){let t=this.quill.getSelection(),r=this.quill.getFormat(t),n=parseInt(r.indent||0,10);if("+1"===e||"-1"===e){let t="+1"===e?1:-1;"rtl"===r.direction&&(t*=-1),this.quill.format("indent",n+t,lO.sources.USER)}},link(e){!0===e&&(e=prompt("Enter link URL:")),this.quill.format("link",e,lO.sources.USER)},list(e){let t=this.quill.getSelection(),r=this.quill.getFormat(t);"check"===e?"checked"===r.list||"unchecked"===r.list?this.quill.format("list",!1,lO.sources.USER):this.quill.format("list","unchecked",lO.sources.USER):this.quill.format("list",e,lO.sources.USER)}}};let c2='<svg viewbox="0 0 18 18"><polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"/><polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"/><line class="ql-stroke" x1="10" x2="8" y1="5" y2="13"/></svg>',c5={align:{"":'<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="3" x2="13" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="9" y1="4" y2="4"/></svg>',center:'<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="14" x2="4" y1="14" y2="14"/><line class="ql-stroke" x1="12" x2="6" y1="4" y2="4"/></svg>',right:'<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="15" x2="5" y1="14" y2="14"/><line class="ql-stroke" x1="15" x2="9" y1="4" y2="4"/></svg>',justify:'<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="15" x2="3" y1="14" y2="14"/><line class="ql-stroke" x1="15" x2="3" y1="4" y2="4"/></svg>'},background:'<svg viewbox="0 0 18 18"><g class="ql-fill ql-color-label"><polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"/><rect height="1" width="1" x="4" y="4"/><polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"/><rect height="1" width="1" x="2" y="6"/><rect height="1" width="1" x="3" y="5"/><rect height="1" width="1" x="4" y="7"/><polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"/><rect height="1" width="1" x="2" y="12"/><rect height="1" width="1" x="2" y="9"/><rect height="1" width="1" x="2" y="15"/><polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"/><rect height="1" width="1" x="3" y="8"/><path d="M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z"/><path d="M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z"/><path d="M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z"/><rect height="1" width="1" x="12" y="2"/><rect height="1" width="1" x="11" y="3"/><path d="M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z"/><rect height="1" width="1" x="2" y="3"/><rect height="1" width="1" x="6" y="2"/><rect height="1" width="1" x="3" y="2"/><rect height="1" width="1" x="5" y="3"/><rect height="1" width="1" x="9" y="2"/><rect height="1" width="1" x="15" y="14"/><polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"/><rect height="1" width="1" x="13" y="7"/><rect height="1" width="1" x="15" y="5"/><rect height="1" width="1" x="14" y="6"/><rect height="1" width="1" x="15" y="8"/><rect height="1" width="1" x="14" y="9"/><path d="M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z"/><rect height="1" width="1" x="14" y="3"/><polygon points="12 6.868 12 6 11.62 6 12 6.868"/><rect height="1" width="1" x="15" y="2"/><rect height="1" width="1" x="12" y="5"/><rect height="1" width="1" x="13" y="4"/><polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"/><rect height="1" width="1" x="9" y="14"/><rect height="1" width="1" x="8" y="15"/><path d="M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z"/><rect height="1" width="1" x="5" y="15"/><path d="M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z"/><rect height="1" width="1" x="11" y="15"/><path d="M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z"/><rect height="1" width="1" x="14" y="15"/><rect height="1" width="1" x="15" y="11"/></g><polyline class="ql-stroke" points="5.5 13 9 5 12.5 13"/><line class="ql-stroke" x1="11.63" x2="6.38" y1="11" y2="11"/></svg>',blockquote:'<svg viewbox="0 0 18 18"><rect class="ql-fill ql-stroke" height="3" width="3" x="4" y="5"/><rect class="ql-fill ql-stroke" height="3" width="3" x="11" y="5"/><path class="ql-even ql-fill ql-stroke" d="M7,8c0,4.031-3,5-3,5"/><path class="ql-even ql-fill ql-stroke" d="M14,8c0,4.031-3,5-3,5"/></svg>',bold:'<svg viewbox="0 0 18 18"><path class="ql-stroke" d="M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z"/><path class="ql-stroke" d="M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z"/></svg>',clean:'<svg class="" viewbox="0 0 18 18"><line class="ql-stroke" x1="5" x2="13" y1="3" y2="3"/><line class="ql-stroke" x1="6" x2="9.35" y1="12" y2="3"/><line class="ql-stroke" x1="11" x2="15" y1="11" y2="15"/><line class="ql-stroke" x1="15" x2="11" y1="11" y2="15"/><rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="7" x="2" y="14"/></svg>',code:c2,"code-block":c2,color:'<svg viewbox="0 0 18 18"><line class="ql-color-label ql-stroke ql-transparent" x1="3" x2="15" y1="15" y2="15"/><polyline class="ql-stroke" points="5.5 11 9 3 12.5 11"/><line class="ql-stroke" x1="11.63" x2="6.38" y1="9" y2="9"/></svg>',direction:{"":'<svg viewbox="0 0 18 18"><polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"/><line class="ql-stroke ql-fill" x1="15" x2="11" y1="4" y2="4"/><path class="ql-fill" d="M11,3a3,3,0,0,0,0,6h1V3H11Z"/><rect class="ql-fill" height="11" width="1" x="11" y="4"/><rect class="ql-fill" height="11" width="1" x="13" y="4"/></svg>',rtl:'<svg viewbox="0 0 18 18"><polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"/><line class="ql-stroke ql-fill" x1="9" x2="5" y1="4" y2="4"/><path class="ql-fill" d="M5,3A3,3,0,0,0,5,9H6V3H5Z"/><rect class="ql-fill" height="11" width="1" x="5" y="4"/><rect class="ql-fill" height="11" width="1" x="7" y="4"/></svg>'},formula:'<svg viewbox="0 0 18 18"><path class="ql-fill" d="M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z"/><rect class="ql-fill" height="1.6" rx="0.8" ry="0.8" width="5" x="5.15" y="6.2"/><path class="ql-fill" d="M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z"/></svg>',header:{1:'<svg viewBox="0 0 18 18"><path class="ql-fill" d="M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z"/></svg>',2:'<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',3:'<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.65186,12.30664a2.6742,2.6742,0,0,1-2.915,2.68457,3.96592,3.96592,0,0,1-2.25537-.6709.56007.56007,0,0,1-.13232-.83594L11.64648,13c.209-.34082.48389-.36328.82471-.1543a2.32654,2.32654,0,0,0,1.12256.33008c.71484,0,1.12207-.35156,1.12207-.78125,0-.61523-.61621-.86816-1.46338-.86816H13.2085a.65159.65159,0,0,1-.68213-.41895l-.05518-.10937a.67114.67114,0,0,1,.14307-.78125l.71533-.86914a8.55289,8.55289,0,0,1,.68213-.7373V8.58887a3.93913,3.93913,0,0,1-.748.05469H11.9873a.54085.54085,0,0,1-.605-.60547V7.59863a.54085.54085,0,0,1,.605-.60547h3.75146a.53773.53773,0,0,1,.60547.59375v.17676a1.03723,1.03723,0,0,1-.27539.748L14.74854,10.0293A2.31132,2.31132,0,0,1,16.65186,12.30664ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',4:'<svg viewBox="0 0 18 18"><path class="ql-fill" d="M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm7.05371,7.96582v.38477c0,.39648-.165.60547-.46191.60547h-.47314v1.29785a.54085.54085,0,0,1-.605.60547h-.69336a.54085.54085,0,0,1-.605-.60547V12.95605H11.333a.5412.5412,0,0,1-.60547-.60547v-.15332a1.199,1.199,0,0,1,.22021-.748l2.56348-4.05957a.7819.7819,0,0,1,.72607-.39648h1.27637a.54085.54085,0,0,1,.605.60547v3.7627h.33008A.54055.54055,0,0,1,17.05371,11.96582ZM14.28125,8.7207h-.022a4.18969,4.18969,0,0,1-.38525.81348l-1.188,1.80469v.02246h1.5293V9.60059A7.04058,7.04058,0,0,1,14.28125,8.7207Z"/></svg>',5:'<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.74023,12.18555a2.75131,2.75131,0,0,1-2.91553,2.80566,3.908,3.908,0,0,1-2.25537-.68164.54809.54809,0,0,1-.13184-.8252L11.73438,13c.209-.34082.48389-.36328.8252-.1543a2.23757,2.23757,0,0,0,1.1001.33008,1.01827,1.01827,0,0,0,1.1001-.96777c0-.61621-.53906-.97949-1.25439-.97949a2.15554,2.15554,0,0,0-.64893.09961,1.15209,1.15209,0,0,1-.814.01074l-.12109-.04395a.64116.64116,0,0,1-.45117-.71484l.231-3.00391a.56666.56666,0,0,1,.62744-.583H15.541a.54085.54085,0,0,1,.605.60547v.43945a.54085.54085,0,0,1-.605.60547H13.41748l-.04395.72559a1.29306,1.29306,0,0,1-.04395.30859h.022a2.39776,2.39776,0,0,1,.57227-.07715A2.53266,2.53266,0,0,1,16.74023,12.18555ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',6:'<svg viewBox="0 0 18 18"><path class="ql-fill" d="M14.51758,9.64453a1.85627,1.85627,0,0,0-1.24316.38477H13.252a1.73532,1.73532,0,0,1,1.72754-1.4082,2.66491,2.66491,0,0,1,.5498.06641c.35254.05469.57227.01074.70508-.40723l.16406-.5166a.53393.53393,0,0,0-.373-.75977,4.83723,4.83723,0,0,0-1.17773-.14258c-2.43164,0-3.7627,2.17773-3.7627,4.43359,0,2.47559,1.60645,3.69629,3.19043,3.69629A2.70585,2.70585,0,0,0,16.96,12.19727,2.43861,2.43861,0,0,0,14.51758,9.64453Zm-.23047,3.58691c-.67187,0-1.22168-.81445-1.22168-1.45215,0-.47363.30762-.583.72559-.583.96875,0,1.27734.59375,1.27734,1.12207A.82182.82182,0,0,1,14.28711,13.23145ZM10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Z"/></svg>'},italic:'<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="13" y1="4" y2="4"/><line class="ql-stroke" x1="5" x2="11" y1="14" y2="14"/><line class="ql-stroke" x1="8" x2="10" y1="14" y2="4"/></svg>',image:'<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="10" width="12" x="3" y="4"/><circle class="ql-fill" cx="6" cy="7" r="1"/><polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"/></svg>',indent:{"+1":'<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"/></svg>',"-1":'<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-stroke" points="5 7 5 11 3 9 5 7"/></svg>'},link:'<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="11" y1="7" y2="11"/><path class="ql-even ql-stroke" d="M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z"/><path class="ql-even ql-stroke" d="M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z"/></svg>',list:{bullet:'<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="6" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="6" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="6" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="3" y1="4" y2="4"/><line class="ql-stroke" x1="3" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="3" x2="3" y1="14" y2="14"/></svg>',check:'<svg class="" viewbox="0 0 18 18"><line class="ql-stroke" x1="9" x2="15" y1="4" y2="4"/><polyline class="ql-stroke" points="3 4 4 5 6 3"/><line class="ql-stroke" x1="9" x2="15" y1="14" y2="14"/><polyline class="ql-stroke" points="3 14 4 15 6 13"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-stroke" points="3 9 4 10 6 8"/></svg>',ordered:'<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="7" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="7" x2="15" y1="14" y2="14"/><line class="ql-stroke ql-thin" x1="2.5" x2="4.5" y1="5.5" y2="5.5"/><path class="ql-fill" d="M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z"/><path class="ql-stroke ql-thin" d="M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156"/><path class="ql-stroke ql-thin" d="M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109"/></svg>'},script:{sub:'<svg viewbox="0 0 18 18"><path class="ql-fill" d="M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z"/><path class="ql-fill" d="M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z"/></svg>',super:'<svg viewbox="0 0 18 18"><path class="ql-fill" d="M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z"/><path class="ql-fill" d="M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z"/></svg>'},strike:'<svg viewbox="0 0 18 18"><line class="ql-stroke ql-thin" x1="15.5" x2="2.5" y1="8.5" y2="9.5"/><path class="ql-fill" d="M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z"/><path class="ql-fill" d="M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z"/></svg>',table:'<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="12" width="12" x="3" y="3"/><rect class="ql-fill" height="2" width="3" x="5" y="5"/><rect class="ql-fill" height="2" width="4" x="9" y="5"/><g class="ql-fill ql-transparent"><rect height="2" width="3" x="5" y="8"/><rect height="2" width="4" x="9" y="8"/><rect height="2" width="3" x="5" y="11"/><rect height="2" width="4" x="9" y="11"/></g></svg>',underline:'<svg viewbox="0 0 18 18"><path class="ql-stroke" d="M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3"/><rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="12" x="3" y="15"/></svg>',video:'<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="12" width="12" x="3" y="3"/><rect class="ql-fill" height="12" width="1" x="5" y="3"/><rect class="ql-fill" height="12" width="1" x="12" y="3"/><rect class="ql-fill" height="2" width="8" x="5" y="8"/><rect class="ql-fill" height="1" width="3" x="3" y="5"/><rect class="ql-fill" height="1" width="3" x="3" y="7"/><rect class="ql-fill" height="1" width="3" x="3" y="10"/><rect class="ql-fill" height="1" width="3" x="3" y="12"/><rect class="ql-fill" height="1" width="3" x="12" y="5"/><rect class="ql-fill" height="1" width="3" x="12" y="7"/><rect class="ql-fill" height="1" width="3" x="12" y="10"/><rect class="ql-fill" height="1" width="3" x="12" y="12"/></svg>'},c3=0;function c4(e,t){e.setAttribute(t,`${"true"!==e.getAttribute(t)}`)}let c6=class{constructor(e){this.select=e,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("mousedown",()=>{this.togglePicker()}),this.label.addEventListener("keydown",e=>{switch(e.key){case"Enter":this.togglePicker();break;case"Escape":this.escape(),e.preventDefault()}}),this.select.addEventListener("change",this.update.bind(this))}togglePicker(){this.container.classList.toggle("ql-expanded"),c4(this.label,"aria-expanded"),c4(this.options,"aria-hidden")}buildItem(e){let t=document.createElement("span");t.tabIndex="0",t.setAttribute("role","button"),t.classList.add("ql-picker-item");let r=e.getAttribute("value");return r&&t.setAttribute("data-value",r),e.textContent&&t.setAttribute("data-label",e.textContent),t.addEventListener("click",()=>{this.selectItem(t,!0)}),t.addEventListener("keydown",e=>{switch(e.key){case"Enter":this.selectItem(t,!0),e.preventDefault();break;case"Escape":this.escape(),e.preventDefault()}}),t}buildLabel(){let e=document.createElement("span");return e.classList.add("ql-picker-label"),e.innerHTML='<svg viewbox="0 0 18 18"><polygon class="ql-stroke" points="7 11 9 13 11 11 7 11"/><polygon class="ql-stroke" points="7 7 9 5 11 7 7 7"/></svg>',e.tabIndex="0",e.setAttribute("role","button"),e.setAttribute("aria-expanded","false"),this.container.appendChild(e),e}buildOptions(){let e=document.createElement("span");e.classList.add("ql-picker-options"),e.setAttribute("aria-hidden","true"),e.tabIndex="-1",e.id=`ql-picker-options-${c3}`,c3+=1,this.label.setAttribute("aria-controls",e.id),this.options=e,Array.from(this.select.options).forEach(t=>{let r=this.buildItem(t);e.appendChild(r),!0===t.selected&&this.selectItem(r)}),this.container.appendChild(e)}buildPicker(){Array.from(this.select.attributes).forEach(e=>{this.container.setAttribute(e.name,e.value)}),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}escape(){this.close(),setTimeout(()=>this.label.focus(),1)}close(){this.container.classList.remove("ql-expanded"),this.label.setAttribute("aria-expanded","false"),this.options.setAttribute("aria-hidden","true")}selectItem(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.container.querySelector(".ql-selected");e!==r&&(null!=r&&r.classList.remove("ql-selected"),null!=e&&(e.classList.add("ql-selected"),this.select.selectedIndex=Array.from(e.parentNode.children).indexOf(e),e.hasAttribute("data-value")?this.label.setAttribute("data-value",e.getAttribute("data-value")):this.label.removeAttribute("data-value"),e.hasAttribute("data-label")?this.label.setAttribute("data-label",e.getAttribute("data-label")):this.label.removeAttribute("data-label"),t&&(this.select.dispatchEvent(new Event("change")),this.close())))}update(){let e;if(this.select.selectedIndex>-1){let t=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];e=this.select.options[this.select.selectedIndex],this.selectItem(t)}else this.selectItem(null);let t=null!=e&&e!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",t)}},c8=class extends c6{constructor(e,t){super(e),this.label.innerHTML=t,this.container.classList.add("ql-color-picker"),Array.from(this.container.querySelectorAll(".ql-picker-item")).slice(0,7).forEach(e=>{e.classList.add("ql-primary")})}buildItem(e){let t=super.buildItem(e);return t.style.backgroundColor=e.getAttribute("value")||"",t}selectItem(e,t){super.selectItem(e,t);let r=this.label.querySelector(".ql-color-label"),n=e&&e.getAttribute("data-value")||"";r&&("line"===r.tagName?r.style.stroke=n:r.style.fill=n)}},c9=class extends c6{constructor(e,t){super(e),this.container.classList.add("ql-icon-picker"),Array.from(this.container.querySelectorAll(".ql-picker-item")).forEach(e=>{e.innerHTML=t[e.getAttribute("data-value")||""]}),this.defaultItem=this.container.querySelector(".ql-selected"),this.selectItem(this.defaultItem)}selectItem(e,t){super.selectItem(e,t);let r=e||this.defaultItem;if(null!=r){if(this.label.innerHTML===r.innerHTML)return;this.label.innerHTML=r.innerHTML}}},c7=class{constructor(e,t){this.quill=e,this.boundsContainer=t||document.body,this.root=e.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,(e=>{let{overflowY:t}=getComputedStyle(e,null);return"visible"!==t&&"clip"!==t})(this.quill.root)&&this.quill.root.addEventListener("scroll",()=>{this.root.style.marginTop=`${-1*this.quill.root.scrollTop}px`}),this.hide()}hide(){this.root.classList.add("ql-hidden")}position(e){let t=e.left+e.width/2-this.root.offsetWidth/2,r=e.bottom+this.quill.root.scrollTop;this.root.style.left=`${t}px`,this.root.style.top=`${r}px`,this.root.classList.remove("ql-flip");let n=this.boundsContainer.getBoundingClientRect(),i=this.root.getBoundingClientRect(),o=0;if(i.right>n.right&&(o=n.right-i.right,this.root.style.left=`${t+o}px`),i.left<n.left&&(o=n.left-i.left,this.root.style.left=`${t+o}px`),i.bottom>n.bottom){let t=i.bottom-i.top,n=e.bottom-e.top+t;this.root.style.top=`${r-n}px`,this.root.classList.add("ql-flip")}return o}show(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}},ue=[!1,"center","right","justify"],ut=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],ur=[!1,"serif","monospace"],un=["1","2","3",!1],ui=["small",!1,"large","huge"];class uo extends lb{constructor(e,t){super(e,t);let r=t=>{if(!document.body.contains(e.root))return void document.body.removeEventListener("click",r);null==this.tooltip||this.tooltip.root.contains(t.target)||document.activeElement===this.tooltip.textbox||this.quill.hasFocus()||this.tooltip.hide(),null!=this.pickers&&this.pickers.forEach(e=>{e.container.contains(t.target)||e.close()})};e.emitter.listenDOM("click",document.body,r)}addModule(e){let t=super.addModule(e);return"toolbar"===e&&this.extendToolbar(t),t}buildButtons(e,t){Array.from(e).forEach(e=>{(e.getAttribute("class")||"").split(/\s+/).forEach(r=>{if(r.startsWith("ql-")&&null!=t[r=r.slice(3)])if("direction"===r)e.innerHTML=t[r][""]+t[r].rtl;else if("string"==typeof t[r])e.innerHTML=t[r];else{let n=e.value||"";null!=n&&t[r][n]&&(e.innerHTML=t[r][n])}})})}buildPickers(e,t){this.pickers=Array.from(e).map(e=>{if(e.classList.contains("ql-align")&&(null==e.querySelector("option")&&ua(e,ue),"object"==typeof t.align))return new c9(e,t.align);if(e.classList.contains("ql-background")||e.classList.contains("ql-color")){let r=e.classList.contains("ql-background")?"background":"color";return null==e.querySelector("option")&&ua(e,ut,"background"===r?"#ffffff":"#000000"),new c8(e,t[r])}return null==e.querySelector("option")&&(e.classList.contains("ql-font")?ua(e,ur):e.classList.contains("ql-header")?ua(e,un):e.classList.contains("ql-size")&&ua(e,ui)),new c6(e)});let r=()=>{this.pickers.forEach(e=>{e.update()})};this.quill.on(lr.events.EDITOR_CHANGE,r)}}uo.DEFAULTS=sf({},lb.DEFAULTS,{modules:{toolbar:{handlers:{formula(){this.quill.theme.tooltip.edit("formula")},image(){let e=this.container.querySelector("input.ql-image[type=file]");null==e&&((e=document.createElement("input")).setAttribute("type","file"),e.setAttribute("accept",this.quill.uploader.options.mimetypes.join(", ")),e.classList.add("ql-image"),e.addEventListener("change",()=>{let t=this.quill.getSelection(!0);this.quill.uploader.upload(t,e.files),e.value=""}),this.container.appendChild(e)),e.click()},video(){this.quill.theme.tooltip.edit("video")}}}}});class us extends c7{constructor(e,t){super(e,t),this.textbox=this.root.querySelector('input[type="text"]'),this.listen()}listen(){this.textbox.addEventListener("keydown",e=>{"Enter"===e.key?(this.save(),e.preventDefault()):"Escape"===e.key&&(this.cancel(),e.preventDefault())})}cancel(){this.hide(),this.restoreFocus()}edit(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"link",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),null==this.textbox)return;null!=t?this.textbox.value=t:e!==this.root.getAttribute("data-mode")&&(this.textbox.value="");let r=this.quill.getBounds(this.quill.selection.savedRange);null!=r&&this.position(r),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute(`data-${e}`)||""),this.root.setAttribute("data-mode",e)}restoreFocus(){this.quill.focus({preventScroll:!0})}save(){let{value:e}=this.textbox;switch(this.root.getAttribute("data-mode")){case"link":{let{scrollTop:t}=this.quill.root;this.linkRange?(this.quill.formatText(this.linkRange,"link",e,lr.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",e,lr.sources.USER)),this.quill.root.scrollTop=t;break}case"video":var t;let r;e=(r=(t=e).match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||t.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/))?`${r[1]||"https"}://www.youtube.com/embed/${r[2]}?showinfo=0`:(r=t.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?`${r[1]||"https"}://player.vimeo.com/video/${r[2]}/`:t;case"formula":{if(!e)break;let t=this.quill.getSelection(!0);if(null!=t){let r=t.index+t.length;this.quill.insertEmbed(r,this.root.getAttribute("data-mode"),e,lr.sources.USER),"formula"===this.root.getAttribute("data-mode")&&this.quill.insertText(r+1," ",lr.sources.USER),this.quill.setSelection(r+2,lr.sources.USER)}}}this.textbox.value="",this.hide()}}function ua(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t.forEach(t=>{let n=document.createElement("option");t===r?n.setAttribute("selected","selected"):n.setAttribute("value",String(t)),e.appendChild(n)})}let ul=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]];class uc extends us{static TEMPLATE='<span class="ql-tooltip-arrow"></span><div class="ql-tooltip-editor"><input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL"><a class="ql-close"></a></div>';constructor(e,t){super(e,t),this.quill.on(lr.events.EDITOR_CHANGE,(e,t,r,n)=>{if(e===lr.events.SELECTION_CHANGE)if(null!=t&&t.length>0&&n===lr.sources.USER){this.show(),this.root.style.left="0px",this.root.style.width="",this.root.style.width=`${this.root.offsetWidth}px`;let e=this.quill.getLines(t.index,t.length);if(1===e.length){let e=this.quill.getBounds(t);null!=e&&this.position(e)}else{let r=e[e.length-1],n=this.quill.getIndex(r),i=Math.min(r.length()-1,t.index+t.length-n),o=this.quill.getBounds(new li(n,i));null!=o&&this.position(o)}}else document.activeElement!==this.textbox&&this.quill.hasFocus()&&this.hide()})}listen(){super.listen(),this.root.querySelector(".ql-close").addEventListener("click",()=>{this.root.classList.remove("ql-editing")}),this.quill.on(lr.events.SCROLL_OPTIMIZE,()=>{setTimeout(()=>{if(this.root.classList.contains("ql-hidden"))return;let e=this.quill.getSelection();if(null!=e){let t=this.quill.getBounds(e);null!=t&&this.position(t)}},1)})}cancel(){this.show()}position(e){let t=super.position(e),r=this.root.querySelector(".ql-tooltip-arrow");return r.style.marginLeft="",0!==t&&(r.style.marginLeft=`${-1*t-r.offsetWidth/2}px`),t}}class uu extends uo{constructor(e,t){null!=t.modules.toolbar&&null==t.modules.toolbar.container&&(t.modules.toolbar.container=ul),super(e,t),this.quill.container.classList.add("ql-bubble")}extendToolbar(e){this.tooltip=new uc(this.quill,this.options.bounds),null!=e.container&&(this.tooltip.root.appendChild(e.container),this.buildButtons(e.container.querySelectorAll("button"),c5),this.buildPickers(e.container.querySelectorAll("select"),c5))}}uu.DEFAULTS=sf({},uo.DEFAULTS,{modules:{toolbar:{handlers:{link(e){e?this.quill.theme.tooltip.edit():this.quill.format("link",!1,lO.sources.USER)}}}}});let ud=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]];class uh extends us{static TEMPLATE='<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a><input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL"><a class="ql-action"></a><a class="ql-remove"></a>';preview=this.root.querySelector("a.ql-preview");listen(){super.listen(),this.root.querySelector("a.ql-action").addEventListener("click",e=>{this.root.classList.contains("ql-editing")?this.save():this.edit("link",this.preview.textContent),e.preventDefault()}),this.root.querySelector("a.ql-remove").addEventListener("click",e=>{if(null!=this.linkRange){let e=this.linkRange;this.restoreFocus(),this.quill.formatText(e,"link",!1,lr.sources.USER),delete this.linkRange}e.preventDefault(),this.hide()}),this.quill.on(lr.events.SELECTION_CHANGE,(e,t,r)=>{if(null!=e){if(0===e.length&&r===lr.sources.USER){let[t,r]=this.quill.scroll.descendant(cP,e.index);if(null!=t){this.linkRange=new li(e.index-r,t.length());let n=cP.formats(t.domNode);this.preview.textContent=n,this.preview.setAttribute("href",n),this.show();let i=this.quill.getBounds(this.linkRange);null!=i&&this.position(i);return}}else delete this.linkRange;this.hide()}})}show(){super.show(),this.root.removeAttribute("data-mode")}}class up extends uo{constructor(e,t){null!=t.modules.toolbar&&null==t.modules.toolbar.container&&(t.modules.toolbar.container=ud),super(e,t),this.quill.container.classList.add("ql-snow")}extendToolbar(e){null!=e.container&&(e.container.classList.add("ql-snow"),this.buildButtons(e.container.querySelectorAll("button"),c5),this.buildPickers(e.container.querySelectorAll("select"),c5),this.tooltip=new uh(this.quill,this.options.bounds),e.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"k",shortKey:!0},(t,r)=>{e.handlers.link.call(e,!r.format.link)}))}}up.DEFAULTS=sf({},uo.DEFAULTS,{modules:{toolbar:{handlers:{link(e){if(e){let e=this.quill.getSelection();if(null==e||0===e.length)return;let t=this.quill.getText(e);/^\S+@\S+\.\S+$/.test(t)&&0!==t.indexOf("mailto:")&&(t=`mailto:${t}`);let{tooltip:r}=this.quill.theme;r.edit("link",t)}else this.quill.format("link",!1,lO.sources.USER)}}}}}),lO.register({"attributors/attribute/direction":lY,"attributors/class/align":lF,"attributors/class/background":lX,"attributors/class/color":lz,"attributors/class/direction":lZ,"attributors/class/font":l0,"attributors/class/size":l2,"attributors/style/align":lU,"attributors/style/background":lV,"attributors/style/color":lH,"attributors/style/direction":lJ,"attributors/style/font":l1,"attributors/style/size":l5},!0),lO.register({"formats/align":lF,"formats/direction":lZ,"formats/indent":cS,"formats/background":lV,"formats/color":lH,"formats/font":l0,"formats/size":l2,"formats/blockquote":ck,"formats/code-block":lK,"formats/header":cN,"formats/list":cI,"formats/bold":cR,"formats/code":lW,"formats/italic":class extends cR{static blotName="italic";static tagName=["EM","I"]},"formats/link":cP,"formats/script":cD,"formats/strike":class extends cR{static blotName="strike";static tagName=["S","STRIKE"]},"formats/underline":cM,"formats/formula":cj,"formats/image":cF,"formats/video":cq,"modules/syntax":c$,"modules/table":cJ,"modules/toolbar":c0,"themes/bubble":uu,"themes/snow":up,"ui/icons":c5,"ui/picker":c6,"ui/icon-picker":c9,"ui/color-picker":c8,"ui/tooltip":c7},!0);var uf=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=t.reduce(function(e,t,r){return e[t.id]=r,e},{});return(e.match(/({[^}]+})|([^{}]+)/g)||[]).map(function(e){if(!(e.startsWith("{")&&e.endsWith("}")))return e;var o=e.substring(1,e.length-1),a=t[i[o]];if(!a)return o;var l=a.values&&r[a.id]?"".concat(r$(a.values.filter(function(e){return r[a.id].includes(e.id)}).map(function(e){return e.label}),n("AND"),"",!1)):" ... ";return s()("strong",l)})},um=function(){return{view:function(e){var t=e.attrs,r=t.template,n=t.state,i=n.model,o=n.curNarrative,a=t.className,l=i.scenario.components,c=void 0===l?[]:l,u=(void 0===o?{}:o).components,d=void 0===u?{}:u;return r.split(/\{(\d+)\}/g).map(function(e){return e.replace(/^\d+$/,function(e){return+e<=c.length?"{".concat(c[e-1].id,"}"):"??? ".concat(e," ???")})}).join("").split(/\n/g).map(function(e){return e.trim()}).filter(Boolean).map(function(e){return s()(".scenario-paragraph",{className:a},[uf(e,c,d)])})}}};function ug(e,t,r,n,i,o,s){try{var a=e[o](s),l=a.value}catch(e){r(e);return}a.done?t(l):Promise.resolve(l).then(n,i)}function ub(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function s(e){ug(o,n,i,s,a,"next",e)}function a(e){ug(o,n,i,s,a,"throw",e)}s(void 0)})}}function uv(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uy(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){uv(e,t,r[t])})}return e}function uw(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r})(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}function ux(e,t){var r,n,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(l){var c=[a,l];if(r)throw TypeError("Generator is already executing.");for(;s&&(s=0,c[0]&&(o=0)),o;)try{if(r=1,n&&(i=2&c[0]?n.return:c[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,c[1])).done)return i;switch(n=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===c[0]||2===c[0])){o=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(6===c[0]&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],n=0}finally{r=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var uE=function(){return{view:function(e){var t=e.attrs,r=t.on,n=t.off,i=t.value,o=t.disabled,a=t.callback;return s()(g,{className:"clickable".concat(o?" grey-text":""),iconName:i?r:n,disabled:o,onclick:o?{}:function(){return a(!i)}})}}},u_=function(e){var t=e.probability,r=e.impact;if("string"==typeof t&&"string"==typeof r){var n=+t.replace(/[a-zA-Z_]/g,""),i=+r.replace(/[a-zA-Z_]/g,"");e.risk="risk_"+[[0,0,1,2,3],[0,1,2,3,4],[1,2,3,4,4],[2,3,4,4,4],[3,4,4,4,4]][n][i]}},uT=function(){var e=!1;return{view:function(t){var r=t.attrs,i=r.catId,o=r.excluded,a=r.state,l=a.model,c=a.excludedComps,u=void 0===c?{}:c,d=a.lockedComps,h=void 0===d?{}:d,p=a.curNarrative,f=void 0===p?{}:p,g=l.scenario,b=g.categories,v=void 0===b?[]:b,y=g.components,w=v.length>1,x=v.filter(function(e){return e.id===i}).shift(),E=null==x?void 0:x.componentIds,_=E&&(void 0===y?[]:y).filter(function(e){return E.indexOf(e.id)>=0}),T=f.components,O=void 0===T?{}:T;return x&&_&&s()(".scenario-table.row",[s()(".col.s10.m11",w&&s()("h5.truncate",x.label)),s()(".col.s2.m1.icons",[s()(uE,{on:"lock_open",off:"lock",value:e,callback:function(t){e=t,r.update({lockedComps:function(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return null==x||null==(t=x.componentIds)||t.forEach(function(t){return r[t]=e}),r}})}})]),_.map(function(e){var t;return[s()(ep,{label:e.label,className:"col s11",multiple:!0,disabled:void 0!==u[e.id]&&u[e.id],checkedId:O[e.id],options:null==(t=e.values)?void 0:t.filter(function(e){return!o.has(e.id)}),placeholder:n("i18n","pick"),onchange:function(t){f.components||(f.components={}),f.components[e.id]=t,nm(r,f)}}),,s()(".col.s1.icons",[s()(uE,{on:"lock_open",off:"lock",disabled:e.manual,value:!e.manual&&!h[e.id],callback:function(t){r.update({lockedComps:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r[e.id]=!t,r}})}})])]})])}}},uO=function(){var e,t=!1,r=0,i=!0,o=!0;return{oninit:function(e){return nd(e.attrs,a.CREATE_SCENARIO)},view:function(a){var l=a.attrs,u=l.state,d=u.model,h=u.curNarrative,p=void 0===h?{}:h,f=u.lockedComps,g=void 0===f?{}:f,b=d.personas,v=d.scenario,w=v.template,x=v.categories,E=void 0===x?[]:x,_=v.inconsistencies,T=void 0===_?{}:_,O=v.hideInconsistentValues,A=v.llm,S=v.personas,k=void 0===S?[]:S,N=v.includeDecisionSupport,C=N&&k.length>0?(void 0===b?[]:b).filter(function(e){return k.includes(e.id)}):[],I=d.scenario&&d.scenario.narratives,R=p.components&&void 0!==O&&O?Object.keys(p.components).filter(function(e){return p.components[e]}).reduce(function(e,t){return p.components[t].forEach(function(t){return T[t]&&Object.keys(T[t]).forEach(function(r){return T[t][r]&&e.add(r)})}),e},new Set):new Set,P=r0(d.scenario.narratives),L=(null==A?void 0:A.autoLLMCount)||10;return s()(".create-scenario.row",[s()(".col.s12",[s()(y,{label:n("GENERATE_NARRATIVE"),iconName:"refresh",onclick:function(){var e=p.components,t=void 0===e?{}:e,i=t?Object.keys(g).reduce(function(e,r){return g[r]&&(e[r]=t[r]),e},{}):{};d.scenario.components.filter(function(e){return e.manual}).forEach(function(e){i[e.id]=t[e.id]});var o=rY(d.scenario,i);o?(r++,l.update({curNarrative:function(){return o}})):alert(n("NO_NARRATIVE"))}}),s()(y,{label:n("CLEAR_NARRATIVE"),iconName:"clear",style:"margin-left: 10px;",onclick:function(){r=+(0===r),e.setContents([]),l.update({lockedComps:function(){return{}},curNarrative:function(){return{included:!1}}})}}),d.scenario.llm&&[s()(y,{label:n("ASK_LLM"),iconName:"auto_awesome",style:"margin-left: 10px;",disabled:!p.components||!i,onclick:function(){return ub(function(){var t,r;return ux(this,function(n){switch(n.label){case 0:return i=!1,p.label="",p.desc="",e.setContents(r4("")),[4,im(d.scenario.llm,p,d.scenario.categories,d.scenario.components).catch(function(e){console.error(e),M.toast({html:e}),i=!0,s().redraw()})];case 1:return console.log(t=n.sent()),i=!0,t&&(r=r4("string"==typeof t?t:t.content),e.setContents(r),"string"!=typeof t&&(p.label=t.title)),s().redraw(),[2]}})})()}}),s()(y,{label:n("AUTO_CREATE","BTN"),title:n("AUTO_CREATE_MSG",+L),iconName:"auto_awesome_motion",onclick:function(){return ub(function(){var t,r,n,o,a,c,u;return ux(this,function(h){switch(h.label){case 0:i=!1,n=(r=void 0===(t=p.components)?{}:t)?Object.keys(g).reduce(function(e,t){return g[t]&&(e[t]=r[t]),e},{}):{},d.scenario.components.filter(function(e){return e.manual}).forEach(function(e){n[e.id]=r[e.id]}),o=0,h.label=1;case 1:if(!(o<L))return[3,4];if(!(a=rY(d.scenario,n)))return[3,3];return[4,im(d.scenario.llm,a,d.scenario.categories,d.scenario.components).catch(function(e){console.error(e),M.toast({html:e}),i=!0,s().redraw()})];case 2:console.log(c=h.sent()),c&&(o++,u=r4("string"==typeof c?c:c.content),e.setContents(u),a.desc=JSON.stringify(e.getContents()),"string"!=typeof c?(M.toast({html:"".concat(o,". ").concat(c.title)}),a.label=c.title):M.toast({html:"".concat(o,". ").concat(c)}),nf(l,a),s().redraw()),h.label=3;case 3:return[3,1];case 4:return i=!0,[2]}})})()}})],p.saved?[s()(y,{label:n("CLONE_NARRATIVE"),iconName:"content_copy",style:"margin-left: 10px;",onclick:function(){var e,t=rW(p);t.id=c(),t.saved=!1,t.label=r3(p.label,null==(e=d.scenario.narratives)?void 0:e.map(function(e){return e.label})),nf(l,t)}}),s()(y,{label:n("DELETE"),iconName:"delete",modalId:"deleteSavedNarrative"}),s()(eo,{id:"deleteSavedNarrative",title:n("DELETE_ITEM","title",{item:n("NARRATIVE")}),description:n("DELETE_ITEM","description",{item:n("NARRATIVE")}),buttons:[{label:n("CANCEL")},{label:n("OK"),onclick:function(){r=0,d.scenario.narratives=d.scenario.narratives.filter(function(e){return e.id!==p.id}),t=!0,e.setContents([]),t=!1,l.update({curNarrative:function(){return{included:!1,components:{}}},lockedComps:function(){}}),np(l,d)}}]})]:[s()(y,{label:n("SAVE_NARRATIVE"),iconName:"save",disabled:!p.label||!p.components||0===Object.keys(p.components).length,onclick:function(){nf(l,p)}})],I&&[s()(ep,{className:"right mb0 w30",label:n("SELECT_NARRATIVE"),checkedId:p.saved?p.id:void 0,placeholder:n("i18n","pickOne"),options:P,onchange:function(n){if(n&&n.length>0){r++;var i=I.filter(function(e){return e.id===n[0]}).shift();t=!0;try{e.setContents(i&&i.desc?JSON.parse(i.desc):[])}catch(e){}t=!1,l.update({curNarrative:function(){return i},lockedComps:function(){return d.scenario.components.reduce(function(e,t){return e[t.id]=!0,e},{})}})}}})]]),w?s()(um,uw(uy({},l),{template:w,className:"col s12"})):"",!1===i&&s()(n6),o&&E.map(function(e,t){return s()(".col.s12",{className:"m".concat(Math.round(12/E.length)),key:1e4*r+t},s()(uT,uw(uy({},l),{catId:e.id,excluded:R})))}),s()(".col.s12",s()("i.right.material-icons.small.clickable",{title:n("TOGGLE",o?"HIDE":"SHOW"),className:"right",onclick:function(){o=!o}},o?"visibility_off":"visibility")),s()(".col.s12",[s()(".row",[s()(Y,{className:"col s6 m4",initialValue:p.label,label:n("NAME_NARRATIVE"),required:!0,onchange:function(e){p.label=e,nm(l,p)}}),s()(er,{className:"col s6 m2 mt25",checked:p.included,label:n("INCLUDE_NARRATIVE"),onchange:function(e){p.included=e,nm(l,p)}}),N&&[s()(ep,{key:"prob".concat(p.id),placeholder:n("i18n","pick"),className:"col s6 m2",label:n("PROBABILITY"),initialValue:p.probability,options:rO(0,4).map(function(e){return{id:"probability_".concat(e),label:n("PROB5",e)}}),onchange:function(e){p.probability=e[0],u_(p),nm(l,p)}}),s()(ep,{key:"imp".concat(p.id),placeholder:n("i18n","pick"),className:"col s6 m2",label:n("IMPACT"),initialValue:p.impact,options:rO(0,4).map(function(e){return{id:"impact_".concat(e),label:n("IMP5",e)}}),onchange:function(e){p.impact=e[0],u_(p),nm(l,p)}}),s()(ep,{key:"".concat(p.id,"-").concat(p.probability,"-").concat(p.impact),placeholder:n("RISK_PLACEHOLDER"),className:"col s6 m2",label:n("RISK"),initialValue:p.risk,options:rO(0,4).map(function(e){return{id:"risk_".concat(e),label:n("RISK5",e)}}),disabled:!0})]]),[s()("#editor",{oncreate:function(){(e=new lO("#editor",{modules:{toolbar:[[{header:[1,2,3,!1]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{color:[]}],[{align:[]}],["image","code-block"]]},placeholder:n("EDITOR_PLACEHOLDER"),readOnly:!1,theme:"snow"})).on("text-change",function(){if(!t){var r=l.getState().curNarrative;r&&(r.desc=JSON.stringify(e.getContents()),console.log(r.desc),nm(l,r))}}),p&&e.setContents(p.desc?JSON.parse(p.desc):[])}})],[C.map(function(e){var t,r;return s()(".row.persona",[s()(".col.s12",s()("h5",e.label)),s()(".col.s6",[s()("img.reponsive-image",{style:{height:"200px"},src:null==(t=tJ.find(function(t){return t.id===e.url}))?void 0:t.img,alt:e.label}),s()("p",e.desc)]),s()(".col.s6",s()(W,{label:n("PERSONA_IMPRESSION"),initialValue:p.personaEffects?null==(r=p.personaEffects[e.id])?void 0:r.story:void 0,onchange:function(t){var r=p.personaEffects&&p.personaEffects[e.id];console.log(r),r?r.story=t:p.personaEffects?p.personaEffects[e.id]={scale:0,story:t}:p.personaEffects=uv({},e.id,{scale:0,story:t}),nm(l,p)}}))])})]])])}}},uA=r(987),uS=function(e){var t=e.body,r=e.lang,n=e.css;return'\n<!doctype html>\n<html lang="'.concat(r,'">\n<head>\n  ').concat(void 0===n?uk:n,"\n</head>\n\n<body>\n  ").concat(t,"\n</body>\n</html>\n")},uk="<style>\ntd, th {\n  text-align: left;\n  border: 1px solid black;\n  padding: 0.5rem;\n}\nth {\n  background-color:#999;\n}\ntable {\n  font-family: Calibri;\n  font-size: 11pt;\n  width: 100%;\n  border-collapse: collapse;\n  border-spacing: 0.5rem;\n}\n</style>";function uN(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function uC(e,t,r,n,i,o,s){try{var a=e[o](s),l=a.value}catch(e){r(e);return}a.done?t(l):Promise.resolve(l).then(n,i)}var uI=function(){var e;return{oninit:function(){return e=c()},view:function(t){var r=t.attrs,i=r.curNarrative,o=r.comps,a=(void 0===i?{}:i).components,l=o&&o.reduce(function(e,t){return t.values&&t.values.forEach(function(r){e[t.id+r.id]=r.label}),e},{});return[s()("table.highlight",{id:e},[s()("thead",s()("tr",[s()("th",n("DIMENSION")),s()("th",n("KEY_VALUE"))])),s()("tbody",a&&o&&l&&o.filter(function(e){return a[e.id]}).map(function(e){return s()("tr",[s()("th",e.label),s()("td",a[e.id].map(function(t){return l[e.id+t]}).join(", "))])}))]),s()(y,{label:n("COPY_TO_CLIPBOARD"),className:"right",iconName:"content_copy",onclick:function(){var t=function(t){if(t.clipboardData){var r=document.getElementById(e);r&&(t.clipboardData.setData("text/html",uS({body:r.outerHTML,lang:nI.currentLocale})),t.preventDefault())}};document.addEventListener("copy",t),document.execCommand("copy"),document.removeEventListener("copy",t)}})]}}},uR=function(){var e,t=function(e,t){var r;return(r=function(){var r,n,i,o,s;return function(e,t){var r,n,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(l){var c=[a,l];if(r)throw TypeError("Generator is already executing.");for(;s&&(s=0,c[0]&&(o=0)),o;)try{if(r=1,n&&(i=2&c[0]?n.return:c[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,c[1])).done)return i;switch(n=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===c[0]||2===c[0])){o=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(6===c[0]&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],n=0}finally{r=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(a){switch(a.label){case 0:return i={ops:[]},(n=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;e.ops&&t&&e.ops.push({insert:t},{attributes:{header:r},insert:"\n"})})(i,null==e||null==(r=e.scenario)?void 0:r.label),t.forEach(function(e){if(n(i,null==e?void 0:e.label,2),e.desc)try{var t,r,o=JSON.parse(e.desc);o.ops&&o.ops.length&&(r=i.ops).push.apply(r,(t=o.ops,function(e){if(Array.isArray(e))return uN(e)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return uN(e,void 0);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uN(e,t)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))}catch(e){}}),[4,(0,uA.generateWord)(i,{exportAs:"blob",paragraphStyles:{normal:{paragraph:{spacing:{before:0,after:12}},run:{font:"Calibri",size:24}}}})];case 1:if(o=a.sent(),!(s=document.getElementById("downloadAnchorElem")))return[2];return e.version=e.version?e.version++:1,s.setAttribute("href",URL.createObjectURL(o)),s.setAttribute("download","".concat(rG(e,1===t.length?t[0].label:void 0),".docx")),s.click(),[2]}})},function(){var e=this,t=arguments;return new Promise(function(n,i){var o=r.apply(e,t);function s(e){uC(o,n,i,s,a,"next",e)}function a(e){uC(o,n,i,s,a,"throw",e)}s(void 0)})})()},r=function(e,t,r,n){e&&(t.setContents(e.desc?JSON.parse(e.desc):[]),r.update({curNarrative:function(){return r_(e)},lockedComps:function(){return n.scenario.components.reduce(function(e,t){return e[t.id]=!0,e},{})}}))};return{oninit:function(e){return nd(e.attrs,a.SHOW_SCENARIO)},view:function(i){var o,a,l=i.attrs,c=l.state,u=c.model,d=c.curNarrative,h=u.scenario,p=h.template,f=h.categories,g=void 0===f?[]:f,b=h.components,v=void 0===b?[]:b,w=h.narratives,x=void 0===w?[]:w,E=g.length>1;if((!d||!d.saved)&&x.length>0){var _=x[0];l.update({curNarrative:function(){return r_(_)}});return}var T=r0(u.scenario.narratives),O=d?x.findIndex(function(e){return e.id===d.id}):-1;return s()(".show-scenario.row",[s()("a#downloadAnchorElem",{style:"display:none"}),d&&s()(".col.s12",[d.risk&&s()("img[title=risk-status].right",{src:r2(r5(r1[+d.risk.replace("risk_","")],48))}),s()(y,{label:n("EXPORT2WORD","TITLE"),iconName:"download",className:"right",disabled:!d.desc,modalId:"exportToWord"}),s()(er,{checked:d.included,label:n("NARRATIVE_INCLUDED"),disabled:!0,className:"right mt3"}),s()(eo,{id:"exportToWord",title:n("EXPORT2WORD","TITLE"),fixedFooter:!0,description:s()(".export-modal",s()(".row",s()(".col.s12",n("EXPORT2WORD","DESC")))),options:{opacity:.7},buttons:[{label:n("EXPORT2WORD","CURRENT"),onclick:function(){return t(u,[d])}},{label:n("EXPORT2WORD","SELECTED"),disabled:0===x.filter(function(e){return e.included}).length,onclick:function(){return t(u,x.filter(function(e){return e.included}))}},{label:n("EXPORT2WORD","ALL"),onclick:function(){return t(u,x)}},{label:n("CANCEL")}]})])],u.scenario&&u.scenario.narratives&&u.scenario.narratives.length>0&&[s()(".col.s12",s()(".row",s()(ep,{className:"col s7 m8 l10 mb0 mw30",label:n("SELECT_NARRATIVE"),checkedId:d&&d.saved?d.id:void 0,placeholder:n("i18n","pickOne"),options:T,onchange:function(t){t&&t.length>0&&r(u.scenario.narratives.find(function(e){return e.id===t[0]}),e,l,u)}}),s()(".right.mb0",s()("i.material-icons.medium",{className:O<x.length-1?"blue-text clickable":"grey-text",onclick:function(){O<x.length-1&&r(x[O+1],e,l,u)}},"arrow_right")),s()(".right.mb0",s()("i.material-icons.medium",{className:O>0?"blue-text clickable":"grey-text",onclick:function(){O>0&&r(x[O-1],e,l,u)}},"arrow_left")))),d&&[s()(".col.s12",{oncreate:function(){(e=new lO("#editor",{modules:{toolbar:!1},readOnly:!0,theme:"snow"})).setContents(d.desc?JSON.parse(d.desc):[])}},s()("#editor.row",{})),p?s()(".col.s12",s()(um,(o=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({},l),a=a={template:p},Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(a)):(function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r})(Object(a)).forEach(function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(a,e))}),o))):"",s()(".col.s12",s()(".row",[g.map(function(e){var t=e&&e.componentIds,r=t&&v.filter(function(e){return t.indexOf(e.id)>=0});return s()(".col",{className:"s".concat(12/g.length)},E&&s()("h5",e.label),s()(uI,{curNarrative:d,comps:r}))})]))]])}}};function uP(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function uL(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r,n,i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var o=[],s=!0,a=!1;try{for(i=i.call(e);!(s=(r=i.next()).done)&&(o.push(r.value),!t||o.length!==t);s=!0);}catch(e){a=!0,n=e}finally{try{s||null==i.return||i.return()}finally{if(a)throw n}}return o}}(e,t)||uM(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function uD(e){return function(e){if(Array.isArray(e))return uP(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||uM(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function uM(e,t){if(e){if("string"==typeof e)return uP(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uP(e,t)}}var uj=function(){var e,t=function(e,t,r){return{id:e,label:t,values:r}},r=["probability","impact","risk"],i=function(r){var i=r.scenario,o=i.components;e=i.categories.filter(function(e){return e.decisionSupport}).reduce(function(e,t){return e.push.apply(e,uD(o.filter(function(e){return t.componentIds&&t.componentIds.includes(e.id)}))),e},[t("probability",n("PROBABILITY"),rO(0,4).map(function(e){return{id:"probability_".concat(e),label:n("PROB5",e)}})),t("impact",n("IMPACT"),rO(0,4).map(function(e){return{id:"impact_".concat(e),label:n("IMP5",e)}})),t("risk",n("RISK"),rO(0,4).map(function(e){return{id:"risk_".concat(e),label:n("RISK5",e)}}))])};return{oninit:function(e){nd(e.attrs,a.DECISION_SUPPORT)},view:function(t){var o,a,l=t.attrs,c=l.state.model,u=c.scenario.narratives;i(c);var d=(void 0===u?[]:u).filter(function(e){return e.included}).sort(function(e,t){return(e.label||"").localeCompare(t.label)}),h=d.map(function(e){return e.risk||"0"}).map(function(e){return+e.replace("risk_","")+1}),p={id:"suggested_approach",included:!0,saved:!1,label:n("SUGGESTED_APPROACH","TITLE"),desc:n("SUGGESTED_APPROACH","DESC"),personaEffects:{},components:e.filter(function(e){return!r.includes(e.id)}).reduce(function(e,t){var r,n=d.map(function(e){return e.components&&e.components[t.id]}).reduce(function(e,t,r){return t&&0!==t.length&&t.filter(function(e){return e}).forEach(function(t){return e.set(t,(e.get(t)||0)+h[r])}),e},new Map),i=(r=Math).max.apply(r,uD(Array.from(n.values())));return e[t.id]=Array.from(n.entries()).filter(function(e){var t=uL(e,2);return t[0],t[1]===i}).map(function(e){var t=uL(e,2),r=t[0];return t[1],r}),e},{})};return d.push(p),s()(".row.decision-support",[s()(n3,(o=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({},l),a=a={narratives:d,components:e},Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(a)):(function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r})(Object(a)).forEach(function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(a,e))}),o))])}}},uB=new(function(){var e;function t(){var e,r;if(!(this instanceof t))throw TypeError("Cannot call a class as a function");r=void 0,(e="dashboards")in this?Object.defineProperty(this,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[e]=r}return e=[{key:"init",value:function(){var e=[{id:a.HOME,icon:"home",title:n("HOME","TITLE"),route:n("HOME","ROUTE"),visible:!0,default:!0,component:n4},{id:a.DEFINE_BOX,icon:"grid_view",title:n("DEFINE_BOX","TITLE"),route:n("DEFINE_BOX","ROUTE"),visible:!0,component:iL},{id:a.CREATE_SCENARIO,icon:"edit",title:n("CREATE_SCENARIO","TITLE"),route:n("CREATE_SCENARIO","ROUTE"),visible:!0,component:uO},{id:a.DECISION_SUPPORT,icon:"assistant_direction",title:n("DECISION_SUPPORT","TITLE"),route:n("DECISION_SUPPORT","ROUTE"),visible:function(e){return!!e&&e.includeDecisionSupport},component:uj},{id:a.SHOW_SCENARIO,icon:"visibility",title:n("SHOW_SCENARIO","TITLE"),route:n("SHOW_SCENARIO","ROUTE"),visible:!0,component:uR},{id:a.ABOUT,icon:"info",title:n("ABOUT","TITLE"),route:n("ABOUT","ROUTE"),visible:!0,component:nG},{id:a.SETTINGS,icon:"settings",iconClass:"secondary",title:n("SETTINGS","TITLE"),route:n("SETTINGS","ROUTE"),visible:!0,component:iE}];this.setList(e)}},{key:"getList",value:function(){return this.dashboards}},{key:"setList",value:function(e){this.dashboards=Object.freeze(e)}},{key:"defaultRoute",get:function(){var e=this.dashboards.filter(function(e){return e.default}).shift();return e?e.route:this.dashboards[0].route}},{key:"route",value:function(e,t){var r=this.dashboards.filter(function(t){return t.id===e}).shift();return r?"#!"+r.route+(t?"?"+s().buildQueryString(t):""):this.defaultRoute}},{key:"href",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=this.dashboards.filter(function(t){return t.id===e}).shift();return r?"#!".concat(r.route.replace(/:\w*/,"")).concat(t):this.defaultRoute}},{key:"switchTo",value:function(e,t,r){var n=this.dashboards.filter(function(t){return t.id===e}).shift();if(n){var i=n.route+(r?"?"+s().buildQueryString(r):"");s().route.set(i,t)}}},{key:"routingTable",value:function(){return this.dashboards.reduce(function(e,t){return e[t.route]=!1===t.hasNavBar?{render:function(){return s()(t.component,nw())}}:{render:function(){return s()(nF,nw(),s()(t.component,nw()))}},e},{})}}],function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,e),t}());window.onbeforeunload=function(e){"true"!==localStorage.getItem(rH)&&(localStorage.setItem(rH,"true"),e.preventDefault())},nI.addOnChangeListener(function(e){console.log("Language loaded"),uB.init(),s().route(document.body,uB.defaultRoute,uB.routingTable())}),nI.init({en:{name:"English",fqn:"en-UK",default:!0},nl:{name:"Nederlands",fqn:"nl-NL"}},window.localStorage.getItem(rz)||"nl")})()})();
//# sourceMappingURL=main.js.map